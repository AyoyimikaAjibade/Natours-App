// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
parcelRequire = (function (modules, cache, entry, globalName) {
  // Save the require from previous bundle to this closure if any
  var previousRequire = typeof parcelRequire === 'function' && parcelRequire;
  var nodeRequire = typeof require === 'function' && require;

  function newRequire(name, jumped) {
    if (!cache[name]) {
      if (!modules[name]) {
        // if we cannot find the module within our internal map or
        // cache jump to the current global require ie. the last bundle
        // that was added to the page.
        var currentRequire = typeof parcelRequire === 'function' && parcelRequire;
        if (!jumped && currentRequire) {
          return currentRequire(name, true);
        }

        // If there are other bundles on this page the require from the
        // previous one is saved to 'previousRequire'. Repeat this as
        // many times as there are bundles until the module is found or
        // we exhaust the require chain.
        if (previousRequire) {
          return previousRequire(name, true);
        }

        // Try the node require function if it exists.
        if (nodeRequire && typeof name === 'string') {
          return nodeRequire(name);
        }

        var err = new Error('Cannot find module \'' + name + '\'');
        err.code = 'MODULE_NOT_FOUND';
        throw err;
      }

      localRequire.resolve = resolve;
      localRequire.cache = {};

      var module = cache[name] = new newRequire.Module(name);

      modules[name][0].call(module.exports, localRequire, module, module.exports, this);
    }

    return cache[name].exports;

    function localRequire(x){
      return newRequire(localRequire.resolve(x));
    }

    function resolve(x){
      return modules[name][1][x] || x;
    }
  }

  function Module(moduleName) {
    this.id = moduleName;
    this.bundle = newRequire;
    this.exports = {};
  }

  newRequire.isParcelRequire = true;
  newRequire.Module = Module;
  newRequire.modules = modules;
  newRequire.cache = cache;
  newRequire.parent = previousRequire;
  newRequire.register = function (id, exports) {
    modules[id] = [function (require, module) {
      module.exports = exports;
    }, {}];
  };

  var error;
  for (var i = 0; i < entry.length; i++) {
    try {
      newRequire(entry[i]);
    } catch (e) {
      // Save first error but execute all entries
      if (!error) {
        error = e;
      }
    }
  }

  if (entry.length) {
    // Expose entry point to Node, AMD or browser globals
    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
    var mainExports = newRequire(entry[entry.length - 1]);

    // CommonJS
    if (typeof exports === "object" && typeof module !== "undefined") {
      module.exports = mainExports;

    // RequireJS
    } else if (typeof define === "function" && define.amd) {
     define(function () {
       return mainExports;
     });

    // <script>
    } else if (globalName) {
      this[globalName] = mainExports;
    }
  }

  // Override the current require with this new one
  parcelRequire = newRequire;

  if (error) {
    // throw error from earlier, _after updating parcelRequire_
    throw error;
  }

  return newRequire;
})({"../../node_modules/core-js/modules/_global.js":[function(require,module,exports) {

// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
var global = module.exports = typeof window != 'undefined' && window.Math == Math
  ? window : typeof self != 'undefined' && self.Math == Math ? self
  // eslint-disable-next-line no-new-func
  : Function('return this')();
if (typeof __g == 'number') __g = global; // eslint-disable-line no-undef

},{}],"../../node_modules/core-js/modules/_core.js":[function(require,module,exports) {
var core = module.exports = { version: '2.6.12' };
if (typeof __e == 'number') __e = core; // eslint-disable-line no-undef

},{}],"../../node_modules/core-js/modules/_is-object.js":[function(require,module,exports) {
module.exports = function (it) {
  return typeof it === 'object' ? it !== null : typeof it === 'function';
};

},{}],"../../node_modules/core-js/modules/_an-object.js":[function(require,module,exports) {
var isObject = require('./_is-object');
module.exports = function (it) {
  if (!isObject(it)) throw TypeError(it + ' is not an object!');
  return it;
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js"}],"../../node_modules/core-js/modules/_fails.js":[function(require,module,exports) {
module.exports = function (exec) {
  try {
    return !!exec();
  } catch (e) {
    return true;
  }
};

},{}],"../../node_modules/core-js/modules/_descriptors.js":[function(require,module,exports) {
// Thank's IE8 for his funny defineProperty
module.exports = !require('./_fails')(function () {
  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;
});

},{"./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/_dom-create.js":[function(require,module,exports) {
var isObject = require('./_is-object');
var document = require('./_global').document;
// typeof document.createElement is 'object' in old IE
var is = isObject(document) && isObject(document.createElement);
module.exports = function (it) {
  return is ? document.createElement(it) : {};
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/_ie8-dom-define.js":[function(require,module,exports) {
module.exports = !require('./_descriptors') && !require('./_fails')(function () {
  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;
});

},{"./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_dom-create":"../../node_modules/core-js/modules/_dom-create.js"}],"../../node_modules/core-js/modules/_to-primitive.js":[function(require,module,exports) {
// 7.1.1 ToPrimitive(input [, PreferredType])
var isObject = require('./_is-object');
// instead of the ES6 spec version, we didn't implement @@toPrimitive case
// and the second argument - flag - preferred type is a string
module.exports = function (it, S) {
  if (!isObject(it)) return it;
  var fn, val;
  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;
  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  throw TypeError("Can't convert object to primitive value");
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js"}],"../../node_modules/core-js/modules/_object-dp.js":[function(require,module,exports) {
var anObject = require('./_an-object');
var IE8_DOM_DEFINE = require('./_ie8-dom-define');
var toPrimitive = require('./_to-primitive');
var dP = Object.defineProperty;

exports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {
  anObject(O);
  P = toPrimitive(P, true);
  anObject(Attributes);
  if (IE8_DOM_DEFINE) try {
    return dP(O, P, Attributes);
  } catch (e) { /* empty */ }
  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');
  if ('value' in Attributes) O[P] = Attributes.value;
  return O;
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_ie8-dom-define":"../../node_modules/core-js/modules/_ie8-dom-define.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js"}],"../../node_modules/core-js/modules/_property-desc.js":[function(require,module,exports) {
module.exports = function (bitmap, value) {
  return {
    enumerable: !(bitmap & 1),
    configurable: !(bitmap & 2),
    writable: !(bitmap & 4),
    value: value
  };
};

},{}],"../../node_modules/core-js/modules/_hide.js":[function(require,module,exports) {
var dP = require('./_object-dp');
var createDesc = require('./_property-desc');
module.exports = require('./_descriptors') ? function (object, key, value) {
  return dP.f(object, key, createDesc(1, value));
} : function (object, key, value) {
  object[key] = value;
  return object;
};

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js"}],"../../node_modules/core-js/modules/_has.js":[function(require,module,exports) {
var hasOwnProperty = {}.hasOwnProperty;
module.exports = function (it, key) {
  return hasOwnProperty.call(it, key);
};

},{}],"../../node_modules/core-js/modules/_uid.js":[function(require,module,exports) {
var id = 0;
var px = Math.random();
module.exports = function (key) {
  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));
};

},{}],"../../node_modules/core-js/modules/_library.js":[function(require,module,exports) {
module.exports = false;

},{}],"../../node_modules/core-js/modules/_shared.js":[function(require,module,exports) {

var core = require('./_core');
var global = require('./_global');
var SHARED = '__core-js_shared__';
var store = global[SHARED] || (global[SHARED] = {});

(module.exports = function (key, value) {
  return store[key] || (store[key] = value !== undefined ? value : {});
})('versions', []).push({
  version: core.version,
  mode: require('./_library') ? 'pure' : 'global',
  copyright: 'Â© 2020 Denis Pushkarev (zloirock.ru)'
});

},{"./_core":"../../node_modules/core-js/modules/_core.js","./_global":"../../node_modules/core-js/modules/_global.js","./_library":"../../node_modules/core-js/modules/_library.js"}],"../../node_modules/core-js/modules/_function-to-string.js":[function(require,module,exports) {
module.exports = require('./_shared')('native-function-to-string', Function.toString);

},{"./_shared":"../../node_modules/core-js/modules/_shared.js"}],"../../node_modules/core-js/modules/_redefine.js":[function(require,module,exports) {

var global = require('./_global');
var hide = require('./_hide');
var has = require('./_has');
var SRC = require('./_uid')('src');
var $toString = require('./_function-to-string');
var TO_STRING = 'toString';
var TPL = ('' + $toString).split(TO_STRING);

require('./_core').inspectSource = function (it) {
  return $toString.call(it);
};

(module.exports = function (O, key, val, safe) {
  var isFunction = typeof val == 'function';
  if (isFunction) has(val, 'name') || hide(val, 'name', key);
  if (O[key] === val) return;
  if (isFunction) has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));
  if (O === global) {
    O[key] = val;
  } else if (!safe) {
    delete O[key];
    hide(O, key, val);
  } else if (O[key]) {
    O[key] = val;
  } else {
    hide(O, key, val);
  }
// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative
})(Function.prototype, TO_STRING, function toString() {
  return typeof this == 'function' && this[SRC] || $toString.call(this);
});

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_has":"../../node_modules/core-js/modules/_has.js","./_uid":"../../node_modules/core-js/modules/_uid.js","./_function-to-string":"../../node_modules/core-js/modules/_function-to-string.js","./_core":"../../node_modules/core-js/modules/_core.js"}],"../../node_modules/core-js/modules/_a-function.js":[function(require,module,exports) {
module.exports = function (it) {
  if (typeof it != 'function') throw TypeError(it + ' is not a function!');
  return it;
};

},{}],"../../node_modules/core-js/modules/_ctx.js":[function(require,module,exports) {
// optional / simple context binding
var aFunction = require('./_a-function');
module.exports = function (fn, that, length) {
  aFunction(fn);
  if (that === undefined) return fn;
  switch (length) {
    case 1: return function (a) {
      return fn.call(that, a);
    };
    case 2: return function (a, b) {
      return fn.call(that, a, b);
    };
    case 3: return function (a, b, c) {
      return fn.call(that, a, b, c);
    };
  }
  return function (/* ...args */) {
    return fn.apply(that, arguments);
  };
};

},{"./_a-function":"../../node_modules/core-js/modules/_a-function.js"}],"../../node_modules/core-js/modules/_export.js":[function(require,module,exports) {

var global = require('./_global');
var core = require('./_core');
var hide = require('./_hide');
var redefine = require('./_redefine');
var ctx = require('./_ctx');
var PROTOTYPE = 'prototype';

var $export = function (type, name, source) {
  var IS_FORCED = type & $export.F;
  var IS_GLOBAL = type & $export.G;
  var IS_STATIC = type & $export.S;
  var IS_PROTO = type & $export.P;
  var IS_BIND = type & $export.B;
  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE];
  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});
  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});
  var key, own, out, exp;
  if (IS_GLOBAL) source = name;
  for (key in source) {
    // contains in native
    own = !IS_FORCED && target && target[key] !== undefined;
    // export native or passed
    out = (own ? target : source)[key];
    // bind timers to global for call from export context
    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;
    // extend global
    if (target) redefine(target, key, out, type & $export.U);
    // export
    if (exports[key] != out) hide(exports, key, exp);
    if (IS_PROTO && expProto[key] != out) expProto[key] = out;
  }
};
global.core = core;
// type bitmap
$export.F = 1;   // forced
$export.G = 2;   // global
$export.S = 4;   // static
$export.P = 8;   // proto
$export.B = 16;  // bind
$export.W = 32;  // wrap
$export.U = 64;  // safe
$export.R = 128; // real proto method for `library`
module.exports = $export;

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_core":"../../node_modules/core-js/modules/_core.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js"}],"../../node_modules/core-js/modules/_defined.js":[function(require,module,exports) {
// 7.2.1 RequireObjectCoercible(argument)
module.exports = function (it) {
  if (it == undefined) throw TypeError("Can't call method on  " + it);
  return it;
};

},{}],"../../node_modules/core-js/modules/_to-object.js":[function(require,module,exports) {
// 7.1.13 ToObject(argument)
var defined = require('./_defined');
module.exports = function (it) {
  return Object(defined(it));
};

},{"./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/_to-integer.js":[function(require,module,exports) {
// 7.1.4 ToInteger
var ceil = Math.ceil;
var floor = Math.floor;
module.exports = function (it) {
  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);
};

},{}],"../../node_modules/core-js/modules/_to-absolute-index.js":[function(require,module,exports) {
var toInteger = require('./_to-integer');
var max = Math.max;
var min = Math.min;
module.exports = function (index, length) {
  index = toInteger(index);
  return index < 0 ? max(index + length, 0) : min(index, length);
};

},{"./_to-integer":"../../node_modules/core-js/modules/_to-integer.js"}],"../../node_modules/core-js/modules/_to-length.js":[function(require,module,exports) {
// 7.1.15 ToLength
var toInteger = require('./_to-integer');
var min = Math.min;
module.exports = function (it) {
  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991
};

},{"./_to-integer":"../../node_modules/core-js/modules/_to-integer.js"}],"../../node_modules/core-js/modules/_array-copy-within.js":[function(require,module,exports) {
// 22.1.3.3 Array.prototype.copyWithin(target, start, end = this.length)
'use strict';
var toObject = require('./_to-object');
var toAbsoluteIndex = require('./_to-absolute-index');
var toLength = require('./_to-length');

module.exports = [].copyWithin || function copyWithin(target /* = 0 */, start /* = 0, end = @length */) {
  var O = toObject(this);
  var len = toLength(O.length);
  var to = toAbsoluteIndex(target, len);
  var from = toAbsoluteIndex(start, len);
  var end = arguments.length > 2 ? arguments[2] : undefined;
  var count = Math.min((end === undefined ? len : toAbsoluteIndex(end, len)) - from, len - to);
  var inc = 1;
  if (from < to && to < from + count) {
    inc = -1;
    from += count - 1;
    to += count - 1;
  }
  while (count-- > 0) {
    if (from in O) O[to] = O[from];
    else delete O[to];
    to += inc;
    from += inc;
  } return O;
};

},{"./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js"}],"../../node_modules/core-js/modules/_wks.js":[function(require,module,exports) {
var store = require('./_shared')('wks');
var uid = require('./_uid');
var Symbol = require('./_global').Symbol;
var USE_SYMBOL = typeof Symbol == 'function';

var $exports = module.exports = function (name) {
  return store[name] || (store[name] =
    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));
};

$exports.store = store;

},{"./_shared":"../../node_modules/core-js/modules/_shared.js","./_uid":"../../node_modules/core-js/modules/_uid.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/_add-to-unscopables.js":[function(require,module,exports) {
// 22.1.3.31 Array.prototype[@@unscopables]
var UNSCOPABLES = require('./_wks')('unscopables');
var ArrayProto = Array.prototype;
if (ArrayProto[UNSCOPABLES] == undefined) require('./_hide')(ArrayProto, UNSCOPABLES, {});
module.exports = function (key) {
  ArrayProto[UNSCOPABLES][key] = true;
};

},{"./_wks":"../../node_modules/core-js/modules/_wks.js","./_hide":"../../node_modules/core-js/modules/_hide.js"}],"../../node_modules/core-js/modules/es6.array.copy-within.js":[function(require,module,exports) {
// 22.1.3.3 Array.prototype.copyWithin(target, start, end = this.length)
var $export = require('./_export');

$export($export.P, 'Array', { copyWithin: require('./_array-copy-within') });

require('./_add-to-unscopables')('copyWithin');

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-copy-within":"../../node_modules/core-js/modules/_array-copy-within.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/_array-fill.js":[function(require,module,exports) {
// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)
'use strict';
var toObject = require('./_to-object');
var toAbsoluteIndex = require('./_to-absolute-index');
var toLength = require('./_to-length');
module.exports = function fill(value /* , start = 0, end = @length */) {
  var O = toObject(this);
  var length = toLength(O.length);
  var aLen = arguments.length;
  var index = toAbsoluteIndex(aLen > 1 ? arguments[1] : undefined, length);
  var end = aLen > 2 ? arguments[2] : undefined;
  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);
  while (endPos > index) O[index++] = value;
  return O;
};

},{"./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js"}],"../../node_modules/core-js/modules/es6.array.fill.js":[function(require,module,exports) {
// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)
var $export = require('./_export');

$export($export.P, 'Array', { fill: require('./_array-fill') });

require('./_add-to-unscopables')('fill');

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-fill":"../../node_modules/core-js/modules/_array-fill.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/_cof.js":[function(require,module,exports) {
var toString = {}.toString;

module.exports = function (it) {
  return toString.call(it).slice(8, -1);
};

},{}],"../../node_modules/core-js/modules/_iobject.js":[function(require,module,exports) {
// fallback for non-array-like ES3 and non-enumerable old V8 strings
var cof = require('./_cof');
// eslint-disable-next-line no-prototype-builtins
module.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {
  return cof(it) == 'String' ? it.split('') : Object(it);
};

},{"./_cof":"../../node_modules/core-js/modules/_cof.js"}],"../../node_modules/core-js/modules/_is-array.js":[function(require,module,exports) {
// 7.2.2 IsArray(argument)
var cof = require('./_cof');
module.exports = Array.isArray || function isArray(arg) {
  return cof(arg) == 'Array';
};

},{"./_cof":"../../node_modules/core-js/modules/_cof.js"}],"../../node_modules/core-js/modules/_array-species-constructor.js":[function(require,module,exports) {
var isObject = require('./_is-object');
var isArray = require('./_is-array');
var SPECIES = require('./_wks')('species');

module.exports = function (original) {
  var C;
  if (isArray(original)) {
    C = original.constructor;
    // cross-realm fallback
    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;
    if (isObject(C)) {
      C = C[SPECIES];
      if (C === null) C = undefined;
    }
  } return C === undefined ? Array : C;
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_is-array":"../../node_modules/core-js/modules/_is-array.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_array-species-create.js":[function(require,module,exports) {
// 9.4.2.3 ArraySpeciesCreate(originalArray, length)
var speciesConstructor = require('./_array-species-constructor');

module.exports = function (original, length) {
  return new (speciesConstructor(original))(length);
};

},{"./_array-species-constructor":"../../node_modules/core-js/modules/_array-species-constructor.js"}],"../../node_modules/core-js/modules/_array-methods.js":[function(require,module,exports) {
// 0 -> Array#forEach
// 1 -> Array#map
// 2 -> Array#filter
// 3 -> Array#some
// 4 -> Array#every
// 5 -> Array#find
// 6 -> Array#findIndex
var ctx = require('./_ctx');
var IObject = require('./_iobject');
var toObject = require('./_to-object');
var toLength = require('./_to-length');
var asc = require('./_array-species-create');
module.exports = function (TYPE, $create) {
  var IS_MAP = TYPE == 1;
  var IS_FILTER = TYPE == 2;
  var IS_SOME = TYPE == 3;
  var IS_EVERY = TYPE == 4;
  var IS_FIND_INDEX = TYPE == 6;
  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;
  var create = $create || asc;
  return function ($this, callbackfn, that) {
    var O = toObject($this);
    var self = IObject(O);
    var f = ctx(callbackfn, that, 3);
    var length = toLength(self.length);
    var index = 0;
    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;
    var val, res;
    for (;length > index; index++) if (NO_HOLES || index in self) {
      val = self[index];
      res = f(val, index, O);
      if (TYPE) {
        if (IS_MAP) result[index] = res;   // map
        else if (res) switch (TYPE) {
          case 3: return true;             // some
          case 5: return val;              // find
          case 6: return index;            // findIndex
          case 2: result.push(val);        // filter
        } else if (IS_EVERY) return false; // every
      }
    }
    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;
  };
};

},{"./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_iobject":"../../node_modules/core-js/modules/_iobject.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_array-species-create":"../../node_modules/core-js/modules/_array-species-create.js"}],"../../node_modules/core-js/modules/es6.array.find.js":[function(require,module,exports) {
'use strict';
// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)
var $export = require('./_export');
var $find = require('./_array-methods')(5);
var KEY = 'find';
var forced = true;
// Shouldn't skip holes
if (KEY in []) Array(1)[KEY](function () { forced = false; });
$export($export.P + $export.F * forced, 'Array', {
  find: function find(callbackfn /* , that = undefined */) {
    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
  }
});
require('./_add-to-unscopables')(KEY);

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/es6.array.find-index.js":[function(require,module,exports) {
'use strict';
// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)
var $export = require('./_export');
var $find = require('./_array-methods')(6);
var KEY = 'findIndex';
var forced = true;
// Shouldn't skip holes
if (KEY in []) Array(1)[KEY](function () { forced = false; });
$export($export.P + $export.F * forced, 'Array', {
  findIndex: function findIndex(callbackfn /* , that = undefined */) {
    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
  }
});
require('./_add-to-unscopables')(KEY);

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/_flatten-into-array.js":[function(require,module,exports) {
'use strict';
// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray
var isArray = require('./_is-array');
var isObject = require('./_is-object');
var toLength = require('./_to-length');
var ctx = require('./_ctx');
var IS_CONCAT_SPREADABLE = require('./_wks')('isConcatSpreadable');

function flattenIntoArray(target, original, source, sourceLen, start, depth, mapper, thisArg) {
  var targetIndex = start;
  var sourceIndex = 0;
  var mapFn = mapper ? ctx(mapper, thisArg, 3) : false;
  var element, spreadable;

  while (sourceIndex < sourceLen) {
    if (sourceIndex in source) {
      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];

      spreadable = false;
      if (isObject(element)) {
        spreadable = element[IS_CONCAT_SPREADABLE];
        spreadable = spreadable !== undefined ? !!spreadable : isArray(element);
      }

      if (spreadable && depth > 0) {
        targetIndex = flattenIntoArray(target, original, element, toLength(element.length), targetIndex, depth - 1) - 1;
      } else {
        if (targetIndex >= 0x1fffffffffffff) throw TypeError();
        target[targetIndex] = element;
      }

      targetIndex++;
    }
    sourceIndex++;
  }
  return targetIndex;
}

module.exports = flattenIntoArray;

},{"./_is-array":"../../node_modules/core-js/modules/_is-array.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/es7.array.flat-map.js":[function(require,module,exports) {
'use strict';
// https://tc39.github.io/proposal-flatMap/#sec-Array.prototype.flatMap
var $export = require('./_export');
var flattenIntoArray = require('./_flatten-into-array');
var toObject = require('./_to-object');
var toLength = require('./_to-length');
var aFunction = require('./_a-function');
var arraySpeciesCreate = require('./_array-species-create');

$export($export.P, 'Array', {
  flatMap: function flatMap(callbackfn /* , thisArg */) {
    var O = toObject(this);
    var sourceLen, A;
    aFunction(callbackfn);
    sourceLen = toLength(O.length);
    A = arraySpeciesCreate(O, 0);
    flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments[1]);
    return A;
  }
});

require('./_add-to-unscopables')('flatMap');

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_flatten-into-array":"../../node_modules/core-js/modules/_flatten-into-array.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_array-species-create":"../../node_modules/core-js/modules/_array-species-create.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/_iter-call.js":[function(require,module,exports) {
// call something on iterator step with safe closing on error
var anObject = require('./_an-object');
module.exports = function (iterator, fn, value, entries) {
  try {
    return entries ? fn(anObject(value)[0], value[1]) : fn(value);
  // 7.4.6 IteratorClose(iterator, completion)
  } catch (e) {
    var ret = iterator['return'];
    if (ret !== undefined) anObject(ret.call(iterator));
    throw e;
  }
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/_iterators.js":[function(require,module,exports) {
module.exports = {};

},{}],"../../node_modules/core-js/modules/_is-array-iter.js":[function(require,module,exports) {
// check on default Array iterator
var Iterators = require('./_iterators');
var ITERATOR = require('./_wks')('iterator');
var ArrayProto = Array.prototype;

module.exports = function (it) {
  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);
};

},{"./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_create-property.js":[function(require,module,exports) {
'use strict';
var $defineProperty = require('./_object-dp');
var createDesc = require('./_property-desc');

module.exports = function (object, index, value) {
  if (index in object) $defineProperty.f(object, index, createDesc(0, value));
  else object[index] = value;
};

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js"}],"../../node_modules/core-js/modules/_classof.js":[function(require,module,exports) {
// getting tag from 19.1.3.6 Object.prototype.toString()
var cof = require('./_cof');
var TAG = require('./_wks')('toStringTag');
// ES3 wrong here
var ARG = cof(function () { return arguments; }()) == 'Arguments';

// fallback for IE11 Script Access Denied error
var tryGet = function (it, key) {
  try {
    return it[key];
  } catch (e) { /* empty */ }
};

module.exports = function (it) {
  var O, T, B;
  return it === undefined ? 'Undefined' : it === null ? 'Null'
    // @@toStringTag case
    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T
    // builtinTag case
    : ARG ? cof(O)
    // ES3 arguments fallback
    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;
};

},{"./_cof":"../../node_modules/core-js/modules/_cof.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/core.get-iterator-method.js":[function(require,module,exports) {
var classof = require('./_classof');
var ITERATOR = require('./_wks')('iterator');
var Iterators = require('./_iterators');
module.exports = require('./_core').getIteratorMethod = function (it) {
  if (it != undefined) return it[ITERATOR]
    || it['@@iterator']
    || Iterators[classof(it)];
};

},{"./_classof":"../../node_modules/core-js/modules/_classof.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_core":"../../node_modules/core-js/modules/_core.js"}],"../../node_modules/core-js/modules/_iter-detect.js":[function(require,module,exports) {
var ITERATOR = require('./_wks')('iterator');
var SAFE_CLOSING = false;

try {
  var riter = [7][ITERATOR]();
  riter['return'] = function () { SAFE_CLOSING = true; };
  // eslint-disable-next-line no-throw-literal
  Array.from(riter, function () { throw 2; });
} catch (e) { /* empty */ }

module.exports = function (exec, skipClosing) {
  if (!skipClosing && !SAFE_CLOSING) return false;
  var safe = false;
  try {
    var arr = [7];
    var iter = arr[ITERATOR]();
    iter.next = function () { return { done: safe = true }; };
    arr[ITERATOR] = function () { return iter; };
    exec(arr);
  } catch (e) { /* empty */ }
  return safe;
};

},{"./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/es6.array.from.js":[function(require,module,exports) {
'use strict';
var ctx = require('./_ctx');
var $export = require('./_export');
var toObject = require('./_to-object');
var call = require('./_iter-call');
var isArrayIter = require('./_is-array-iter');
var toLength = require('./_to-length');
var createProperty = require('./_create-property');
var getIterFn = require('./core.get-iterator-method');

$export($export.S + $export.F * !require('./_iter-detect')(function (iter) { Array.from(iter); }), 'Array', {
  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)
  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {
    var O = toObject(arrayLike);
    var C = typeof this == 'function' ? this : Array;
    var aLen = arguments.length;
    var mapfn = aLen > 1 ? arguments[1] : undefined;
    var mapping = mapfn !== undefined;
    var index = 0;
    var iterFn = getIterFn(O);
    var length, result, step, iterator;
    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);
    // if object isn't iterable or it's array with default iterator - use simple case
    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {
      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {
        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);
      }
    } else {
      length = toLength(O.length);
      for (result = new C(length); length > index; index++) {
        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);
      }
    }
    result.length = index;
    return result;
  }
});

},{"./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_export":"../../node_modules/core-js/modules/_export.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_iter-call":"../../node_modules/core-js/modules/_iter-call.js","./_is-array-iter":"../../node_modules/core-js/modules/_is-array-iter.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_create-property":"../../node_modules/core-js/modules/_create-property.js","./core.get-iterator-method":"../../node_modules/core-js/modules/core.get-iterator-method.js","./_iter-detect":"../../node_modules/core-js/modules/_iter-detect.js"}],"../../node_modules/core-js/modules/_to-iobject.js":[function(require,module,exports) {
// to indexed object, toObject with fallback for non-array-like ES3 strings
var IObject = require('./_iobject');
var defined = require('./_defined');
module.exports = function (it) {
  return IObject(defined(it));
};

},{"./_iobject":"../../node_modules/core-js/modules/_iobject.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/_array-includes.js":[function(require,module,exports) {
// false -> Array#indexOf
// true  -> Array#includes
var toIObject = require('./_to-iobject');
var toLength = require('./_to-length');
var toAbsoluteIndex = require('./_to-absolute-index');
module.exports = function (IS_INCLUDES) {
  return function ($this, el, fromIndex) {
    var O = toIObject($this);
    var length = toLength(O.length);
    var index = toAbsoluteIndex(fromIndex, length);
    var value;
    // Array#includes uses SameValueZero equality algorithm
    // eslint-disable-next-line no-self-compare
    if (IS_INCLUDES && el != el) while (length > index) {
      value = O[index++];
      // eslint-disable-next-line no-self-compare
      if (value != value) return true;
    // Array#indexOf ignores holes, Array#includes - not
    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {
      if (O[index] === el) return IS_INCLUDES || index || 0;
    } return !IS_INCLUDES && -1;
  };
};

},{"./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js"}],"../../node_modules/core-js/modules/es7.array.includes.js":[function(require,module,exports) {
'use strict';
// https://github.com/tc39/Array.prototype.includes
var $export = require('./_export');
var $includes = require('./_array-includes')(true);

$export($export.P, 'Array', {
  includes: function includes(el /* , fromIndex = 0 */) {
    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);
  }
});

require('./_add-to-unscopables')('includes');

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-includes":"../../node_modules/core-js/modules/_array-includes.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/_iter-step.js":[function(require,module,exports) {
module.exports = function (done, value) {
  return { value: value, done: !!done };
};

},{}],"../../node_modules/core-js/modules/_shared-key.js":[function(require,module,exports) {
var shared = require('./_shared')('keys');
var uid = require('./_uid');
module.exports = function (key) {
  return shared[key] || (shared[key] = uid(key));
};

},{"./_shared":"../../node_modules/core-js/modules/_shared.js","./_uid":"../../node_modules/core-js/modules/_uid.js"}],"../../node_modules/core-js/modules/_object-keys-internal.js":[function(require,module,exports) {
var has = require('./_has');
var toIObject = require('./_to-iobject');
var arrayIndexOf = require('./_array-includes')(false);
var IE_PROTO = require('./_shared-key')('IE_PROTO');

module.exports = function (object, names) {
  var O = toIObject(object);
  var i = 0;
  var result = [];
  var key;
  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);
  // Don't enum bug & hidden keys
  while (names.length > i) if (has(O, key = names[i++])) {
    ~arrayIndexOf(result, key) || result.push(key);
  }
  return result;
};

},{"./_has":"../../node_modules/core-js/modules/_has.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_array-includes":"../../node_modules/core-js/modules/_array-includes.js","./_shared-key":"../../node_modules/core-js/modules/_shared-key.js"}],"../../node_modules/core-js/modules/_enum-bug-keys.js":[function(require,module,exports) {
// IE 8- don't enum bug keys
module.exports = (
  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'
).split(',');

},{}],"../../node_modules/core-js/modules/_object-keys.js":[function(require,module,exports) {
// 19.1.2.14 / 15.2.3.14 Object.keys(O)
var $keys = require('./_object-keys-internal');
var enumBugKeys = require('./_enum-bug-keys');

module.exports = Object.keys || function keys(O) {
  return $keys(O, enumBugKeys);
};

},{"./_object-keys-internal":"../../node_modules/core-js/modules/_object-keys-internal.js","./_enum-bug-keys":"../../node_modules/core-js/modules/_enum-bug-keys.js"}],"../../node_modules/core-js/modules/_object-dps.js":[function(require,module,exports) {
var dP = require('./_object-dp');
var anObject = require('./_an-object');
var getKeys = require('./_object-keys');

module.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {
  anObject(O);
  var keys = getKeys(Properties);
  var length = keys.length;
  var i = 0;
  var P;
  while (length > i) dP.f(O, P = keys[i++], Properties[P]);
  return O;
};

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js"}],"../../node_modules/core-js/modules/_html.js":[function(require,module,exports) {
var document = require('./_global').document;
module.exports = document && document.documentElement;

},{"./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/_object-create.js":[function(require,module,exports) {
// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
var anObject = require('./_an-object');
var dPs = require('./_object-dps');
var enumBugKeys = require('./_enum-bug-keys');
var IE_PROTO = require('./_shared-key')('IE_PROTO');
var Empty = function () { /* empty */ };
var PROTOTYPE = 'prototype';

// Create object with fake `null` prototype: use iframe Object with cleared prototype
var createDict = function () {
  // Thrash, waste and sodomy: IE GC bug
  var iframe = require('./_dom-create')('iframe');
  var i = enumBugKeys.length;
  var lt = '<';
  var gt = '>';
  var iframeDocument;
  iframe.style.display = 'none';
  require('./_html').appendChild(iframe);
  iframe.src = 'javascript:'; // eslint-disable-line no-script-url
  // createDict = iframe.contentWindow.Object;
  // html.removeChild(iframe);
  iframeDocument = iframe.contentWindow.document;
  iframeDocument.open();
  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);
  iframeDocument.close();
  createDict = iframeDocument.F;
  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];
  return createDict();
};

module.exports = Object.create || function create(O, Properties) {
  var result;
  if (O !== null) {
    Empty[PROTOTYPE] = anObject(O);
    result = new Empty();
    Empty[PROTOTYPE] = null;
    // add "__proto__" for Object.getPrototypeOf polyfill
    result[IE_PROTO] = O;
  } else result = createDict();
  return Properties === undefined ? result : dPs(result, Properties);
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_object-dps":"../../node_modules/core-js/modules/_object-dps.js","./_enum-bug-keys":"../../node_modules/core-js/modules/_enum-bug-keys.js","./_shared-key":"../../node_modules/core-js/modules/_shared-key.js","./_dom-create":"../../node_modules/core-js/modules/_dom-create.js","./_html":"../../node_modules/core-js/modules/_html.js"}],"../../node_modules/core-js/modules/_set-to-string-tag.js":[function(require,module,exports) {
var def = require('./_object-dp').f;
var has = require('./_has');
var TAG = require('./_wks')('toStringTag');

module.exports = function (it, tag, stat) {
  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });
};

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_has":"../../node_modules/core-js/modules/_has.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_iter-create.js":[function(require,module,exports) {
'use strict';
var create = require('./_object-create');
var descriptor = require('./_property-desc');
var setToStringTag = require('./_set-to-string-tag');
var IteratorPrototype = {};

// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()
require('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });

module.exports = function (Constructor, NAME, next) {
  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });
  setToStringTag(Constructor, NAME + ' Iterator');
};

},{"./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_object-gpo.js":[function(require,module,exports) {
// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)
var has = require('./_has');
var toObject = require('./_to-object');
var IE_PROTO = require('./_shared-key')('IE_PROTO');
var ObjectProto = Object.prototype;

module.exports = Object.getPrototypeOf || function (O) {
  O = toObject(O);
  if (has(O, IE_PROTO)) return O[IE_PROTO];
  if (typeof O.constructor == 'function' && O instanceof O.constructor) {
    return O.constructor.prototype;
  } return O instanceof Object ? ObjectProto : null;
};

},{"./_has":"../../node_modules/core-js/modules/_has.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_shared-key":"../../node_modules/core-js/modules/_shared-key.js"}],"../../node_modules/core-js/modules/_iter-define.js":[function(require,module,exports) {
'use strict';
var LIBRARY = require('./_library');
var $export = require('./_export');
var redefine = require('./_redefine');
var hide = require('./_hide');
var Iterators = require('./_iterators');
var $iterCreate = require('./_iter-create');
var setToStringTag = require('./_set-to-string-tag');
var getPrototypeOf = require('./_object-gpo');
var ITERATOR = require('./_wks')('iterator');
var BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`
var FF_ITERATOR = '@@iterator';
var KEYS = 'keys';
var VALUES = 'values';

var returnThis = function () { return this; };

module.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {
  $iterCreate(Constructor, NAME, next);
  var getMethod = function (kind) {
    if (!BUGGY && kind in proto) return proto[kind];
    switch (kind) {
      case KEYS: return function keys() { return new Constructor(this, kind); };
      case VALUES: return function values() { return new Constructor(this, kind); };
    } return function entries() { return new Constructor(this, kind); };
  };
  var TAG = NAME + ' Iterator';
  var DEF_VALUES = DEFAULT == VALUES;
  var VALUES_BUG = false;
  var proto = Base.prototype;
  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];
  var $default = $native || getMethod(DEFAULT);
  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;
  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;
  var methods, key, IteratorPrototype;
  // Fix native
  if ($anyNative) {
    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));
    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {
      // Set @@toStringTag to native iterators
      setToStringTag(IteratorPrototype, TAG, true);
      // fix for some old engines
      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);
    }
  }
  // fix Array#{values, @@iterator}.name in V8 / FF
  if (DEF_VALUES && $native && $native.name !== VALUES) {
    VALUES_BUG = true;
    $default = function values() { return $native.call(this); };
  }
  // Define iterator
  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {
    hide(proto, ITERATOR, $default);
  }
  // Plug for library
  Iterators[NAME] = $default;
  Iterators[TAG] = returnThis;
  if (DEFAULT) {
    methods = {
      values: DEF_VALUES ? $default : getMethod(VALUES),
      keys: IS_SET ? $default : getMethod(KEYS),
      entries: $entries
    };
    if (FORCED) for (key in methods) {
      if (!(key in proto)) redefine(proto, key, methods[key]);
    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);
  }
  return methods;
};

},{"./_library":"../../node_modules/core-js/modules/_library.js","./_export":"../../node_modules/core-js/modules/_export.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_iter-create":"../../node_modules/core-js/modules/_iter-create.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/es6.array.iterator.js":[function(require,module,exports) {
'use strict';
var addToUnscopables = require('./_add-to-unscopables');
var step = require('./_iter-step');
var Iterators = require('./_iterators');
var toIObject = require('./_to-iobject');

// 22.1.3.4 Array.prototype.entries()
// 22.1.3.13 Array.prototype.keys()
// 22.1.3.29 Array.prototype.values()
// 22.1.3.30 Array.prototype[@@iterator]()
module.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {
  this._t = toIObject(iterated); // target
  this._i = 0;                   // next index
  this._k = kind;                // kind
// 22.1.5.2.1 %ArrayIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var kind = this._k;
  var index = this._i++;
  if (!O || index >= O.length) {
    this._t = undefined;
    return step(1);
  }
  if (kind == 'keys') return step(0, index);
  if (kind == 'values') return step(0, O[index]);
  return step(0, [index, O[index]]);
}, 'values');

// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)
Iterators.Arguments = Iterators.Array;

addToUnscopables('keys');
addToUnscopables('values');
addToUnscopables('entries');

},{"./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js","./_iter-step":"../../node_modules/core-js/modules/_iter-step.js","./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_iter-define":"../../node_modules/core-js/modules/_iter-define.js"}],"../../node_modules/core-js/modules/es6.array.of.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var createProperty = require('./_create-property');

// WebKit Array.of isn't generic
$export($export.S + $export.F * require('./_fails')(function () {
  function F() { /* empty */ }
  return !(Array.of.call(F) instanceof F);
}), 'Array', {
  // 22.1.2.3 Array.of( ...items)
  of: function of(/* ...args */) {
    var index = 0;
    var aLen = arguments.length;
    var result = new (typeof this == 'function' ? this : Array)(aLen);
    while (aLen > index) createProperty(result, index, arguments[index++]);
    result.length = aLen;
    return result;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_create-property":"../../node_modules/core-js/modules/_create-property.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/_strict-method.js":[function(require,module,exports) {
'use strict';
var fails = require('./_fails');

module.exports = function (method, arg) {
  return !!method && fails(function () {
    // eslint-disable-next-line no-useless-call
    arg ? method.call(null, function () { /* empty */ }, 1) : method.call(null);
  });
};

},{"./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.array.sort.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var aFunction = require('./_a-function');
var toObject = require('./_to-object');
var fails = require('./_fails');
var $sort = [].sort;
var test = [1, 2, 3];

$export($export.P + $export.F * (fails(function () {
  // IE8-
  test.sort(undefined);
}) || !fails(function () {
  // V8 bug
  test.sort(null);
  // Old WebKit
}) || !require('./_strict-method')($sort)), 'Array', {
  // 22.1.3.25 Array.prototype.sort(comparefn)
  sort: function sort(comparefn) {
    return comparefn === undefined
      ? $sort.call(toObject(this))
      : $sort.call(toObject(this), aFunction(comparefn));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_strict-method":"../../node_modules/core-js/modules/_strict-method.js"}],"../../node_modules/core-js/modules/_set-species.js":[function(require,module,exports) {

'use strict';
var global = require('./_global');
var dP = require('./_object-dp');
var DESCRIPTORS = require('./_descriptors');
var SPECIES = require('./_wks')('species');

module.exports = function (KEY) {
  var C = global[KEY];
  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {
    configurable: true,
    get: function () { return this; }
  });
};

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/es6.array.species.js":[function(require,module,exports) {
require('./_set-species')('Array');

},{"./_set-species":"../../node_modules/core-js/modules/_set-species.js"}],"../../node_modules/core-js/modules/_date-to-primitive.js":[function(require,module,exports) {
'use strict';
var anObject = require('./_an-object');
var toPrimitive = require('./_to-primitive');
var NUMBER = 'number';

module.exports = function (hint) {
  if (hint !== 'string' && hint !== NUMBER && hint !== 'default') throw TypeError('Incorrect hint');
  return toPrimitive(anObject(this), hint != NUMBER);
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js"}],"../../node_modules/core-js/modules/es6.date.to-primitive.js":[function(require,module,exports) {
var TO_PRIMITIVE = require('./_wks')('toPrimitive');
var proto = Date.prototype;

if (!(TO_PRIMITIVE in proto)) require('./_hide')(proto, TO_PRIMITIVE, require('./_date-to-primitive'));

},{"./_wks":"../../node_modules/core-js/modules/_wks.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_date-to-primitive":"../../node_modules/core-js/modules/_date-to-primitive.js"}],"../../node_modules/core-js/modules/es6.function.has-instance.js":[function(require,module,exports) {
'use strict';
var isObject = require('./_is-object');
var getPrototypeOf = require('./_object-gpo');
var HAS_INSTANCE = require('./_wks')('hasInstance');
var FunctionProto = Function.prototype;
// 19.2.3.6 Function.prototype[@@hasInstance](V)
if (!(HAS_INSTANCE in FunctionProto)) require('./_object-dp').f(FunctionProto, HAS_INSTANCE, { value: function (O) {
  if (typeof this != 'function' || !isObject(O)) return false;
  if (!isObject(this.prototype)) return O instanceof this;
  // for environment w/o native `@@hasInstance` logic enough `instanceof`, but add this:
  while (O = getPrototypeOf(O)) if (this.prototype === O) return true;
  return false;
} });

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js"}],"../../node_modules/core-js/modules/es6.function.name.js":[function(require,module,exports) {
var dP = require('./_object-dp').f;
var FProto = Function.prototype;
var nameRE = /^\s*function ([^ (]*)/;
var NAME = 'name';

// 19.2.4.2 name
NAME in FProto || require('./_descriptors') && dP(FProto, NAME, {
  configurable: true,
  get: function () {
    try {
      return ('' + this).match(nameRE)[1];
    } catch (e) {
      return '';
    }
  }
});

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js"}],"../../node_modules/core-js/modules/_redefine-all.js":[function(require,module,exports) {
var redefine = require('./_redefine');
module.exports = function (target, src, safe) {
  for (var key in src) redefine(target, key, src[key], safe);
  return target;
};

},{"./_redefine":"../../node_modules/core-js/modules/_redefine.js"}],"../../node_modules/core-js/modules/_an-instance.js":[function(require,module,exports) {
module.exports = function (it, Constructor, name, forbiddenField) {
  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {
    throw TypeError(name + ': incorrect invocation!');
  } return it;
};

},{}],"../../node_modules/core-js/modules/_for-of.js":[function(require,module,exports) {
var ctx = require('./_ctx');
var call = require('./_iter-call');
var isArrayIter = require('./_is-array-iter');
var anObject = require('./_an-object');
var toLength = require('./_to-length');
var getIterFn = require('./core.get-iterator-method');
var BREAK = {};
var RETURN = {};
var exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {
  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);
  var f = ctx(fn, that, entries ? 2 : 1);
  var index = 0;
  var length, step, iterator, result;
  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');
  // fast case for arrays with default iterator
  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {
    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);
    if (result === BREAK || result === RETURN) return result;
  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {
    result = call(iterator, f, step.value, entries);
    if (result === BREAK || result === RETURN) return result;
  }
};
exports.BREAK = BREAK;
exports.RETURN = RETURN;

},{"./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_iter-call":"../../node_modules/core-js/modules/_iter-call.js","./_is-array-iter":"../../node_modules/core-js/modules/_is-array-iter.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./core.get-iterator-method":"../../node_modules/core-js/modules/core.get-iterator-method.js"}],"../../node_modules/core-js/modules/_meta.js":[function(require,module,exports) {
var META = require('./_uid')('meta');
var isObject = require('./_is-object');
var has = require('./_has');
var setDesc = require('./_object-dp').f;
var id = 0;
var isExtensible = Object.isExtensible || function () {
  return true;
};
var FREEZE = !require('./_fails')(function () {
  return isExtensible(Object.preventExtensions({}));
});
var setMeta = function (it) {
  setDesc(it, META, { value: {
    i: 'O' + ++id, // object ID
    w: {}          // weak collections IDs
  } });
};
var fastKey = function (it, create) {
  // return primitive with prefix
  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return 'F';
    // not necessary to add metadata
    if (!create) return 'E';
    // add missing metadata
    setMeta(it);
  // return object ID
  } return it[META].i;
};
var getWeak = function (it, create) {
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return true;
    // not necessary to add metadata
    if (!create) return false;
    // add missing metadata
    setMeta(it);
  // return hash weak collections IDs
  } return it[META].w;
};
// add metadata on freeze-family methods calling
var onFreeze = function (it) {
  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);
  return it;
};
var meta = module.exports = {
  KEY: META,
  NEED: false,
  fastKey: fastKey,
  getWeak: getWeak,
  onFreeze: onFreeze
};

},{"./_uid":"../../node_modules/core-js/modules/_uid.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_has":"../../node_modules/core-js/modules/_has.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/_validate-collection.js":[function(require,module,exports) {
var isObject = require('./_is-object');
module.exports = function (it, TYPE) {
  if (!isObject(it) || it._t !== TYPE) throw TypeError('Incompatible receiver, ' + TYPE + ' required!');
  return it;
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js"}],"../../node_modules/core-js/modules/_collection-strong.js":[function(require,module,exports) {
'use strict';
var dP = require('./_object-dp').f;
var create = require('./_object-create');
var redefineAll = require('./_redefine-all');
var ctx = require('./_ctx');
var anInstance = require('./_an-instance');
var forOf = require('./_for-of');
var $iterDefine = require('./_iter-define');
var step = require('./_iter-step');
var setSpecies = require('./_set-species');
var DESCRIPTORS = require('./_descriptors');
var fastKey = require('./_meta').fastKey;
var validate = require('./_validate-collection');
var SIZE = DESCRIPTORS ? '_s' : 'size';

var getEntry = function (that, key) {
  // fast case
  var index = fastKey(key);
  var entry;
  if (index !== 'F') return that._i[index];
  // frozen object case
  for (entry = that._f; entry; entry = entry.n) {
    if (entry.k == key) return entry;
  }
};

module.exports = {
  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {
    var C = wrapper(function (that, iterable) {
      anInstance(that, C, NAME, '_i');
      that._t = NAME;         // collection type
      that._i = create(null); // index
      that._f = undefined;    // first entry
      that._l = undefined;    // last entry
      that[SIZE] = 0;         // size
      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);
    });
    redefineAll(C.prototype, {
      // 23.1.3.1 Map.prototype.clear()
      // 23.2.3.2 Set.prototype.clear()
      clear: function clear() {
        for (var that = validate(this, NAME), data = that._i, entry = that._f; entry; entry = entry.n) {
          entry.r = true;
          if (entry.p) entry.p = entry.p.n = undefined;
          delete data[entry.i];
        }
        that._f = that._l = undefined;
        that[SIZE] = 0;
      },
      // 23.1.3.3 Map.prototype.delete(key)
      // 23.2.3.4 Set.prototype.delete(value)
      'delete': function (key) {
        var that = validate(this, NAME);
        var entry = getEntry(that, key);
        if (entry) {
          var next = entry.n;
          var prev = entry.p;
          delete that._i[entry.i];
          entry.r = true;
          if (prev) prev.n = next;
          if (next) next.p = prev;
          if (that._f == entry) that._f = next;
          if (that._l == entry) that._l = prev;
          that[SIZE]--;
        } return !!entry;
      },
      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)
      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)
      forEach: function forEach(callbackfn /* , that = undefined */) {
        validate(this, NAME);
        var f = ctx(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);
        var entry;
        while (entry = entry ? entry.n : this._f) {
          f(entry.v, entry.k, this);
          // revert to the last existing entry
          while (entry && entry.r) entry = entry.p;
        }
      },
      // 23.1.3.7 Map.prototype.has(key)
      // 23.2.3.7 Set.prototype.has(value)
      has: function has(key) {
        return !!getEntry(validate(this, NAME), key);
      }
    });
    if (DESCRIPTORS) dP(C.prototype, 'size', {
      get: function () {
        return validate(this, NAME)[SIZE];
      }
    });
    return C;
  },
  def: function (that, key, value) {
    var entry = getEntry(that, key);
    var prev, index;
    // change existing entry
    if (entry) {
      entry.v = value;
    // create new entry
    } else {
      that._l = entry = {
        i: index = fastKey(key, true), // <- index
        k: key,                        // <- key
        v: value,                      // <- value
        p: prev = that._l,             // <- previous entry
        n: undefined,                  // <- next entry
        r: false                       // <- removed
      };
      if (!that._f) that._f = entry;
      if (prev) prev.n = entry;
      that[SIZE]++;
      // add to index
      if (index !== 'F') that._i[index] = entry;
    } return that;
  },
  getEntry: getEntry,
  setStrong: function (C, NAME, IS_MAP) {
    // add .keys, .values, .entries, [@@iterator]
    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11
    $iterDefine(C, NAME, function (iterated, kind) {
      this._t = validate(iterated, NAME); // target
      this._k = kind;                     // kind
      this._l = undefined;                // previous
    }, function () {
      var that = this;
      var kind = that._k;
      var entry = that._l;
      // revert to the last existing entry
      while (entry && entry.r) entry = entry.p;
      // get next entry
      if (!that._t || !(that._l = entry = entry ? entry.n : that._t._f)) {
        // or finish the iteration
        that._t = undefined;
        return step(1);
      }
      // return step by kind
      if (kind == 'keys') return step(0, entry.k);
      if (kind == 'values') return step(0, entry.v);
      return step(0, [entry.k, entry.v]);
    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);

    // add [@@species], 23.1.2.2, 23.2.2.2
    setSpecies(NAME);
  }
};

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_for-of":"../../node_modules/core-js/modules/_for-of.js","./_iter-define":"../../node_modules/core-js/modules/_iter-define.js","./_iter-step":"../../node_modules/core-js/modules/_iter-step.js","./_set-species":"../../node_modules/core-js/modules/_set-species.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js"}],"../../node_modules/core-js/modules/_object-pie.js":[function(require,module,exports) {
exports.f = {}.propertyIsEnumerable;

},{}],"../../node_modules/core-js/modules/_object-gopd.js":[function(require,module,exports) {
var pIE = require('./_object-pie');
var createDesc = require('./_property-desc');
var toIObject = require('./_to-iobject');
var toPrimitive = require('./_to-primitive');
var has = require('./_has');
var IE8_DOM_DEFINE = require('./_ie8-dom-define');
var gOPD = Object.getOwnPropertyDescriptor;

exports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {
  O = toIObject(O);
  P = toPrimitive(P, true);
  if (IE8_DOM_DEFINE) try {
    return gOPD(O, P);
  } catch (e) { /* empty */ }
  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);
};

},{"./_object-pie":"../../node_modules/core-js/modules/_object-pie.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_has":"../../node_modules/core-js/modules/_has.js","./_ie8-dom-define":"../../node_modules/core-js/modules/_ie8-dom-define.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js"}],"../../node_modules/core-js/modules/_set-proto.js":[function(require,module,exports) {
// Works with __proto__ only. Old v8 can't work with null proto objects.
/* eslint-disable no-proto */
var isObject = require('./_is-object');
var anObject = require('./_an-object');
var check = function (O, proto) {
  anObject(O);
  if (!isObject(proto) && proto !== null) throw TypeError(proto + ": can't set as prototype!");
};
module.exports = {
  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line
    function (test, buggy, set) {
      try {
        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);
        set(test, []);
        buggy = !(test instanceof Array);
      } catch (e) { buggy = true; }
      return function setPrototypeOf(O, proto) {
        check(O, proto);
        if (buggy) O.__proto__ = proto;
        else set(O, proto);
        return O;
      };
    }({}, false) : undefined),
  check: check
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js"}],"../../node_modules/core-js/modules/_inherit-if-required.js":[function(require,module,exports) {
var isObject = require('./_is-object');
var setPrototypeOf = require('./_set-proto').set;
module.exports = function (that, target, C) {
  var S = target.constructor;
  var P;
  if (S !== C && typeof S == 'function' && (P = S.prototype) !== C.prototype && isObject(P) && setPrototypeOf) {
    setPrototypeOf(that, P);
  } return that;
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_set-proto":"../../node_modules/core-js/modules/_set-proto.js"}],"../../node_modules/core-js/modules/_collection.js":[function(require,module,exports) {

'use strict';
var global = require('./_global');
var $export = require('./_export');
var redefine = require('./_redefine');
var redefineAll = require('./_redefine-all');
var meta = require('./_meta');
var forOf = require('./_for-of');
var anInstance = require('./_an-instance');
var isObject = require('./_is-object');
var fails = require('./_fails');
var $iterDetect = require('./_iter-detect');
var setToStringTag = require('./_set-to-string-tag');
var inheritIfRequired = require('./_inherit-if-required');

module.exports = function (NAME, wrapper, methods, common, IS_MAP, IS_WEAK) {
  var Base = global[NAME];
  var C = Base;
  var ADDER = IS_MAP ? 'set' : 'add';
  var proto = C && C.prototype;
  var O = {};
  var fixMethod = function (KEY) {
    var fn = proto[KEY];
    redefine(proto, KEY,
      KEY == 'delete' ? function (a) {
        return IS_WEAK && !isObject(a) ? false : fn.call(this, a === 0 ? 0 : a);
      } : KEY == 'has' ? function has(a) {
        return IS_WEAK && !isObject(a) ? false : fn.call(this, a === 0 ? 0 : a);
      } : KEY == 'get' ? function get(a) {
        return IS_WEAK && !isObject(a) ? undefined : fn.call(this, a === 0 ? 0 : a);
      } : KEY == 'add' ? function add(a) { fn.call(this, a === 0 ? 0 : a); return this; }
        : function set(a, b) { fn.call(this, a === 0 ? 0 : a, b); return this; }
    );
  };
  if (typeof C != 'function' || !(IS_WEAK || proto.forEach && !fails(function () {
    new C().entries().next();
  }))) {
    // create collection constructor
    C = common.getConstructor(wrapper, NAME, IS_MAP, ADDER);
    redefineAll(C.prototype, methods);
    meta.NEED = true;
  } else {
    var instance = new C();
    // early implementations not supports chaining
    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;
    // V8 ~  Chromium 40- weak-collections throws on primitives, but should return false
    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });
    // most early implementations doesn't supports iterables, most modern - not close it correctly
    var ACCEPT_ITERABLES = $iterDetect(function (iter) { new C(iter); }); // eslint-disable-line no-new
    // for early implementations -0 and +0 not the same
    var BUGGY_ZERO = !IS_WEAK && fails(function () {
      // V8 ~ Chromium 42- fails only with 5+ elements
      var $instance = new C();
      var index = 5;
      while (index--) $instance[ADDER](index, index);
      return !$instance.has(-0);
    });
    if (!ACCEPT_ITERABLES) {
      C = wrapper(function (target, iterable) {
        anInstance(target, C, NAME);
        var that = inheritIfRequired(new Base(), target, C);
        if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);
        return that;
      });
      C.prototype = proto;
      proto.constructor = C;
    }
    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {
      fixMethod('delete');
      fixMethod('has');
      IS_MAP && fixMethod('get');
    }
    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);
    // weak collections should not contains .clear method
    if (IS_WEAK && proto.clear) delete proto.clear;
  }

  setToStringTag(C, NAME);

  O[NAME] = C;
  $export($export.G + $export.W + $export.F * (C != Base), O);

  if (!IS_WEAK) common.setStrong(C, NAME, IS_MAP);

  return C;
};

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_export":"../../node_modules/core-js/modules/_export.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_for-of":"../../node_modules/core-js/modules/_for-of.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_iter-detect":"../../node_modules/core-js/modules/_iter-detect.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js","./_inherit-if-required":"../../node_modules/core-js/modules/_inherit-if-required.js"}],"../../node_modules/core-js/modules/es6.map.js":[function(require,module,exports) {
'use strict';
var strong = require('./_collection-strong');
var validate = require('./_validate-collection');
var MAP = 'Map';

// 23.1 Map Objects
module.exports = require('./_collection')(MAP, function (get) {
  return function Map() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };
}, {
  // 23.1.3.6 Map.prototype.get(key)
  get: function get(key) {
    var entry = strong.getEntry(validate(this, MAP), key);
    return entry && entry.v;
  },
  // 23.1.3.9 Map.prototype.set(key, value)
  set: function set(key, value) {
    return strong.def(validate(this, MAP), key === 0 ? 0 : key, value);
  }
}, strong, true);

},{"./_collection-strong":"../../node_modules/core-js/modules/_collection-strong.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js","./_collection":"../../node_modules/core-js/modules/_collection.js"}],"../../node_modules/core-js/modules/_math-log1p.js":[function(require,module,exports) {
// 20.2.2.20 Math.log1p(x)
module.exports = Math.log1p || function log1p(x) {
  return (x = +x) > -1e-8 && x < 1e-8 ? x - x * x / 2 : Math.log(1 + x);
};

},{}],"../../node_modules/core-js/modules/es6.math.acosh.js":[function(require,module,exports) {
// 20.2.2.3 Math.acosh(x)
var $export = require('./_export');
var log1p = require('./_math-log1p');
var sqrt = Math.sqrt;
var $acosh = Math.acosh;

$export($export.S + $export.F * !($acosh
  // V8 bug: https://code.google.com/p/v8/issues/detail?id=3509
  && Math.floor($acosh(Number.MAX_VALUE)) == 710
  // Tor Browser bug: Math.acosh(Infinity) -> NaN
  && $acosh(Infinity) == Infinity
), 'Math', {
  acosh: function acosh(x) {
    return (x = +x) < 1 ? NaN : x > 94906265.62425156
      ? Math.log(x) + Math.LN2
      : log1p(x - 1 + sqrt(x - 1) * sqrt(x + 1));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-log1p":"../../node_modules/core-js/modules/_math-log1p.js"}],"../../node_modules/core-js/modules/es6.math.asinh.js":[function(require,module,exports) {
// 20.2.2.5 Math.asinh(x)
var $export = require('./_export');
var $asinh = Math.asinh;

function asinh(x) {
  return !isFinite(x = +x) || x == 0 ? x : x < 0 ? -asinh(-x) : Math.log(x + Math.sqrt(x * x + 1));
}

// Tor Browser bug: Math.asinh(0) -> -0
$export($export.S + $export.F * !($asinh && 1 / $asinh(0) > 0), 'Math', { asinh: asinh });

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.math.atanh.js":[function(require,module,exports) {
// 20.2.2.7 Math.atanh(x)
var $export = require('./_export');
var $atanh = Math.atanh;

// Tor Browser bug: Math.atanh(-0) -> 0
$export($export.S + $export.F * !($atanh && 1 / $atanh(-0) < 0), 'Math', {
  atanh: function atanh(x) {
    return (x = +x) == 0 ? x : Math.log((1 + x) / (1 - x)) / 2;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/_math-sign.js":[function(require,module,exports) {
// 20.2.2.28 Math.sign(x)
module.exports = Math.sign || function sign(x) {
  // eslint-disable-next-line no-self-compare
  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;
};

},{}],"../../node_modules/core-js/modules/es6.math.cbrt.js":[function(require,module,exports) {
// 20.2.2.9 Math.cbrt(x)
var $export = require('./_export');
var sign = require('./_math-sign');

$export($export.S, 'Math', {
  cbrt: function cbrt(x) {
    return sign(x = +x) * Math.pow(Math.abs(x), 1 / 3);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-sign":"../../node_modules/core-js/modules/_math-sign.js"}],"../../node_modules/core-js/modules/es6.math.clz32.js":[function(require,module,exports) {
// 20.2.2.11 Math.clz32(x)
var $export = require('./_export');

$export($export.S, 'Math', {
  clz32: function clz32(x) {
    return (x >>>= 0) ? 31 - Math.floor(Math.log(x + 0.5) * Math.LOG2E) : 32;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.math.cosh.js":[function(require,module,exports) {
// 20.2.2.12 Math.cosh(x)
var $export = require('./_export');
var exp = Math.exp;

$export($export.S, 'Math', {
  cosh: function cosh(x) {
    return (exp(x = +x) + exp(-x)) / 2;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/_math-expm1.js":[function(require,module,exports) {
// 20.2.2.14 Math.expm1(x)
var $expm1 = Math.expm1;
module.exports = (!$expm1
  // Old FF bug
  || $expm1(10) > 22025.465794806719 || $expm1(10) < 22025.4657948067165168
  // Tor Browser bug
  || $expm1(-2e-17) != -2e-17
) ? function expm1(x) {
  return (x = +x) == 0 ? x : x > -1e-6 && x < 1e-6 ? x + x * x / 2 : Math.exp(x) - 1;
} : $expm1;

},{}],"../../node_modules/core-js/modules/es6.math.expm1.js":[function(require,module,exports) {
// 20.2.2.14 Math.expm1(x)
var $export = require('./_export');
var $expm1 = require('./_math-expm1');

$export($export.S + $export.F * ($expm1 != Math.expm1), 'Math', { expm1: $expm1 });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-expm1":"../../node_modules/core-js/modules/_math-expm1.js"}],"../../node_modules/core-js/modules/_math-fround.js":[function(require,module,exports) {
// 20.2.2.16 Math.fround(x)
var sign = require('./_math-sign');
var pow = Math.pow;
var EPSILON = pow(2, -52);
var EPSILON32 = pow(2, -23);
var MAX32 = pow(2, 127) * (2 - EPSILON32);
var MIN32 = pow(2, -126);

var roundTiesToEven = function (n) {
  return n + 1 / EPSILON - 1 / EPSILON;
};

module.exports = Math.fround || function fround(x) {
  var $abs = Math.abs(x);
  var $sign = sign(x);
  var a, result;
  if ($abs < MIN32) return $sign * roundTiesToEven($abs / MIN32 / EPSILON32) * MIN32 * EPSILON32;
  a = (1 + EPSILON32 / EPSILON) * $abs;
  result = a - (a - $abs);
  // eslint-disable-next-line no-self-compare
  if (result > MAX32 || result != result) return $sign * Infinity;
  return $sign * result;
};

},{"./_math-sign":"../../node_modules/core-js/modules/_math-sign.js"}],"../../node_modules/core-js/modules/es6.math.fround.js":[function(require,module,exports) {
// 20.2.2.16 Math.fround(x)
var $export = require('./_export');

$export($export.S, 'Math', { fround: require('./_math-fround') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-fround":"../../node_modules/core-js/modules/_math-fround.js"}],"../../node_modules/core-js/modules/es6.math.hypot.js":[function(require,module,exports) {
// 20.2.2.17 Math.hypot([value1[, value2[, â¦ ]]])
var $export = require('./_export');
var abs = Math.abs;

$export($export.S, 'Math', {
  hypot: function hypot(value1, value2) { // eslint-disable-line no-unused-vars
    var sum = 0;
    var i = 0;
    var aLen = arguments.length;
    var larg = 0;
    var arg, div;
    while (i < aLen) {
      arg = abs(arguments[i++]);
      if (larg < arg) {
        div = larg / arg;
        sum = sum * div * div + 1;
        larg = arg;
      } else if (arg > 0) {
        div = arg / larg;
        sum += div * div;
      } else sum += arg;
    }
    return larg === Infinity ? Infinity : larg * Math.sqrt(sum);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.math.imul.js":[function(require,module,exports) {
// 20.2.2.18 Math.imul(x, y)
var $export = require('./_export');
var $imul = Math.imul;

// some WebKit versions fails with big numbers, some has wrong arity
$export($export.S + $export.F * require('./_fails')(function () {
  return $imul(0xffffffff, 5) != -5 || $imul.length != 2;
}), 'Math', {
  imul: function imul(x, y) {
    var UINT16 = 0xffff;
    var xn = +x;
    var yn = +y;
    var xl = UINT16 & xn;
    var yl = UINT16 & yn;
    return 0 | xl * yl + ((UINT16 & xn >>> 16) * yl + xl * (UINT16 & yn >>> 16) << 16 >>> 0);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.math.log1p.js":[function(require,module,exports) {
// 20.2.2.20 Math.log1p(x)
var $export = require('./_export');

$export($export.S, 'Math', { log1p: require('./_math-log1p') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-log1p":"../../node_modules/core-js/modules/_math-log1p.js"}],"../../node_modules/core-js/modules/es6.math.log10.js":[function(require,module,exports) {
// 20.2.2.21 Math.log10(x)
var $export = require('./_export');

$export($export.S, 'Math', {
  log10: function log10(x) {
    return Math.log(x) * Math.LOG10E;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.math.log2.js":[function(require,module,exports) {
// 20.2.2.22 Math.log2(x)
var $export = require('./_export');

$export($export.S, 'Math', {
  log2: function log2(x) {
    return Math.log(x) / Math.LN2;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.math.sign.js":[function(require,module,exports) {
// 20.2.2.28 Math.sign(x)
var $export = require('./_export');

$export($export.S, 'Math', { sign: require('./_math-sign') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-sign":"../../node_modules/core-js/modules/_math-sign.js"}],"../../node_modules/core-js/modules/es6.math.sinh.js":[function(require,module,exports) {
// 20.2.2.30 Math.sinh(x)
var $export = require('./_export');
var expm1 = require('./_math-expm1');
var exp = Math.exp;

// V8 near Chromium 38 has a problem with very small numbers
$export($export.S + $export.F * require('./_fails')(function () {
  return !Math.sinh(-2e-17) != -2e-17;
}), 'Math', {
  sinh: function sinh(x) {
    return Math.abs(x = +x) < 1
      ? (expm1(x) - expm1(-x)) / 2
      : (exp(x - 1) - exp(-x - 1)) * (Math.E / 2);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-expm1":"../../node_modules/core-js/modules/_math-expm1.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.math.tanh.js":[function(require,module,exports) {
// 20.2.2.33 Math.tanh(x)
var $export = require('./_export');
var expm1 = require('./_math-expm1');
var exp = Math.exp;

$export($export.S, 'Math', {
  tanh: function tanh(x) {
    var a = expm1(x = +x);
    var b = expm1(-x);
    return a == Infinity ? 1 : b == Infinity ? -1 : (a - b) / (exp(x) + exp(-x));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-expm1":"../../node_modules/core-js/modules/_math-expm1.js"}],"../../node_modules/core-js/modules/es6.math.trunc.js":[function(require,module,exports) {
// 20.2.2.34 Math.trunc(x)
var $export = require('./_export');

$export($export.S, 'Math', {
  trunc: function trunc(it) {
    return (it > 0 ? Math.floor : Math.ceil)(it);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/_object-gopn.js":[function(require,module,exports) {
// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)
var $keys = require('./_object-keys-internal');
var hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');

exports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
  return $keys(O, hiddenKeys);
};

},{"./_object-keys-internal":"../../node_modules/core-js/modules/_object-keys-internal.js","./_enum-bug-keys":"../../node_modules/core-js/modules/_enum-bug-keys.js"}],"../../node_modules/core-js/modules/_string-ws.js":[function(require,module,exports) {
module.exports = '\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003' +
  '\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF';

},{}],"../../node_modules/core-js/modules/_string-trim.js":[function(require,module,exports) {
var $export = require('./_export');
var defined = require('./_defined');
var fails = require('./_fails');
var spaces = require('./_string-ws');
var space = '[' + spaces + ']';
var non = '\u200b\u0085';
var ltrim = RegExp('^' + space + space + '*');
var rtrim = RegExp(space + space + '*$');

var exporter = function (KEY, exec, ALIAS) {
  var exp = {};
  var FORCE = fails(function () {
    return !!spaces[KEY]() || non[KEY]() != non;
  });
  var fn = exp[KEY] = FORCE ? exec(trim) : spaces[KEY];
  if (ALIAS) exp[ALIAS] = fn;
  $export($export.P + $export.F * FORCE, 'String', exp);
};

// 1 -> String#trimLeft
// 2 -> String#trimRight
// 3 -> String#trim
var trim = exporter.trim = function (string, TYPE) {
  string = String(defined(string));
  if (TYPE & 1) string = string.replace(ltrim, '');
  if (TYPE & 2) string = string.replace(rtrim, '');
  return string;
};

module.exports = exporter;

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_defined":"../../node_modules/core-js/modules/_defined.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_string-ws":"../../node_modules/core-js/modules/_string-ws.js"}],"../../node_modules/core-js/modules/es6.number.constructor.js":[function(require,module,exports) {

'use strict';
var global = require('./_global');
var has = require('./_has');
var cof = require('./_cof');
var inheritIfRequired = require('./_inherit-if-required');
var toPrimitive = require('./_to-primitive');
var fails = require('./_fails');
var gOPN = require('./_object-gopn').f;
var gOPD = require('./_object-gopd').f;
var dP = require('./_object-dp').f;
var $trim = require('./_string-trim').trim;
var NUMBER = 'Number';
var $Number = global[NUMBER];
var Base = $Number;
var proto = $Number.prototype;
// Opera ~12 has broken Object#toString
var BROKEN_COF = cof(require('./_object-create')(proto)) == NUMBER;
var TRIM = 'trim' in String.prototype;

// 7.1.3 ToNumber(argument)
var toNumber = function (argument) {
  var it = toPrimitive(argument, false);
  if (typeof it == 'string' && it.length > 2) {
    it = TRIM ? it.trim() : $trim(it, 3);
    var first = it.charCodeAt(0);
    var third, radix, maxCode;
    if (first === 43 || first === 45) {
      third = it.charCodeAt(2);
      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix
    } else if (first === 48) {
      switch (it.charCodeAt(1)) {
        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal /^0b[01]+$/i
        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal /^0o[0-7]+$/i
        default: return +it;
      }
      for (var digits = it.slice(2), i = 0, l = digits.length, code; i < l; i++) {
        code = digits.charCodeAt(i);
        // parseInt parses a string to a first unavailable symbol
        // but ToNumber should return NaN if a string contains unavailable symbols
        if (code < 48 || code > maxCode) return NaN;
      } return parseInt(digits, radix);
    }
  } return +it;
};

if (!$Number(' 0o1') || !$Number('0b1') || $Number('+0x1')) {
  $Number = function Number(value) {
    var it = arguments.length < 1 ? 0 : value;
    var that = this;
    return that instanceof $Number
      // check on 1..constructor(foo) case
      && (BROKEN_COF ? fails(function () { proto.valueOf.call(that); }) : cof(that) != NUMBER)
        ? inheritIfRequired(new Base(toNumber(it)), that, $Number) : toNumber(it);
  };
  for (var keys = require('./_descriptors') ? gOPN(Base) : (
    // ES3:
    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +
    // ES6 (in case, if modules with ES6 Number statics required before):
    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +
    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger'
  ).split(','), j = 0, key; keys.length > j; j++) {
    if (has(Base, key = keys[j]) && !has($Number, key)) {
      dP($Number, key, gOPD(Base, key));
    }
  }
  $Number.prototype = proto;
  proto.constructor = $Number;
  require('./_redefine')(global, NUMBER, $Number);
}

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_has":"../../node_modules/core-js/modules/_has.js","./_cof":"../../node_modules/core-js/modules/_cof.js","./_inherit-if-required":"../../node_modules/core-js/modules/_inherit-if-required.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_string-trim":"../../node_modules/core-js/modules/_string-trim.js","./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js"}],"../../node_modules/core-js/modules/es6.number.epsilon.js":[function(require,module,exports) {
// 20.1.2.1 Number.EPSILON
var $export = require('./_export');

$export($export.S, 'Number', { EPSILON: Math.pow(2, -52) });

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.number.is-finite.js":[function(require,module,exports) {
// 20.1.2.2 Number.isFinite(number)
var $export = require('./_export');
var _isFinite = require('./_global').isFinite;

$export($export.S, 'Number', {
  isFinite: function isFinite(it) {
    return typeof it == 'number' && _isFinite(it);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/_is-integer.js":[function(require,module,exports) {
// 20.1.2.3 Number.isInteger(number)
var isObject = require('./_is-object');
var floor = Math.floor;
module.exports = function isInteger(it) {
  return !isObject(it) && isFinite(it) && floor(it) === it;
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js"}],"../../node_modules/core-js/modules/es6.number.is-integer.js":[function(require,module,exports) {
// 20.1.2.3 Number.isInteger(number)
var $export = require('./_export');

$export($export.S, 'Number', { isInteger: require('./_is-integer') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_is-integer":"../../node_modules/core-js/modules/_is-integer.js"}],"../../node_modules/core-js/modules/es6.number.is-nan.js":[function(require,module,exports) {
// 20.1.2.4 Number.isNaN(number)
var $export = require('./_export');

$export($export.S, 'Number', {
  isNaN: function isNaN(number) {
    // eslint-disable-next-line no-self-compare
    return number != number;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.number.is-safe-integer.js":[function(require,module,exports) {
// 20.1.2.5 Number.isSafeInteger(number)
var $export = require('./_export');
var isInteger = require('./_is-integer');
var abs = Math.abs;

$export($export.S, 'Number', {
  isSafeInteger: function isSafeInteger(number) {
    return isInteger(number) && abs(number) <= 0x1fffffffffffff;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_is-integer":"../../node_modules/core-js/modules/_is-integer.js"}],"../../node_modules/core-js/modules/es6.number.max-safe-integer.js":[function(require,module,exports) {
// 20.1.2.6 Number.MAX_SAFE_INTEGER
var $export = require('./_export');

$export($export.S, 'Number', { MAX_SAFE_INTEGER: 0x1fffffffffffff });

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.number.min-safe-integer.js":[function(require,module,exports) {
// 20.1.2.10 Number.MIN_SAFE_INTEGER
var $export = require('./_export');

$export($export.S, 'Number', { MIN_SAFE_INTEGER: -0x1fffffffffffff });

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/_parse-float.js":[function(require,module,exports) {
var $parseFloat = require('./_global').parseFloat;
var $trim = require('./_string-trim').trim;

module.exports = 1 / $parseFloat(require('./_string-ws') + '-0') !== -Infinity ? function parseFloat(str) {
  var string = $trim(String(str), 3);
  var result = $parseFloat(string);
  return result === 0 && string.charAt(0) == '-' ? -0 : result;
} : $parseFloat;

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_string-trim":"../../node_modules/core-js/modules/_string-trim.js","./_string-ws":"../../node_modules/core-js/modules/_string-ws.js"}],"../../node_modules/core-js/modules/es6.number.parse-float.js":[function(require,module,exports) {
var $export = require('./_export');
var $parseFloat = require('./_parse-float');
// 20.1.2.12 Number.parseFloat(string)
$export($export.S + $export.F * (Number.parseFloat != $parseFloat), 'Number', { parseFloat: $parseFloat });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_parse-float":"../../node_modules/core-js/modules/_parse-float.js"}],"../../node_modules/core-js/modules/_parse-int.js":[function(require,module,exports) {
var $parseInt = require('./_global').parseInt;
var $trim = require('./_string-trim').trim;
var ws = require('./_string-ws');
var hex = /^[-+]?0[xX]/;

module.exports = $parseInt(ws + '08') !== 8 || $parseInt(ws + '0x16') !== 22 ? function parseInt(str, radix) {
  var string = $trim(String(str), 3);
  return $parseInt(string, (radix >>> 0) || (hex.test(string) ? 16 : 10));
} : $parseInt;

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_string-trim":"../../node_modules/core-js/modules/_string-trim.js","./_string-ws":"../../node_modules/core-js/modules/_string-ws.js"}],"../../node_modules/core-js/modules/es6.number.parse-int.js":[function(require,module,exports) {
var $export = require('./_export');
var $parseInt = require('./_parse-int');
// 20.1.2.13 Number.parseInt(string, radix)
$export($export.S + $export.F * (Number.parseInt != $parseInt), 'Number', { parseInt: $parseInt });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_parse-int":"../../node_modules/core-js/modules/_parse-int.js"}],"../../node_modules/core-js/modules/_object-gops.js":[function(require,module,exports) {
exports.f = Object.getOwnPropertySymbols;

},{}],"../../node_modules/core-js/modules/_object-assign.js":[function(require,module,exports) {
'use strict';
// 19.1.2.1 Object.assign(target, source, ...)
var DESCRIPTORS = require('./_descriptors');
var getKeys = require('./_object-keys');
var gOPS = require('./_object-gops');
var pIE = require('./_object-pie');
var toObject = require('./_to-object');
var IObject = require('./_iobject');
var $assign = Object.assign;

// should work with symbols and should have deterministic property order (V8 bug)
module.exports = !$assign || require('./_fails')(function () {
  var A = {};
  var B = {};
  // eslint-disable-next-line no-undef
  var S = Symbol();
  var K = 'abcdefghijklmnopqrst';
  A[S] = 7;
  K.split('').forEach(function (k) { B[k] = k; });
  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;
}) ? function assign(target, source) { // eslint-disable-line no-unused-vars
  var T = toObject(target);
  var aLen = arguments.length;
  var index = 1;
  var getSymbols = gOPS.f;
  var isEnum = pIE.f;
  while (aLen > index) {
    var S = IObject(arguments[index++]);
    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);
    var length = keys.length;
    var j = 0;
    var key;
    while (length > j) {
      key = keys[j++];
      if (!DESCRIPTORS || isEnum.call(S, key)) T[key] = S[key];
    }
  } return T;
} : $assign;

},{"./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_object-gops":"../../node_modules/core-js/modules/_object-gops.js","./_object-pie":"../../node_modules/core-js/modules/_object-pie.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_iobject":"../../node_modules/core-js/modules/_iobject.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.object.assign.js":[function(require,module,exports) {
// 19.1.3.1 Object.assign(target, source)
var $export = require('./_export');

$export($export.S + $export.F, 'Object', { assign: require('./_object-assign') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-assign":"../../node_modules/core-js/modules/_object-assign.js"}],"../../node_modules/core-js/modules/_object-forced-pam.js":[function(require,module,exports) {
'use strict';
// Forced replacement prototype accessors methods
module.exports = require('./_library') || !require('./_fails')(function () {
  var K = Math.random();
  // In FF throws only define methods
  // eslint-disable-next-line no-undef, no-useless-call
  __defineSetter__.call(null, K, function () { /* empty */ });
  delete require('./_global')[K];
});

},{"./_library":"../../node_modules/core-js/modules/_library.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/es7.object.define-getter.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var toObject = require('./_to-object');
var aFunction = require('./_a-function');
var $defineProperty = require('./_object-dp');

// B.2.2.2 Object.prototype.__defineGetter__(P, getter)
require('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {
  __defineGetter__: function __defineGetter__(P, getter) {
    $defineProperty.f(toObject(this), P, { get: aFunction(getter), enumerable: true, configurable: true });
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-forced-pam":"../../node_modules/core-js/modules/_object-forced-pam.js"}],"../../node_modules/core-js/modules/es7.object.define-setter.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var toObject = require('./_to-object');
var aFunction = require('./_a-function');
var $defineProperty = require('./_object-dp');

// B.2.2.3 Object.prototype.__defineSetter__(P, setter)
require('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {
  __defineSetter__: function __defineSetter__(P, setter) {
    $defineProperty.f(toObject(this), P, { set: aFunction(setter), enumerable: true, configurable: true });
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-forced-pam":"../../node_modules/core-js/modules/_object-forced-pam.js"}],"../../node_modules/core-js/modules/_object-to-array.js":[function(require,module,exports) {
var DESCRIPTORS = require('./_descriptors');
var getKeys = require('./_object-keys');
var toIObject = require('./_to-iobject');
var isEnum = require('./_object-pie').f;
module.exports = function (isEntries) {
  return function (it) {
    var O = toIObject(it);
    var keys = getKeys(O);
    var length = keys.length;
    var i = 0;
    var result = [];
    var key;
    while (length > i) {
      key = keys[i++];
      if (!DESCRIPTORS || isEnum.call(O, key)) {
        result.push(isEntries ? [key, O[key]] : O[key]);
      }
    }
    return result;
  };
};

},{"./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_object-pie":"../../node_modules/core-js/modules/_object-pie.js"}],"../../node_modules/core-js/modules/es7.object.entries.js":[function(require,module,exports) {
// https://github.com/tc39/proposal-object-values-entries
var $export = require('./_export');
var $entries = require('./_object-to-array')(true);

$export($export.S, 'Object', {
  entries: function entries(it) {
    return $entries(it);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-to-array":"../../node_modules/core-js/modules/_object-to-array.js"}],"../../node_modules/core-js/modules/_object-sap.js":[function(require,module,exports) {
// most Object methods by ES6 should accept primitives
var $export = require('./_export');
var core = require('./_core');
var fails = require('./_fails');
module.exports = function (KEY, exec) {
  var fn = (core.Object || {})[KEY] || Object[KEY];
  var exp = {};
  exp[KEY] = exec(fn);
  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);
};

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_core":"../../node_modules/core-js/modules/_core.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.object.freeze.js":[function(require,module,exports) {
// 19.1.2.5 Object.freeze(O)
var isObject = require('./_is-object');
var meta = require('./_meta').onFreeze;

require('./_object-sap')('freeze', function ($freeze) {
  return function freeze(it) {
    return $freeze && isObject(it) ? $freeze(meta(it)) : it;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.get-own-property-descriptor.js":[function(require,module,exports) {
// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
var toIObject = require('./_to-iobject');
var $getOwnPropertyDescriptor = require('./_object-gopd').f;

require('./_object-sap')('getOwnPropertyDescriptor', function () {
  return function getOwnPropertyDescriptor(it, key) {
    return $getOwnPropertyDescriptor(toIObject(it), key);
  };
});

},{"./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/_own-keys.js":[function(require,module,exports) {
// all object keys, includes non-enumerable and symbols
var gOPN = require('./_object-gopn');
var gOPS = require('./_object-gops');
var anObject = require('./_an-object');
var Reflect = require('./_global').Reflect;
module.exports = Reflect && Reflect.ownKeys || function ownKeys(it) {
  var keys = gOPN.f(anObject(it));
  var getSymbols = gOPS.f;
  return getSymbols ? keys.concat(getSymbols(it)) : keys;
};

},{"./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./_object-gops":"../../node_modules/core-js/modules/_object-gops.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/es7.object.get-own-property-descriptors.js":[function(require,module,exports) {
// https://github.com/tc39/proposal-object-getownpropertydescriptors
var $export = require('./_export');
var ownKeys = require('./_own-keys');
var toIObject = require('./_to-iobject');
var gOPD = require('./_object-gopd');
var createProperty = require('./_create-property');

$export($export.S, 'Object', {
  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {
    var O = toIObject(object);
    var getDesc = gOPD.f;
    var keys = ownKeys(O);
    var result = {};
    var i = 0;
    var key, desc;
    while (keys.length > i) {
      desc = getDesc(O, key = keys[i++]);
      if (desc !== undefined) createProperty(result, key, desc);
    }
    return result;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_own-keys":"../../node_modules/core-js/modules/_own-keys.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_create-property":"../../node_modules/core-js/modules/_create-property.js"}],"../../node_modules/core-js/modules/_object-gopn-ext.js":[function(require,module,exports) {
// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window
var toIObject = require('./_to-iobject');
var gOPN = require('./_object-gopn').f;
var toString = {}.toString;

var windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames
  ? Object.getOwnPropertyNames(window) : [];

var getWindowNames = function (it) {
  try {
    return gOPN(it);
  } catch (e) {
    return windowNames.slice();
  }
};

module.exports.f = function getOwnPropertyNames(it) {
  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));
};

},{"./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js"}],"../../node_modules/core-js/modules/es6.object.get-own-property-names.js":[function(require,module,exports) {
// 19.1.2.7 Object.getOwnPropertyNames(O)
require('./_object-sap')('getOwnPropertyNames', function () {
  return require('./_object-gopn-ext').f;
});

},{"./_object-sap":"../../node_modules/core-js/modules/_object-sap.js","./_object-gopn-ext":"../../node_modules/core-js/modules/_object-gopn-ext.js"}],"../../node_modules/core-js/modules/es6.object.get-prototype-of.js":[function(require,module,exports) {
// 19.1.2.9 Object.getPrototypeOf(O)
var toObject = require('./_to-object');
var $getPrototypeOf = require('./_object-gpo');

require('./_object-sap')('getPrototypeOf', function () {
  return function getPrototypeOf(it) {
    return $getPrototypeOf(toObject(it));
  };
});

},{"./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es7.object.lookup-getter.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var toObject = require('./_to-object');
var toPrimitive = require('./_to-primitive');
var getPrototypeOf = require('./_object-gpo');
var getOwnPropertyDescriptor = require('./_object-gopd').f;

// B.2.2.4 Object.prototype.__lookupGetter__(P)
require('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {
  __lookupGetter__: function __lookupGetter__(P) {
    var O = toObject(this);
    var K = toPrimitive(P, true);
    var D;
    do {
      if (D = getOwnPropertyDescriptor(O, K)) return D.get;
    } while (O = getPrototypeOf(O));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-forced-pam":"../../node_modules/core-js/modules/_object-forced-pam.js"}],"../../node_modules/core-js/modules/es7.object.lookup-setter.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var toObject = require('./_to-object');
var toPrimitive = require('./_to-primitive');
var getPrototypeOf = require('./_object-gpo');
var getOwnPropertyDescriptor = require('./_object-gopd').f;

// B.2.2.5 Object.prototype.__lookupSetter__(P)
require('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {
  __lookupSetter__: function __lookupSetter__(P) {
    var O = toObject(this);
    var K = toPrimitive(P, true);
    var D;
    do {
      if (D = getOwnPropertyDescriptor(O, K)) return D.set;
    } while (O = getPrototypeOf(O));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-forced-pam":"../../node_modules/core-js/modules/_object-forced-pam.js"}],"../../node_modules/core-js/modules/es6.object.prevent-extensions.js":[function(require,module,exports) {
// 19.1.2.15 Object.preventExtensions(O)
var isObject = require('./_is-object');
var meta = require('./_meta').onFreeze;

require('./_object-sap')('preventExtensions', function ($preventExtensions) {
  return function preventExtensions(it) {
    return $preventExtensions && isObject(it) ? $preventExtensions(meta(it)) : it;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.to-string.js":[function(require,module,exports) {
'use strict';
// 19.1.3.6 Object.prototype.toString()
var classof = require('./_classof');
var test = {};
test[require('./_wks')('toStringTag')] = 'z';
if (test + '' != '[object z]') {
  require('./_redefine')(Object.prototype, 'toString', function toString() {
    return '[object ' + classof(this) + ']';
  }, true);
}

},{"./_classof":"../../node_modules/core-js/modules/_classof.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js"}],"../../node_modules/core-js/modules/_same-value.js":[function(require,module,exports) {
// 7.2.9 SameValue(x, y)
module.exports = Object.is || function is(x, y) {
  // eslint-disable-next-line no-self-compare
  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;
};

},{}],"../../node_modules/core-js/modules/es6.object.is.js":[function(require,module,exports) {
// 19.1.3.10 Object.is(value1, value2)
var $export = require('./_export');
$export($export.S, 'Object', { is: require('./_same-value') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_same-value":"../../node_modules/core-js/modules/_same-value.js"}],"../../node_modules/core-js/modules/es6.object.is-frozen.js":[function(require,module,exports) {
// 19.1.2.12 Object.isFrozen(O)
var isObject = require('./_is-object');

require('./_object-sap')('isFrozen', function ($isFrozen) {
  return function isFrozen(it) {
    return isObject(it) ? $isFrozen ? $isFrozen(it) : false : true;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.is-sealed.js":[function(require,module,exports) {
// 19.1.2.13 Object.isSealed(O)
var isObject = require('./_is-object');

require('./_object-sap')('isSealed', function ($isSealed) {
  return function isSealed(it) {
    return isObject(it) ? $isSealed ? $isSealed(it) : false : true;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.is-extensible.js":[function(require,module,exports) {
// 19.1.2.11 Object.isExtensible(O)
var isObject = require('./_is-object');

require('./_object-sap')('isExtensible', function ($isExtensible) {
  return function isExtensible(it) {
    return isObject(it) ? $isExtensible ? $isExtensible(it) : true : false;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.keys.js":[function(require,module,exports) {
// 19.1.2.14 Object.keys(O)
var toObject = require('./_to-object');
var $keys = require('./_object-keys');

require('./_object-sap')('keys', function () {
  return function keys(it) {
    return $keys(toObject(it));
  };
});

},{"./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.seal.js":[function(require,module,exports) {
// 19.1.2.17 Object.seal(O)
var isObject = require('./_is-object');
var meta = require('./_meta').onFreeze;

require('./_object-sap')('seal', function ($seal) {
  return function seal(it) {
    return $seal && isObject(it) ? $seal(meta(it)) : it;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es7.object.values.js":[function(require,module,exports) {
// https://github.com/tc39/proposal-object-values-entries
var $export = require('./_export');
var $values = require('./_object-to-array')(false);

$export($export.S, 'Object', {
  values: function values(it) {
    return $values(it);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-to-array":"../../node_modules/core-js/modules/_object-to-array.js"}],"../../node_modules/core-js/modules/_species-constructor.js":[function(require,module,exports) {
// 7.3.20 SpeciesConstructor(O, defaultConstructor)
var anObject = require('./_an-object');
var aFunction = require('./_a-function');
var SPECIES = require('./_wks')('species');
module.exports = function (O, D) {
  var C = anObject(O).constructor;
  var S;
  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_invoke.js":[function(require,module,exports) {
// fast apply, http://jsperf.lnkit.com/fast-apply/5
module.exports = function (fn, args, that) {
  var un = that === undefined;
  switch (args.length) {
    case 0: return un ? fn()
                      : fn.call(that);
    case 1: return un ? fn(args[0])
                      : fn.call(that, args[0]);
    case 2: return un ? fn(args[0], args[1])
                      : fn.call(that, args[0], args[1]);
    case 3: return un ? fn(args[0], args[1], args[2])
                      : fn.call(that, args[0], args[1], args[2]);
    case 4: return un ? fn(args[0], args[1], args[2], args[3])
                      : fn.call(that, args[0], args[1], args[2], args[3]);
  } return fn.apply(that, args);
};

},{}],"../../node_modules/core-js/modules/_task.js":[function(require,module,exports) {


var ctx = require('./_ctx');
var invoke = require('./_invoke');
var html = require('./_html');
var cel = require('./_dom-create');
var global = require('./_global');
var process = global.process;
var setTask = global.setImmediate;
var clearTask = global.clearImmediate;
var MessageChannel = global.MessageChannel;
var Dispatch = global.Dispatch;
var counter = 0;
var queue = {};
var ONREADYSTATECHANGE = 'onreadystatechange';
var defer, channel, port;
var run = function () {
  var id = +this;
  // eslint-disable-next-line no-prototype-builtins
  if (queue.hasOwnProperty(id)) {
    var fn = queue[id];
    delete queue[id];
    fn();
  }
};
var listener = function (event) {
  run.call(event.data);
};
// Node.js 0.9+ & IE10+ has setImmediate, otherwise:
if (!setTask || !clearTask) {
  setTask = function setImmediate(fn) {
    var args = [];
    var i = 1;
    while (arguments.length > i) args.push(arguments[i++]);
    queue[++counter] = function () {
      // eslint-disable-next-line no-new-func
      invoke(typeof fn == 'function' ? fn : Function(fn), args);
    };
    defer(counter);
    return counter;
  };
  clearTask = function clearImmediate(id) {
    delete queue[id];
  };
  // Node.js 0.8-
  if (require('./_cof')(process) == 'process') {
    defer = function (id) {
      process.nextTick(ctx(run, id, 1));
    };
  // Sphere (JS game engine) Dispatch API
  } else if (Dispatch && Dispatch.now) {
    defer = function (id) {
      Dispatch.now(ctx(run, id, 1));
    };
  // Browsers with MessageChannel, includes WebWorkers
  } else if (MessageChannel) {
    channel = new MessageChannel();
    port = channel.port2;
    channel.port1.onmessage = listener;
    defer = ctx(port.postMessage, port, 1);
  // Browsers with postMessage, skip WebWorkers
  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'
  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {
    defer = function (id) {
      global.postMessage(id + '', '*');
    };
    global.addEventListener('message', listener, false);
  // IE8-
  } else if (ONREADYSTATECHANGE in cel('script')) {
    defer = function (id) {
      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {
        html.removeChild(this);
        run.call(id);
      };
    };
  // Rest old browsers
  } else {
    defer = function (id) {
      setTimeout(ctx(run, id, 1), 0);
    };
  }
}
module.exports = {
  set: setTask,
  clear: clearTask
};

},{"./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_invoke":"../../node_modules/core-js/modules/_invoke.js","./_html":"../../node_modules/core-js/modules/_html.js","./_dom-create":"../../node_modules/core-js/modules/_dom-create.js","./_global":"../../node_modules/core-js/modules/_global.js","./_cof":"../../node_modules/core-js/modules/_cof.js"}],"../../node_modules/core-js/modules/_microtask.js":[function(require,module,exports) {


var global = require('./_global');
var macrotask = require('./_task').set;
var Observer = global.MutationObserver || global.WebKitMutationObserver;
var process = global.process;
var Promise = global.Promise;
var isNode = require('./_cof')(process) == 'process';

module.exports = function () {
  var head, last, notify;

  var flush = function () {
    var parent, fn;
    if (isNode && (parent = process.domain)) parent.exit();
    while (head) {
      fn = head.fn;
      head = head.next;
      try {
        fn();
      } catch (e) {
        if (head) notify();
        else last = undefined;
        throw e;
      }
    } last = undefined;
    if (parent) parent.enter();
  };

  // Node.js
  if (isNode) {
    notify = function () {
      process.nextTick(flush);
    };
  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339
  } else if (Observer && !(global.navigator && global.navigator.standalone)) {
    var toggle = true;
    var node = document.createTextNode('');
    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new
    notify = function () {
      node.data = toggle = !toggle;
    };
  // environments with maybe non-completely correct, but existent Promise
  } else if (Promise && Promise.resolve) {
    // Promise.resolve without an argument throws an error in LG WebOS 2
    var promise = Promise.resolve(undefined);
    notify = function () {
      promise.then(flush);
    };
  // for other environments - macrotask based on:
  // - setImmediate
  // - MessageChannel
  // - window.postMessag
  // - onreadystatechange
  // - setTimeout
  } else {
    notify = function () {
      // strange IE + webpack dev server bug - use .call(global)
      macrotask.call(global, flush);
    };
  }

  return function (fn) {
    var task = { fn: fn, next: undefined };
    if (last) last.next = task;
    if (!head) {
      head = task;
      notify();
    } last = task;
  };
};

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_task":"../../node_modules/core-js/modules/_task.js","./_cof":"../../node_modules/core-js/modules/_cof.js"}],"../../node_modules/core-js/modules/_new-promise-capability.js":[function(require,module,exports) {
'use strict';
// 25.4.1.5 NewPromiseCapability(C)
var aFunction = require('./_a-function');

function PromiseCapability(C) {
  var resolve, reject;
  this.promise = new C(function ($$resolve, $$reject) {
    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');
    resolve = $$resolve;
    reject = $$reject;
  });
  this.resolve = aFunction(resolve);
  this.reject = aFunction(reject);
}

module.exports.f = function (C) {
  return new PromiseCapability(C);
};

},{"./_a-function":"../../node_modules/core-js/modules/_a-function.js"}],"../../node_modules/core-js/modules/_perform.js":[function(require,module,exports) {
module.exports = function (exec) {
  try {
    return { e: false, v: exec() };
  } catch (e) {
    return { e: true, v: e };
  }
};

},{}],"../../node_modules/core-js/modules/_user-agent.js":[function(require,module,exports) {

var global = require('./_global');
var navigator = global.navigator;

module.exports = navigator && navigator.userAgent || '';

},{"./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/_promise-resolve.js":[function(require,module,exports) {
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var newPromiseCapability = require('./_new-promise-capability');

module.exports = function (C, x) {
  anObject(C);
  if (isObject(x) && x.constructor === C) return x;
  var promiseCapability = newPromiseCapability.f(C);
  var resolve = promiseCapability.resolve;
  resolve(x);
  return promiseCapability.promise;
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_new-promise-capability":"../../node_modules/core-js/modules/_new-promise-capability.js"}],"../../node_modules/core-js/modules/es6.promise.js":[function(require,module,exports) {


'use strict';
var LIBRARY = require('./_library');
var global = require('./_global');
var ctx = require('./_ctx');
var classof = require('./_classof');
var $export = require('./_export');
var isObject = require('./_is-object');
var aFunction = require('./_a-function');
var anInstance = require('./_an-instance');
var forOf = require('./_for-of');
var speciesConstructor = require('./_species-constructor');
var task = require('./_task').set;
var microtask = require('./_microtask')();
var newPromiseCapabilityModule = require('./_new-promise-capability');
var perform = require('./_perform');
var userAgent = require('./_user-agent');
var promiseResolve = require('./_promise-resolve');
var PROMISE = 'Promise';
var TypeError = global.TypeError;
var process = global.process;
var versions = process && process.versions;
var v8 = versions && versions.v8 || '';
var $Promise = global[PROMISE];
var isNode = classof(process) == 'process';
var empty = function () { /* empty */ };
var Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;
var newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;

var USE_NATIVE = !!function () {
  try {
    // correct subclassing with @@species support
    var promise = $Promise.resolve(1);
    var FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function (exec) {
      exec(empty, empty);
    };
    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test
    return (isNode || typeof PromiseRejectionEvent == 'function')
      && promise.then(empty) instanceof FakePromise
      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables
      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565
      // we can't detect it synchronously, so just check versions
      && v8.indexOf('6.6') !== 0
      && userAgent.indexOf('Chrome/66') === -1;
  } catch (e) { /* empty */ }
}();

// helpers
var isThenable = function (it) {
  var then;
  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;
};
var notify = function (promise, isReject) {
  if (promise._n) return;
  promise._n = true;
  var chain = promise._c;
  microtask(function () {
    var value = promise._v;
    var ok = promise._s == 1;
    var i = 0;
    var run = function (reaction) {
      var handler = ok ? reaction.ok : reaction.fail;
      var resolve = reaction.resolve;
      var reject = reaction.reject;
      var domain = reaction.domain;
      var result, then, exited;
      try {
        if (handler) {
          if (!ok) {
            if (promise._h == 2) onHandleUnhandled(promise);
            promise._h = 1;
          }
          if (handler === true) result = value;
          else {
            if (domain) domain.enter();
            result = handler(value); // may throw
            if (domain) {
              domain.exit();
              exited = true;
            }
          }
          if (result === reaction.promise) {
            reject(TypeError('Promise-chain cycle'));
          } else if (then = isThenable(result)) {
            then.call(result, resolve, reject);
          } else resolve(result);
        } else reject(value);
      } catch (e) {
        if (domain && !exited) domain.exit();
        reject(e);
      }
    };
    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach
    promise._c = [];
    promise._n = false;
    if (isReject && !promise._h) onUnhandled(promise);
  });
};
var onUnhandled = function (promise) {
  task.call(global, function () {
    var value = promise._v;
    var unhandled = isUnhandled(promise);
    var result, handler, console;
    if (unhandled) {
      result = perform(function () {
        if (isNode) {
          process.emit('unhandledRejection', value, promise);
        } else if (handler = global.onunhandledrejection) {
          handler({ promise: promise, reason: value });
        } else if ((console = global.console) && console.error) {
          console.error('Unhandled promise rejection', value);
        }
      });
      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should
      promise._h = isNode || isUnhandled(promise) ? 2 : 1;
    } promise._a = undefined;
    if (unhandled && result.e) throw result.v;
  });
};
var isUnhandled = function (promise) {
  return promise._h !== 1 && (promise._a || promise._c).length === 0;
};
var onHandleUnhandled = function (promise) {
  task.call(global, function () {
    var handler;
    if (isNode) {
      process.emit('rejectionHandled', promise);
    } else if (handler = global.onrejectionhandled) {
      handler({ promise: promise, reason: promise._v });
    }
  });
};
var $reject = function (value) {
  var promise = this;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  promise._v = value;
  promise._s = 2;
  if (!promise._a) promise._a = promise._c.slice();
  notify(promise, true);
};
var $resolve = function (value) {
  var promise = this;
  var then;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  try {
    if (promise === value) throw TypeError("Promise can't be resolved itself");
    if (then = isThenable(value)) {
      microtask(function () {
        var wrapper = { _w: promise, _d: false }; // wrap
        try {
          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));
        } catch (e) {
          $reject.call(wrapper, e);
        }
      });
    } else {
      promise._v = value;
      promise._s = 1;
      notify(promise, false);
    }
  } catch (e) {
    $reject.call({ _w: promise, _d: false }, e); // wrap
  }
};

// constructor polyfill
if (!USE_NATIVE) {
  // 25.4.3.1 Promise(executor)
  $Promise = function Promise(executor) {
    anInstance(this, $Promise, PROMISE, '_h');
    aFunction(executor);
    Internal.call(this);
    try {
      executor(ctx($resolve, this, 1), ctx($reject, this, 1));
    } catch (err) {
      $reject.call(this, err);
    }
  };
  // eslint-disable-next-line no-unused-vars
  Internal = function Promise(executor) {
    this._c = [];             // <- awaiting reactions
    this._a = undefined;      // <- checked in isUnhandled reactions
    this._s = 0;              // <- state
    this._d = false;          // <- done
    this._v = undefined;      // <- value
    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled
    this._n = false;          // <- notify
  };
  Internal.prototype = require('./_redefine-all')($Promise.prototype, {
    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)
    then: function then(onFulfilled, onRejected) {
      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));
      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;
      reaction.fail = typeof onRejected == 'function' && onRejected;
      reaction.domain = isNode ? process.domain : undefined;
      this._c.push(reaction);
      if (this._a) this._a.push(reaction);
      if (this._s) notify(this, false);
      return reaction.promise;
    },
    // 25.4.5.1 Promise.prototype.catch(onRejected)
    'catch': function (onRejected) {
      return this.then(undefined, onRejected);
    }
  });
  OwnPromiseCapability = function () {
    var promise = new Internal();
    this.promise = promise;
    this.resolve = ctx($resolve, promise, 1);
    this.reject = ctx($reject, promise, 1);
  };
  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {
    return C === $Promise || C === Wrapper
      ? new OwnPromiseCapability(C)
      : newGenericPromiseCapability(C);
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });
require('./_set-to-string-tag')($Promise, PROMISE);
require('./_set-species')(PROMISE);
Wrapper = require('./_core')[PROMISE];

// statics
$export($export.S + $export.F * !USE_NATIVE, PROMISE, {
  // 25.4.4.5 Promise.reject(r)
  reject: function reject(r) {
    var capability = newPromiseCapability(this);
    var $$reject = capability.reject;
    $$reject(r);
    return capability.promise;
  }
});
$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {
  // 25.4.4.6 Promise.resolve(x)
  resolve: function resolve(x) {
    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);
  }
});
$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function (iter) {
  $Promise.all(iter)['catch'](empty);
})), PROMISE, {
  // 25.4.4.1 Promise.all(iterable)
  all: function all(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var resolve = capability.resolve;
    var reject = capability.reject;
    var result = perform(function () {
      var values = [];
      var index = 0;
      var remaining = 1;
      forOf(iterable, false, function (promise) {
        var $index = index++;
        var alreadyCalled = false;
        values.push(undefined);
        remaining++;
        C.resolve(promise).then(function (value) {
          if (alreadyCalled) return;
          alreadyCalled = true;
          values[$index] = value;
          --remaining || resolve(values);
        }, reject);
      });
      --remaining || resolve(values);
    });
    if (result.e) reject(result.v);
    return capability.promise;
  },
  // 25.4.4.4 Promise.race(iterable)
  race: function race(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var reject = capability.reject;
    var result = perform(function () {
      forOf(iterable, false, function (promise) {
        C.resolve(promise).then(capability.resolve, reject);
      });
    });
    if (result.e) reject(result.v);
    return capability.promise;
  }
});

},{"./_library":"../../node_modules/core-js/modules/_library.js","./_global":"../../node_modules/core-js/modules/_global.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_classof":"../../node_modules/core-js/modules/_classof.js","./_export":"../../node_modules/core-js/modules/_export.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_for-of":"../../node_modules/core-js/modules/_for-of.js","./_species-constructor":"../../node_modules/core-js/modules/_species-constructor.js","./_task":"../../node_modules/core-js/modules/_task.js","./_microtask":"../../node_modules/core-js/modules/_microtask.js","./_new-promise-capability":"../../node_modules/core-js/modules/_new-promise-capability.js","./_perform":"../../node_modules/core-js/modules/_perform.js","./_user-agent":"../../node_modules/core-js/modules/_user-agent.js","./_promise-resolve":"../../node_modules/core-js/modules/_promise-resolve.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js","./_set-species":"../../node_modules/core-js/modules/_set-species.js","./_core":"../../node_modules/core-js/modules/_core.js","./_iter-detect":"../../node_modules/core-js/modules/_iter-detect.js"}],"../../node_modules/core-js/modules/es7.promise.finally.js":[function(require,module,exports) {

// https://github.com/tc39/proposal-promise-finally
'use strict';
var $export = require('./_export');
var core = require('./_core');
var global = require('./_global');
var speciesConstructor = require('./_species-constructor');
var promiseResolve = require('./_promise-resolve');

$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {
  var C = speciesConstructor(this, core.Promise || global.Promise);
  var isFunction = typeof onFinally == 'function';
  return this.then(
    isFunction ? function (x) {
      return promiseResolve(C, onFinally()).then(function () { return x; });
    } : onFinally,
    isFunction ? function (e) {
      return promiseResolve(C, onFinally()).then(function () { throw e; });
    } : onFinally
  );
} });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_core":"../../node_modules/core-js/modules/_core.js","./_global":"../../node_modules/core-js/modules/_global.js","./_species-constructor":"../../node_modules/core-js/modules/_species-constructor.js","./_promise-resolve":"../../node_modules/core-js/modules/_promise-resolve.js"}],"../../node_modules/core-js/modules/es6.reflect.apply.js":[function(require,module,exports) {
// 26.1.1 Reflect.apply(target, thisArgument, argumentsList)
var $export = require('./_export');
var aFunction = require('./_a-function');
var anObject = require('./_an-object');
var rApply = (require('./_global').Reflect || {}).apply;
var fApply = Function.apply;
// MS Edge argumentsList argument is optional
$export($export.S + $export.F * !require('./_fails')(function () {
  rApply(function () { /* empty */ });
}), 'Reflect', {
  apply: function apply(target, thisArgument, argumentsList) {
    var T = aFunction(target);
    var L = anObject(argumentsList);
    return rApply ? rApply(T, thisArgument, L) : fApply.call(T, thisArgument, L);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_global":"../../node_modules/core-js/modules/_global.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/_bind.js":[function(require,module,exports) {
'use strict';
var aFunction = require('./_a-function');
var isObject = require('./_is-object');
var invoke = require('./_invoke');
var arraySlice = [].slice;
var factories = {};

var construct = function (F, len, args) {
  if (!(len in factories)) {
    for (var n = [], i = 0; i < len; i++) n[i] = 'a[' + i + ']';
    // eslint-disable-next-line no-new-func
    factories[len] = Function('F,a', 'return new F(' + n.join(',') + ')');
  } return factories[len](F, args);
};

module.exports = Function.bind || function bind(that /* , ...args */) {
  var fn = aFunction(this);
  var partArgs = arraySlice.call(arguments, 1);
  var bound = function (/* args... */) {
    var args = partArgs.concat(arraySlice.call(arguments));
    return this instanceof bound ? construct(fn, args.length, args) : invoke(fn, args, that);
  };
  if (isObject(fn.prototype)) bound.prototype = fn.prototype;
  return bound;
};

},{"./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_invoke":"../../node_modules/core-js/modules/_invoke.js"}],"../../node_modules/core-js/modules/es6.reflect.construct.js":[function(require,module,exports) {
// 26.1.2 Reflect.construct(target, argumentsList [, newTarget])
var $export = require('./_export');
var create = require('./_object-create');
var aFunction = require('./_a-function');
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var fails = require('./_fails');
var bind = require('./_bind');
var rConstruct = (require('./_global').Reflect || {}).construct;

// MS Edge supports only 2 arguments and argumentsList argument is optional
// FF Nightly sets third argument as `new.target`, but does not create `this` from it
var NEW_TARGET_BUG = fails(function () {
  function F() { /* empty */ }
  return !(rConstruct(function () { /* empty */ }, [], F) instanceof F);
});
var ARGS_BUG = !fails(function () {
  rConstruct(function () { /* empty */ });
});

$export($export.S + $export.F * (NEW_TARGET_BUG || ARGS_BUG), 'Reflect', {
  construct: function construct(Target, args /* , newTarget */) {
    aFunction(Target);
    anObject(args);
    var newTarget = arguments.length < 3 ? Target : aFunction(arguments[2]);
    if (ARGS_BUG && !NEW_TARGET_BUG) return rConstruct(Target, args, newTarget);
    if (Target == newTarget) {
      // w/o altered newTarget, optimization for 0-4 arguments
      switch (args.length) {
        case 0: return new Target();
        case 1: return new Target(args[0]);
        case 2: return new Target(args[0], args[1]);
        case 3: return new Target(args[0], args[1], args[2]);
        case 4: return new Target(args[0], args[1], args[2], args[3]);
      }
      // w/o altered newTarget, lot of arguments case
      var $args = [null];
      $args.push.apply($args, args);
      return new (bind.apply(Target, $args))();
    }
    // with altered newTarget, not support built-in constructors
    var proto = newTarget.prototype;
    var instance = create(isObject(proto) ? proto : Object.prototype);
    var result = Function.apply.call(Target, instance, args);
    return isObject(result) ? result : instance;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_bind":"../../node_modules/core-js/modules/_bind.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/es6.reflect.define-property.js":[function(require,module,exports) {
// 26.1.3 Reflect.defineProperty(target, propertyKey, attributes)
var dP = require('./_object-dp');
var $export = require('./_export');
var anObject = require('./_an-object');
var toPrimitive = require('./_to-primitive');

// MS Edge has broken Reflect.defineProperty - throwing instead of returning false
$export($export.S + $export.F * require('./_fails')(function () {
  // eslint-disable-next-line no-undef
  Reflect.defineProperty(dP.f({}, 1, { value: 1 }), 1, { value: 2 });
}), 'Reflect', {
  defineProperty: function defineProperty(target, propertyKey, attributes) {
    anObject(target);
    propertyKey = toPrimitive(propertyKey, true);
    anObject(attributes);
    try {
      dP.f(target, propertyKey, attributes);
      return true;
    } catch (e) {
      return false;
    }
  }
});

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_export":"../../node_modules/core-js/modules/_export.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.reflect.delete-property.js":[function(require,module,exports) {
// 26.1.4 Reflect.deleteProperty(target, propertyKey)
var $export = require('./_export');
var gOPD = require('./_object-gopd').f;
var anObject = require('./_an-object');

$export($export.S, 'Reflect', {
  deleteProperty: function deleteProperty(target, propertyKey) {
    var desc = gOPD(anObject(target), propertyKey);
    return desc && !desc.configurable ? false : delete target[propertyKey];
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.get.js":[function(require,module,exports) {
// 26.1.6 Reflect.get(target, propertyKey [, receiver])
var gOPD = require('./_object-gopd');
var getPrototypeOf = require('./_object-gpo');
var has = require('./_has');
var $export = require('./_export');
var isObject = require('./_is-object');
var anObject = require('./_an-object');

function get(target, propertyKey /* , receiver */) {
  var receiver = arguments.length < 3 ? target : arguments[2];
  var desc, proto;
  if (anObject(target) === receiver) return target[propertyKey];
  if (desc = gOPD.f(target, propertyKey)) return has(desc, 'value')
    ? desc.value
    : desc.get !== undefined
      ? desc.get.call(receiver)
      : undefined;
  if (isObject(proto = getPrototypeOf(target))) return get(proto, propertyKey, receiver);
}

$export($export.S, 'Reflect', { get: get });

},{"./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_has":"../../node_modules/core-js/modules/_has.js","./_export":"../../node_modules/core-js/modules/_export.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.get-own-property-descriptor.js":[function(require,module,exports) {
// 26.1.7 Reflect.getOwnPropertyDescriptor(target, propertyKey)
var gOPD = require('./_object-gopd');
var $export = require('./_export');
var anObject = require('./_an-object');

$export($export.S, 'Reflect', {
  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(target, propertyKey) {
    return gOPD.f(anObject(target), propertyKey);
  }
});

},{"./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_export":"../../node_modules/core-js/modules/_export.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.get-prototype-of.js":[function(require,module,exports) {
// 26.1.8 Reflect.getPrototypeOf(target)
var $export = require('./_export');
var getProto = require('./_object-gpo');
var anObject = require('./_an-object');

$export($export.S, 'Reflect', {
  getPrototypeOf: function getPrototypeOf(target) {
    return getProto(anObject(target));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.has.js":[function(require,module,exports) {
// 26.1.9 Reflect.has(target, propertyKey)
var $export = require('./_export');

$export($export.S, 'Reflect', {
  has: function has(target, propertyKey) {
    return propertyKey in target;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.reflect.is-extensible.js":[function(require,module,exports) {
// 26.1.10 Reflect.isExtensible(target)
var $export = require('./_export');
var anObject = require('./_an-object');
var $isExtensible = Object.isExtensible;

$export($export.S, 'Reflect', {
  isExtensible: function isExtensible(target) {
    anObject(target);
    return $isExtensible ? $isExtensible(target) : true;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.own-keys.js":[function(require,module,exports) {
// 26.1.11 Reflect.ownKeys(target)
var $export = require('./_export');

$export($export.S, 'Reflect', { ownKeys: require('./_own-keys') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_own-keys":"../../node_modules/core-js/modules/_own-keys.js"}],"../../node_modules/core-js/modules/es6.reflect.prevent-extensions.js":[function(require,module,exports) {
// 26.1.12 Reflect.preventExtensions(target)
var $export = require('./_export');
var anObject = require('./_an-object');
var $preventExtensions = Object.preventExtensions;

$export($export.S, 'Reflect', {
  preventExtensions: function preventExtensions(target) {
    anObject(target);
    try {
      if ($preventExtensions) $preventExtensions(target);
      return true;
    } catch (e) {
      return false;
    }
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.set.js":[function(require,module,exports) {
// 26.1.13 Reflect.set(target, propertyKey, V [, receiver])
var dP = require('./_object-dp');
var gOPD = require('./_object-gopd');
var getPrototypeOf = require('./_object-gpo');
var has = require('./_has');
var $export = require('./_export');
var createDesc = require('./_property-desc');
var anObject = require('./_an-object');
var isObject = require('./_is-object');

function set(target, propertyKey, V /* , receiver */) {
  var receiver = arguments.length < 4 ? target : arguments[3];
  var ownDesc = gOPD.f(anObject(target), propertyKey);
  var existingDescriptor, proto;
  if (!ownDesc) {
    if (isObject(proto = getPrototypeOf(target))) {
      return set(proto, propertyKey, V, receiver);
    }
    ownDesc = createDesc(0);
  }
  if (has(ownDesc, 'value')) {
    if (ownDesc.writable === false || !isObject(receiver)) return false;
    if (existingDescriptor = gOPD.f(receiver, propertyKey)) {
      if (existingDescriptor.get || existingDescriptor.set || existingDescriptor.writable === false) return false;
      existingDescriptor.value = V;
      dP.f(receiver, propertyKey, existingDescriptor);
    } else dP.f(receiver, propertyKey, createDesc(0, V));
    return true;
  }
  return ownDesc.set === undefined ? false : (ownDesc.set.call(receiver, V), true);
}

$export($export.S, 'Reflect', { set: set });

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_has":"../../node_modules/core-js/modules/_has.js","./_export":"../../node_modules/core-js/modules/_export.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js"}],"../../node_modules/core-js/modules/es6.reflect.set-prototype-of.js":[function(require,module,exports) {
// 26.1.14 Reflect.setPrototypeOf(target, proto)
var $export = require('./_export');
var setProto = require('./_set-proto');

if (setProto) $export($export.S, 'Reflect', {
  setPrototypeOf: function setPrototypeOf(target, proto) {
    setProto.check(target, proto);
    try {
      setProto.set(target, proto);
      return true;
    } catch (e) {
      return false;
    }
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_set-proto":"../../node_modules/core-js/modules/_set-proto.js"}],"../../node_modules/core-js/modules/_is-regexp.js":[function(require,module,exports) {
// 7.2.8 IsRegExp(argument)
var isObject = require('./_is-object');
var cof = require('./_cof');
var MATCH = require('./_wks')('match');
module.exports = function (it) {
  var isRegExp;
  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : cof(it) == 'RegExp');
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_cof":"../../node_modules/core-js/modules/_cof.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_flags.js":[function(require,module,exports) {
'use strict';
// 21.2.5.3 get RegExp.prototype.flags
var anObject = require('./_an-object');
module.exports = function () {
  var that = anObject(this);
  var result = '';
  if (that.global) result += 'g';
  if (that.ignoreCase) result += 'i';
  if (that.multiline) result += 'm';
  if (that.unicode) result += 'u';
  if (that.sticky) result += 'y';
  return result;
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.regexp.constructor.js":[function(require,module,exports) {

var global = require('./_global');
var inheritIfRequired = require('./_inherit-if-required');
var dP = require('./_object-dp').f;
var gOPN = require('./_object-gopn').f;
var isRegExp = require('./_is-regexp');
var $flags = require('./_flags');
var $RegExp = global.RegExp;
var Base = $RegExp;
var proto = $RegExp.prototype;
var re1 = /a/g;
var re2 = /a/g;
// "new" creates a new object, old webkit buggy here
var CORRECT_NEW = new $RegExp(re1) !== re1;

if (require('./_descriptors') && (!CORRECT_NEW || require('./_fails')(function () {
  re2[require('./_wks')('match')] = false;
  // RegExp constructor can alter flags and IsRegExp works correct with @@match
  return $RegExp(re1) != re1 || $RegExp(re2) == re2 || $RegExp(re1, 'i') != '/a/i';
}))) {
  $RegExp = function RegExp(p, f) {
    var tiRE = this instanceof $RegExp;
    var piRE = isRegExp(p);
    var fiU = f === undefined;
    return !tiRE && piRE && p.constructor === $RegExp && fiU ? p
      : inheritIfRequired(CORRECT_NEW
        ? new Base(piRE && !fiU ? p.source : p, f)
        : Base((piRE = p instanceof $RegExp) ? p.source : p, piRE && fiU ? $flags.call(p) : f)
      , tiRE ? this : proto, $RegExp);
  };
  var proxy = function (key) {
    key in $RegExp || dP($RegExp, key, {
      configurable: true,
      get: function () { return Base[key]; },
      set: function (it) { Base[key] = it; }
    });
  };
  for (var keys = gOPN(Base), i = 0; keys.length > i;) proxy(keys[i++]);
  proto.constructor = $RegExp;
  $RegExp.prototype = proto;
  require('./_redefine')(global, 'RegExp', $RegExp);
}

require('./_set-species')('RegExp');

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_inherit-if-required":"../../node_modules/core-js/modules/_inherit-if-required.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./_is-regexp":"../../node_modules/core-js/modules/_is-regexp.js","./_flags":"../../node_modules/core-js/modules/_flags.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_set-species":"../../node_modules/core-js/modules/_set-species.js"}],"../../node_modules/core-js/modules/es6.regexp.flags.js":[function(require,module,exports) {
// 21.2.5.3 get RegExp.prototype.flags()
if (require('./_descriptors') && /./g.flags != 'g') require('./_object-dp').f(RegExp.prototype, 'flags', {
  configurable: true,
  get: require('./_flags')
});

},{"./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_flags":"../../node_modules/core-js/modules/_flags.js"}],"../../node_modules/core-js/modules/_string-at.js":[function(require,module,exports) {
var toInteger = require('./_to-integer');
var defined = require('./_defined');
// true  -> String#at
// false -> String#codePointAt
module.exports = function (TO_STRING) {
  return function (that, pos) {
    var s = String(defined(that));
    var i = toInteger(pos);
    var l = s.length;
    var a, b;
    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;
    a = s.charCodeAt(i);
    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff
      ? TO_STRING ? s.charAt(i) : a
      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;
  };
};

},{"./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/_advance-string-index.js":[function(require,module,exports) {
'use strict';
var at = require('./_string-at')(true);

 // `AdvanceStringIndex` abstract operation
// https://tc39.github.io/ecma262/#sec-advancestringindex
module.exports = function (S, index, unicode) {
  return index + (unicode ? at(S, index).length : 1);
};

},{"./_string-at":"../../node_modules/core-js/modules/_string-at.js"}],"../../node_modules/core-js/modules/_regexp-exec-abstract.js":[function(require,module,exports) {
'use strict';

var classof = require('./_classof');
var builtinExec = RegExp.prototype.exec;

 // `RegExpExec` abstract operation
// https://tc39.github.io/ecma262/#sec-regexpexec
module.exports = function (R, S) {
  var exec = R.exec;
  if (typeof exec === 'function') {
    var result = exec.call(R, S);
    if (typeof result !== 'object') {
      throw new TypeError('RegExp exec method returned something other than an Object or null');
    }
    return result;
  }
  if (classof(R) !== 'RegExp') {
    throw new TypeError('RegExp#exec called on incompatible receiver');
  }
  return builtinExec.call(R, S);
};

},{"./_classof":"../../node_modules/core-js/modules/_classof.js"}],"../../node_modules/core-js/modules/_regexp-exec.js":[function(require,module,exports) {
'use strict';

var regexpFlags = require('./_flags');

var nativeExec = RegExp.prototype.exec;
// This always refers to the native implementation, because the
// String#replace polyfill uses ./fix-regexp-well-known-symbol-logic.js,
// which loads this file before patching the method.
var nativeReplace = String.prototype.replace;

var patchedExec = nativeExec;

var LAST_INDEX = 'lastIndex';

var UPDATES_LAST_INDEX_WRONG = (function () {
  var re1 = /a/,
      re2 = /b*/g;
  nativeExec.call(re1, 'a');
  nativeExec.call(re2, 'a');
  return re1[LAST_INDEX] !== 0 || re2[LAST_INDEX] !== 0;
})();

// nonparticipating capturing group, copied from es5-shim's String#split patch.
var NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;

var PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED;

if (PATCH) {
  patchedExec = function exec(str) {
    var re = this;
    var lastIndex, reCopy, match, i;

    if (NPCG_INCLUDED) {
      reCopy = new RegExp('^' + re.source + '$(?!\\s)', regexpFlags.call(re));
    }
    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re[LAST_INDEX];

    match = nativeExec.call(re, str);

    if (UPDATES_LAST_INDEX_WRONG && match) {
      re[LAST_INDEX] = re.global ? match.index + match[0].length : lastIndex;
    }
    if (NPCG_INCLUDED && match && match.length > 1) {
      // Fix browsers whose `exec` methods don't consistently return `undefined`
      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/
      // eslint-disable-next-line no-loop-func
      nativeReplace.call(match[0], reCopy, function () {
        for (i = 1; i < arguments.length - 2; i++) {
          if (arguments[i] === undefined) match[i] = undefined;
        }
      });
    }

    return match;
  };
}

module.exports = patchedExec;

},{"./_flags":"../../node_modules/core-js/modules/_flags.js"}],"../../node_modules/core-js/modules/es6.regexp.exec.js":[function(require,module,exports) {
'use strict';
var regexpExec = require('./_regexp-exec');
require('./_export')({
  target: 'RegExp',
  proto: true,
  forced: regexpExec !== /./.exec
}, {
  exec: regexpExec
});

},{"./_regexp-exec":"../../node_modules/core-js/modules/_regexp-exec.js","./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/_fix-re-wks.js":[function(require,module,exports) {
'use strict';
require('./es6.regexp.exec');
var redefine = require('./_redefine');
var hide = require('./_hide');
var fails = require('./_fails');
var defined = require('./_defined');
var wks = require('./_wks');
var regexpExec = require('./_regexp-exec');

var SPECIES = wks('species');

var REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {
  // #replace needs built-in support for named groups.
  // #match works fine because it just return the exec results, even if it has
  // a "grops" property.
  var re = /./;
  re.exec = function () {
    var result = [];
    result.groups = { a: '7' };
    return result;
  };
  return ''.replace(re, '$<a>') !== '7';
});

var SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = (function () {
  // Chrome 51 has a buggy "split" implementation when RegExp#exec !== nativeExec
  var re = /(?:)/;
  var originalExec = re.exec;
  re.exec = function () { return originalExec.apply(this, arguments); };
  var result = 'ab'.split(re);
  return result.length === 2 && result[0] === 'a' && result[1] === 'b';
})();

module.exports = function (KEY, length, exec) {
  var SYMBOL = wks(KEY);

  var DELEGATES_TO_SYMBOL = !fails(function () {
    // String methods call symbol-named RegEp methods
    var O = {};
    O[SYMBOL] = function () { return 7; };
    return ''[KEY](O) != 7;
  });

  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL ? !fails(function () {
    // Symbol-named RegExp methods call .exec
    var execCalled = false;
    var re = /a/;
    re.exec = function () { execCalled = true; return null; };
    if (KEY === 'split') {
      // RegExp[@@split] doesn't call the regex's exec method, but first creates
      // a new one. We need to return the patched regex when creating the new one.
      re.constructor = {};
      re.constructor[SPECIES] = function () { return re; };
    }
    re[SYMBOL]('');
    return !execCalled;
  }) : undefined;

  if (
    !DELEGATES_TO_SYMBOL ||
    !DELEGATES_TO_EXEC ||
    (KEY === 'replace' && !REPLACE_SUPPORTS_NAMED_GROUPS) ||
    (KEY === 'split' && !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC)
  ) {
    var nativeRegExpMethod = /./[SYMBOL];
    var fns = exec(
      defined,
      SYMBOL,
      ''[KEY],
      function maybeCallNative(nativeMethod, regexp, str, arg2, forceStringMethod) {
        if (regexp.exec === regexpExec) {
          if (DELEGATES_TO_SYMBOL && !forceStringMethod) {
            // The native String method already delegates to @@method (this
            // polyfilled function), leasing to infinite recursion.
            // We avoid it by directly calling the native @@method method.
            return { done: true, value: nativeRegExpMethod.call(regexp, str, arg2) };
          }
          return { done: true, value: nativeMethod.call(str, regexp, arg2) };
        }
        return { done: false };
      }
    );
    var strfn = fns[0];
    var rxfn = fns[1];

    redefine(String.prototype, KEY, strfn);
    hide(RegExp.prototype, SYMBOL, length == 2
      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)
      // 21.2.5.11 RegExp.prototype[@@split](string, limit)
      ? function (string, arg) { return rxfn.call(string, this, arg); }
      // 21.2.5.6 RegExp.prototype[@@match](string)
      // 21.2.5.9 RegExp.prototype[@@search](string)
      : function (string) { return rxfn.call(string, this); }
    );
  }
};

},{"./es6.regexp.exec":"../../node_modules/core-js/modules/es6.regexp.exec.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_defined":"../../node_modules/core-js/modules/_defined.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_regexp-exec":"../../node_modules/core-js/modules/_regexp-exec.js"}],"../../node_modules/core-js/modules/es6.regexp.match.js":[function(require,module,exports) {
'use strict';

var anObject = require('./_an-object');
var toLength = require('./_to-length');
var advanceStringIndex = require('./_advance-string-index');
var regExpExec = require('./_regexp-exec-abstract');

// @@match logic
require('./_fix-re-wks')('match', 1, function (defined, MATCH, $match, maybeCallNative) {
  return [
    // `String.prototype.match` method
    // https://tc39.github.io/ecma262/#sec-string.prototype.match
    function match(regexp) {
      var O = defined(this);
      var fn = regexp == undefined ? undefined : regexp[MATCH];
      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));
    },
    // `RegExp.prototype[@@match]` method
    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match
    function (regexp) {
      var res = maybeCallNative($match, regexp, this);
      if (res.done) return res.value;
      var rx = anObject(regexp);
      var S = String(this);
      if (!rx.global) return regExpExec(rx, S);
      var fullUnicode = rx.unicode;
      rx.lastIndex = 0;
      var A = [];
      var n = 0;
      var result;
      while ((result = regExpExec(rx, S)) !== null) {
        var matchStr = String(result[0]);
        A[n] = matchStr;
        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);
        n++;
      }
      return n === 0 ? null : A;
    }
  ];
});

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_advance-string-index":"../../node_modules/core-js/modules/_advance-string-index.js","./_regexp-exec-abstract":"../../node_modules/core-js/modules/_regexp-exec-abstract.js","./_fix-re-wks":"../../node_modules/core-js/modules/_fix-re-wks.js"}],"../../node_modules/core-js/modules/es6.regexp.replace.js":[function(require,module,exports) {
var global = arguments[3];
'use strict';

var anObject = require('./_an-object');
var toObject = require('./_to-object');
var toLength = require('./_to-length');
var toInteger = require('./_to-integer');
var advanceStringIndex = require('./_advance-string-index');
var regExpExec = require('./_regexp-exec-abstract');
var max = Math.max;
var min = Math.min;
var floor = Math.floor;
var SUBSTITUTION_SYMBOLS = /\$([$&`']|\d\d?|<[^>]*>)/g;
var SUBSTITUTION_SYMBOLS_NO_NAMED = /\$([$&`']|\d\d?)/g;

var maybeToString = function (it) {
  return it === undefined ? it : String(it);
};

// @@replace logic
require('./_fix-re-wks')('replace', 2, function (defined, REPLACE, $replace, maybeCallNative) {
  return [
    // `String.prototype.replace` method
    // https://tc39.github.io/ecma262/#sec-string.prototype.replace
    function replace(searchValue, replaceValue) {
      var O = defined(this);
      var fn = searchValue == undefined ? undefined : searchValue[REPLACE];
      return fn !== undefined
        ? fn.call(searchValue, O, replaceValue)
        : $replace.call(String(O), searchValue, replaceValue);
    },
    // `RegExp.prototype[@@replace]` method
    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace
    function (regexp, replaceValue) {
      var res = maybeCallNative($replace, regexp, this, replaceValue);
      if (res.done) return res.value;

      var rx = anObject(regexp);
      var S = String(this);
      var functionalReplace = typeof replaceValue === 'function';
      if (!functionalReplace) replaceValue = String(replaceValue);
      var global = rx.global;
      if (global) {
        var fullUnicode = rx.unicode;
        rx.lastIndex = 0;
      }
      var results = [];
      while (true) {
        var result = regExpExec(rx, S);
        if (result === null) break;
        results.push(result);
        if (!global) break;
        var matchStr = String(result[0]);
        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);
      }
      var accumulatedResult = '';
      var nextSourcePosition = 0;
      for (var i = 0; i < results.length; i++) {
        result = results[i];
        var matched = String(result[0]);
        var position = max(min(toInteger(result.index), S.length), 0);
        var captures = [];
        // NOTE: This is equivalent to
        //   captures = result.slice(1).map(maybeToString)
        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in
        // the slice polyfill when slicing native arrays) "doesn't work" in safari 9 and
        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.
        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));
        var namedCaptures = result.groups;
        if (functionalReplace) {
          var replacerArgs = [matched].concat(captures, position, S);
          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);
          var replacement = String(replaceValue.apply(undefined, replacerArgs));
        } else {
          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);
        }
        if (position >= nextSourcePosition) {
          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;
          nextSourcePosition = position + matched.length;
        }
      }
      return accumulatedResult + S.slice(nextSourcePosition);
    }
  ];

    // https://tc39.github.io/ecma262/#sec-getsubstitution
  function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {
    var tailPos = position + matched.length;
    var m = captures.length;
    var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;
    if (namedCaptures !== undefined) {
      namedCaptures = toObject(namedCaptures);
      symbols = SUBSTITUTION_SYMBOLS;
    }
    return $replace.call(replacement, symbols, function (match, ch) {
      var capture;
      switch (ch.charAt(0)) {
        case '$': return '$';
        case '&': return matched;
        case '`': return str.slice(0, position);
        case "'": return str.slice(tailPos);
        case '<':
          capture = namedCaptures[ch.slice(1, -1)];
          break;
        default: // \d\d?
          var n = +ch;
          if (n === 0) return match;
          if (n > m) {
            var f = floor(n / 10);
            if (f === 0) return match;
            if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);
            return match;
          }
          capture = captures[n - 1];
      }
      return capture === undefined ? '' : capture;
    });
  }
});

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_advance-string-index":"../../node_modules/core-js/modules/_advance-string-index.js","./_regexp-exec-abstract":"../../node_modules/core-js/modules/_regexp-exec-abstract.js","./_fix-re-wks":"../../node_modules/core-js/modules/_fix-re-wks.js"}],"../../node_modules/core-js/modules/es6.regexp.split.js":[function(require,module,exports) {
'use strict';

var isRegExp = require('./_is-regexp');
var anObject = require('./_an-object');
var speciesConstructor = require('./_species-constructor');
var advanceStringIndex = require('./_advance-string-index');
var toLength = require('./_to-length');
var callRegExpExec = require('./_regexp-exec-abstract');
var regexpExec = require('./_regexp-exec');
var fails = require('./_fails');
var $min = Math.min;
var $push = [].push;
var $SPLIT = 'split';
var LENGTH = 'length';
var LAST_INDEX = 'lastIndex';
var MAX_UINT32 = 0xffffffff;

// babel-minify transpiles RegExp('x', 'y') -> /x/y and it causes SyntaxError
var SUPPORTS_Y = !fails(function () { RegExp(MAX_UINT32, 'y'); });

// @@split logic
require('./_fix-re-wks')('split', 2, function (defined, SPLIT, $split, maybeCallNative) {
  var internalSplit;
  if (
    'abbc'[$SPLIT](/(b)*/)[1] == 'c' ||
    'test'[$SPLIT](/(?:)/, -1)[LENGTH] != 4 ||
    'ab'[$SPLIT](/(?:ab)*/)[LENGTH] != 2 ||
    '.'[$SPLIT](/(.?)(.?)/)[LENGTH] != 4 ||
    '.'[$SPLIT](/()()/)[LENGTH] > 1 ||
    ''[$SPLIT](/.?/)[LENGTH]
  ) {
    // based on es5-shim implementation, need to rework it
    internalSplit = function (separator, limit) {
      var string = String(this);
      if (separator === undefined && limit === 0) return [];
      // If `separator` is not a regex, use native split
      if (!isRegExp(separator)) return $split.call(string, separator, limit);
      var output = [];
      var flags = (separator.ignoreCase ? 'i' : '') +
                  (separator.multiline ? 'm' : '') +
                  (separator.unicode ? 'u' : '') +
                  (separator.sticky ? 'y' : '');
      var lastLastIndex = 0;
      var splitLimit = limit === undefined ? MAX_UINT32 : limit >>> 0;
      // Make `global` and avoid `lastIndex` issues by working with a copy
      var separatorCopy = new RegExp(separator.source, flags + 'g');
      var match, lastIndex, lastLength;
      while (match = regexpExec.call(separatorCopy, string)) {
        lastIndex = separatorCopy[LAST_INDEX];
        if (lastIndex > lastLastIndex) {
          output.push(string.slice(lastLastIndex, match.index));
          if (match[LENGTH] > 1 && match.index < string[LENGTH]) $push.apply(output, match.slice(1));
          lastLength = match[0][LENGTH];
          lastLastIndex = lastIndex;
          if (output[LENGTH] >= splitLimit) break;
        }
        if (separatorCopy[LAST_INDEX] === match.index) separatorCopy[LAST_INDEX]++; // Avoid an infinite loop
      }
      if (lastLastIndex === string[LENGTH]) {
        if (lastLength || !separatorCopy.test('')) output.push('');
      } else output.push(string.slice(lastLastIndex));
      return output[LENGTH] > splitLimit ? output.slice(0, splitLimit) : output;
    };
  // Chakra, V8
  } else if ('0'[$SPLIT](undefined, 0)[LENGTH]) {
    internalSplit = function (separator, limit) {
      return separator === undefined && limit === 0 ? [] : $split.call(this, separator, limit);
    };
  } else {
    internalSplit = $split;
  }

  return [
    // `String.prototype.split` method
    // https://tc39.github.io/ecma262/#sec-string.prototype.split
    function split(separator, limit) {
      var O = defined(this);
      var splitter = separator == undefined ? undefined : separator[SPLIT];
      return splitter !== undefined
        ? splitter.call(separator, O, limit)
        : internalSplit.call(String(O), separator, limit);
    },
    // `RegExp.prototype[@@split]` method
    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@split
    //
    // NOTE: This cannot be properly polyfilled in engines that don't support
    // the 'y' flag.
    function (regexp, limit) {
      var res = maybeCallNative(internalSplit, regexp, this, limit, internalSplit !== $split);
      if (res.done) return res.value;

      var rx = anObject(regexp);
      var S = String(this);
      var C = speciesConstructor(rx, RegExp);

      var unicodeMatching = rx.unicode;
      var flags = (rx.ignoreCase ? 'i' : '') +
                  (rx.multiline ? 'm' : '') +
                  (rx.unicode ? 'u' : '') +
                  (SUPPORTS_Y ? 'y' : 'g');

      // ^(? + rx + ) is needed, in combination with some S slicing, to
      // simulate the 'y' flag.
      var splitter = new C(SUPPORTS_Y ? rx : '^(?:' + rx.source + ')', flags);
      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;
      if (lim === 0) return [];
      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];
      var p = 0;
      var q = 0;
      var A = [];
      while (q < S.length) {
        splitter.lastIndex = SUPPORTS_Y ? q : 0;
        var z = callRegExpExec(splitter, SUPPORTS_Y ? S : S.slice(q));
        var e;
        if (
          z === null ||
          (e = $min(toLength(splitter.lastIndex + (SUPPORTS_Y ? 0 : q)), S.length)) === p
        ) {
          q = advanceStringIndex(S, q, unicodeMatching);
        } else {
          A.push(S.slice(p, q));
          if (A.length === lim) return A;
          for (var i = 1; i <= z.length - 1; i++) {
            A.push(z[i]);
            if (A.length === lim) return A;
          }
          q = p = e;
        }
      }
      A.push(S.slice(p));
      return A;
    }
  ];
});

},{"./_is-regexp":"../../node_modules/core-js/modules/_is-regexp.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_species-constructor":"../../node_modules/core-js/modules/_species-constructor.js","./_advance-string-index":"../../node_modules/core-js/modules/_advance-string-index.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_regexp-exec-abstract":"../../node_modules/core-js/modules/_regexp-exec-abstract.js","./_regexp-exec":"../../node_modules/core-js/modules/_regexp-exec.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_fix-re-wks":"../../node_modules/core-js/modules/_fix-re-wks.js"}],"../../node_modules/core-js/modules/es6.regexp.search.js":[function(require,module,exports) {
'use strict';

var anObject = require('./_an-object');
var sameValue = require('./_same-value');
var regExpExec = require('./_regexp-exec-abstract');

// @@search logic
require('./_fix-re-wks')('search', 1, function (defined, SEARCH, $search, maybeCallNative) {
  return [
    // `String.prototype.search` method
    // https://tc39.github.io/ecma262/#sec-string.prototype.search
    function search(regexp) {
      var O = defined(this);
      var fn = regexp == undefined ? undefined : regexp[SEARCH];
      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));
    },
    // `RegExp.prototype[@@search]` method
    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@search
    function (regexp) {
      var res = maybeCallNative($search, regexp, this);
      if (res.done) return res.value;
      var rx = anObject(regexp);
      var S = String(this);
      var previousLastIndex = rx.lastIndex;
      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;
      var result = regExpExec(rx, S);
      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;
      return result === null ? -1 : result.index;
    }
  ];
});

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_same-value":"../../node_modules/core-js/modules/_same-value.js","./_regexp-exec-abstract":"../../node_modules/core-js/modules/_regexp-exec-abstract.js","./_fix-re-wks":"../../node_modules/core-js/modules/_fix-re-wks.js"}],"../../node_modules/core-js/modules/es6.regexp.to-string.js":[function(require,module,exports) {

'use strict';
require('./es6.regexp.flags');
var anObject = require('./_an-object');
var $flags = require('./_flags');
var DESCRIPTORS = require('./_descriptors');
var TO_STRING = 'toString';
var $toString = /./[TO_STRING];

var define = function (fn) {
  require('./_redefine')(RegExp.prototype, TO_STRING, fn, true);
};

// 21.2.5.14 RegExp.prototype.toString()
if (require('./_fails')(function () { return $toString.call({ source: 'a', flags: 'b' }) != '/a/b'; })) {
  define(function toString() {
    var R = anObject(this);
    return '/'.concat(R.source, '/',
      'flags' in R ? R.flags : !DESCRIPTORS && R instanceof RegExp ? $flags.call(R) : undefined);
  });
// FF44- RegExp#toString has a wrong name
} else if ($toString.name != TO_STRING) {
  define(function toString() {
    return $toString.call(this);
  });
}

},{"./es6.regexp.flags":"../../node_modules/core-js/modules/es6.regexp.flags.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_flags":"../../node_modules/core-js/modules/_flags.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.set.js":[function(require,module,exports) {
'use strict';
var strong = require('./_collection-strong');
var validate = require('./_validate-collection');
var SET = 'Set';

// 23.2 Set Objects
module.exports = require('./_collection')(SET, function (get) {
  return function Set() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };
}, {
  // 23.2.3.1 Set.prototype.add(value)
  add: function add(value) {
    return strong.def(validate(this, SET), value = value === 0 ? 0 : value, value);
  }
}, strong);

},{"./_collection-strong":"../../node_modules/core-js/modules/_collection-strong.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js","./_collection":"../../node_modules/core-js/modules/_collection.js"}],"../../node_modules/core-js/modules/_wks-ext.js":[function(require,module,exports) {
exports.f = require('./_wks');

},{"./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_wks-define.js":[function(require,module,exports) {

var global = require('./_global');
var core = require('./_core');
var LIBRARY = require('./_library');
var wksExt = require('./_wks-ext');
var defineProperty = require('./_object-dp').f;
module.exports = function (name) {
  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});
  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });
};

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_core":"../../node_modules/core-js/modules/_core.js","./_library":"../../node_modules/core-js/modules/_library.js","./_wks-ext":"../../node_modules/core-js/modules/_wks-ext.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js"}],"../../node_modules/core-js/modules/_enum-keys.js":[function(require,module,exports) {
// all enumerable object keys, includes symbols
var getKeys = require('./_object-keys');
var gOPS = require('./_object-gops');
var pIE = require('./_object-pie');
module.exports = function (it) {
  var result = getKeys(it);
  var getSymbols = gOPS.f;
  if (getSymbols) {
    var symbols = getSymbols(it);
    var isEnum = pIE.f;
    var i = 0;
    var key;
    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);
  } return result;
};

},{"./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_object-gops":"../../node_modules/core-js/modules/_object-gops.js","./_object-pie":"../../node_modules/core-js/modules/_object-pie.js"}],"../../node_modules/core-js/modules/es6.symbol.js":[function(require,module,exports) {

'use strict';
// ECMAScript 6 symbols shim
var global = require('./_global');
var has = require('./_has');
var DESCRIPTORS = require('./_descriptors');
var $export = require('./_export');
var redefine = require('./_redefine');
var META = require('./_meta').KEY;
var $fails = require('./_fails');
var shared = require('./_shared');
var setToStringTag = require('./_set-to-string-tag');
var uid = require('./_uid');
var wks = require('./_wks');
var wksExt = require('./_wks-ext');
var wksDefine = require('./_wks-define');
var enumKeys = require('./_enum-keys');
var isArray = require('./_is-array');
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var toObject = require('./_to-object');
var toIObject = require('./_to-iobject');
var toPrimitive = require('./_to-primitive');
var createDesc = require('./_property-desc');
var _create = require('./_object-create');
var gOPNExt = require('./_object-gopn-ext');
var $GOPD = require('./_object-gopd');
var $GOPS = require('./_object-gops');
var $DP = require('./_object-dp');
var $keys = require('./_object-keys');
var gOPD = $GOPD.f;
var dP = $DP.f;
var gOPN = gOPNExt.f;
var $Symbol = global.Symbol;
var $JSON = global.JSON;
var _stringify = $JSON && $JSON.stringify;
var PROTOTYPE = 'prototype';
var HIDDEN = wks('_hidden');
var TO_PRIMITIVE = wks('toPrimitive');
var isEnum = {}.propertyIsEnumerable;
var SymbolRegistry = shared('symbol-registry');
var AllSymbols = shared('symbols');
var OPSymbols = shared('op-symbols');
var ObjectProto = Object[PROTOTYPE];
var USE_NATIVE = typeof $Symbol == 'function' && !!$GOPS.f;
var QObject = global.QObject;
// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173
var setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;

// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687
var setSymbolDesc = DESCRIPTORS && $fails(function () {
  return _create(dP({}, 'a', {
    get: function () { return dP(this, 'a', { value: 7 }).a; }
  })).a != 7;
}) ? function (it, key, D) {
  var protoDesc = gOPD(ObjectProto, key);
  if (protoDesc) delete ObjectProto[key];
  dP(it, key, D);
  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);
} : dP;

var wrap = function (tag) {
  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);
  sym._k = tag;
  return sym;
};

var isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {
  return typeof it == 'symbol';
} : function (it) {
  return it instanceof $Symbol;
};

var $defineProperty = function defineProperty(it, key, D) {
  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);
  anObject(it);
  key = toPrimitive(key, true);
  anObject(D);
  if (has(AllSymbols, key)) {
    if (!D.enumerable) {
      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));
      it[HIDDEN][key] = true;
    } else {
      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;
      D = _create(D, { enumerable: createDesc(0, false) });
    } return setSymbolDesc(it, key, D);
  } return dP(it, key, D);
};
var $defineProperties = function defineProperties(it, P) {
  anObject(it);
  var keys = enumKeys(P = toIObject(P));
  var i = 0;
  var l = keys.length;
  var key;
  while (l > i) $defineProperty(it, key = keys[i++], P[key]);
  return it;
};
var $create = function create(it, P) {
  return P === undefined ? _create(it) : $defineProperties(_create(it), P);
};
var $propertyIsEnumerable = function propertyIsEnumerable(key) {
  var E = isEnum.call(this, key = toPrimitive(key, true));
  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;
  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;
};
var $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {
  it = toIObject(it);
  key = toPrimitive(key, true);
  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;
  var D = gOPD(it, key);
  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;
  return D;
};
var $getOwnPropertyNames = function getOwnPropertyNames(it) {
  var names = gOPN(toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);
  } return result;
};
var $getOwnPropertySymbols = function getOwnPropertySymbols(it) {
  var IS_OP = it === ObjectProto;
  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);
  } return result;
};

// 19.4.1.1 Symbol([description])
if (!USE_NATIVE) {
  $Symbol = function Symbol() {
    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');
    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);
    var $set = function (value) {
      if (this === ObjectProto) $set.call(OPSymbols, value);
      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;
      setSymbolDesc(this, tag, createDesc(1, value));
    };
    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });
    return wrap(tag);
  };
  redefine($Symbol[PROTOTYPE], 'toString', function toString() {
    return this._k;
  });

  $GOPD.f = $getOwnPropertyDescriptor;
  $DP.f = $defineProperty;
  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;
  require('./_object-pie').f = $propertyIsEnumerable;
  $GOPS.f = $getOwnPropertySymbols;

  if (DESCRIPTORS && !require('./_library')) {
    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);
  }

  wksExt.f = function (name) {
    return wrap(wks(name));
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });

for (var es6Symbols = (
  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14
  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'
).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);

for (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);

$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {
  // 19.4.2.1 Symbol.for(key)
  'for': function (key) {
    return has(SymbolRegistry, key += '')
      ? SymbolRegistry[key]
      : SymbolRegistry[key] = $Symbol(key);
  },
  // 19.4.2.5 Symbol.keyFor(sym)
  keyFor: function keyFor(sym) {
    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');
    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;
  },
  useSetter: function () { setter = true; },
  useSimple: function () { setter = false; }
});

$export($export.S + $export.F * !USE_NATIVE, 'Object', {
  // 19.1.2.2 Object.create(O [, Properties])
  create: $create,
  // 19.1.2.4 Object.defineProperty(O, P, Attributes)
  defineProperty: $defineProperty,
  // 19.1.2.3 Object.defineProperties(O, Properties)
  defineProperties: $defineProperties,
  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,
  // 19.1.2.7 Object.getOwnPropertyNames(O)
  getOwnPropertyNames: $getOwnPropertyNames,
  // 19.1.2.8 Object.getOwnPropertySymbols(O)
  getOwnPropertySymbols: $getOwnPropertySymbols
});

// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives
// https://bugs.chromium.org/p/v8/issues/detail?id=3443
var FAILS_ON_PRIMITIVES = $fails(function () { $GOPS.f(1); });

$export($export.S + $export.F * FAILS_ON_PRIMITIVES, 'Object', {
  getOwnPropertySymbols: function getOwnPropertySymbols(it) {
    return $GOPS.f(toObject(it));
  }
});

// 24.3.2 JSON.stringify(value [, replacer [, space]])
$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {
  var S = $Symbol();
  // MS Edge converts symbol values to JSON as {}
  // WebKit converts symbol values to JSON as null
  // V8 throws on boxed symbols
  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';
})), 'JSON', {
  stringify: function stringify(it) {
    var args = [it];
    var i = 1;
    var replacer, $replacer;
    while (arguments.length > i) args.push(arguments[i++]);
    $replacer = replacer = args[1];
    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined
    if (!isArray(replacer)) replacer = function (key, value) {
      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);
      if (!isSymbol(value)) return value;
    };
    args[1] = replacer;
    return _stringify.apply($JSON, args);
  }
});

// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)
$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);
// 19.4.3.5 Symbol.prototype[@@toStringTag]
setToStringTag($Symbol, 'Symbol');
// 20.2.1.9 Math[@@toStringTag]
setToStringTag(Math, 'Math', true);
// 24.3.3 JSON[@@toStringTag]
setToStringTag(global.JSON, 'JSON', true);

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_has":"../../node_modules/core-js/modules/_has.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_export":"../../node_modules/core-js/modules/_export.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_shared":"../../node_modules/core-js/modules/_shared.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js","./_uid":"../../node_modules/core-js/modules/_uid.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_wks-ext":"../../node_modules/core-js/modules/_wks-ext.js","./_wks-define":"../../node_modules/core-js/modules/_wks-define.js","./_enum-keys":"../../node_modules/core-js/modules/_enum-keys.js","./_is-array":"../../node_modules/core-js/modules/_is-array.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_object-gopn-ext":"../../node_modules/core-js/modules/_object-gopn-ext.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_object-gops":"../../node_modules/core-js/modules/_object-gops.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./_object-pie":"../../node_modules/core-js/modules/_object-pie.js","./_library":"../../node_modules/core-js/modules/_library.js","./_hide":"../../node_modules/core-js/modules/_hide.js"}],"../../node_modules/core-js/modules/es7.symbol.async-iterator.js":[function(require,module,exports) {
require('./_wks-define')('asyncIterator');

},{"./_wks-define":"../../node_modules/core-js/modules/_wks-define.js"}],"../../node_modules/core-js/modules/_string-html.js":[function(require,module,exports) {
var $export = require('./_export');
var fails = require('./_fails');
var defined = require('./_defined');
var quot = /"/g;
// B.2.3.2.1 CreateHTML(string, tag, attribute, value)
var createHTML = function (string, tag, attribute, value) {
  var S = String(defined(string));
  var p1 = '<' + tag;
  if (attribute !== '') p1 += ' ' + attribute + '="' + String(value).replace(quot, '&quot;') + '"';
  return p1 + '>' + S + '</' + tag + '>';
};
module.exports = function (NAME, exec) {
  var O = {};
  O[NAME] = exec(createHTML);
  $export($export.P + $export.F * fails(function () {
    var test = ''[NAME]('"');
    return test !== test.toLowerCase() || test.split('"').length > 3;
  }), 'String', O);
};

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/es6.string.anchor.js":[function(require,module,exports) {
'use strict';
// B.2.3.2 String.prototype.anchor(name)
require('./_string-html')('anchor', function (createHTML) {
  return function anchor(name) {
    return createHTML(this, 'a', 'name', name);
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.big.js":[function(require,module,exports) {
'use strict';
// B.2.3.3 String.prototype.big()
require('./_string-html')('big', function (createHTML) {
  return function big() {
    return createHTML(this, 'big', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.blink.js":[function(require,module,exports) {
'use strict';
// B.2.3.4 String.prototype.blink()
require('./_string-html')('blink', function (createHTML) {
  return function blink() {
    return createHTML(this, 'blink', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.bold.js":[function(require,module,exports) {
'use strict';
// B.2.3.5 String.prototype.bold()
require('./_string-html')('bold', function (createHTML) {
  return function bold() {
    return createHTML(this, 'b', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.code-point-at.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var $at = require('./_string-at')(false);
$export($export.P, 'String', {
  // 21.1.3.3 String.prototype.codePointAt(pos)
  codePointAt: function codePointAt(pos) {
    return $at(this, pos);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_string-at":"../../node_modules/core-js/modules/_string-at.js"}],"../../node_modules/core-js/modules/_string-context.js":[function(require,module,exports) {
// helper for String#{startsWith, endsWith, includes}
var isRegExp = require('./_is-regexp');
var defined = require('./_defined');

module.exports = function (that, searchString, NAME) {
  if (isRegExp(searchString)) throw TypeError('String#' + NAME + " doesn't accept regex!");
  return String(defined(that));
};

},{"./_is-regexp":"../../node_modules/core-js/modules/_is-regexp.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/_fails-is-regexp.js":[function(require,module,exports) {
var MATCH = require('./_wks')('match');
module.exports = function (KEY) {
  var re = /./;
  try {
    '/./'[KEY](re);
  } catch (e) {
    try {
      re[MATCH] = false;
      return !'/./'[KEY](re);
    } catch (f) { /* empty */ }
  } return true;
};

},{"./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/es6.string.ends-with.js":[function(require,module,exports) {
// 21.1.3.6 String.prototype.endsWith(searchString [, endPosition])
'use strict';
var $export = require('./_export');
var toLength = require('./_to-length');
var context = require('./_string-context');
var ENDS_WITH = 'endsWith';
var $endsWith = ''[ENDS_WITH];

$export($export.P + $export.F * require('./_fails-is-regexp')(ENDS_WITH), 'String', {
  endsWith: function endsWith(searchString /* , endPosition = @length */) {
    var that = context(this, searchString, ENDS_WITH);
    var endPosition = arguments.length > 1 ? arguments[1] : undefined;
    var len = toLength(that.length);
    var end = endPosition === undefined ? len : Math.min(toLength(endPosition), len);
    var search = String(searchString);
    return $endsWith
      ? $endsWith.call(that, search, end)
      : that.slice(end - search.length, end) === search;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_string-context":"../../node_modules/core-js/modules/_string-context.js","./_fails-is-regexp":"../../node_modules/core-js/modules/_fails-is-regexp.js"}],"../../node_modules/core-js/modules/es6.string.fixed.js":[function(require,module,exports) {
'use strict';
// B.2.3.6 String.prototype.fixed()
require('./_string-html')('fixed', function (createHTML) {
  return function fixed() {
    return createHTML(this, 'tt', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.fontcolor.js":[function(require,module,exports) {
'use strict';
// B.2.3.7 String.prototype.fontcolor(color)
require('./_string-html')('fontcolor', function (createHTML) {
  return function fontcolor(color) {
    return createHTML(this, 'font', 'color', color);
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.fontsize.js":[function(require,module,exports) {
'use strict';
// B.2.3.8 String.prototype.fontsize(size)
require('./_string-html')('fontsize', function (createHTML) {
  return function fontsize(size) {
    return createHTML(this, 'font', 'size', size);
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.from-code-point.js":[function(require,module,exports) {
var $export = require('./_export');
var toAbsoluteIndex = require('./_to-absolute-index');
var fromCharCode = String.fromCharCode;
var $fromCodePoint = String.fromCodePoint;

// length should be 1, old FF problem
$export($export.S + $export.F * (!!$fromCodePoint && $fromCodePoint.length != 1), 'String', {
  // 21.1.2.2 String.fromCodePoint(...codePoints)
  fromCodePoint: function fromCodePoint(x) { // eslint-disable-line no-unused-vars
    var res = [];
    var aLen = arguments.length;
    var i = 0;
    var code;
    while (aLen > i) {
      code = +arguments[i++];
      if (toAbsoluteIndex(code, 0x10ffff) !== code) throw RangeError(code + ' is not a valid code point');
      res.push(code < 0x10000
        ? fromCharCode(code)
        : fromCharCode(((code -= 0x10000) >> 10) + 0xd800, code % 0x400 + 0xdc00)
      );
    } return res.join('');
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js"}],"../../node_modules/core-js/modules/es6.string.includes.js":[function(require,module,exports) {
// 21.1.3.7 String.prototype.includes(searchString, position = 0)
'use strict';
var $export = require('./_export');
var context = require('./_string-context');
var INCLUDES = 'includes';

$export($export.P + $export.F * require('./_fails-is-regexp')(INCLUDES), 'String', {
  includes: function includes(searchString /* , position = 0 */) {
    return !!~context(this, searchString, INCLUDES)
      .indexOf(searchString, arguments.length > 1 ? arguments[1] : undefined);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_string-context":"../../node_modules/core-js/modules/_string-context.js","./_fails-is-regexp":"../../node_modules/core-js/modules/_fails-is-regexp.js"}],"../../node_modules/core-js/modules/es6.string.italics.js":[function(require,module,exports) {
'use strict';
// B.2.3.9 String.prototype.italics()
require('./_string-html')('italics', function (createHTML) {
  return function italics() {
    return createHTML(this, 'i', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.iterator.js":[function(require,module,exports) {
'use strict';
var $at = require('./_string-at')(true);

// 21.1.3.27 String.prototype[@@iterator]()
require('./_iter-define')(String, 'String', function (iterated) {
  this._t = String(iterated); // target
  this._i = 0;                // next index
// 21.1.5.2.1 %StringIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var index = this._i;
  var point;
  if (index >= O.length) return { value: undefined, done: true };
  point = $at(O, index);
  this._i += point.length;
  return { value: point, done: false };
});

},{"./_string-at":"../../node_modules/core-js/modules/_string-at.js","./_iter-define":"../../node_modules/core-js/modules/_iter-define.js"}],"../../node_modules/core-js/modules/es6.string.link.js":[function(require,module,exports) {
'use strict';
// B.2.3.10 String.prototype.link(url)
require('./_string-html')('link', function (createHTML) {
  return function link(url) {
    return createHTML(this, 'a', 'href', url);
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/_string-repeat.js":[function(require,module,exports) {
'use strict';
var toInteger = require('./_to-integer');
var defined = require('./_defined');

module.exports = function repeat(count) {
  var str = String(defined(this));
  var res = '';
  var n = toInteger(count);
  if (n < 0 || n == Infinity) throw RangeError("Count can't be negative");
  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) res += str;
  return res;
};

},{"./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/_string-pad.js":[function(require,module,exports) {
// https://github.com/tc39/proposal-string-pad-start-end
var toLength = require('./_to-length');
var repeat = require('./_string-repeat');
var defined = require('./_defined');

module.exports = function (that, maxLength, fillString, left) {
  var S = String(defined(that));
  var stringLength = S.length;
  var fillStr = fillString === undefined ? ' ' : String(fillString);
  var intMaxLength = toLength(maxLength);
  if (intMaxLength <= stringLength || fillStr == '') return S;
  var fillLen = intMaxLength - stringLength;
  var stringFiller = repeat.call(fillStr, Math.ceil(fillLen / fillStr.length));
  if (stringFiller.length > fillLen) stringFiller = stringFiller.slice(0, fillLen);
  return left ? stringFiller + S : S + stringFiller;
};

},{"./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_string-repeat":"../../node_modules/core-js/modules/_string-repeat.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/es7.string.pad-start.js":[function(require,module,exports) {
'use strict';
// https://github.com/tc39/proposal-string-pad-start-end
var $export = require('./_export');
var $pad = require('./_string-pad');
var userAgent = require('./_user-agent');

// https://github.com/zloirock/core-js/issues/280
var WEBKIT_BUG = /Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(userAgent);

$export($export.P + $export.F * WEBKIT_BUG, 'String', {
  padStart: function padStart(maxLength /* , fillString = ' ' */) {
    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, true);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_string-pad":"../../node_modules/core-js/modules/_string-pad.js","./_user-agent":"../../node_modules/core-js/modules/_user-agent.js"}],"../../node_modules/core-js/modules/es7.string.pad-end.js":[function(require,module,exports) {
'use strict';
// https://github.com/tc39/proposal-string-pad-start-end
var $export = require('./_export');
var $pad = require('./_string-pad');
var userAgent = require('./_user-agent');

// https://github.com/zloirock/core-js/issues/280
var WEBKIT_BUG = /Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(userAgent);

$export($export.P + $export.F * WEBKIT_BUG, 'String', {
  padEnd: function padEnd(maxLength /* , fillString = ' ' */) {
    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, false);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_string-pad":"../../node_modules/core-js/modules/_string-pad.js","./_user-agent":"../../node_modules/core-js/modules/_user-agent.js"}],"../../node_modules/core-js/modules/es6.string.raw.js":[function(require,module,exports) {
var $export = require('./_export');
var toIObject = require('./_to-iobject');
var toLength = require('./_to-length');

$export($export.S, 'String', {
  // 21.1.2.4 String.raw(callSite, ...substitutions)
  raw: function raw(callSite) {
    var tpl = toIObject(callSite.raw);
    var len = toLength(tpl.length);
    var aLen = arguments.length;
    var res = [];
    var i = 0;
    while (len > i) {
      res.push(String(tpl[i++]));
      if (i < aLen) res.push(String(arguments[i]));
    } return res.join('');
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js"}],"../../node_modules/core-js/modules/es6.string.repeat.js":[function(require,module,exports) {
var $export = require('./_export');

$export($export.P, 'String', {
  // 21.1.3.13 String.prototype.repeat(count)
  repeat: require('./_string-repeat')
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_string-repeat":"../../node_modules/core-js/modules/_string-repeat.js"}],"../../node_modules/core-js/modules/es6.string.small.js":[function(require,module,exports) {
'use strict';
// B.2.3.11 String.prototype.small()
require('./_string-html')('small', function (createHTML) {
  return function small() {
    return createHTML(this, 'small', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.starts-with.js":[function(require,module,exports) {
// 21.1.3.18 String.prototype.startsWith(searchString [, position ])
'use strict';
var $export = require('./_export');
var toLength = require('./_to-length');
var context = require('./_string-context');
var STARTS_WITH = 'startsWith';
var $startsWith = ''[STARTS_WITH];

$export($export.P + $export.F * require('./_fails-is-regexp')(STARTS_WITH), 'String', {
  startsWith: function startsWith(searchString /* , position = 0 */) {
    var that = context(this, searchString, STARTS_WITH);
    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));
    var search = String(searchString);
    return $startsWith
      ? $startsWith.call(that, search, index)
      : that.slice(index, index + search.length) === search;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_string-context":"../../node_modules/core-js/modules/_string-context.js","./_fails-is-regexp":"../../node_modules/core-js/modules/_fails-is-regexp.js"}],"../../node_modules/core-js/modules/es6.string.strike.js":[function(require,module,exports) {
'use strict';
// B.2.3.12 String.prototype.strike()
require('./_string-html')('strike', function (createHTML) {
  return function strike() {
    return createHTML(this, 'strike', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.sub.js":[function(require,module,exports) {
'use strict';
// B.2.3.13 String.prototype.sub()
require('./_string-html')('sub', function (createHTML) {
  return function sub() {
    return createHTML(this, 'sub', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.sup.js":[function(require,module,exports) {
'use strict';
// B.2.3.14 String.prototype.sup()
require('./_string-html')('sup', function (createHTML) {
  return function sup() {
    return createHTML(this, 'sup', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es7.string.trim-left.js":[function(require,module,exports) {
'use strict';
// https://github.com/sebmarkbage/ecmascript-string-left-right-trim
require('./_string-trim')('trimLeft', function ($trim) {
  return function trimLeft() {
    return $trim(this, 1);
  };
}, 'trimStart');

},{"./_string-trim":"../../node_modules/core-js/modules/_string-trim.js"}],"../../node_modules/core-js/modules/es7.string.trim-right.js":[function(require,module,exports) {
'use strict';
// https://github.com/sebmarkbage/ecmascript-string-left-right-trim
require('./_string-trim')('trimRight', function ($trim) {
  return function trimRight() {
    return $trim(this, 2);
  };
}, 'trimEnd');

},{"./_string-trim":"../../node_modules/core-js/modules/_string-trim.js"}],"../../node_modules/core-js/modules/_typed.js":[function(require,module,exports) {

var global = require('./_global');
var hide = require('./_hide');
var uid = require('./_uid');
var TYPED = uid('typed_array');
var VIEW = uid('view');
var ABV = !!(global.ArrayBuffer && global.DataView);
var CONSTR = ABV;
var i = 0;
var l = 9;
var Typed;

var TypedArrayConstructors = (
  'Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array'
).split(',');

while (i < l) {
  if (Typed = global[TypedArrayConstructors[i++]]) {
    hide(Typed.prototype, TYPED, true);
    hide(Typed.prototype, VIEW, true);
  } else CONSTR = false;
}

module.exports = {
  ABV: ABV,
  CONSTR: CONSTR,
  TYPED: TYPED,
  VIEW: VIEW
};

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_uid":"../../node_modules/core-js/modules/_uid.js"}],"../../node_modules/core-js/modules/_to-index.js":[function(require,module,exports) {
// https://tc39.github.io/ecma262/#sec-toindex
var toInteger = require('./_to-integer');
var toLength = require('./_to-length');
module.exports = function (it) {
  if (it === undefined) return 0;
  var number = toInteger(it);
  var length = toLength(number);
  if (number !== length) throw RangeError('Wrong length!');
  return length;
};

},{"./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js"}],"../../node_modules/core-js/modules/_typed-buffer.js":[function(require,module,exports) {

'use strict';
var global = require('./_global');
var DESCRIPTORS = require('./_descriptors');
var LIBRARY = require('./_library');
var $typed = require('./_typed');
var hide = require('./_hide');
var redefineAll = require('./_redefine-all');
var fails = require('./_fails');
var anInstance = require('./_an-instance');
var toInteger = require('./_to-integer');
var toLength = require('./_to-length');
var toIndex = require('./_to-index');
var gOPN = require('./_object-gopn').f;
var dP = require('./_object-dp').f;
var arrayFill = require('./_array-fill');
var setToStringTag = require('./_set-to-string-tag');
var ARRAY_BUFFER = 'ArrayBuffer';
var DATA_VIEW = 'DataView';
var PROTOTYPE = 'prototype';
var WRONG_LENGTH = 'Wrong length!';
var WRONG_INDEX = 'Wrong index!';
var $ArrayBuffer = global[ARRAY_BUFFER];
var $DataView = global[DATA_VIEW];
var Math = global.Math;
var RangeError = global.RangeError;
// eslint-disable-next-line no-shadow-restricted-names
var Infinity = global.Infinity;
var BaseBuffer = $ArrayBuffer;
var abs = Math.abs;
var pow = Math.pow;
var floor = Math.floor;
var log = Math.log;
var LN2 = Math.LN2;
var BUFFER = 'buffer';
var BYTE_LENGTH = 'byteLength';
var BYTE_OFFSET = 'byteOffset';
var $BUFFER = DESCRIPTORS ? '_b' : BUFFER;
var $LENGTH = DESCRIPTORS ? '_l' : BYTE_LENGTH;
var $OFFSET = DESCRIPTORS ? '_o' : BYTE_OFFSET;

// IEEE754 conversions based on https://github.com/feross/ieee754
function packIEEE754(value, mLen, nBytes) {
  var buffer = new Array(nBytes);
  var eLen = nBytes * 8 - mLen - 1;
  var eMax = (1 << eLen) - 1;
  var eBias = eMax >> 1;
  var rt = mLen === 23 ? pow(2, -24) - pow(2, -77) : 0;
  var i = 0;
  var s = value < 0 || value === 0 && 1 / value < 0 ? 1 : 0;
  var e, m, c;
  value = abs(value);
  // eslint-disable-next-line no-self-compare
  if (value != value || value === Infinity) {
    // eslint-disable-next-line no-self-compare
    m = value != value ? 1 : 0;
    e = eMax;
  } else {
    e = floor(log(value) / LN2);
    if (value * (c = pow(2, -e)) < 1) {
      e--;
      c *= 2;
    }
    if (e + eBias >= 1) {
      value += rt / c;
    } else {
      value += rt * pow(2, 1 - eBias);
    }
    if (value * c >= 2) {
      e++;
      c /= 2;
    }
    if (e + eBias >= eMax) {
      m = 0;
      e = eMax;
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * pow(2, mLen);
      e = e + eBias;
    } else {
      m = value * pow(2, eBias - 1) * pow(2, mLen);
      e = 0;
    }
  }
  for (; mLen >= 8; buffer[i++] = m & 255, m /= 256, mLen -= 8);
  e = e << mLen | m;
  eLen += mLen;
  for (; eLen > 0; buffer[i++] = e & 255, e /= 256, eLen -= 8);
  buffer[--i] |= s * 128;
  return buffer;
}
function unpackIEEE754(buffer, mLen, nBytes) {
  var eLen = nBytes * 8 - mLen - 1;
  var eMax = (1 << eLen) - 1;
  var eBias = eMax >> 1;
  var nBits = eLen - 7;
  var i = nBytes - 1;
  var s = buffer[i--];
  var e = s & 127;
  var m;
  s >>= 7;
  for (; nBits > 0; e = e * 256 + buffer[i], i--, nBits -= 8);
  m = e & (1 << -nBits) - 1;
  e >>= -nBits;
  nBits += mLen;
  for (; nBits > 0; m = m * 256 + buffer[i], i--, nBits -= 8);
  if (e === 0) {
    e = 1 - eBias;
  } else if (e === eMax) {
    return m ? NaN : s ? -Infinity : Infinity;
  } else {
    m = m + pow(2, mLen);
    e = e - eBias;
  } return (s ? -1 : 1) * m * pow(2, e - mLen);
}

function unpackI32(bytes) {
  return bytes[3] << 24 | bytes[2] << 16 | bytes[1] << 8 | bytes[0];
}
function packI8(it) {
  return [it & 0xff];
}
function packI16(it) {
  return [it & 0xff, it >> 8 & 0xff];
}
function packI32(it) {
  return [it & 0xff, it >> 8 & 0xff, it >> 16 & 0xff, it >> 24 & 0xff];
}
function packF64(it) {
  return packIEEE754(it, 52, 8);
}
function packF32(it) {
  return packIEEE754(it, 23, 4);
}

function addGetter(C, key, internal) {
  dP(C[PROTOTYPE], key, { get: function () { return this[internal]; } });
}

function get(view, bytes, index, isLittleEndian) {
  var numIndex = +index;
  var intIndex = toIndex(numIndex);
  if (intIndex + bytes > view[$LENGTH]) throw RangeError(WRONG_INDEX);
  var store = view[$BUFFER]._b;
  var start = intIndex + view[$OFFSET];
  var pack = store.slice(start, start + bytes);
  return isLittleEndian ? pack : pack.reverse();
}
function set(view, bytes, index, conversion, value, isLittleEndian) {
  var numIndex = +index;
  var intIndex = toIndex(numIndex);
  if (intIndex + bytes > view[$LENGTH]) throw RangeError(WRONG_INDEX);
  var store = view[$BUFFER]._b;
  var start = intIndex + view[$OFFSET];
  var pack = conversion(+value);
  for (var i = 0; i < bytes; i++) store[start + i] = pack[isLittleEndian ? i : bytes - i - 1];
}

if (!$typed.ABV) {
  $ArrayBuffer = function ArrayBuffer(length) {
    anInstance(this, $ArrayBuffer, ARRAY_BUFFER);
    var byteLength = toIndex(length);
    this._b = arrayFill.call(new Array(byteLength), 0);
    this[$LENGTH] = byteLength;
  };

  $DataView = function DataView(buffer, byteOffset, byteLength) {
    anInstance(this, $DataView, DATA_VIEW);
    anInstance(buffer, $ArrayBuffer, DATA_VIEW);
    var bufferLength = buffer[$LENGTH];
    var offset = toInteger(byteOffset);
    if (offset < 0 || offset > bufferLength) throw RangeError('Wrong offset!');
    byteLength = byteLength === undefined ? bufferLength - offset : toLength(byteLength);
    if (offset + byteLength > bufferLength) throw RangeError(WRONG_LENGTH);
    this[$BUFFER] = buffer;
    this[$OFFSET] = offset;
    this[$LENGTH] = byteLength;
  };

  if (DESCRIPTORS) {
    addGetter($ArrayBuffer, BYTE_LENGTH, '_l');
    addGetter($DataView, BUFFER, '_b');
    addGetter($DataView, BYTE_LENGTH, '_l');
    addGetter($DataView, BYTE_OFFSET, '_o');
  }

  redefineAll($DataView[PROTOTYPE], {
    getInt8: function getInt8(byteOffset) {
      return get(this, 1, byteOffset)[0] << 24 >> 24;
    },
    getUint8: function getUint8(byteOffset) {
      return get(this, 1, byteOffset)[0];
    },
    getInt16: function getInt16(byteOffset /* , littleEndian */) {
      var bytes = get(this, 2, byteOffset, arguments[1]);
      return (bytes[1] << 8 | bytes[0]) << 16 >> 16;
    },
    getUint16: function getUint16(byteOffset /* , littleEndian */) {
      var bytes = get(this, 2, byteOffset, arguments[1]);
      return bytes[1] << 8 | bytes[0];
    },
    getInt32: function getInt32(byteOffset /* , littleEndian */) {
      return unpackI32(get(this, 4, byteOffset, arguments[1]));
    },
    getUint32: function getUint32(byteOffset /* , littleEndian */) {
      return unpackI32(get(this, 4, byteOffset, arguments[1])) >>> 0;
    },
    getFloat32: function getFloat32(byteOffset /* , littleEndian */) {
      return unpackIEEE754(get(this, 4, byteOffset, arguments[1]), 23, 4);
    },
    getFloat64: function getFloat64(byteOffset /* , littleEndian */) {
      return unpackIEEE754(get(this, 8, byteOffset, arguments[1]), 52, 8);
    },
    setInt8: function setInt8(byteOffset, value) {
      set(this, 1, byteOffset, packI8, value);
    },
    setUint8: function setUint8(byteOffset, value) {
      set(this, 1, byteOffset, packI8, value);
    },
    setInt16: function setInt16(byteOffset, value /* , littleEndian */) {
      set(this, 2, byteOffset, packI16, value, arguments[2]);
    },
    setUint16: function setUint16(byteOffset, value /* , littleEndian */) {
      set(this, 2, byteOffset, packI16, value, arguments[2]);
    },
    setInt32: function setInt32(byteOffset, value /* , littleEndian */) {
      set(this, 4, byteOffset, packI32, value, arguments[2]);
    },
    setUint32: function setUint32(byteOffset, value /* , littleEndian */) {
      set(this, 4, byteOffset, packI32, value, arguments[2]);
    },
    setFloat32: function setFloat32(byteOffset, value /* , littleEndian */) {
      set(this, 4, byteOffset, packF32, value, arguments[2]);
    },
    setFloat64: function setFloat64(byteOffset, value /* , littleEndian */) {
      set(this, 8, byteOffset, packF64, value, arguments[2]);
    }
  });
} else {
  if (!fails(function () {
    $ArrayBuffer(1);
  }) || !fails(function () {
    new $ArrayBuffer(-1); // eslint-disable-line no-new
  }) || fails(function () {
    new $ArrayBuffer(); // eslint-disable-line no-new
    new $ArrayBuffer(1.5); // eslint-disable-line no-new
    new $ArrayBuffer(NaN); // eslint-disable-line no-new
    return $ArrayBuffer.name != ARRAY_BUFFER;
  })) {
    $ArrayBuffer = function ArrayBuffer(length) {
      anInstance(this, $ArrayBuffer);
      return new BaseBuffer(toIndex(length));
    };
    var ArrayBufferProto = $ArrayBuffer[PROTOTYPE] = BaseBuffer[PROTOTYPE];
    for (var keys = gOPN(BaseBuffer), j = 0, key; keys.length > j;) {
      if (!((key = keys[j++]) in $ArrayBuffer)) hide($ArrayBuffer, key, BaseBuffer[key]);
    }
    if (!LIBRARY) ArrayBufferProto.constructor = $ArrayBuffer;
  }
  // iOS Safari 7.x bug
  var view = new $DataView(new $ArrayBuffer(2));
  var $setInt8 = $DataView[PROTOTYPE].setInt8;
  view.setInt8(0, 2147483648);
  view.setInt8(1, 2147483649);
  if (view.getInt8(0) || !view.getInt8(1)) redefineAll($DataView[PROTOTYPE], {
    setInt8: function setInt8(byteOffset, value) {
      $setInt8.call(this, byteOffset, value << 24 >> 24);
    },
    setUint8: function setUint8(byteOffset, value) {
      $setInt8.call(this, byteOffset, value << 24 >> 24);
    }
  }, true);
}
setToStringTag($ArrayBuffer, ARRAY_BUFFER);
setToStringTag($DataView, DATA_VIEW);
hide($DataView[PROTOTYPE], $typed.VIEW, true);
exports[ARRAY_BUFFER] = $ArrayBuffer;
exports[DATA_VIEW] = $DataView;

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_library":"../../node_modules/core-js/modules/_library.js","./_typed":"../../node_modules/core-js/modules/_typed.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_to-index":"../../node_modules/core-js/modules/_to-index.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_array-fill":"../../node_modules/core-js/modules/_array-fill.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js"}],"../../node_modules/core-js/modules/es6.typed.array-buffer.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var $typed = require('./_typed');
var buffer = require('./_typed-buffer');
var anObject = require('./_an-object');
var toAbsoluteIndex = require('./_to-absolute-index');
var toLength = require('./_to-length');
var isObject = require('./_is-object');
var ArrayBuffer = require('./_global').ArrayBuffer;
var speciesConstructor = require('./_species-constructor');
var $ArrayBuffer = buffer.ArrayBuffer;
var $DataView = buffer.DataView;
var $isView = $typed.ABV && ArrayBuffer.isView;
var $slice = $ArrayBuffer.prototype.slice;
var VIEW = $typed.VIEW;
var ARRAY_BUFFER = 'ArrayBuffer';

$export($export.G + $export.W + $export.F * (ArrayBuffer !== $ArrayBuffer), { ArrayBuffer: $ArrayBuffer });

$export($export.S + $export.F * !$typed.CONSTR, ARRAY_BUFFER, {
  // 24.1.3.1 ArrayBuffer.isView(arg)
  isView: function isView(it) {
    return $isView && $isView(it) || isObject(it) && VIEW in it;
  }
});

$export($export.P + $export.U + $export.F * require('./_fails')(function () {
  return !new $ArrayBuffer(2).slice(1, undefined).byteLength;
}), ARRAY_BUFFER, {
  // 24.1.4.3 ArrayBuffer.prototype.slice(start, end)
  slice: function slice(start, end) {
    if ($slice !== undefined && end === undefined) return $slice.call(anObject(this), start); // FF fix
    var len = anObject(this).byteLength;
    var first = toAbsoluteIndex(start, len);
    var fin = toAbsoluteIndex(end === undefined ? len : end, len);
    var result = new (speciesConstructor(this, $ArrayBuffer))(toLength(fin - first));
    var viewS = new $DataView(this);
    var viewT = new $DataView(result);
    var index = 0;
    while (first < fin) {
      viewT.setUint8(index++, viewS.getUint8(first++));
    } return result;
  }
});

require('./_set-species')(ARRAY_BUFFER);

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_typed":"../../node_modules/core-js/modules/_typed.js","./_typed-buffer":"../../node_modules/core-js/modules/_typed-buffer.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_global":"../../node_modules/core-js/modules/_global.js","./_species-constructor":"../../node_modules/core-js/modules/_species-constructor.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_set-species":"../../node_modules/core-js/modules/_set-species.js"}],"../../node_modules/core-js/modules/_typed-array.js":[function(require,module,exports) {
var global = arguments[3];
'use strict';
if (require('./_descriptors')) {
  var LIBRARY = require('./_library');
  var global = require('./_global');
  var fails = require('./_fails');
  var $export = require('./_export');
  var $typed = require('./_typed');
  var $buffer = require('./_typed-buffer');
  var ctx = require('./_ctx');
  var anInstance = require('./_an-instance');
  var propertyDesc = require('./_property-desc');
  var hide = require('./_hide');
  var redefineAll = require('./_redefine-all');
  var toInteger = require('./_to-integer');
  var toLength = require('./_to-length');
  var toIndex = require('./_to-index');
  var toAbsoluteIndex = require('./_to-absolute-index');
  var toPrimitive = require('./_to-primitive');
  var has = require('./_has');
  var classof = require('./_classof');
  var isObject = require('./_is-object');
  var toObject = require('./_to-object');
  var isArrayIter = require('./_is-array-iter');
  var create = require('./_object-create');
  var getPrototypeOf = require('./_object-gpo');
  var gOPN = require('./_object-gopn').f;
  var getIterFn = require('./core.get-iterator-method');
  var uid = require('./_uid');
  var wks = require('./_wks');
  var createArrayMethod = require('./_array-methods');
  var createArrayIncludes = require('./_array-includes');
  var speciesConstructor = require('./_species-constructor');
  var ArrayIterators = require('./es6.array.iterator');
  var Iterators = require('./_iterators');
  var $iterDetect = require('./_iter-detect');
  var setSpecies = require('./_set-species');
  var arrayFill = require('./_array-fill');
  var arrayCopyWithin = require('./_array-copy-within');
  var $DP = require('./_object-dp');
  var $GOPD = require('./_object-gopd');
  var dP = $DP.f;
  var gOPD = $GOPD.f;
  var RangeError = global.RangeError;
  var TypeError = global.TypeError;
  var Uint8Array = global.Uint8Array;
  var ARRAY_BUFFER = 'ArrayBuffer';
  var SHARED_BUFFER = 'Shared' + ARRAY_BUFFER;
  var BYTES_PER_ELEMENT = 'BYTES_PER_ELEMENT';
  var PROTOTYPE = 'prototype';
  var ArrayProto = Array[PROTOTYPE];
  var $ArrayBuffer = $buffer.ArrayBuffer;
  var $DataView = $buffer.DataView;
  var arrayForEach = createArrayMethod(0);
  var arrayFilter = createArrayMethod(2);
  var arraySome = createArrayMethod(3);
  var arrayEvery = createArrayMethod(4);
  var arrayFind = createArrayMethod(5);
  var arrayFindIndex = createArrayMethod(6);
  var arrayIncludes = createArrayIncludes(true);
  var arrayIndexOf = createArrayIncludes(false);
  var arrayValues = ArrayIterators.values;
  var arrayKeys = ArrayIterators.keys;
  var arrayEntries = ArrayIterators.entries;
  var arrayLastIndexOf = ArrayProto.lastIndexOf;
  var arrayReduce = ArrayProto.reduce;
  var arrayReduceRight = ArrayProto.reduceRight;
  var arrayJoin = ArrayProto.join;
  var arraySort = ArrayProto.sort;
  var arraySlice = ArrayProto.slice;
  var arrayToString = ArrayProto.toString;
  var arrayToLocaleString = ArrayProto.toLocaleString;
  var ITERATOR = wks('iterator');
  var TAG = wks('toStringTag');
  var TYPED_CONSTRUCTOR = uid('typed_constructor');
  var DEF_CONSTRUCTOR = uid('def_constructor');
  var ALL_CONSTRUCTORS = $typed.CONSTR;
  var TYPED_ARRAY = $typed.TYPED;
  var VIEW = $typed.VIEW;
  var WRONG_LENGTH = 'Wrong length!';

  var $map = createArrayMethod(1, function (O, length) {
    return allocate(speciesConstructor(O, O[DEF_CONSTRUCTOR]), length);
  });

  var LITTLE_ENDIAN = fails(function () {
    // eslint-disable-next-line no-undef
    return new Uint8Array(new Uint16Array([1]).buffer)[0] === 1;
  });

  var FORCED_SET = !!Uint8Array && !!Uint8Array[PROTOTYPE].set && fails(function () {
    new Uint8Array(1).set({});
  });

  var toOffset = function (it, BYTES) {
    var offset = toInteger(it);
    if (offset < 0 || offset % BYTES) throw RangeError('Wrong offset!');
    return offset;
  };

  var validate = function (it) {
    if (isObject(it) && TYPED_ARRAY in it) return it;
    throw TypeError(it + ' is not a typed array!');
  };

  var allocate = function (C, length) {
    if (!(isObject(C) && TYPED_CONSTRUCTOR in C)) {
      throw TypeError('It is not a typed array constructor!');
    } return new C(length);
  };

  var speciesFromList = function (O, list) {
    return fromList(speciesConstructor(O, O[DEF_CONSTRUCTOR]), list);
  };

  var fromList = function (C, list) {
    var index = 0;
    var length = list.length;
    var result = allocate(C, length);
    while (length > index) result[index] = list[index++];
    return result;
  };

  var addGetter = function (it, key, internal) {
    dP(it, key, { get: function () { return this._d[internal]; } });
  };

  var $from = function from(source /* , mapfn, thisArg */) {
    var O = toObject(source);
    var aLen = arguments.length;
    var mapfn = aLen > 1 ? arguments[1] : undefined;
    var mapping = mapfn !== undefined;
    var iterFn = getIterFn(O);
    var i, length, values, result, step, iterator;
    if (iterFn != undefined && !isArrayIter(iterFn)) {
      for (iterator = iterFn.call(O), values = [], i = 0; !(step = iterator.next()).done; i++) {
        values.push(step.value);
      } O = values;
    }
    if (mapping && aLen > 2) mapfn = ctx(mapfn, arguments[2], 2);
    for (i = 0, length = toLength(O.length), result = allocate(this, length); length > i; i++) {
      result[i] = mapping ? mapfn(O[i], i) : O[i];
    }
    return result;
  };

  var $of = function of(/* ...items */) {
    var index = 0;
    var length = arguments.length;
    var result = allocate(this, length);
    while (length > index) result[index] = arguments[index++];
    return result;
  };

  // iOS Safari 6.x fails here
  var TO_LOCALE_BUG = !!Uint8Array && fails(function () { arrayToLocaleString.call(new Uint8Array(1)); });

  var $toLocaleString = function toLocaleString() {
    return arrayToLocaleString.apply(TO_LOCALE_BUG ? arraySlice.call(validate(this)) : validate(this), arguments);
  };

  var proto = {
    copyWithin: function copyWithin(target, start /* , end */) {
      return arrayCopyWithin.call(validate(this), target, start, arguments.length > 2 ? arguments[2] : undefined);
    },
    every: function every(callbackfn /* , thisArg */) {
      return arrayEvery(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);
    },
    fill: function fill(value /* , start, end */) { // eslint-disable-line no-unused-vars
      return arrayFill.apply(validate(this), arguments);
    },
    filter: function filter(callbackfn /* , thisArg */) {
      return speciesFromList(this, arrayFilter(validate(this), callbackfn,
        arguments.length > 1 ? arguments[1] : undefined));
    },
    find: function find(predicate /* , thisArg */) {
      return arrayFind(validate(this), predicate, arguments.length > 1 ? arguments[1] : undefined);
    },
    findIndex: function findIndex(predicate /* , thisArg */) {
      return arrayFindIndex(validate(this), predicate, arguments.length > 1 ? arguments[1] : undefined);
    },
    forEach: function forEach(callbackfn /* , thisArg */) {
      arrayForEach(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);
    },
    indexOf: function indexOf(searchElement /* , fromIndex */) {
      return arrayIndexOf(validate(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);
    },
    includes: function includes(searchElement /* , fromIndex */) {
      return arrayIncludes(validate(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);
    },
    join: function join(separator) { // eslint-disable-line no-unused-vars
      return arrayJoin.apply(validate(this), arguments);
    },
    lastIndexOf: function lastIndexOf(searchElement /* , fromIndex */) { // eslint-disable-line no-unused-vars
      return arrayLastIndexOf.apply(validate(this), arguments);
    },
    map: function map(mapfn /* , thisArg */) {
      return $map(validate(this), mapfn, arguments.length > 1 ? arguments[1] : undefined);
    },
    reduce: function reduce(callbackfn /* , initialValue */) { // eslint-disable-line no-unused-vars
      return arrayReduce.apply(validate(this), arguments);
    },
    reduceRight: function reduceRight(callbackfn /* , initialValue */) { // eslint-disable-line no-unused-vars
      return arrayReduceRight.apply(validate(this), arguments);
    },
    reverse: function reverse() {
      var that = this;
      var length = validate(that).length;
      var middle = Math.floor(length / 2);
      var index = 0;
      var value;
      while (index < middle) {
        value = that[index];
        that[index++] = that[--length];
        that[length] = value;
      } return that;
    },
    some: function some(callbackfn /* , thisArg */) {
      return arraySome(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);
    },
    sort: function sort(comparefn) {
      return arraySort.call(validate(this), comparefn);
    },
    subarray: function subarray(begin, end) {
      var O = validate(this);
      var length = O.length;
      var $begin = toAbsoluteIndex(begin, length);
      return new (speciesConstructor(O, O[DEF_CONSTRUCTOR]))(
        O.buffer,
        O.byteOffset + $begin * O.BYTES_PER_ELEMENT,
        toLength((end === undefined ? length : toAbsoluteIndex(end, length)) - $begin)
      );
    }
  };

  var $slice = function slice(start, end) {
    return speciesFromList(this, arraySlice.call(validate(this), start, end));
  };

  var $set = function set(arrayLike /* , offset */) {
    validate(this);
    var offset = toOffset(arguments[1], 1);
    var length = this.length;
    var src = toObject(arrayLike);
    var len = toLength(src.length);
    var index = 0;
    if (len + offset > length) throw RangeError(WRONG_LENGTH);
    while (index < len) this[offset + index] = src[index++];
  };

  var $iterators = {
    entries: function entries() {
      return arrayEntries.call(validate(this));
    },
    keys: function keys() {
      return arrayKeys.call(validate(this));
    },
    values: function values() {
      return arrayValues.call(validate(this));
    }
  };

  var isTAIndex = function (target, key) {
    return isObject(target)
      && target[TYPED_ARRAY]
      && typeof key != 'symbol'
      && key in target
      && String(+key) == String(key);
  };
  var $getDesc = function getOwnPropertyDescriptor(target, key) {
    return isTAIndex(target, key = toPrimitive(key, true))
      ? propertyDesc(2, target[key])
      : gOPD(target, key);
  };
  var $setDesc = function defineProperty(target, key, desc) {
    if (isTAIndex(target, key = toPrimitive(key, true))
      && isObject(desc)
      && has(desc, 'value')
      && !has(desc, 'get')
      && !has(desc, 'set')
      // TODO: add validation descriptor w/o calling accessors
      && !desc.configurable
      && (!has(desc, 'writable') || desc.writable)
      && (!has(desc, 'enumerable') || desc.enumerable)
    ) {
      target[key] = desc.value;
      return target;
    } return dP(target, key, desc);
  };

  if (!ALL_CONSTRUCTORS) {
    $GOPD.f = $getDesc;
    $DP.f = $setDesc;
  }

  $export($export.S + $export.F * !ALL_CONSTRUCTORS, 'Object', {
    getOwnPropertyDescriptor: $getDesc,
    defineProperty: $setDesc
  });

  if (fails(function () { arrayToString.call({}); })) {
    arrayToString = arrayToLocaleString = function toString() {
      return arrayJoin.call(this);
    };
  }

  var $TypedArrayPrototype$ = redefineAll({}, proto);
  redefineAll($TypedArrayPrototype$, $iterators);
  hide($TypedArrayPrototype$, ITERATOR, $iterators.values);
  redefineAll($TypedArrayPrototype$, {
    slice: $slice,
    set: $set,
    constructor: function () { /* noop */ },
    toString: arrayToString,
    toLocaleString: $toLocaleString
  });
  addGetter($TypedArrayPrototype$, 'buffer', 'b');
  addGetter($TypedArrayPrototype$, 'byteOffset', 'o');
  addGetter($TypedArrayPrototype$, 'byteLength', 'l');
  addGetter($TypedArrayPrototype$, 'length', 'e');
  dP($TypedArrayPrototype$, TAG, {
    get: function () { return this[TYPED_ARRAY]; }
  });

  // eslint-disable-next-line max-statements
  module.exports = function (KEY, BYTES, wrapper, CLAMPED) {
    CLAMPED = !!CLAMPED;
    var NAME = KEY + (CLAMPED ? 'Clamped' : '') + 'Array';
    var GETTER = 'get' + KEY;
    var SETTER = 'set' + KEY;
    var TypedArray = global[NAME];
    var Base = TypedArray || {};
    var TAC = TypedArray && getPrototypeOf(TypedArray);
    var FORCED = !TypedArray || !$typed.ABV;
    var O = {};
    var TypedArrayPrototype = TypedArray && TypedArray[PROTOTYPE];
    var getter = function (that, index) {
      var data = that._d;
      return data.v[GETTER](index * BYTES + data.o, LITTLE_ENDIAN);
    };
    var setter = function (that, index, value) {
      var data = that._d;
      if (CLAMPED) value = (value = Math.round(value)) < 0 ? 0 : value > 0xff ? 0xff : value & 0xff;
      data.v[SETTER](index * BYTES + data.o, value, LITTLE_ENDIAN);
    };
    var addElement = function (that, index) {
      dP(that, index, {
        get: function () {
          return getter(this, index);
        },
        set: function (value) {
          return setter(this, index, value);
        },
        enumerable: true
      });
    };
    if (FORCED) {
      TypedArray = wrapper(function (that, data, $offset, $length) {
        anInstance(that, TypedArray, NAME, '_d');
        var index = 0;
        var offset = 0;
        var buffer, byteLength, length, klass;
        if (!isObject(data)) {
          length = toIndex(data);
          byteLength = length * BYTES;
          buffer = new $ArrayBuffer(byteLength);
        } else if (data instanceof $ArrayBuffer || (klass = classof(data)) == ARRAY_BUFFER || klass == SHARED_BUFFER) {
          buffer = data;
          offset = toOffset($offset, BYTES);
          var $len = data.byteLength;
          if ($length === undefined) {
            if ($len % BYTES) throw RangeError(WRONG_LENGTH);
            byteLength = $len - offset;
            if (byteLength < 0) throw RangeError(WRONG_LENGTH);
          } else {
            byteLength = toLength($length) * BYTES;
            if (byteLength + offset > $len) throw RangeError(WRONG_LENGTH);
          }
          length = byteLength / BYTES;
        } else if (TYPED_ARRAY in data) {
          return fromList(TypedArray, data);
        } else {
          return $from.call(TypedArray, data);
        }
        hide(that, '_d', {
          b: buffer,
          o: offset,
          l: byteLength,
          e: length,
          v: new $DataView(buffer)
        });
        while (index < length) addElement(that, index++);
      });
      TypedArrayPrototype = TypedArray[PROTOTYPE] = create($TypedArrayPrototype$);
      hide(TypedArrayPrototype, 'constructor', TypedArray);
    } else if (!fails(function () {
      TypedArray(1);
    }) || !fails(function () {
      new TypedArray(-1); // eslint-disable-line no-new
    }) || !$iterDetect(function (iter) {
      new TypedArray(); // eslint-disable-line no-new
      new TypedArray(null); // eslint-disable-line no-new
      new TypedArray(1.5); // eslint-disable-line no-new
      new TypedArray(iter); // eslint-disable-line no-new
    }, true)) {
      TypedArray = wrapper(function (that, data, $offset, $length) {
        anInstance(that, TypedArray, NAME);
        var klass;
        // `ws` module bug, temporarily remove validation length for Uint8Array
        // https://github.com/websockets/ws/pull/645
        if (!isObject(data)) return new Base(toIndex(data));
        if (data instanceof $ArrayBuffer || (klass = classof(data)) == ARRAY_BUFFER || klass == SHARED_BUFFER) {
          return $length !== undefined
            ? new Base(data, toOffset($offset, BYTES), $length)
            : $offset !== undefined
              ? new Base(data, toOffset($offset, BYTES))
              : new Base(data);
        }
        if (TYPED_ARRAY in data) return fromList(TypedArray, data);
        return $from.call(TypedArray, data);
      });
      arrayForEach(TAC !== Function.prototype ? gOPN(Base).concat(gOPN(TAC)) : gOPN(Base), function (key) {
        if (!(key in TypedArray)) hide(TypedArray, key, Base[key]);
      });
      TypedArray[PROTOTYPE] = TypedArrayPrototype;
      if (!LIBRARY) TypedArrayPrototype.constructor = TypedArray;
    }
    var $nativeIterator = TypedArrayPrototype[ITERATOR];
    var CORRECT_ITER_NAME = !!$nativeIterator
      && ($nativeIterator.name == 'values' || $nativeIterator.name == undefined);
    var $iterator = $iterators.values;
    hide(TypedArray, TYPED_CONSTRUCTOR, true);
    hide(TypedArrayPrototype, TYPED_ARRAY, NAME);
    hide(TypedArrayPrototype, VIEW, true);
    hide(TypedArrayPrototype, DEF_CONSTRUCTOR, TypedArray);

    if (CLAMPED ? new TypedArray(1)[TAG] != NAME : !(TAG in TypedArrayPrototype)) {
      dP(TypedArrayPrototype, TAG, {
        get: function () { return NAME; }
      });
    }

    O[NAME] = TypedArray;

    $export($export.G + $export.W + $export.F * (TypedArray != Base), O);

    $export($export.S, NAME, {
      BYTES_PER_ELEMENT: BYTES
    });

    $export($export.S + $export.F * fails(function () { Base.of.call(TypedArray, 1); }), NAME, {
      from: $from,
      of: $of
    });

    if (!(BYTES_PER_ELEMENT in TypedArrayPrototype)) hide(TypedArrayPrototype, BYTES_PER_ELEMENT, BYTES);

    $export($export.P, NAME, proto);

    setSpecies(NAME);

    $export($export.P + $export.F * FORCED_SET, NAME, { set: $set });

    $export($export.P + $export.F * !CORRECT_ITER_NAME, NAME, $iterators);

    if (!LIBRARY && TypedArrayPrototype.toString != arrayToString) TypedArrayPrototype.toString = arrayToString;

    $export($export.P + $export.F * fails(function () {
      new TypedArray(1).slice();
    }), NAME, { slice: $slice });

    $export($export.P + $export.F * (fails(function () {
      return [1, 2].toLocaleString() != new TypedArray([1, 2]).toLocaleString();
    }) || !fails(function () {
      TypedArrayPrototype.toLocaleString.call([1, 2]);
    })), NAME, { toLocaleString: $toLocaleString });

    Iterators[NAME] = CORRECT_ITER_NAME ? $nativeIterator : $iterator;
    if (!LIBRARY && !CORRECT_ITER_NAME) hide(TypedArrayPrototype, ITERATOR, $iterator);
  };
} else module.exports = function () { /* empty */ };

},{"./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_library":"../../node_modules/core-js/modules/_library.js","./_global":"../../node_modules/core-js/modules/_global.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_export":"../../node_modules/core-js/modules/_export.js","./_typed":"../../node_modules/core-js/modules/_typed.js","./_typed-buffer":"../../node_modules/core-js/modules/_typed-buffer.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_to-index":"../../node_modules/core-js/modules/_to-index.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_has":"../../node_modules/core-js/modules/_has.js","./_classof":"../../node_modules/core-js/modules/_classof.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_is-array-iter":"../../node_modules/core-js/modules/_is-array-iter.js","./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./core.get-iterator-method":"../../node_modules/core-js/modules/core.get-iterator-method.js","./_uid":"../../node_modules/core-js/modules/_uid.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_array-includes":"../../node_modules/core-js/modules/_array-includes.js","./_species-constructor":"../../node_modules/core-js/modules/_species-constructor.js","./es6.array.iterator":"../../node_modules/core-js/modules/es6.array.iterator.js","./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_iter-detect":"../../node_modules/core-js/modules/_iter-detect.js","./_set-species":"../../node_modules/core-js/modules/_set-species.js","./_array-fill":"../../node_modules/core-js/modules/_array-fill.js","./_array-copy-within":"../../node_modules/core-js/modules/_array-copy-within.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js"}],"../../node_modules/core-js/modules/es6.typed.int8-array.js":[function(require,module,exports) {
require('./_typed-array')('Int8', 1, function (init) {
  return function Int8Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.uint8-array.js":[function(require,module,exports) {
require('./_typed-array')('Uint8', 1, function (init) {
  return function Uint8Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.uint8-clamped-array.js":[function(require,module,exports) {
require('./_typed-array')('Uint8', 1, function (init) {
  return function Uint8ClampedArray(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
}, true);

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.int16-array.js":[function(require,module,exports) {
require('./_typed-array')('Int16', 2, function (init) {
  return function Int16Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.uint16-array.js":[function(require,module,exports) {
require('./_typed-array')('Uint16', 2, function (init) {
  return function Uint16Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.int32-array.js":[function(require,module,exports) {
require('./_typed-array')('Int32', 4, function (init) {
  return function Int32Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.uint32-array.js":[function(require,module,exports) {
require('./_typed-array')('Uint32', 4, function (init) {
  return function Uint32Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.float32-array.js":[function(require,module,exports) {
require('./_typed-array')('Float32', 4, function (init) {
  return function Float32Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.float64-array.js":[function(require,module,exports) {
require('./_typed-array')('Float64', 8, function (init) {
  return function Float64Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/_collection-weak.js":[function(require,module,exports) {
'use strict';
var redefineAll = require('./_redefine-all');
var getWeak = require('./_meta').getWeak;
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var anInstance = require('./_an-instance');
var forOf = require('./_for-of');
var createArrayMethod = require('./_array-methods');
var $has = require('./_has');
var validate = require('./_validate-collection');
var arrayFind = createArrayMethod(5);
var arrayFindIndex = createArrayMethod(6);
var id = 0;

// fallback for uncaught frozen keys
var uncaughtFrozenStore = function (that) {
  return that._l || (that._l = new UncaughtFrozenStore());
};
var UncaughtFrozenStore = function () {
  this.a = [];
};
var findUncaughtFrozen = function (store, key) {
  return arrayFind(store.a, function (it) {
    return it[0] === key;
  });
};
UncaughtFrozenStore.prototype = {
  get: function (key) {
    var entry = findUncaughtFrozen(this, key);
    if (entry) return entry[1];
  },
  has: function (key) {
    return !!findUncaughtFrozen(this, key);
  },
  set: function (key, value) {
    var entry = findUncaughtFrozen(this, key);
    if (entry) entry[1] = value;
    else this.a.push([key, value]);
  },
  'delete': function (key) {
    var index = arrayFindIndex(this.a, function (it) {
      return it[0] === key;
    });
    if (~index) this.a.splice(index, 1);
    return !!~index;
  }
};

module.exports = {
  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {
    var C = wrapper(function (that, iterable) {
      anInstance(that, C, NAME, '_i');
      that._t = NAME;      // collection type
      that._i = id++;      // collection id
      that._l = undefined; // leak store for uncaught frozen objects
      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);
    });
    redefineAll(C.prototype, {
      // 23.3.3.2 WeakMap.prototype.delete(key)
      // 23.4.3.3 WeakSet.prototype.delete(value)
      'delete': function (key) {
        if (!isObject(key)) return false;
        var data = getWeak(key);
        if (data === true) return uncaughtFrozenStore(validate(this, NAME))['delete'](key);
        return data && $has(data, this._i) && delete data[this._i];
      },
      // 23.3.3.4 WeakMap.prototype.has(key)
      // 23.4.3.4 WeakSet.prototype.has(value)
      has: function has(key) {
        if (!isObject(key)) return false;
        var data = getWeak(key);
        if (data === true) return uncaughtFrozenStore(validate(this, NAME)).has(key);
        return data && $has(data, this._i);
      }
    });
    return C;
  },
  def: function (that, key, value) {
    var data = getWeak(anObject(key), true);
    if (data === true) uncaughtFrozenStore(that).set(key, value);
    else data[that._i] = value;
    return that;
  },
  ufstore: uncaughtFrozenStore
};

},{"./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_for-of":"../../node_modules/core-js/modules/_for-of.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_has":"../../node_modules/core-js/modules/_has.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js"}],"../../node_modules/core-js/modules/es6.weak-map.js":[function(require,module,exports) {

'use strict';
var global = require('./_global');
var each = require('./_array-methods')(0);
var redefine = require('./_redefine');
var meta = require('./_meta');
var assign = require('./_object-assign');
var weak = require('./_collection-weak');
var isObject = require('./_is-object');
var validate = require('./_validate-collection');
var NATIVE_WEAK_MAP = require('./_validate-collection');
var IS_IE11 = !global.ActiveXObject && 'ActiveXObject' in global;
var WEAK_MAP = 'WeakMap';
var getWeak = meta.getWeak;
var isExtensible = Object.isExtensible;
var uncaughtFrozenStore = weak.ufstore;
var InternalMap;

var wrapper = function (get) {
  return function WeakMap() {
    return get(this, arguments.length > 0 ? arguments[0] : undefined);
  };
};

var methods = {
  // 23.3.3.3 WeakMap.prototype.get(key)
  get: function get(key) {
    if (isObject(key)) {
      var data = getWeak(key);
      if (data === true) return uncaughtFrozenStore(validate(this, WEAK_MAP)).get(key);
      return data ? data[this._i] : undefined;
    }
  },
  // 23.3.3.5 WeakMap.prototype.set(key, value)
  set: function set(key, value) {
    return weak.def(validate(this, WEAK_MAP), key, value);
  }
};

// 23.3 WeakMap Objects
var $WeakMap = module.exports = require('./_collection')(WEAK_MAP, wrapper, methods, weak, true, true);

// IE11 WeakMap frozen keys fix
if (NATIVE_WEAK_MAP && IS_IE11) {
  InternalMap = weak.getConstructor(wrapper, WEAK_MAP);
  assign(InternalMap.prototype, methods);
  meta.NEED = true;
  each(['delete', 'has', 'get', 'set'], function (key) {
    var proto = $WeakMap.prototype;
    var method = proto[key];
    redefine(proto, key, function (a, b) {
      // store frozen objects on internal weakmap shim
      if (isObject(a) && !isExtensible(a)) {
        if (!this._f) this._f = new InternalMap();
        var result = this._f[key](a, b);
        return key == 'set' ? this : result;
      // store all the rest on native weakmap
      } return method.call(this, a, b);
    });
  });
}

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_object-assign":"../../node_modules/core-js/modules/_object-assign.js","./_collection-weak":"../../node_modules/core-js/modules/_collection-weak.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js","./_collection":"../../node_modules/core-js/modules/_collection.js"}],"../../node_modules/core-js/modules/es6.weak-set.js":[function(require,module,exports) {
'use strict';
var weak = require('./_collection-weak');
var validate = require('./_validate-collection');
var WEAK_SET = 'WeakSet';

// 23.4 WeakSet Objects
require('./_collection')(WEAK_SET, function (get) {
  return function WeakSet() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };
}, {
  // 23.4.3.1 WeakSet.prototype.add(value)
  add: function add(value) {
    return weak.def(validate(this, WEAK_SET), value, true);
  }
}, weak, false, true);

},{"./_collection-weak":"../../node_modules/core-js/modules/_collection-weak.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js","./_collection":"../../node_modules/core-js/modules/_collection.js"}],"../../node_modules/core-js/modules/web.timers.js":[function(require,module,exports) {

// ie9- setTimeout & setInterval additional parameters fix
var global = require('./_global');
var $export = require('./_export');
var userAgent = require('./_user-agent');
var slice = [].slice;
var MSIE = /MSIE .\./.test(userAgent); // <- dirty ie9- check
var wrap = function (set) {
  return function (fn, time /* , ...args */) {
    var boundArgs = arguments.length > 2;
    var args = boundArgs ? slice.call(arguments, 2) : false;
    return set(boundArgs ? function () {
      // eslint-disable-next-line no-new-func
      (typeof fn == 'function' ? fn : Function(fn)).apply(this, args);
    } : fn, time);
  };
};
$export($export.G + $export.B + $export.F * MSIE, {
  setTimeout: wrap(global.setTimeout),
  setInterval: wrap(global.setInterval)
});

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_export":"../../node_modules/core-js/modules/_export.js","./_user-agent":"../../node_modules/core-js/modules/_user-agent.js"}],"../../node_modules/core-js/modules/web.immediate.js":[function(require,module,exports) {
var $export = require('./_export');
var $task = require('./_task');
$export($export.G + $export.B, {
  setImmediate: $task.set,
  clearImmediate: $task.clear
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_task":"../../node_modules/core-js/modules/_task.js"}],"../../node_modules/core-js/modules/web.dom.iterable.js":[function(require,module,exports) {

var $iterators = require('./es6.array.iterator');
var getKeys = require('./_object-keys');
var redefine = require('./_redefine');
var global = require('./_global');
var hide = require('./_hide');
var Iterators = require('./_iterators');
var wks = require('./_wks');
var ITERATOR = wks('iterator');
var TO_STRING_TAG = wks('toStringTag');
var ArrayValues = Iterators.Array;

var DOMIterables = {
  CSSRuleList: true, // TODO: Not spec compliant, should be false.
  CSSStyleDeclaration: false,
  CSSValueList: false,
  ClientRectList: false,
  DOMRectList: false,
  DOMStringList: false,
  DOMTokenList: true,
  DataTransferItemList: false,
  FileList: false,
  HTMLAllCollection: false,
  HTMLCollection: false,
  HTMLFormElement: false,
  HTMLSelectElement: false,
  MediaList: true, // TODO: Not spec compliant, should be false.
  MimeTypeArray: false,
  NamedNodeMap: false,
  NodeList: true,
  PaintRequestList: false,
  Plugin: false,
  PluginArray: false,
  SVGLengthList: false,
  SVGNumberList: false,
  SVGPathSegList: false,
  SVGPointList: false,
  SVGStringList: false,
  SVGTransformList: false,
  SourceBufferList: false,
  StyleSheetList: true, // TODO: Not spec compliant, should be false.
  TextTrackCueList: false,
  TextTrackList: false,
  TouchList: false
};

for (var collections = getKeys(DOMIterables), i = 0; i < collections.length; i++) {
  var NAME = collections[i];
  var explicit = DOMIterables[NAME];
  var Collection = global[NAME];
  var proto = Collection && Collection.prototype;
  var key;
  if (proto) {
    if (!proto[ITERATOR]) hide(proto, ITERATOR, ArrayValues);
    if (!proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);
    Iterators[NAME] = ArrayValues;
    if (explicit) for (key in $iterators) if (!proto[key]) redefine(proto, key, $iterators[key], true);
  }
}

},{"./es6.array.iterator":"../../node_modules/core-js/modules/es6.array.iterator.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_global":"../../node_modules/core-js/modules/_global.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/regenerator-runtime/runtime.js":[function(require,module,exports) {
var define;
/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var runtime = (function (exports) {
  "use strict";

  var Op = Object.prototype;
  var hasOwn = Op.hasOwnProperty;
  var undefined; // More compressible than void 0.
  var $Symbol = typeof Symbol === "function" ? Symbol : {};
  var iteratorSymbol = $Symbol.iterator || "@@iterator";
  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";
  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";

  function define(obj, key, value) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
    return obj[key];
  }
  try {
    // IE 8 has a broken Object.defineProperty that only works on DOM objects.
    define({}, "");
  } catch (err) {
    define = function(obj, key, value) {
      return obj[key] = value;
    };
  }

  function wrap(innerFn, outerFn, self, tryLocsList) {
    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.
    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;
    var generator = Object.create(protoGenerator.prototype);
    var context = new Context(tryLocsList || []);

    // The ._invoke method unifies the implementations of the .next,
    // .throw, and .return methods.
    generator._invoke = makeInvokeMethod(innerFn, self, context);

    return generator;
  }
  exports.wrap = wrap;

  // Try/catch helper to minimize deoptimizations. Returns a completion
  // record like context.tryEntries[i].completion. This interface could
  // have been (and was previously) designed to take a closure to be
  // invoked without arguments, but in all the cases we care about we
  // already have an existing method we want to call, so there's no need
  // to create a new function object. We can even get away with assuming
  // the method takes exactly one argument, since that happens to be true
  // in every case, so we don't have to touch the arguments object. The
  // only additional allocation required is the completion record, which
  // has a stable shape and so hopefully should be cheap to allocate.
  function tryCatch(fn, obj, arg) {
    try {
      return { type: "normal", arg: fn.call(obj, arg) };
    } catch (err) {
      return { type: "throw", arg: err };
    }
  }

  var GenStateSuspendedStart = "suspendedStart";
  var GenStateSuspendedYield = "suspendedYield";
  var GenStateExecuting = "executing";
  var GenStateCompleted = "completed";

  // Returning this object from the innerFn has the same effect as
  // breaking out of the dispatch switch statement.
  var ContinueSentinel = {};

  // Dummy constructor functions that we use as the .constructor and
  // .constructor.prototype properties for functions that return Generator
  // objects. For full spec compliance, you may wish to configure your
  // minifier not to mangle the names of these two functions.
  function Generator() {}
  function GeneratorFunction() {}
  function GeneratorFunctionPrototype() {}

  // This is a polyfill for %IteratorPrototype% for environments that
  // don't natively support it.
  var IteratorPrototype = {};
  IteratorPrototype[iteratorSymbol] = function () {
    return this;
  };

  var getProto = Object.getPrototypeOf;
  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));
  if (NativeIteratorPrototype &&
      NativeIteratorPrototype !== Op &&
      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {
    // This environment has a native %IteratorPrototype%; use it instead
    // of the polyfill.
    IteratorPrototype = NativeIteratorPrototype;
  }

  var Gp = GeneratorFunctionPrototype.prototype =
    Generator.prototype = Object.create(IteratorPrototype);
  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;
  GeneratorFunctionPrototype.constructor = GeneratorFunction;
  GeneratorFunction.displayName = define(
    GeneratorFunctionPrototype,
    toStringTagSymbol,
    "GeneratorFunction"
  );

  // Helper for defining the .next, .throw, and .return methods of the
  // Iterator interface in terms of a single ._invoke method.
  function defineIteratorMethods(prototype) {
    ["next", "throw", "return"].forEach(function(method) {
      define(prototype, method, function(arg) {
        return this._invoke(method, arg);
      });
    });
  }

  exports.isGeneratorFunction = function(genFun) {
    var ctor = typeof genFun === "function" && genFun.constructor;
    return ctor
      ? ctor === GeneratorFunction ||
        // For the native GeneratorFunction constructor, the best we can
        // do is to check its .name property.
        (ctor.displayName || ctor.name) === "GeneratorFunction"
      : false;
  };

  exports.mark = function(genFun) {
    if (Object.setPrototypeOf) {
      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);
    } else {
      genFun.__proto__ = GeneratorFunctionPrototype;
      define(genFun, toStringTagSymbol, "GeneratorFunction");
    }
    genFun.prototype = Object.create(Gp);
    return genFun;
  };

  // Within the body of any async function, `await x` is transformed to
  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test
  // `hasOwn.call(value, "__await")` to determine if the yielded value is
  // meant to be awaited.
  exports.awrap = function(arg) {
    return { __await: arg };
  };

  function AsyncIterator(generator, PromiseImpl) {
    function invoke(method, arg, resolve, reject) {
      var record = tryCatch(generator[method], generator, arg);
      if (record.type === "throw") {
        reject(record.arg);
      } else {
        var result = record.arg;
        var value = result.value;
        if (value &&
            typeof value === "object" &&
            hasOwn.call(value, "__await")) {
          return PromiseImpl.resolve(value.__await).then(function(value) {
            invoke("next", value, resolve, reject);
          }, function(err) {
            invoke("throw", err, resolve, reject);
          });
        }

        return PromiseImpl.resolve(value).then(function(unwrapped) {
          // When a yielded Promise is resolved, its final value becomes
          // the .value of the Promise<{value,done}> result for the
          // current iteration.
          result.value = unwrapped;
          resolve(result);
        }, function(error) {
          // If a rejected Promise was yielded, throw the rejection back
          // into the async generator function so it can be handled there.
          return invoke("throw", error, resolve, reject);
        });
      }
    }

    var previousPromise;

    function enqueue(method, arg) {
      function callInvokeWithMethodAndArg() {
        return new PromiseImpl(function(resolve, reject) {
          invoke(method, arg, resolve, reject);
        });
      }

      return previousPromise =
        // If enqueue has been called before, then we want to wait until
        // all previous Promises have been resolved before calling invoke,
        // so that results are always delivered in the correct order. If
        // enqueue has not been called before, then it is important to
        // call invoke immediately, without waiting on a callback to fire,
        // so that the async generator function has the opportunity to do
        // any necessary setup in a predictable way. This predictability
        // is why the Promise constructor synchronously invokes its
        // executor callback, and why async functions synchronously
        // execute code before the first await. Since we implement simple
        // async functions in terms of async generators, it is especially
        // important to get this right, even though it requires care.
        previousPromise ? previousPromise.then(
          callInvokeWithMethodAndArg,
          // Avoid propagating failures to Promises returned by later
          // invocations of the iterator.
          callInvokeWithMethodAndArg
        ) : callInvokeWithMethodAndArg();
    }

    // Define the unified helper method that is used to implement .next,
    // .throw, and .return (see defineIteratorMethods).
    this._invoke = enqueue;
  }

  defineIteratorMethods(AsyncIterator.prototype);
  AsyncIterator.prototype[asyncIteratorSymbol] = function () {
    return this;
  };
  exports.AsyncIterator = AsyncIterator;

  // Note that simple async functions are implemented on top of
  // AsyncIterator objects; they just return a Promise for the value of
  // the final result produced by the iterator.
  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {
    if (PromiseImpl === void 0) PromiseImpl = Promise;

    var iter = new AsyncIterator(
      wrap(innerFn, outerFn, self, tryLocsList),
      PromiseImpl
    );

    return exports.isGeneratorFunction(outerFn)
      ? iter // If outerFn is a generator, return the full iterator.
      : iter.next().then(function(result) {
          return result.done ? result.value : iter.next();
        });
  };

  function makeInvokeMethod(innerFn, self, context) {
    var state = GenStateSuspendedStart;

    return function invoke(method, arg) {
      if (state === GenStateExecuting) {
        throw new Error("Generator is already running");
      }

      if (state === GenStateCompleted) {
        if (method === "throw") {
          throw arg;
        }

        // Be forgiving, per 25.3.3.3.3 of the spec:
        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume
        return doneResult();
      }

      context.method = method;
      context.arg = arg;

      while (true) {
        var delegate = context.delegate;
        if (delegate) {
          var delegateResult = maybeInvokeDelegate(delegate, context);
          if (delegateResult) {
            if (delegateResult === ContinueSentinel) continue;
            return delegateResult;
          }
        }

        if (context.method === "next") {
          // Setting context._sent for legacy support of Babel's
          // function.sent implementation.
          context.sent = context._sent = context.arg;

        } else if (context.method === "throw") {
          if (state === GenStateSuspendedStart) {
            state = GenStateCompleted;
            throw context.arg;
          }

          context.dispatchException(context.arg);

        } else if (context.method === "return") {
          context.abrupt("return", context.arg);
        }

        state = GenStateExecuting;

        var record = tryCatch(innerFn, self, context);
        if (record.type === "normal") {
          // If an exception is thrown from innerFn, we leave state ===
          // GenStateExecuting and loop back for another invocation.
          state = context.done
            ? GenStateCompleted
            : GenStateSuspendedYield;

          if (record.arg === ContinueSentinel) {
            continue;
          }

          return {
            value: record.arg,
            done: context.done
          };

        } else if (record.type === "throw") {
          state = GenStateCompleted;
          // Dispatch the exception by looping back around to the
          // context.dispatchException(context.arg) call above.
          context.method = "throw";
          context.arg = record.arg;
        }
      }
    };
  }

  // Call delegate.iterator[context.method](context.arg) and handle the
  // result, either by returning a { value, done } result from the
  // delegate iterator, or by modifying context.method and context.arg,
  // setting context.delegate to null, and returning the ContinueSentinel.
  function maybeInvokeDelegate(delegate, context) {
    var method = delegate.iterator[context.method];
    if (method === undefined) {
      // A .throw or .return when the delegate iterator has no .throw
      // method always terminates the yield* loop.
      context.delegate = null;

      if (context.method === "throw") {
        // Note: ["return"] must be used for ES3 parsing compatibility.
        if (delegate.iterator["return"]) {
          // If the delegate iterator has a return method, give it a
          // chance to clean up.
          context.method = "return";
          context.arg = undefined;
          maybeInvokeDelegate(delegate, context);

          if (context.method === "throw") {
            // If maybeInvokeDelegate(context) changed context.method from
            // "return" to "throw", let that override the TypeError below.
            return ContinueSentinel;
          }
        }

        context.method = "throw";
        context.arg = new TypeError(
          "The iterator does not provide a 'throw' method");
      }

      return ContinueSentinel;
    }

    var record = tryCatch(method, delegate.iterator, context.arg);

    if (record.type === "throw") {
      context.method = "throw";
      context.arg = record.arg;
      context.delegate = null;
      return ContinueSentinel;
    }

    var info = record.arg;

    if (! info) {
      context.method = "throw";
      context.arg = new TypeError("iterator result is not an object");
      context.delegate = null;
      return ContinueSentinel;
    }

    if (info.done) {
      // Assign the result of the finished delegate to the temporary
      // variable specified by delegate.resultName (see delegateYield).
      context[delegate.resultName] = info.value;

      // Resume execution at the desired location (see delegateYield).
      context.next = delegate.nextLoc;

      // If context.method was "throw" but the delegate handled the
      // exception, let the outer generator proceed normally. If
      // context.method was "next", forget context.arg since it has been
      // "consumed" by the delegate iterator. If context.method was
      // "return", allow the original .return call to continue in the
      // outer generator.
      if (context.method !== "return") {
        context.method = "next";
        context.arg = undefined;
      }

    } else {
      // Re-yield the result returned by the delegate method.
      return info;
    }

    // The delegate iterator is finished, so forget it and continue with
    // the outer generator.
    context.delegate = null;
    return ContinueSentinel;
  }

  // Define Generator.prototype.{next,throw,return} in terms of the
  // unified ._invoke helper method.
  defineIteratorMethods(Gp);

  define(Gp, toStringTagSymbol, "Generator");

  // A Generator should always return itself as the iterator object when the
  // @@iterator function is called on it. Some browsers' implementations of the
  // iterator prototype chain incorrectly implement this, causing the Generator
  // object to not be returned from this call. This ensures that doesn't happen.
  // See https://github.com/facebook/regenerator/issues/274 for more details.
  Gp[iteratorSymbol] = function() {
    return this;
  };

  Gp.toString = function() {
    return "[object Generator]";
  };

  function pushTryEntry(locs) {
    var entry = { tryLoc: locs[0] };

    if (1 in locs) {
      entry.catchLoc = locs[1];
    }

    if (2 in locs) {
      entry.finallyLoc = locs[2];
      entry.afterLoc = locs[3];
    }

    this.tryEntries.push(entry);
  }

  function resetTryEntry(entry) {
    var record = entry.completion || {};
    record.type = "normal";
    delete record.arg;
    entry.completion = record;
  }

  function Context(tryLocsList) {
    // The root entry object (effectively a try statement without a catch
    // or a finally block) gives us a place to store values thrown from
    // locations where there is no enclosing try statement.
    this.tryEntries = [{ tryLoc: "root" }];
    tryLocsList.forEach(pushTryEntry, this);
    this.reset(true);
  }

  exports.keys = function(object) {
    var keys = [];
    for (var key in object) {
      keys.push(key);
    }
    keys.reverse();

    // Rather than returning an object with a next method, we keep
    // things simple and return the next function itself.
    return function next() {
      while (keys.length) {
        var key = keys.pop();
        if (key in object) {
          next.value = key;
          next.done = false;
          return next;
        }
      }

      // To avoid creating an additional object, we just hang the .value
      // and .done properties off the next function object itself. This
      // also ensures that the minifier will not anonymize the function.
      next.done = true;
      return next;
    };
  };

  function values(iterable) {
    if (iterable) {
      var iteratorMethod = iterable[iteratorSymbol];
      if (iteratorMethod) {
        return iteratorMethod.call(iterable);
      }

      if (typeof iterable.next === "function") {
        return iterable;
      }

      if (!isNaN(iterable.length)) {
        var i = -1, next = function next() {
          while (++i < iterable.length) {
            if (hasOwn.call(iterable, i)) {
              next.value = iterable[i];
              next.done = false;
              return next;
            }
          }

          next.value = undefined;
          next.done = true;

          return next;
        };

        return next.next = next;
      }
    }

    // Return an iterator with no values.
    return { next: doneResult };
  }
  exports.values = values;

  function doneResult() {
    return { value: undefined, done: true };
  }

  Context.prototype = {
    constructor: Context,

    reset: function(skipTempReset) {
      this.prev = 0;
      this.next = 0;
      // Resetting context._sent for legacy support of Babel's
      // function.sent implementation.
      this.sent = this._sent = undefined;
      this.done = false;
      this.delegate = null;

      this.method = "next";
      this.arg = undefined;

      this.tryEntries.forEach(resetTryEntry);

      if (!skipTempReset) {
        for (var name in this) {
          // Not sure about the optimal order of these conditions:
          if (name.charAt(0) === "t" &&
              hasOwn.call(this, name) &&
              !isNaN(+name.slice(1))) {
            this[name] = undefined;
          }
        }
      }
    },

    stop: function() {
      this.done = true;

      var rootEntry = this.tryEntries[0];
      var rootRecord = rootEntry.completion;
      if (rootRecord.type === "throw") {
        throw rootRecord.arg;
      }

      return this.rval;
    },

    dispatchException: function(exception) {
      if (this.done) {
        throw exception;
      }

      var context = this;
      function handle(loc, caught) {
        record.type = "throw";
        record.arg = exception;
        context.next = loc;

        if (caught) {
          // If the dispatched exception was caught by a catch block,
          // then let that catch block handle the exception normally.
          context.method = "next";
          context.arg = undefined;
        }

        return !! caught;
      }

      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        var record = entry.completion;

        if (entry.tryLoc === "root") {
          // Exception thrown outside of any try block that could handle
          // it, so set the completion value of the entire function to
          // throw the exception.
          return handle("end");
        }

        if (entry.tryLoc <= this.prev) {
          var hasCatch = hasOwn.call(entry, "catchLoc");
          var hasFinally = hasOwn.call(entry, "finallyLoc");

          if (hasCatch && hasFinally) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            } else if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else if (hasCatch) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            }

          } else if (hasFinally) {
            if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else {
            throw new Error("try statement without catch or finally");
          }
        }
      }
    },

    abrupt: function(type, arg) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc <= this.prev &&
            hasOwn.call(entry, "finallyLoc") &&
            this.prev < entry.finallyLoc) {
          var finallyEntry = entry;
          break;
        }
      }

      if (finallyEntry &&
          (type === "break" ||
           type === "continue") &&
          finallyEntry.tryLoc <= arg &&
          arg <= finallyEntry.finallyLoc) {
        // Ignore the finally entry if control is not jumping to a
        // location outside the try/catch block.
        finallyEntry = null;
      }

      var record = finallyEntry ? finallyEntry.completion : {};
      record.type = type;
      record.arg = arg;

      if (finallyEntry) {
        this.method = "next";
        this.next = finallyEntry.finallyLoc;
        return ContinueSentinel;
      }

      return this.complete(record);
    },

    complete: function(record, afterLoc) {
      if (record.type === "throw") {
        throw record.arg;
      }

      if (record.type === "break" ||
          record.type === "continue") {
        this.next = record.arg;
      } else if (record.type === "return") {
        this.rval = this.arg = record.arg;
        this.method = "return";
        this.next = "end";
      } else if (record.type === "normal" && afterLoc) {
        this.next = afterLoc;
      }

      return ContinueSentinel;
    },

    finish: function(finallyLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.finallyLoc === finallyLoc) {
          this.complete(entry.completion, entry.afterLoc);
          resetTryEntry(entry);
          return ContinueSentinel;
        }
      }
    },

    "catch": function(tryLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc === tryLoc) {
          var record = entry.completion;
          if (record.type === "throw") {
            var thrown = record.arg;
            resetTryEntry(entry);
          }
          return thrown;
        }
      }

      // The context.catch method must only be called with a location
      // argument that corresponds to a known catch block.
      throw new Error("illegal catch attempt");
    },

    delegateYield: function(iterable, resultName, nextLoc) {
      this.delegate = {
        iterator: values(iterable),
        resultName: resultName,
        nextLoc: nextLoc
      };

      if (this.method === "next") {
        // Deliberately forget the last sent value so that we don't
        // accidentally pass it on to the delegate.
        this.arg = undefined;
      }

      return ContinueSentinel;
    }
  };

  // Regardless of whether this script is executing as a CommonJS module
  // or not, return the runtime object so that we can declare the variable
  // regeneratorRuntime in the outer scope, which allows this module to be
  // injected easily by `bin/regenerator --include-runtime script.js`.
  return exports;

}(
  // If this script is executing as a CommonJS module, use module.exports
  // as the regeneratorRuntime namespace. Otherwise create a new empty
  // object. Either way, the resulting object will be used to initialize
  // the regeneratorRuntime variable at the top of this file.
  typeof module === "object" ? module.exports : {}
));

try {
  regeneratorRuntime = runtime;
} catch (accidentalStrictMode) {
  // This module should not be running in strict mode, so the above
  // assignment should always work unless something is misconfigured. Just
  // in case runtime.js accidentally runs in strict mode, we can escape
  // strict mode using a global Function call. This could conceivably fail
  // if a Content Security Policy forbids using Function, but in that case
  // the proper solution is to fix the accidental strict mode problem. If
  // you've misconfigured your bundler to force strict mode and applied a
  // CSP to forbid Function, and you're not willing to fix either of those
  // problems, please detail your unique predicament in a GitHub issue.
  Function("r", "regeneratorRuntime = r")(runtime);
}

},{}],"../../node_modules/mapbox-gl/dist/mapbox-gl.js":[function(require,module,exports) {
var define;
var global = arguments[3];
function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function (obj) { return typeof obj; }; } else { _typeof = function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

/* Mapbox GL JS is Copyright Â© 2020 Mapbox and subject to the Mapbox Terms of Service ((https://www.mapbox.com/legal/tos/). */
(function (global, factory) {
  (typeof exports === "undefined" ? "undefined" : _typeof(exports)) === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = global || self, global.mapboxgl = factory());
})(this, function () {
  'use strict';
  /* eslint-disable */

  var shared, worker, mapboxgl; // define gets called three times: one for each chunk. we rely on the order
  // they're imported to know which is which

  function define(_, chunk) {
    if (!shared) {
      shared = chunk;
    } else if (!worker) {
      worker = chunk;
    } else {
      var workerBundleString = 'var sharedChunk = {}; (' + shared + ')(sharedChunk); (' + worker + ')(sharedChunk);';
      var sharedChunk = {};
      shared(sharedChunk);
      mapboxgl = chunk(sharedChunk);

      if (typeof window !== 'undefined') {
        mapboxgl.workerUrl = window.URL.createObjectURL(new Blob([workerBundleString], {
          type: 'text/javascript'
        }));
      }
    }
  }

  define(["exports"], function (t) {
    "use strict";

    var e = r;

    function r(t, e, r, i) {
      this.cx = 3 * t, this.bx = 3 * (r - t) - this.cx, this.ax = 1 - this.cx - this.bx, this.cy = 3 * e, this.by = 3 * (i - e) - this.cy, this.ay = 1 - this.cy - this.by, this.p1x = t, this.p1y = i, this.p2x = r, this.p2y = i;
    }

    r.prototype.sampleCurveX = function (t) {
      return ((this.ax * t + this.bx) * t + this.cx) * t;
    }, r.prototype.sampleCurveY = function (t) {
      return ((this.ay * t + this.by) * t + this.cy) * t;
    }, r.prototype.sampleCurveDerivativeX = function (t) {
      return (3 * this.ax * t + 2 * this.bx) * t + this.cx;
    }, r.prototype.solveCurveX = function (t, e) {
      var r, i, n, s, a;

      for (void 0 === e && (e = 1e-6), n = t, a = 0; a < 8; a++) {
        if (s = this.sampleCurveX(n) - t, Math.abs(s) < e) return n;
        var o = this.sampleCurveDerivativeX(n);
        if (Math.abs(o) < 1e-6) break;
        n -= s / o;
      }

      if ((n = t) < (r = 0)) return r;
      if (n > (i = 1)) return i;

      for (; r < i;) {
        if (s = this.sampleCurveX(n), Math.abs(s - t) < e) return n;
        t > s ? r = n : i = n, n = .5 * (i - r) + r;
      }

      return n;
    }, r.prototype.solve = function (t, e) {
      return this.sampleCurveY(this.solveCurveX(t, e));
    };
    var i = n;

    function n(t, e) {
      this.x = t, this.y = e;
    }

    n.prototype = {
      clone: function () {
        return new n(this.x, this.y);
      },
      add: function (t) {
        return this.clone()._add(t);
      },
      sub: function (t) {
        return this.clone()._sub(t);
      },
      multByPoint: function (t) {
        return this.clone()._multByPoint(t);
      },
      divByPoint: function (t) {
        return this.clone()._divByPoint(t);
      },
      mult: function (t) {
        return this.clone()._mult(t);
      },
      div: function (t) {
        return this.clone()._div(t);
      },
      rotate: function (t) {
        return this.clone()._rotate(t);
      },
      rotateAround: function (t, e) {
        return this.clone()._rotateAround(t, e);
      },
      matMult: function (t) {
        return this.clone()._matMult(t);
      },
      unit: function () {
        return this.clone()._unit();
      },
      perp: function () {
        return this.clone()._perp();
      },
      round: function () {
        return this.clone()._round();
      },
      mag: function () {
        return Math.sqrt(this.x * this.x + this.y * this.y);
      },
      equals: function (t) {
        return this.x === t.x && this.y === t.y;
      },
      dist: function (t) {
        return Math.sqrt(this.distSqr(t));
      },
      distSqr: function (t) {
        var e = t.x - this.x,
            r = t.y - this.y;
        return e * e + r * r;
      },
      angle: function () {
        return Math.atan2(this.y, this.x);
      },
      angleTo: function (t) {
        return Math.atan2(this.y - t.y, this.x - t.x);
      },
      angleWith: function (t) {
        return this.angleWithSep(t.x, t.y);
      },
      angleWithSep: function (t, e) {
        return Math.atan2(this.x * e - this.y * t, this.x * t + this.y * e);
      },
      _matMult: function (t) {
        var e = t[2] * this.x + t[3] * this.y;
        return this.x = t[0] * this.x + t[1] * this.y, this.y = e, this;
      },
      _add: function (t) {
        return this.x += t.x, this.y += t.y, this;
      },
      _sub: function (t) {
        return this.x -= t.x, this.y -= t.y, this;
      },
      _mult: function (t) {
        return this.x *= t, this.y *= t, this;
      },
      _div: function (t) {
        return this.x /= t, this.y /= t, this;
      },
      _multByPoint: function (t) {
        return this.x *= t.x, this.y *= t.y, this;
      },
      _divByPoint: function (t) {
        return this.x /= t.x, this.y /= t.y, this;
      },
      _unit: function () {
        return this._div(this.mag()), this;
      },
      _perp: function () {
        var t = this.y;
        return this.y = this.x, this.x = -t, this;
      },
      _rotate: function (t) {
        var e = Math.cos(t),
            r = Math.sin(t),
            i = r * this.x + e * this.y;
        return this.x = e * this.x - r * this.y, this.y = i, this;
      },
      _rotateAround: function (t, e) {
        var r = Math.cos(t),
            i = Math.sin(t),
            n = e.y + i * (this.x - e.x) + r * (this.y - e.y);
        return this.x = e.x + r * (this.x - e.x) - i * (this.y - e.y), this.y = n, this;
      },
      _round: function () {
        return this.x = Math.round(this.x), this.y = Math.round(this.y), this;
      }
    }, n.convert = function (t) {
      return t instanceof n ? t : Array.isArray(t) ? new n(t[0], t[1]) : t;
    };
    var s = "undefined" != typeof self ? self : {};

    function a(t, e) {
      if (Array.isArray(t)) {
        if (!Array.isArray(e) || t.length !== e.length) return !1;

        for (var _r2 = 0; _r2 < t.length; _r2++) {
          if (!a(t[_r2], e[_r2])) return !1;
        }

        return !0;
      }

      if ("object" == _typeof(t) && null !== t && null !== e) {
        if ("object" != _typeof(e)) return !1;
        if (Object.keys(t).length !== Object.keys(e).length) return !1;

        for (var _r3 in t) {
          if (!a(t[_r3], e[_r3])) return !1;
        }

        return !0;
      }

      return t === e;
    }

    var o = Math.pow(2, 53) - 1,
        l = Math.PI / 180,
        u = 180 / Math.PI;

    function c(t) {
      return t * l;
    }

    function h(t) {
      if (t <= 0) return 0;
      if (t >= 1) return 1;
      var e = t * t,
          r = e * t;
      return 4 * (t < .5 ? r : 3 * (t - e) + r - .75);
    }

    function p(t, r, i, n) {
      var s = new e(t, r, i, n);
      return function (t) {
        return s.solve(t);
      };
    }

    var d = p(.25, .1, .25, 1);

    function f(t, e, r) {
      return Math.min(r, Math.max(e, t));
    }

    function y(t, e, r) {
      var i = r - e,
          n = ((t - e) % i + i) % i + e;
      return n === e ? r : n;
    }

    function m(t, e, r) {
      if (!t.length) return r(null, []);
      var i = t.length;
      var n = new Array(t.length);
      var s = null;
      t.forEach(function (t, a) {
        e(t, function (t, e) {
          t && (s = t), n[a] = e, 0 == --i && r(s, n);
        });
      });
    }

    function g(t) {
      var e = [];

      for (var _r4 in t) {
        e.push(t[_r4]);
      }

      return e;
    }

    function x(t) {
      for (var _len = arguments.length, e = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        e[_key - 1] = arguments[_key];
      }

      for (var _r5 of e) {
        for (var _e2 in _r5) {
          t[_e2] = _r5[_e2];
        }
      }

      return t;
    }

    var v = 1;

    function b() {
      return v++;
    }

    function w() {
      return function t(e) {
        return e ? (e ^ 16 * Math.random() >> e / 4).toString(16) : ([1e7] + -[1e3] + -4e3 + -8e3 + -1e11).replace(/[018]/g, t);
      }();
    }

    function _(t) {
      return !!t && /^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t);
    }

    function k(t, e) {
      t.forEach(function (t) {
        e[t] && (e[t] = e[t].bind(e));
      });
    }

    function A(t, e) {
      return -1 !== t.indexOf(e, t.length - e.length);
    }

    function S(t, e, r) {
      var i = {};

      for (var _n2 in t) {
        i[_n2] = e.call(r || this, t[_n2], _n2, t);
      }

      return i;
    }

    function I(t, e, r) {
      var i = {};

      for (var _n3 in t) {
        e.call(r || this, t[_n3], _n3, t) && (i[_n3] = t[_n3]);
      }

      return i;
    }

    function T(t) {
      return Array.isArray(t) ? t.map(T) : "object" == _typeof(t) && t ? S(t, T) : t;
    }

    var z = {};

    function E(t) {
      z[t] || ("undefined" != typeof console && console.warn(t), z[t] = !0);
    }

    function M(t, e, r) {
      return (r.y - t.y) * (e.x - t.x) > (e.y - t.y) * (r.x - t.x);
    }

    function B(t) {
      var e = 0;

      for (var _r6, _i2, _n4 = 0, _s2 = t.length, _a2 = _s2 - 1; _n4 < _s2; _a2 = _n4++) {
        _r6 = t[_n4], _i2 = t[_a2], e += (_i2.x - _r6.x) * (_r6.y + _i2.y);
      }

      return e;
    }

    function D() {
      return "undefined" != typeof WorkerGlobalScope && "undefined" != typeof self && self instanceof WorkerGlobalScope;
    }

    function C(t) {
      var e = {};

      if (t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g, function (t, r, i, n) {
        var s = i || n;
        return e[r] = !s || s.toLowerCase(), "";
      }), e["max-age"]) {
        var _t2 = parseInt(e["max-age"], 10);

        isNaN(_t2) ? delete e["max-age"] : e["max-age"] = _t2;
      }

      return e;
    }

    var P,
        V,
        F = null;

    function R(t) {
      if (null == F) {
        var _e3 = t.navigator ? t.navigator.userAgent : null;

        F = !!t.safari || !(!_e3 || !(/\b(iPad|iPhone|iPod)\b/.test(_e3) || _e3.match("Safari") && !_e3.match("Chrome")));
      }

      return F;
    }

    function L(t) {
      try {
        var _e4 = s[t];
        return _e4.setItem("_mapbox_test_", 1), _e4.removeItem("_mapbox_test_"), !0;
      } catch (t) {
        return !1;
      }
    }

    var U,
        O = !1;
    var $ = {
      now: function () {
        return void 0 !== U ? U : s.performance.now();
      },
      setErrorState: function () {
        O = !0;
      },
      setNow: function (t) {
        U = t;
      },
      restoreNow: function () {
        U = void 0;
      },
      frame: function (t) {
        if (O) return {
          cancel: function () {}
        };
        var e = s.requestAnimationFrame(t);
        return {
          cancel: function () {
            return s.cancelAnimationFrame(e);
          }
        };
      },
      getImageData: function (t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var r = s.document.createElement("canvas"),
            i = r.getContext("2d");
        if (!i) throw new Error("failed to create canvas 2d context");
        return r.width = t.width, r.height = t.height, i.drawImage(t, 0, 0, t.width, t.height), i.getImageData(-e, -e, t.width + 2 * e, t.height + 2 * e);
      },
      resolveURL: function (t) {
        return P || (P = s.document.createElement("a")), P.href = t, P.href;
      },

      get devicePixelRatio() {
        return s.devicePixelRatio;
      },

      get prefersReducedMotion() {
        return !!s.matchMedia && (null == V && (V = s.matchMedia("(prefers-reduced-motion: reduce)")), V.matches);
      }

    };
    var q;
    var N = {
      API_URL: "https://api.mapbox.com",

      get API_URL_REGEX() {
        if (null == q) {
          var _t3 = /^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;

          try {
            q = null != undefined ? new RegExp(undefined) : _t3;
          } catch (e) {
            q = _t3;
          }
        }

        return q;
      },

      get EVENTS_URL() {
        return this.API_URL ? 0 === this.API_URL.indexOf("https://api.mapbox.cn") ? "https://events.mapbox.cn/events/v2" : 0 === this.API_URL.indexOf("https://api.mapbox.com") ? "https://events.mapbox.com/events/v2" : null : null;
      },

      SESSION_PATH: "/map-sessions/v1",
      FEEDBACK_URL: "https://apps.mapbox.com/feedback",
      TILE_URL_VERSION: "v4",
      RASTER_URL_PREFIX: "raster/v1",
      REQUIRE_ACCESS_TOKEN: !0,
      ACCESS_TOKEN: null,
      MAX_PARALLEL_IMAGE_REQUESTS: 16
    },
        j = {
      supported: !1,
      testSupport: function (t) {
        !X && Z && (K ? H(t) : G = t);
      }
    };
    var G,
        Z,
        X = !1,
        K = !1;

    function H(t) {
      var e = t.createTexture();
      t.bindTexture(t.TEXTURE_2D, e);

      try {
        if (t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, t.RGBA, t.UNSIGNED_BYTE, Z), t.isContextLost()) return;
        j.supported = !0;
      } catch (t) {}

      t.deleteTexture(e), X = !0;
    }

    s.document && (Z = s.document.createElement("img"), Z.onload = function () {
      G && H(G), G = null, K = !0;
    }, Z.onerror = function () {
      X = !0, G = null;
    }, Z.src = "data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");
    var Y = "01";

    function W(t) {
      return 0 === t.indexOf("mapbox:");
    }

    function J(t) {
      return N.API_URL_REGEX.test(t);
    }

    var Q = /^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;

    function tt(t) {
      var e = t.match(Q);
      if (!e) throw new Error("Unable to parse URL object");
      return {
        protocol: e[1],
        authority: e[2],
        path: e[3] || "/",
        params: e[4] ? e[4].split("&") : []
      };
    }

    function et(t) {
      var e = t.params.length ? "?".concat(t.params.join("&")) : "";
      return "".concat(t.protocol, "://").concat(t.authority).concat(t.path).concat(e);
    }

    function rt(t) {
      if (!t) return null;
      var e = t.split(".");
      if (!e || 3 !== e.length) return null;

      try {
        return JSON.parse(decodeURIComponent(s.atob(e[1]).split("").map(function (t) {
          return "%" + ("00" + t.charCodeAt(0).toString(16)).slice(-2);
        }).join("")));
      } catch (t) {
        return null;
      }
    }

    var it = /*#__PURE__*/function () {
      function it(t) {
        _classCallCheck(this, it);

        this.type = t, this.anonId = null, this.eventData = {}, this.queue = [], this.pendingRequest = null;
      }

      _createClass(it, [{
        key: "getStorageKey",
        value: function getStorageKey(t) {
          var e = rt(N.ACCESS_TOKEN);
          var r = "";
          return r = e && e.u ? s.btoa(encodeURIComponent(e.u).replace(/%([0-9A-F]{2})/g, function (t, e) {
            return String.fromCharCode(Number("0x" + e));
          })) : N.ACCESS_TOKEN || "", t ? "mapbox.eventData.".concat(t, ":").concat(r) : "mapbox.eventData:".concat(r);
        }
      }, {
        key: "fetchEventData",
        value: function fetchEventData() {
          var t = L("localStorage"),
              e = this.getStorageKey(),
              r = this.getStorageKey("uuid");
          if (t) try {
            var _t4 = s.localStorage.getItem(e);

            _t4 && (this.eventData = JSON.parse(_t4));

            var _i3 = s.localStorage.getItem(r);

            _i3 && (this.anonId = _i3);
          } catch (t) {
            E("Unable to read from LocalStorage");
          }
        }
      }, {
        key: "saveEventData",
        value: function saveEventData() {
          var t = L("localStorage"),
              e = this.getStorageKey(),
              r = this.getStorageKey("uuid");
          if (t) try {
            s.localStorage.setItem(r, this.anonId), Object.keys(this.eventData).length >= 1 && s.localStorage.setItem(e, JSON.stringify(this.eventData));
          } catch (t) {
            E("Unable to write to LocalStorage");
          }
        }
      }, {
        key: "processRequests",
        value: function processRequests(t) {}
      }, {
        key: "postEvent",
        value: function postEvent(t, e, r, i) {
          var _this = this;

          if (!N.EVENTS_URL) return;
          var n = tt(N.EVENTS_URL);
          n.params.push("access_token=".concat(i || N.ACCESS_TOKEN || ""));
          var s = {
            event: this.type,
            created: new Date(t).toISOString(),
            sdkIdentifier: "mapbox-gl-js",
            sdkVersion: "2.1.1",
            skuId: Y,
            userId: this.anonId
          },
              a = e ? x(s, e) : s,
              o = {
            url: et(n),
            headers: {
              "Content-Type": "text/plain"
            },
            body: JSON.stringify([a])
          };
          this.pendingRequest = At(o, function (t) {
            _this.pendingRequest = null, r(t), _this.saveEventData(), _this.processRequests(i);
          });
        }
      }, {
        key: "queueRequest",
        value: function queueRequest(t, e) {
          this.queue.push(t), this.processRequests(e);
        }
      }]);

      return it;
    }();

    var nt = new ( /*#__PURE__*/function (_it) {
      _inherits(_class, _it);

      var _super = _createSuper(_class);

      function _class(t) {
        var _this2;

        _classCallCheck(this, _class);

        _this2 = _super.call(this, "appUserTurnstile"), _this2._customAccessToken = t;
        return _this2;
      }

      _createClass(_class, [{
        key: "postTurnstileEvent",
        value: function postTurnstileEvent(t, e) {
          N.EVENTS_URL && N.ACCESS_TOKEN && Array.isArray(t) && t.some(function (t) {
            return W(t) || J(t);
          }) && this.queueRequest(Date.now(), e);
        }
      }, {
        key: "processRequests",
        value: function processRequests(t) {
          var _this3 = this;

          if (this.pendingRequest || 0 === this.queue.length) return;
          this.anonId && this.eventData.lastSuccess && this.eventData.tokenU || this.fetchEventData();
          var e = rt(N.ACCESS_TOKEN),
              r = e ? e.u : N.ACCESS_TOKEN;
          var i = r !== this.eventData.tokenU;
          _(this.anonId) || (this.anonId = w(), i = !0);
          var n = this.queue.shift();

          if (this.eventData.lastSuccess) {
            var _t5 = new Date(this.eventData.lastSuccess),
                _e5 = new Date(n),
                _r7 = (n - this.eventData.lastSuccess) / 864e5;

            i = i || _r7 >= 1 || _r7 < -1 || _t5.getDate() !== _e5.getDate();
          } else i = !0;

          if (!i) return this.processRequests();
          this.postEvent(n, {
            "enabled.telemetry": !1
          }, function (t) {
            t || (_this3.eventData.lastSuccess = n, _this3.eventData.tokenU = r);
          }, t);
        }
      }]);

      return _class;
    }(it))(),
        st = nt.postTurnstileEvent.bind(nt),
        at = new ( /*#__PURE__*/function (_it2) {
      _inherits(_class2, _it2);

      var _super2 = _createSuper(_class2);

      function _class2() {
        var _this4;

        _classCallCheck(this, _class2);

        _this4 = _super2.call(this, "map.load"), _this4.success = {}, _this4.skuToken = "";
        return _this4;
      }

      _createClass(_class2, [{
        key: "postMapLoadEvent",
        value: function postMapLoadEvent(t, e, r, i) {
          this.skuToken = e, this.errorCb = i, N.EVENTS_URL && (r || N.ACCESS_TOKEN ? this.queueRequest({
            id: t,
            timestamp: Date.now()
          }, r) : this.errorCb(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")));
        }
      }, {
        key: "processRequests",
        value: function processRequests(t) {
          var _this5 = this;

          if (this.pendingRequest || 0 === this.queue.length) return;
          var {
            id: e,
            timestamp: r
          } = this.queue.shift();
          e && this.success[e] || (this.anonId || this.fetchEventData(), _(this.anonId) || (this.anonId = w()), this.postEvent(r, {
            skuToken: this.skuToken
          }, function (t) {
            t ? _this5.errorCb(t) : e && (_this5.success[e] = !0);
          }, t));
        }
      }]);

      return _class2;
    }(it))(),
        ot = at.postMapLoadEvent.bind(at),
        lt = new ( /*#__PURE__*/function (_it3) {
      _inherits(_class3, _it3);

      var _super3 = _createSuper(_class3);

      function _class3() {
        var _this6;

        _classCallCheck(this, _class3);

        _this6 = _super3.call(this, "map.auth"), _this6.success = {}, _this6.skuToken = "";
        return _this6;
      }

      _createClass(_class3, [{
        key: "getSession",
        value: function getSession(t, e, r, i) {
          var _this7 = this;

          if (!N.API_URL || !N.SESSION_PATH) return;
          var n = tt(N.API_URL + N.SESSION_PATH);
          n.params.push("sku=".concat(e || "")), n.params.push("access_token=".concat(i || N.ACCESS_TOKEN || ""));
          var s = {
            url: et(n),
            headers: {
              "Content-Type": "text/plain"
            }
          };
          this.pendingRequest = St(s, function (t) {
            _this7.pendingRequest = null, r(t), _this7.saveEventData(), _this7.processRequests(i);
          });
        }
      }, {
        key: "getSessionAPI",
        value: function getSessionAPI(t, e, r, i) {
          this.skuToken = e, this.errorCb = i, N.SESSION_PATH && N.API_URL && (r || N.ACCESS_TOKEN ? this.queueRequest({
            id: t,
            timestamp: Date.now()
          }, r) : this.errorCb(new Error("NO_ACCESS_TOKEN")));
        }
      }, {
        key: "processRequests",
        value: function processRequests(t) {
          var _this8 = this;

          if (this.pendingRequest || 0 === this.queue.length) return;
          var {
            id: e,
            timestamp: r
          } = this.queue.shift();
          e && this.success[e] || this.getSession(r, this.skuToken, function (t) {
            t ? _this8.errorCb(t) : e && (_this8.success[e] = !0);
          }, t);
        }
      }]);

      return _class3;
    }(it))(),
        ut = lt.getSessionAPI.bind(lt);
    var ct,
        ht,
        pt = 500,
        dt = 50;

    function ft() {
      s.caches && !ct && (ct = s.caches.open("mapbox-tiles"));
    }

    function yt(t) {
      var e = t.indexOf("?");
      return e < 0 ? t : t.slice(0, e);
    }

    var mt,
        gt = 1 / 0;

    function xt() {
      return null == mt && (mt = s.OffscreenCanvas && new s.OffscreenCanvas(1, 1).getContext("2d") && "function" == typeof s.createImageBitmap), mt;
    }

    var vt = {
      Unknown: "Unknown",
      Style: "Style",
      Source: "Source",
      Tile: "Tile",
      Glyphs: "Glyphs",
      SpriteImage: "SpriteImage",
      SpriteJSON: "SpriteJSON",
      Image: "Image"
    };
    "function" == typeof Object.freeze && Object.freeze(vt);

    var bt = /*#__PURE__*/function (_Error) {
      _inherits(bt, _Error);

      var _super4 = _createSuper(bt);

      function bt(t, e, r) {
        var _this9;

        _classCallCheck(this, bt);

        401 === e && J(r) && (t += ": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"), _this9 = _super4.call(this, t), _this9.status = e, _this9.url = r;
        return _this9;
      }

      _createClass(bt, [{
        key: "toString",
        value: function toString() {
          return "".concat(this.name, ": ").concat(this.message, " (").concat(this.status, "): ").concat(this.url);
        }
      }]);

      return bt;
    }( /*#__PURE__*/_wrapNativeSuper(Error));

    var wt = D() ? function () {
      return self.worker && self.worker.referrer;
    } : function () {
      return ("blob:" === s.location.protocol ? s.parent : s).location.href;
    };

    var _t = function (t, e) {
      if (!(/^file:/.test(r = t.url) || /^file:/.test(wt()) && !/^\w+:/.test(r))) {
        if (s.fetch && s.Request && s.AbortController && s.Request.prototype.hasOwnProperty("signal")) return function (t, e) {
          var r = new s.AbortController(),
              i = new s.Request(t.url, {
            method: t.method || "GET",
            body: t.body,
            credentials: t.credentials,
            headers: t.headers,
            referrer: wt(),
            signal: r.signal
          });
          var n = !1,
              a = !1;
          var o = (l = i.url).indexOf("sku=") > 0 && J(l);
          var l;
          "json" === t.type && i.headers.set("Accept", "application/json");

          var u = function (r, n, l) {
            if (a) return;
            if (r && "SecurityError" !== r.message && E(r), n && l) return c(n);
            var u = Date.now();
            s.fetch(i).then(function (r) {
              if (r.ok) {
                var _t6 = o ? r.clone() : null;

                return c(r, _t6, u);
              }

              return e(new bt(r.statusText, r.status, t.url));
            }).catch(function (t) {
              20 !== t.code && e(new Error(t.message));
            });
          },
              c = function (r, o, l) {
            ("arrayBuffer" === t.type ? r.arrayBuffer() : "json" === t.type ? r.json() : r.text()).then(function (t) {
              a || (o && l && function (t, e, r) {
                if (ft(), !ct) return;
                var i = {
                  status: e.status,
                  statusText: e.statusText,
                  headers: new s.Headers()
                };
                e.headers.forEach(function (t, e) {
                  return i.headers.set(e, t);
                });
                var n = C(e.headers.get("Cache-Control") || "");
                n["no-store"] || (n["max-age"] && i.headers.set("Expires", new Date(r + 1e3 * n["max-age"]).toUTCString()), new Date(i.headers.get("Expires")).getTime() - r < 42e4 || function (t, e) {
                  if (void 0 === ht) try {
                    new Response(new ReadableStream()), ht = !0;
                  } catch (t) {
                    ht = !1;
                  }
                  ht ? e(t.body) : t.blob().then(e);
                }(e, function (e) {
                  var r = new s.Response(e, i);
                  ft(), ct && ct.then(function (e) {
                    return e.put(yt(t.url), r);
                  }).catch(function (t) {
                    return E(t.message);
                  });
                }));
              }(i, o, l), n = !0, e(null, t, r.headers.get("Cache-Control"), r.headers.get("Expires")));
            }).catch(function (t) {
              a || e(new Error(t.message));
            });
          };

          return o ? function (t, e) {
            if (ft(), !ct) return e(null);
            var r = yt(t.url);
            ct.then(function (t) {
              t.match(r).then(function (i) {
                var n = function (t) {
                  if (!t) return !1;
                  var e = new Date(t.headers.get("Expires") || 0),
                      r = C(t.headers.get("Cache-Control") || "");
                  return e > Date.now() && !r["no-cache"];
                }(i);

                t.delete(r), n && t.put(r, i.clone()), e(null, i, n);
              }).catch(e);
            }).catch(e);
          }(i, u) : u(null, null), {
            cancel: function () {
              a = !0, n || r.abort();
            }
          };
        }(t, e);
        if (D() && self.worker && self.worker.actor) return self.worker.actor.send("getResource", t, e, void 0, !0);
      }

      var r;
      return function (t, e) {
        var r = new s.XMLHttpRequest();
        r.open(t.method || "GET", t.url, !0), "arrayBuffer" === t.type && (r.responseType = "arraybuffer");

        for (var _e6 in t.headers) {
          r.setRequestHeader(_e6, t.headers[_e6]);
        }

        return "json" === t.type && (r.responseType = "text", r.setRequestHeader("Accept", "application/json")), r.withCredentials = "include" === t.credentials, r.onerror = function () {
          e(new Error(r.statusText));
        }, r.onload = function () {
          if ((r.status >= 200 && r.status < 300 || 0 === r.status) && null !== r.response) {
            var _i4 = r.response;
            if ("json" === t.type) try {
              _i4 = JSON.parse(r.response);
            } catch (t) {
              return e(t);
            }
            e(null, _i4, r.getResponseHeader("Cache-Control"), r.getResponseHeader("Expires"));
          } else e(new bt(r.statusText, r.status, t.url));
        }, r.send(t.body), {
          cancel: function () {
            return r.abort();
          }
        };
      }(t, e);
    },
        kt = function (t, e) {
      return _t(x(t, {
        type: "arrayBuffer"
      }), e);
    },
        At = function (t, e) {
      return _t(x(t, {
        method: "POST"
      }), e);
    },
        St = function (t, e) {
      return _t(x(t, {
        method: "GET"
      }), e);
    };

    function It(t) {
      var e = s.document.createElement("a");
      return e.href = t, e.protocol === s.document.location.protocol && e.host === s.document.location.host;
    }

    var Tt = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";
    var zt, Et;
    zt = [], Et = 0;

    var Mt = function (t, e) {
      if (j.supported && (t.headers || (t.headers = {}), t.headers.accept = "image/webp,*/*"), Et >= N.MAX_PARALLEL_IMAGE_REQUESTS) {
        var _r8 = {
          requestParameters: t,
          callback: e,
          cancelled: !1,
          cancel: function () {
            this.cancelled = !0;
          }
        };
        return zt.push(_r8), _r8;
      }

      Et++;
      var r = !1;

      var i = function () {
        if (!r) for (r = !0, Et--; zt.length && Et < N.MAX_PARALLEL_IMAGE_REQUESTS;) {
          var _t7 = zt.shift(),
              {
            requestParameters: _e7,
            callback: _r9,
            cancelled: _i5
          } = _t7;

          _i5 || (_t7.cancel = Mt(_e7, _r9).cancel);
        }
      },
          n = kt(t, function (t, r, n, a) {
        i(), t ? e(t) : r && (xt() ? function (t, e) {
          var r = new s.Blob([new Uint8Array(t)], {
            type: "image/png"
          });
          s.createImageBitmap(r).then(function (t) {
            e(null, t);
          }).catch(function (t) {
            e(new Error("Could not load image because of ".concat(t.message, ". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")));
          });
        }(r, e) : function (t, e, r, i) {
          var n = new s.Image(),
              a = s.URL;
          n.onload = function () {
            e(null, n), a.revokeObjectURL(n.src), n.onload = null, s.requestAnimationFrame(function () {
              n.src = Tt;
            });
          }, n.onerror = function () {
            return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));
          };
          var o = new s.Blob([new Uint8Array(t)], {
            type: "image/png"
          });
          n.cacheControl = r, n.expires = i, n.src = t.byteLength ? a.createObjectURL(o) : Tt;
        }(r, e, n, a));
      });

      return {
        cancel: function () {
          n.cancel(), i();
        }
      };
    };

    function Bt(t, e, r) {
      r[t] && -1 !== r[t].indexOf(e) || (r[t] = r[t] || [], r[t].push(e));
    }

    function Dt(t, e, r) {
      if (r && r[t]) {
        var _i6 = r[t].indexOf(e);

        -1 !== _i6 && r[t].splice(_i6, 1);
      }
    }

    var Ct = function Ct(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      _classCallCheck(this, Ct);

      x(this, e), this.type = t;
    };

    var Pt = /*#__PURE__*/function (_Ct) {
      _inherits(Pt, _Ct);

      var _super5 = _createSuper(Pt);

      function Pt(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        _classCallCheck(this, Pt);

        return _super5.call(this, "error", x({
          error: t
        }, e));
      }

      return Pt;
    }(Ct);

    var Vt = /*#__PURE__*/function () {
      function Vt() {
        _classCallCheck(this, Vt);
      }

      _createClass(Vt, [{
        key: "on",
        value: function on(t, e) {
          return this._listeners = this._listeners || {}, Bt(t, e, this._listeners), this;
        }
      }, {
        key: "off",
        value: function off(t, e) {
          return Dt(t, e, this._listeners), Dt(t, e, this._oneTimeListeners), this;
        }
      }, {
        key: "once",
        value: function once(t, e) {
          var _this10 = this;

          return e ? (this._oneTimeListeners = this._oneTimeListeners || {}, Bt(t, e, this._oneTimeListeners), this) : new Promise(function (e) {
            return _this10.once(t, e);
          });
        }
      }, {
        key: "fire",
        value: function fire(t, e) {
          "string" == typeof t && (t = new Ct(t, e || {}));
          var r = t.type;

          if (this.listens(r)) {
            t.target = this;

            var _e8 = this._listeners && this._listeners[r] ? this._listeners[r].slice() : [];

            for (var _r10 of _e8) {
              _r10.call(this, t);
            }

            var _i7 = this._oneTimeListeners && this._oneTimeListeners[r] ? this._oneTimeListeners[r].slice() : [];

            for (var _e9 of _i7) {
              Dt(r, _e9, this._oneTimeListeners), _e9.call(this, t);
            }

            var _n5 = this._eventedParent;
            _n5 && (x(t, "function" == typeof this._eventedParentData ? this._eventedParentData() : this._eventedParentData), _n5.fire(t));
          } else t instanceof Pt && console.error(t.error);

          return this;
        }
      }, {
        key: "listens",
        value: function listens(t) {
          return !!(this._listeners && this._listeners[t] && this._listeners[t].length > 0 || this._oneTimeListeners && this._oneTimeListeners[t] && this._oneTimeListeners[t].length > 0 || this._eventedParent && this._eventedParent.listens(t));
        }
      }, {
        key: "setEventedParent",
        value: function setEventedParent(t, e) {
          return this._eventedParent = t, this._eventedParentData = e, this;
        }
      }]);

      return Vt;
    }();

    var Ft = {
      $version: 8,
      $root: {
        version: {
          required: !0,
          type: "enum",
          values: [8]
        },
        name: {
          type: "string"
        },
        metadata: {
          type: "*"
        },
        center: {
          type: "array",
          value: "number"
        },
        zoom: {
          type: "number"
        },
        bearing: {
          type: "number",
          default: 0,
          period: 360,
          units: "degrees"
        },
        pitch: {
          type: "number",
          default: 0,
          units: "degrees"
        },
        light: {
          type: "light"
        },
        terrain: {
          type: "terrain"
        },
        sources: {
          required: !0,
          type: "sources"
        },
        sprite: {
          type: "string"
        },
        glyphs: {
          type: "string"
        },
        transition: {
          type: "transition"
        },
        layers: {
          required: !0,
          type: "array",
          value: "layer"
        }
      },
      sources: {
        "*": {
          type: "source"
        }
      },
      source: ["source_vector", "source_raster", "source_raster_dem", "source_geojson", "source_video", "source_image"],
      source_vector: {
        type: {
          required: !0,
          type: "enum",
          values: {
            vector: {}
          }
        },
        url: {
          type: "string"
        },
        tiles: {
          type: "array",
          value: "string"
        },
        bounds: {
          type: "array",
          value: "number",
          length: 4,
          default: [-180, -85.051129, 180, 85.051129]
        },
        scheme: {
          type: "enum",
          values: {
            xyz: {},
            tms: {}
          },
          default: "xyz"
        },
        minzoom: {
          type: "number",
          default: 0
        },
        maxzoom: {
          type: "number",
          default: 22
        },
        attribution: {
          type: "string"
        },
        promoteId: {
          type: "promoteId"
        },
        volatile: {
          type: "boolean",
          default: !1
        },
        "*": {
          type: "*"
        }
      },
      source_raster: {
        type: {
          required: !0,
          type: "enum",
          values: {
            raster: {}
          }
        },
        url: {
          type: "string"
        },
        tiles: {
          type: "array",
          value: "string"
        },
        bounds: {
          type: "array",
          value: "number",
          length: 4,
          default: [-180, -85.051129, 180, 85.051129]
        },
        minzoom: {
          type: "number",
          default: 0
        },
        maxzoom: {
          type: "number",
          default: 22
        },
        tileSize: {
          type: "number",
          default: 512,
          units: "pixels"
        },
        scheme: {
          type: "enum",
          values: {
            xyz: {},
            tms: {}
          },
          default: "xyz"
        },
        attribution: {
          type: "string"
        },
        volatile: {
          type: "boolean",
          default: !1
        },
        "*": {
          type: "*"
        }
      },
      source_raster_dem: {
        type: {
          required: !0,
          type: "enum",
          values: {
            "raster-dem": {}
          }
        },
        url: {
          type: "string"
        },
        tiles: {
          type: "array",
          value: "string"
        },
        bounds: {
          type: "array",
          value: "number",
          length: 4,
          default: [-180, -85.051129, 180, 85.051129]
        },
        minzoom: {
          type: "number",
          default: 0
        },
        maxzoom: {
          type: "number",
          default: 22
        },
        tileSize: {
          type: "number",
          default: 512,
          units: "pixels"
        },
        attribution: {
          type: "string"
        },
        encoding: {
          type: "enum",
          values: {
            terrarium: {},
            mapbox: {}
          },
          default: "mapbox"
        },
        volatile: {
          type: "boolean",
          default: !1
        },
        "*": {
          type: "*"
        }
      },
      source_geojson: {
        type: {
          required: !0,
          type: "enum",
          values: {
            geojson: {}
          }
        },
        data: {
          type: "*"
        },
        maxzoom: {
          type: "number",
          default: 18
        },
        attribution: {
          type: "string"
        },
        buffer: {
          type: "number",
          default: 128,
          maximum: 512,
          minimum: 0
        },
        filter: {
          type: "*"
        },
        tolerance: {
          type: "number",
          default: .375
        },
        cluster: {
          type: "boolean",
          default: !1
        },
        clusterRadius: {
          type: "number",
          default: 50,
          minimum: 0
        },
        clusterMaxZoom: {
          type: "number"
        },
        clusterMinPoints: {
          type: "number"
        },
        clusterProperties: {
          type: "*"
        },
        lineMetrics: {
          type: "boolean",
          default: !1
        },
        generateId: {
          type: "boolean",
          default: !1
        },
        promoteId: {
          type: "promoteId"
        }
      },
      source_video: {
        type: {
          required: !0,
          type: "enum",
          values: {
            video: {}
          }
        },
        urls: {
          required: !0,
          type: "array",
          value: "string"
        },
        coordinates: {
          required: !0,
          type: "array",
          length: 4,
          value: {
            type: "array",
            length: 2,
            value: "number"
          }
        }
      },
      source_image: {
        type: {
          required: !0,
          type: "enum",
          values: {
            image: {}
          }
        },
        url: {
          required: !0,
          type: "string"
        },
        coordinates: {
          required: !0,
          type: "array",
          length: 4,
          value: {
            type: "array",
            length: 2,
            value: "number"
          }
        }
      },
      layer: {
        id: {
          type: "string",
          required: !0
        },
        type: {
          type: "enum",
          values: {
            fill: {},
            line: {},
            symbol: {},
            circle: {},
            heatmap: {},
            "fill-extrusion": {},
            raster: {},
            hillshade: {},
            background: {},
            sky: {}
          },
          required: !0
        },
        metadata: {
          type: "*"
        },
        source: {
          type: "string"
        },
        "source-layer": {
          type: "string"
        },
        minzoom: {
          type: "number",
          minimum: 0,
          maximum: 24
        },
        maxzoom: {
          type: "number",
          minimum: 0,
          maximum: 24
        },
        filter: {
          type: "filter"
        },
        layout: {
          type: "layout"
        },
        paint: {
          type: "paint"
        }
      },
      layout: ["layout_fill", "layout_line", "layout_circle", "layout_heatmap", "layout_fill-extrusion", "layout_symbol", "layout_raster", "layout_hillshade", "layout_background", "layout_sky"],
      layout_background: {
        visibility: {
          type: "enum",
          values: {
            visible: {},
            none: {}
          },
          default: "visible",
          "property-type": "constant"
        }
      },
      layout_sky: {
        visibility: {
          type: "enum",
          values: {
            visible: {},
            none: {}
          },
          default: "visible",
          "property-type": "constant"
        }
      },
      layout_fill: {
        "fill-sort-key": {
          type: "number",
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        visibility: {
          type: "enum",
          values: {
            visible: {},
            none: {}
          },
          default: "visible",
          "property-type": "constant"
        }
      },
      layout_circle: {
        "circle-sort-key": {
          type: "number",
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        visibility: {
          type: "enum",
          values: {
            visible: {},
            none: {}
          },
          default: "visible",
          "property-type": "constant"
        }
      },
      layout_heatmap: {
        visibility: {
          type: "enum",
          values: {
            visible: {},
            none: {}
          },
          default: "visible",
          "property-type": "constant"
        }
      },
      "layout_fill-extrusion": {
        visibility: {
          type: "enum",
          values: {
            visible: {},
            none: {}
          },
          default: "visible",
          "property-type": "constant"
        }
      },
      layout_line: {
        "line-cap": {
          type: "enum",
          values: {
            butt: {},
            round: {},
            square: {}
          },
          default: "butt",
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "line-join": {
          type: "enum",
          values: {
            bevel: {},
            round: {},
            miter: {}
          },
          default: "miter",
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "line-miter-limit": {
          type: "number",
          default: 2,
          requires: [{
            "line-join": "miter"
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "line-round-limit": {
          type: "number",
          default: 1.05,
          requires: [{
            "line-join": "round"
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "line-sort-key": {
          type: "number",
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        visibility: {
          type: "enum",
          values: {
            visible: {},
            none: {}
          },
          default: "visible",
          "property-type": "constant"
        }
      },
      layout_symbol: {
        "symbol-placement": {
          type: "enum",
          values: {
            point: {},
            line: {},
            "line-center": {}
          },
          default: "point",
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "symbol-spacing": {
          type: "number",
          default: 250,
          minimum: 1,
          units: "pixels",
          requires: [{
            "symbol-placement": "line"
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "symbol-avoid-edges": {
          type: "boolean",
          default: !1,
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "symbol-sort-key": {
          type: "number",
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "symbol-z-order": {
          type: "enum",
          values: {
            auto: {},
            "viewport-y": {},
            source: {}
          },
          default: "auto",
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "icon-allow-overlap": {
          type: "boolean",
          default: !1,
          requires: ["icon-image"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "icon-ignore-placement": {
          type: "boolean",
          default: !1,
          requires: ["icon-image"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "icon-optional": {
          type: "boolean",
          default: !1,
          requires: ["icon-image", "text-field"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "icon-rotation-alignment": {
          type: "enum",
          values: {
            map: {},
            viewport: {},
            auto: {}
          },
          default: "auto",
          requires: ["icon-image"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "icon-size": {
          type: "number",
          default: 1,
          minimum: 0,
          units: "factor of the original icon size",
          requires: ["icon-image"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "icon-text-fit": {
          type: "enum",
          values: {
            none: {},
            width: {},
            height: {},
            both: {}
          },
          default: "none",
          requires: ["icon-image", "text-field"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "icon-text-fit-padding": {
          type: "array",
          value: "number",
          length: 4,
          default: [0, 0, 0, 0],
          units: "pixels",
          requires: ["icon-image", "text-field", {
            "icon-text-fit": ["both", "width", "height"]
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "icon-image": {
          type: "resolvedImage",
          tokens: !0,
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "icon-rotate": {
          type: "number",
          default: 0,
          period: 360,
          units: "degrees",
          requires: ["icon-image"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "icon-padding": {
          type: "number",
          default: 2,
          minimum: 0,
          units: "pixels",
          requires: ["icon-image"],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "icon-keep-upright": {
          type: "boolean",
          default: !1,
          requires: ["icon-image", {
            "icon-rotation-alignment": "map"
          }, {
            "symbol-placement": ["line", "line-center"]
          }],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "icon-offset": {
          type: "array",
          value: "number",
          length: 2,
          default: [0, 0],
          requires: ["icon-image"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "icon-anchor": {
          type: "enum",
          values: {
            center: {},
            left: {},
            right: {},
            top: {},
            bottom: {},
            "top-left": {},
            "top-right": {},
            "bottom-left": {},
            "bottom-right": {}
          },
          default: "center",
          requires: ["icon-image"],
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "icon-pitch-alignment": {
          type: "enum",
          values: {
            map: {},
            viewport: {},
            auto: {}
          },
          default: "auto",
          requires: ["icon-image"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-pitch-alignment": {
          type: "enum",
          values: {
            map: {},
            viewport: {},
            auto: {}
          },
          default: "auto",
          requires: ["text-field"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-rotation-alignment": {
          type: "enum",
          values: {
            map: {},
            viewport: {},
            auto: {}
          },
          default: "auto",
          requires: ["text-field"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-field": {
          type: "formatted",
          default: "",
          tokens: !0,
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "text-font": {
          type: "array",
          value: "string",
          default: ["Open Sans Regular", "Arial Unicode MS Regular"],
          requires: ["text-field"],
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "text-size": {
          type: "number",
          default: 16,
          minimum: 0,
          units: "pixels",
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "text-max-width": {
          type: "number",
          default: 10,
          minimum: 0,
          units: "ems",
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "text-line-height": {
          type: "number",
          default: 1.2,
          units: "ems",
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-letter-spacing": {
          type: "number",
          default: 0,
          units: "ems",
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "text-justify": {
          type: "enum",
          values: {
            auto: {},
            left: {},
            center: {},
            right: {}
          },
          default: "center",
          requires: ["text-field"],
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "text-radial-offset": {
          type: "number",
          units: "ems",
          default: 0,
          requires: ["text-field"],
          "property-type": "data-driven",
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature"]
          }
        },
        "text-variable-anchor": {
          type: "array",
          value: "enum",
          values: {
            center: {},
            left: {},
            right: {},
            top: {},
            bottom: {},
            "top-left": {},
            "top-right": {},
            "bottom-left": {},
            "bottom-right": {}
          },
          requires: ["text-field", {
            "symbol-placement": ["point"]
          }],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-anchor": {
          type: "enum",
          values: {
            center: {},
            left: {},
            right: {},
            top: {},
            bottom: {},
            "top-left": {},
            "top-right": {},
            "bottom-left": {},
            "bottom-right": {}
          },
          default: "center",
          requires: ["text-field", {
            "!": "text-variable-anchor"
          }],
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "text-max-angle": {
          type: "number",
          default: 45,
          units: "degrees",
          requires: ["text-field", {
            "symbol-placement": ["line", "line-center"]
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-writing-mode": {
          type: "array",
          value: "enum",
          values: {
            horizontal: {},
            vertical: {}
          },
          requires: ["text-field", {
            "symbol-placement": ["point"]
          }],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-rotate": {
          type: "number",
          default: 0,
          period: 360,
          units: "degrees",
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "text-padding": {
          type: "number",
          default: 2,
          minimum: 0,
          units: "pixels",
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-keep-upright": {
          type: "boolean",
          default: !0,
          requires: ["text-field", {
            "text-rotation-alignment": "map"
          }, {
            "symbol-placement": ["line", "line-center"]
          }],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-transform": {
          type: "enum",
          values: {
            none: {},
            uppercase: {},
            lowercase: {}
          },
          default: "none",
          requires: ["text-field"],
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "text-offset": {
          type: "array",
          value: "number",
          units: "ems",
          length: 2,
          default: [0, 0],
          requires: ["text-field", {
            "!": "text-radial-offset"
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature"]
          },
          "property-type": "data-driven"
        },
        "text-allow-overlap": {
          type: "boolean",
          default: !1,
          requires: ["text-field"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-ignore-placement": {
          type: "boolean",
          default: !1,
          requires: ["text-field"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-optional": {
          type: "boolean",
          default: !1,
          requires: ["text-field", "icon-image"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        visibility: {
          type: "enum",
          values: {
            visible: {},
            none: {}
          },
          default: "visible",
          "property-type": "constant"
        }
      },
      layout_raster: {
        visibility: {
          type: "enum",
          values: {
            visible: {},
            none: {}
          },
          default: "visible",
          "property-type": "constant"
        }
      },
      layout_hillshade: {
        visibility: {
          type: "enum",
          values: {
            visible: {},
            none: {}
          },
          default: "visible",
          "property-type": "constant"
        }
      },
      filter: {
        type: "array",
        value: "*"
      },
      filter_operator: {
        type: "enum",
        values: {
          "==": {},
          "!=": {},
          ">": {},
          ">=": {},
          "<": {},
          "<=": {},
          in: {},
          "!in": {},
          all: {},
          any: {},
          none: {},
          has: {},
          "!has": {},
          within: {}
        }
      },
      geometry_type: {
        type: "enum",
        values: {
          Point: {},
          LineString: {},
          Polygon: {}
        }
      },
      function: {
        expression: {
          type: "expression"
        },
        stops: {
          type: "array",
          value: "function_stop"
        },
        base: {
          type: "number",
          default: 1,
          minimum: 0
        },
        property: {
          type: "string",
          default: "$zoom"
        },
        type: {
          type: "enum",
          values: {
            identity: {},
            exponential: {},
            interval: {},
            categorical: {}
          },
          default: "exponential"
        },
        colorSpace: {
          type: "enum",
          values: {
            rgb: {},
            lab: {},
            hcl: {}
          },
          default: "rgb"
        },
        default: {
          type: "*",
          required: !1
        }
      },
      function_stop: {
        type: "array",
        minimum: 0,
        maximum: 24,
        value: ["number", "color"],
        length: 2
      },
      expression: {
        type: "array",
        value: "*",
        minimum: 1
      },
      light: {
        anchor: {
          type: "enum",
          default: "viewport",
          values: {
            map: {},
            viewport: {}
          },
          "property-type": "data-constant",
          transition: !1,
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          }
        },
        position: {
          type: "array",
          default: [1.15, 210, 30],
          length: 3,
          value: "number",
          "property-type": "data-constant",
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          }
        },
        color: {
          type: "color",
          "property-type": "data-constant",
          default: "#ffffff",
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          transition: !0
        },
        intensity: {
          type: "number",
          "property-type": "data-constant",
          default: .5,
          minimum: 0,
          maximum: 1,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          transition: !0
        }
      },
      terrain: {
        source: {
          type: "string",
          required: !0
        },
        exaggeration: {
          type: "number",
          "property-type": "data-constant",
          default: 1,
          minimum: 0,
          maximum: 1e3,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          transition: !0
        }
      },
      paint: ["paint_fill", "paint_line", "paint_circle", "paint_heatmap", "paint_fill-extrusion", "paint_symbol", "paint_raster", "paint_hillshade", "paint_background", "paint_sky"],
      paint_fill: {
        "fill-antialias": {
          type: "boolean",
          default: !0,
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "fill-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "fill-color": {
          type: "color",
          default: "#000000",
          transition: !0,
          requires: [{
            "!": "fill-pattern"
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "fill-outline-color": {
          type: "color",
          transition: !0,
          requires: [{
            "!": "fill-pattern"
          }, {
            "fill-antialias": !0
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "fill-translate": {
          type: "array",
          value: "number",
          length: 2,
          default: [0, 0],
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "fill-translate-anchor": {
          type: "enum",
          values: {
            map: {},
            viewport: {}
          },
          default: "map",
          requires: ["fill-translate"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "fill-pattern": {
          type: "resolvedImage",
          transition: !0,
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "cross-faded-data-driven"
        }
      },
      "paint_fill-extrusion": {
        "fill-extrusion-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "fill-extrusion-color": {
          type: "color",
          default: "#000000",
          transition: !0,
          requires: [{
            "!": "fill-extrusion-pattern"
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "fill-extrusion-translate": {
          type: "array",
          value: "number",
          length: 2,
          default: [0, 0],
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "fill-extrusion-translate-anchor": {
          type: "enum",
          values: {
            map: {},
            viewport: {}
          },
          default: "map",
          requires: ["fill-extrusion-translate"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "fill-extrusion-pattern": {
          type: "resolvedImage",
          transition: !0,
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "cross-faded-data-driven"
        },
        "fill-extrusion-height": {
          type: "number",
          default: 0,
          minimum: 0,
          units: "meters",
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "fill-extrusion-base": {
          type: "number",
          default: 0,
          minimum: 0,
          units: "meters",
          transition: !0,
          requires: ["fill-extrusion-height"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "fill-extrusion-vertical-gradient": {
          type: "boolean",
          default: !0,
          transition: !1,
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        }
      },
      paint_line: {
        "line-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "line-color": {
          type: "color",
          default: "#000000",
          transition: !0,
          requires: [{
            "!": "line-pattern"
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "line-translate": {
          type: "array",
          value: "number",
          length: 2,
          default: [0, 0],
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "line-translate-anchor": {
          type: "enum",
          values: {
            map: {},
            viewport: {}
          },
          default: "map",
          requires: ["line-translate"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "line-width": {
          type: "number",
          default: 1,
          minimum: 0,
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "line-gap-width": {
          type: "number",
          default: 0,
          minimum: 0,
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "line-offset": {
          type: "number",
          default: 0,
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "line-blur": {
          type: "number",
          default: 0,
          minimum: 0,
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "line-dasharray": {
          type: "array",
          value: "number",
          minimum: 0,
          transition: !0,
          units: "line widths",
          requires: [{
            "!": "line-pattern"
          }],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "cross-faded"
        },
        "line-pattern": {
          type: "resolvedImage",
          transition: !0,
          expression: {
            interpolated: !1,
            parameters: ["zoom", "feature"]
          },
          "property-type": "cross-faded-data-driven"
        },
        "line-gradient": {
          type: "color",
          transition: !1,
          requires: [{
            "!": "line-dasharray"
          }, {
            "!": "line-pattern"
          }, {
            source: "geojson",
            has: {
              lineMetrics: !0
            }
          }],
          expression: {
            interpolated: !0,
            parameters: ["line-progress"]
          },
          "property-type": "color-ramp"
        }
      },
      paint_circle: {
        "circle-radius": {
          type: "number",
          default: 5,
          minimum: 0,
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "circle-color": {
          type: "color",
          default: "#000000",
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "circle-blur": {
          type: "number",
          default: 0,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "circle-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "circle-translate": {
          type: "array",
          value: "number",
          length: 2,
          default: [0, 0],
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "circle-translate-anchor": {
          type: "enum",
          values: {
            map: {},
            viewport: {}
          },
          default: "map",
          requires: ["circle-translate"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "circle-pitch-scale": {
          type: "enum",
          values: {
            map: {},
            viewport: {}
          },
          default: "map",
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "circle-pitch-alignment": {
          type: "enum",
          values: {
            map: {},
            viewport: {}
          },
          default: "viewport",
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "circle-stroke-width": {
          type: "number",
          default: 0,
          minimum: 0,
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "circle-stroke-color": {
          type: "color",
          default: "#000000",
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "circle-stroke-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        }
      },
      paint_heatmap: {
        "heatmap-radius": {
          type: "number",
          default: 30,
          minimum: 1,
          transition: !0,
          units: "pixels",
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "heatmap-weight": {
          type: "number",
          default: 1,
          minimum: 0,
          transition: !1,
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "heatmap-intensity": {
          type: "number",
          default: 1,
          minimum: 0,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "heatmap-color": {
          type: "color",
          default: ["interpolate", ["linear"], ["heatmap-density"], 0, "rgba(0, 0, 255, 0)", .1, "royalblue", .3, "cyan", .5, "lime", .7, "yellow", 1, "red"],
          transition: !1,
          expression: {
            interpolated: !0,
            parameters: ["heatmap-density"]
          },
          "property-type": "color-ramp"
        },
        "heatmap-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        }
      },
      paint_symbol: {
        "icon-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          requires: ["icon-image"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "icon-color": {
          type: "color",
          default: "#000000",
          transition: !0,
          requires: ["icon-image"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "icon-halo-color": {
          type: "color",
          default: "rgba(0, 0, 0, 0)",
          transition: !0,
          requires: ["icon-image"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "icon-halo-width": {
          type: "number",
          default: 0,
          minimum: 0,
          transition: !0,
          units: "pixels",
          requires: ["icon-image"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "icon-halo-blur": {
          type: "number",
          default: 0,
          minimum: 0,
          transition: !0,
          units: "pixels",
          requires: ["icon-image"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "icon-translate": {
          type: "array",
          value: "number",
          length: 2,
          default: [0, 0],
          transition: !0,
          units: "pixels",
          requires: ["icon-image"],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "icon-translate-anchor": {
          type: "enum",
          values: {
            map: {},
            viewport: {}
          },
          default: "map",
          requires: ["icon-image", "icon-translate"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "text-color": {
          type: "color",
          default: "#000000",
          transition: !0,
          overridable: !0,
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "text-halo-color": {
          type: "color",
          default: "rgba(0, 0, 0, 0)",
          transition: !0,
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "text-halo-width": {
          type: "number",
          default: 0,
          minimum: 0,
          transition: !0,
          units: "pixels",
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "text-halo-blur": {
          type: "number",
          default: 0,
          minimum: 0,
          transition: !0,
          units: "pixels",
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom", "feature", "feature-state"]
          },
          "property-type": "data-driven"
        },
        "text-translate": {
          type: "array",
          value: "number",
          length: 2,
          default: [0, 0],
          transition: !0,
          units: "pixels",
          requires: ["text-field"],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "text-translate-anchor": {
          type: "enum",
          values: {
            map: {},
            viewport: {}
          },
          default: "map",
          requires: ["text-field", "text-translate"],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        }
      },
      paint_raster: {
        "raster-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "raster-hue-rotate": {
          type: "number",
          default: 0,
          period: 360,
          transition: !0,
          units: "degrees",
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "raster-brightness-min": {
          type: "number",
          default: 0,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "raster-brightness-max": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "raster-saturation": {
          type: "number",
          default: 0,
          minimum: -1,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "raster-contrast": {
          type: "number",
          default: 0,
          minimum: -1,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "raster-resampling": {
          type: "enum",
          values: {
            linear: {},
            nearest: {}
          },
          default: "linear",
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "raster-fade-duration": {
          type: "number",
          default: 300,
          minimum: 0,
          transition: !1,
          units: "milliseconds",
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        }
      },
      paint_hillshade: {
        "hillshade-illumination-direction": {
          type: "number",
          default: 335,
          minimum: 0,
          maximum: 359,
          transition: !1,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "hillshade-illumination-anchor": {
          type: "enum",
          values: {
            map: {},
            viewport: {}
          },
          default: "viewport",
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "hillshade-exaggeration": {
          type: "number",
          default: .5,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "hillshade-shadow-color": {
          type: "color",
          default: "#000000",
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "hillshade-highlight-color": {
          type: "color",
          default: "#FFFFFF",
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "hillshade-accent-color": {
          type: "color",
          default: "#000000",
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        }
      },
      paint_background: {
        "background-color": {
          type: "color",
          default: "#000000",
          transition: !0,
          requires: [{
            "!": "background-pattern"
          }],
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "background-pattern": {
          type: "resolvedImage",
          transition: !0,
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "cross-faded"
        },
        "background-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        }
      },
      paint_sky: {
        "sky-type": {
          type: "enum",
          values: {
            gradient: {},
            atmosphere: {}
          },
          default: "atmosphere",
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "sky-atmosphere-sun": {
          type: "array",
          value: "number",
          length: 2,
          units: "degrees",
          minimum: [0, 0],
          maximum: [360, 180],
          transition: !1,
          requires: [{
            "sky-type": "atmosphere"
          }],
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "sky-atmosphere-sun-intensity": {
          type: "number",
          requires: [{
            "sky-type": "atmosphere"
          }],
          default: 10,
          minimum: 0,
          maximum: 100,
          transition: !1,
          "property-type": "data-constant"
        },
        "sky-gradient-center": {
          type: "array",
          requires: [{
            "sky-type": "gradient"
          }],
          value: "number",
          default: [0, 0],
          length: 2,
          units: "degrees",
          minimum: [0, 0],
          maximum: [360, 180],
          transition: !1,
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "sky-gradient-radius": {
          type: "number",
          requires: [{
            "sky-type": "gradient"
          }],
          default: 90,
          minimum: 0,
          maximum: 180,
          transition: !1,
          expression: {
            interpolated: !1,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        },
        "sky-gradient": {
          type: "color",
          default: ["interpolate", ["linear"], ["sky-radial-progress"], .8, "#87ceeb", 1, "white"],
          transition: !1,
          requires: [{
            "sky-type": "gradient"
          }],
          expression: {
            interpolated: !0,
            parameters: ["sky-radial-progress"]
          },
          "property-type": "color-ramp"
        },
        "sky-atmosphere-halo-color": {
          type: "color",
          default: "white",
          transition: !1,
          requires: [{
            "sky-type": "atmosphere"
          }],
          "property-type": "data-constant"
        },
        "sky-atmosphere-color": {
          type: "color",
          default: "white",
          transition: !1,
          requires: [{
            "sky-type": "atmosphere"
          }],
          "property-type": "data-constant"
        },
        "sky-opacity": {
          type: "number",
          default: 1,
          minimum: 0,
          maximum: 1,
          transition: !0,
          expression: {
            interpolated: !0,
            parameters: ["zoom"]
          },
          "property-type": "data-constant"
        }
      },
      transition: {
        duration: {
          type: "number",
          default: 300,
          minimum: 0,
          units: "milliseconds"
        },
        delay: {
          type: "number",
          default: 0,
          minimum: 0,
          units: "milliseconds"
        }
      },
      "property-type": {
        "data-driven": {
          type: "property-type"
        },
        "cross-faded": {
          type: "property-type"
        },
        "cross-faded-data-driven": {
          type: "property-type"
        },
        "color-ramp": {
          type: "property-type"
        },
        "data-constant": {
          type: "property-type"
        },
        constant: {
          type: "property-type"
        }
      },
      promoteId: {
        "*": {
          type: "string"
        }
      }
    };

    var Rt = function Rt(t, e, r, i) {
      _classCallCheck(this, Rt);

      this.message = (t ? "".concat(t, ": ") : "") + r, i && (this.identifier = i), null != e && e.__line__ && (this.line = e.__line__);
    };

    function Lt(t) {
      var e = t.value;
      return e ? [new Rt(t.key, e, "constants have been deprecated as of v8")] : [];
    }

    function Ut(t) {
      for (var _len2 = arguments.length, e = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
        e[_key2 - 1] = arguments[_key2];
      }

      for (var _r11 of e) {
        for (var _e10 in _r11) {
          t[_e10] = _r11[_e10];
        }
      }

      return t;
    }

    function Ot(t) {
      return t instanceof Number || t instanceof String || t instanceof Boolean ? t.valueOf() : t;
    }

    function $t(t) {
      if (Array.isArray(t)) return t.map($t);

      if (t instanceof Object && !(t instanceof Number || t instanceof String || t instanceof Boolean)) {
        var _e11 = {};

        for (var _r12 in t) {
          _e11[_r12] = $t(t[_r12]);
        }

        return _e11;
      }

      return Ot(t);
    }

    var qt = /*#__PURE__*/function (_Error2) {
      _inherits(qt, _Error2);

      var _super6 = _createSuper(qt);

      function qt(t, e) {
        var _this11;

        _classCallCheck(this, qt);

        _this11 = _super6.call(this, e), _this11.message = e, _this11.key = t;
        return _this11;
      }

      return qt;
    }( /*#__PURE__*/_wrapNativeSuper(Error));

    var Nt = /*#__PURE__*/function () {
      function Nt(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

        _classCallCheck(this, Nt);

        this.parent = t, this.bindings = {};

        for (var [_t8, _r13] of e) {
          this.bindings[_t8] = _r13;
        }
      }

      _createClass(Nt, [{
        key: "concat",
        value: function concat(t) {
          return new Nt(this, t);
        }
      }, {
        key: "get",
        value: function get(t) {
          if (this.bindings[t]) return this.bindings[t];
          if (this.parent) return this.parent.get(t);
          throw new Error("".concat(t, " not found in scope."));
        }
      }, {
        key: "has",
        value: function has(t) {
          return !!this.bindings[t] || !!this.parent && this.parent.has(t);
        }
      }]);

      return Nt;
    }();

    var jt = {
      kind: "null"
    },
        Gt = {
      kind: "number"
    },
        Zt = {
      kind: "string"
    },
        Xt = {
      kind: "boolean"
    },
        Kt = {
      kind: "color"
    },
        Ht = {
      kind: "object"
    },
        Yt = {
      kind: "value"
    },
        Wt = {
      kind: "collator"
    },
        Jt = {
      kind: "formatted"
    },
        Qt = {
      kind: "resolvedImage"
    };

    function te(t, e) {
      return {
        kind: "array",
        itemType: t,
        N: e
      };
    }

    function ee(t) {
      if ("array" === t.kind) {
        var _e12 = ee(t.itemType);

        return "number" == typeof t.N ? "array<".concat(_e12, ", ").concat(t.N, ">") : "value" === t.itemType.kind ? "array" : "array<".concat(_e12, ">");
      }

      return t.kind;
    }

    var re = [jt, Gt, Zt, Xt, Kt, Jt, Ht, te(Yt), Qt];

    function ie(t, e) {
      if ("error" === e.kind) return null;

      if ("array" === t.kind) {
        if ("array" === e.kind && (0 === e.N && "value" === e.itemType.kind || !ie(t.itemType, e.itemType)) && ("number" != typeof t.N || t.N === e.N)) return null;
      } else {
        if (t.kind === e.kind) return null;
        if ("value" === t.kind) for (var _t9 of re) {
          if (!ie(_t9, e)) return null;
        }
      }

      return "Expected ".concat(ee(t), " but found ").concat(ee(e), " instead.");
    }

    function ne(t, e) {
      return e.some(function (e) {
        return e.kind === t.kind;
      });
    }

    function se(t, e) {
      return e.some(function (e) {
        return "null" === e ? null === t : "array" === e ? Array.isArray(t) : "object" === e ? t && !Array.isArray(t) && "object" == _typeof(t) : e === _typeof(t);
      });
    }

    function ae(t, e) {
      return t(e = {
        exports: {}
      }, e.exports), e.exports;
    }

    var oe = ae(function (t, e) {
      var r = {
        transparent: [0, 0, 0, 0],
        aliceblue: [240, 248, 255, 1],
        antiquewhite: [250, 235, 215, 1],
        aqua: [0, 255, 255, 1],
        aquamarine: [127, 255, 212, 1],
        azure: [240, 255, 255, 1],
        beige: [245, 245, 220, 1],
        bisque: [255, 228, 196, 1],
        black: [0, 0, 0, 1],
        blanchedalmond: [255, 235, 205, 1],
        blue: [0, 0, 255, 1],
        blueviolet: [138, 43, 226, 1],
        brown: [165, 42, 42, 1],
        burlywood: [222, 184, 135, 1],
        cadetblue: [95, 158, 160, 1],
        chartreuse: [127, 255, 0, 1],
        chocolate: [210, 105, 30, 1],
        coral: [255, 127, 80, 1],
        cornflowerblue: [100, 149, 237, 1],
        cornsilk: [255, 248, 220, 1],
        crimson: [220, 20, 60, 1],
        cyan: [0, 255, 255, 1],
        darkblue: [0, 0, 139, 1],
        darkcyan: [0, 139, 139, 1],
        darkgoldenrod: [184, 134, 11, 1],
        darkgray: [169, 169, 169, 1],
        darkgreen: [0, 100, 0, 1],
        darkgrey: [169, 169, 169, 1],
        darkkhaki: [189, 183, 107, 1],
        darkmagenta: [139, 0, 139, 1],
        darkolivegreen: [85, 107, 47, 1],
        darkorange: [255, 140, 0, 1],
        darkorchid: [153, 50, 204, 1],
        darkred: [139, 0, 0, 1],
        darksalmon: [233, 150, 122, 1],
        darkseagreen: [143, 188, 143, 1],
        darkslateblue: [72, 61, 139, 1],
        darkslategray: [47, 79, 79, 1],
        darkslategrey: [47, 79, 79, 1],
        darkturquoise: [0, 206, 209, 1],
        darkviolet: [148, 0, 211, 1],
        deeppink: [255, 20, 147, 1],
        deepskyblue: [0, 191, 255, 1],
        dimgray: [105, 105, 105, 1],
        dimgrey: [105, 105, 105, 1],
        dodgerblue: [30, 144, 255, 1],
        firebrick: [178, 34, 34, 1],
        floralwhite: [255, 250, 240, 1],
        forestgreen: [34, 139, 34, 1],
        fuchsia: [255, 0, 255, 1],
        gainsboro: [220, 220, 220, 1],
        ghostwhite: [248, 248, 255, 1],
        gold: [255, 215, 0, 1],
        goldenrod: [218, 165, 32, 1],
        gray: [128, 128, 128, 1],
        green: [0, 128, 0, 1],
        greenyellow: [173, 255, 47, 1],
        grey: [128, 128, 128, 1],
        honeydew: [240, 255, 240, 1],
        hotpink: [255, 105, 180, 1],
        indianred: [205, 92, 92, 1],
        indigo: [75, 0, 130, 1],
        ivory: [255, 255, 240, 1],
        khaki: [240, 230, 140, 1],
        lavender: [230, 230, 250, 1],
        lavenderblush: [255, 240, 245, 1],
        lawngreen: [124, 252, 0, 1],
        lemonchiffon: [255, 250, 205, 1],
        lightblue: [173, 216, 230, 1],
        lightcoral: [240, 128, 128, 1],
        lightcyan: [224, 255, 255, 1],
        lightgoldenrodyellow: [250, 250, 210, 1],
        lightgray: [211, 211, 211, 1],
        lightgreen: [144, 238, 144, 1],
        lightgrey: [211, 211, 211, 1],
        lightpink: [255, 182, 193, 1],
        lightsalmon: [255, 160, 122, 1],
        lightseagreen: [32, 178, 170, 1],
        lightskyblue: [135, 206, 250, 1],
        lightslategray: [119, 136, 153, 1],
        lightslategrey: [119, 136, 153, 1],
        lightsteelblue: [176, 196, 222, 1],
        lightyellow: [255, 255, 224, 1],
        lime: [0, 255, 0, 1],
        limegreen: [50, 205, 50, 1],
        linen: [250, 240, 230, 1],
        magenta: [255, 0, 255, 1],
        maroon: [128, 0, 0, 1],
        mediumaquamarine: [102, 205, 170, 1],
        mediumblue: [0, 0, 205, 1],
        mediumorchid: [186, 85, 211, 1],
        mediumpurple: [147, 112, 219, 1],
        mediumseagreen: [60, 179, 113, 1],
        mediumslateblue: [123, 104, 238, 1],
        mediumspringgreen: [0, 250, 154, 1],
        mediumturquoise: [72, 209, 204, 1],
        mediumvioletred: [199, 21, 133, 1],
        midnightblue: [25, 25, 112, 1],
        mintcream: [245, 255, 250, 1],
        mistyrose: [255, 228, 225, 1],
        moccasin: [255, 228, 181, 1],
        navajowhite: [255, 222, 173, 1],
        navy: [0, 0, 128, 1],
        oldlace: [253, 245, 230, 1],
        olive: [128, 128, 0, 1],
        olivedrab: [107, 142, 35, 1],
        orange: [255, 165, 0, 1],
        orangered: [255, 69, 0, 1],
        orchid: [218, 112, 214, 1],
        palegoldenrod: [238, 232, 170, 1],
        palegreen: [152, 251, 152, 1],
        paleturquoise: [175, 238, 238, 1],
        palevioletred: [219, 112, 147, 1],
        papayawhip: [255, 239, 213, 1],
        peachpuff: [255, 218, 185, 1],
        peru: [205, 133, 63, 1],
        pink: [255, 192, 203, 1],
        plum: [221, 160, 221, 1],
        powderblue: [176, 224, 230, 1],
        purple: [128, 0, 128, 1],
        rebeccapurple: [102, 51, 153, 1],
        red: [255, 0, 0, 1],
        rosybrown: [188, 143, 143, 1],
        royalblue: [65, 105, 225, 1],
        saddlebrown: [139, 69, 19, 1],
        salmon: [250, 128, 114, 1],
        sandybrown: [244, 164, 96, 1],
        seagreen: [46, 139, 87, 1],
        seashell: [255, 245, 238, 1],
        sienna: [160, 82, 45, 1],
        silver: [192, 192, 192, 1],
        skyblue: [135, 206, 235, 1],
        slateblue: [106, 90, 205, 1],
        slategray: [112, 128, 144, 1],
        slategrey: [112, 128, 144, 1],
        snow: [255, 250, 250, 1],
        springgreen: [0, 255, 127, 1],
        steelblue: [70, 130, 180, 1],
        tan: [210, 180, 140, 1],
        teal: [0, 128, 128, 1],
        thistle: [216, 191, 216, 1],
        tomato: [255, 99, 71, 1],
        turquoise: [64, 224, 208, 1],
        violet: [238, 130, 238, 1],
        wheat: [245, 222, 179, 1],
        white: [255, 255, 255, 1],
        whitesmoke: [245, 245, 245, 1],
        yellow: [255, 255, 0, 1],
        yellowgreen: [154, 205, 50, 1]
      };

      function i(t) {
        return (t = Math.round(t)) < 0 ? 0 : t > 255 ? 255 : t;
      }

      function n(t) {
        return i("%" === t[t.length - 1] ? parseFloat(t) / 100 * 255 : parseInt(t));
      }

      function s(t) {
        return (e = "%" === t[t.length - 1] ? parseFloat(t) / 100 : parseFloat(t)) < 0 ? 0 : e > 1 ? 1 : e;
        var e;
      }

      function a(t, e, r) {
        return r < 0 ? r += 1 : r > 1 && (r -= 1), 6 * r < 1 ? t + (e - t) * r * 6 : 2 * r < 1 ? e : 3 * r < 2 ? t + (e - t) * (2 / 3 - r) * 6 : t;
      }

      try {
        e.parseCSSColor = function (t) {
          var e,
              o = t.replace(/ /g, "").toLowerCase();
          if (o in r) return r[o].slice();
          if ("#" === o[0]) return 4 === o.length ? (e = parseInt(o.substr(1), 16)) >= 0 && e <= 4095 ? [(3840 & e) >> 4 | (3840 & e) >> 8, 240 & e | (240 & e) >> 4, 15 & e | (15 & e) << 4, 1] : null : 7 === o.length && (e = parseInt(o.substr(1), 16)) >= 0 && e <= 16777215 ? [(16711680 & e) >> 16, (65280 & e) >> 8, 255 & e, 1] : null;
          var l = o.indexOf("("),
              u = o.indexOf(")");

          if (-1 !== l && u + 1 === o.length) {
            var c = o.substr(0, l),
                h = o.substr(l + 1, u - (l + 1)).split(","),
                p = 1;

            switch (c) {
              case "rgba":
                if (4 !== h.length) return null;
                p = s(h.pop());

              case "rgb":
                return 3 !== h.length ? null : [n(h[0]), n(h[1]), n(h[2]), p];

              case "hsla":
                if (4 !== h.length) return null;
                p = s(h.pop());

              case "hsl":
                if (3 !== h.length) return null;
                var d = (parseFloat(h[0]) % 360 + 360) % 360 / 360,
                    f = s(h[1]),
                    y = s(h[2]),
                    m = y <= .5 ? y * (f + 1) : y + f - y * f,
                    g = 2 * y - m;
                return [i(255 * a(g, m, d + 1 / 3)), i(255 * a(g, m, d)), i(255 * a(g, m, d - 1 / 3)), p];

              default:
                return null;
            }
          }

          return null;
        };
      } catch (t) {}
    }).parseCSSColor;

    var le = /*#__PURE__*/function () {
      function le(t, e, r) {
        var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

        _classCallCheck(this, le);

        this.r = t, this.g = e, this.b = r, this.a = i;
      }

      _createClass(le, [{
        key: "toString",
        value: function toString() {
          var [t, e, r, i] = this.toArray();
          return "rgba(".concat(Math.round(t), ",").concat(Math.round(e), ",").concat(Math.round(r), ",").concat(i, ")");
        }
      }, {
        key: "toArray",
        value: function toArray() {
          var {
            r: t,
            g: e,
            b: r,
            a: i
          } = this;
          return 0 === i ? [0, 0, 0, 0] : [255 * t / i, 255 * e / i, 255 * r / i, i];
        }
      }], [{
        key: "parse",
        value: function parse(t) {
          if (!t) return;
          if (t instanceof le) return t;
          if ("string" != typeof t) return;
          var e = oe(t);
          return e ? new le(e[0] / 255 * e[3], e[1] / 255 * e[3], e[2] / 255 * e[3], e[3]) : void 0;
        }
      }]);

      return le;
    }();

    le.black = new le(0, 0, 0, 1), le.white = new le(1, 1, 1, 1), le.transparent = new le(0, 0, 0, 0), le.red = new le(1, 0, 0, 1), le.blue = new le(0, 0, 1, 1);

    var ue = /*#__PURE__*/function () {
      function ue(t, e, r) {
        _classCallCheck(this, ue);

        this.sensitivity = t ? e ? "variant" : "case" : e ? "accent" : "base", this.locale = r, this.collator = new Intl.Collator(this.locale ? this.locale : [], {
          sensitivity: this.sensitivity,
          usage: "search"
        });
      }

      _createClass(ue, [{
        key: "compare",
        value: function compare(t, e) {
          return this.collator.compare(t, e);
        }
      }, {
        key: "resolvedLocale",
        value: function resolvedLocale() {
          return new Intl.Collator(this.locale ? this.locale : []).resolvedOptions().locale;
        }
      }]);

      return ue;
    }();

    var ce = function ce(t, e, r, i, n) {
      _classCallCheck(this, ce);

      this.text = t, this.image = e, this.scale = r, this.fontStack = i, this.textColor = n;
    };

    var he = /*#__PURE__*/function () {
      function he(t) {
        _classCallCheck(this, he);

        this.sections = t;
      }

      _createClass(he, [{
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.sections.length || !this.sections.some(function (t) {
            return 0 !== t.text.length || t.image && 0 !== t.image.name.length;
          });
        }
      }, {
        key: "toString",
        value: function toString() {
          return 0 === this.sections.length ? "" : this.sections.map(function (t) {
            return t.text;
          }).join("");
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["format"];

          for (var _e13 of this.sections) {
            if (_e13.image) {
              t.push(["image", _e13.image.name]);
              continue;
            }

            t.push(_e13.text);
            var _r14 = {};
            _e13.fontStack && (_r14["text-font"] = ["literal", _e13.fontStack.split(",")]), _e13.scale && (_r14["font-scale"] = _e13.scale), _e13.textColor && (_r14["text-color"] = ["rgba"].concat(_e13.textColor.toArray())), t.push(_r14);
          }

          return t;
        }
      }], [{
        key: "fromString",
        value: function fromString(t) {
          return new he([new ce(t, null, null, null, null)]);
        }
      }, {
        key: "factory",
        value: function factory(t) {
          return t instanceof he ? t : he.fromString(t);
        }
      }]);

      return he;
    }();

    var pe = /*#__PURE__*/function () {
      function pe(t) {
        _classCallCheck(this, pe);

        this.name = t.name, this.available = t.available;
      }

      _createClass(pe, [{
        key: "toString",
        value: function toString() {
          return this.name;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["image", this.name];
        }
      }], [{
        key: "fromString",
        value: function fromString(t) {
          return t ? new pe({
            name: t,
            available: !1
          }) : null;
        }
      }]);

      return pe;
    }();

    function de(t, e, r, i) {
      return "number" == typeof t && t >= 0 && t <= 255 && "number" == typeof e && e >= 0 && e <= 255 && "number" == typeof r && r >= 0 && r <= 255 ? void 0 === i || "number" == typeof i && i >= 0 && i <= 1 ? null : "Invalid rgba value [".concat([t, e, r, i].join(", "), "]: 'a' must be between 0 and 1.") : "Invalid rgba value [".concat(("number" == typeof i ? [t, e, r, i] : [t, e, r]).join(", "), "]: 'r', 'g', and 'b' must be between 0 and 255.");
    }

    function fe(t) {
      if (null === t) return !0;
      if ("string" == typeof t) return !0;
      if ("boolean" == typeof t) return !0;
      if ("number" == typeof t) return !0;
      if (t instanceof le) return !0;
      if (t instanceof ue) return !0;
      if (t instanceof he) return !0;
      if (t instanceof pe) return !0;

      if (Array.isArray(t)) {
        for (var _e14 of t) {
          if (!fe(_e14)) return !1;
        }

        return !0;
      }

      if ("object" == _typeof(t)) {
        for (var _e15 in t) {
          if (!fe(t[_e15])) return !1;
        }

        return !0;
      }

      return !1;
    }

    function ye(t) {
      if (null === t) return jt;
      if ("string" == typeof t) return Zt;
      if ("boolean" == typeof t) return Xt;
      if ("number" == typeof t) return Gt;
      if (t instanceof le) return Kt;
      if (t instanceof ue) return Wt;
      if (t instanceof he) return Jt;
      if (t instanceof pe) return Qt;

      if (Array.isArray(t)) {
        var _e16 = t.length;

        var _r15;

        for (var _e17 of t) {
          var _t10 = ye(_e17);

          if (_r15) {
            if (_r15 === _t10) continue;
            _r15 = Yt;
            break;
          }

          _r15 = _t10;
        }

        return te(_r15 || Yt, _e16);
      }

      return Ht;
    }

    function me(t) {
      var e = _typeof(t);

      return null === t ? "" : "string" === e || "number" === e || "boolean" === e ? String(t) : t instanceof le || t instanceof he || t instanceof pe ? t.toString() : JSON.stringify(t);
    }

    var ge = /*#__PURE__*/function () {
      function ge(t, e) {
        _classCallCheck(this, ge);

        this.type = t, this.value = e;
      }

      _createClass(ge, [{
        key: "evaluate",
        value: function evaluate() {
          return this.value;
        }
      }, {
        key: "eachChild",
        value: function eachChild() {}
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !0;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return "array" === this.type.kind || "object" === this.type.kind ? ["literal", this.value] : this.value instanceof le ? ["rgba"].concat(this.value.toArray()) : this.value instanceof he ? this.value.serialize() : this.value;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length) return e.error("'literal' expression requires exactly one argument, but found ".concat(t.length - 1, " instead."));
          if (!fe(t[1])) return e.error("invalid value");
          var r = t[1];
          var i = ye(r);
          var n = e.expectedType;
          return "array" !== i.kind || 0 !== i.N || !n || "array" !== n.kind || "number" == typeof n.N && 0 !== n.N || (i = n), new ge(i, r);
        }
      }]);

      return ge;
    }();

    var xe = /*#__PURE__*/function () {
      function xe(t) {
        _classCallCheck(this, xe);

        this.name = "ExpressionEvaluationError", this.message = t;
      }

      _createClass(xe, [{
        key: "toJSON",
        value: function toJSON() {
          return this.message;
        }
      }]);

      return xe;
    }();

    var ve = {
      string: Zt,
      number: Gt,
      boolean: Xt,
      object: Ht
    };

    var be = /*#__PURE__*/function () {
      function be(t, e) {
        _classCallCheck(this, be);

        this.type = t, this.args = e;
      }

      _createClass(be, [{
        key: "evaluate",
        value: function evaluate(t) {
          for (var _e18 = 0; _e18 < this.args.length; _e18++) {
            var _r16 = this.args[_e18].evaluate(t);

            if (!ie(this.type, ye(_r16))) return _r16;
            if (_e18 === this.args.length - 1) throw new xe("Expected value to be of type ".concat(ee(this.type), ", but found ").concat(ee(ye(_r16)), " instead."));
          }

          return null;
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          this.args.forEach(t);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.args.every(function (t) {
            return t.outputDefined();
          });
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = this.type,
              e = [t.kind];

          if ("array" === t.kind) {
            var _r17 = t.itemType;

            if ("string" === _r17.kind || "number" === _r17.kind || "boolean" === _r17.kind) {
              e.push(_r17.kind);
              var _i8 = t.N;
              ("number" == typeof _i8 || this.args.length > 1) && e.push(_i8);
            }
          }

          return e.concat(this.args.map(function (t) {
            return t.serialize();
          }));
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 2) return e.error("Expected at least one argument.");
          var r,
              i = 1;
          var n = t[0];

          if ("array" === n) {
            var _n6, _s3;

            if (t.length > 2) {
              var _r18 = t[1];
              if ("string" != typeof _r18 || !(_r18 in ve) || "object" === _r18) return e.error('The item type argument of "array" must be one of string, number, boolean', 1);
              _n6 = ve[_r18], i++;
            } else _n6 = Yt;

            if (t.length > 3) {
              if (null !== t[2] && ("number" != typeof t[2] || t[2] < 0 || t[2] !== Math.floor(t[2]))) return e.error('The length argument to "array" must be a positive integer literal', 2);
              _s3 = t[2], i++;
            }

            r = te(_n6, _s3);
          } else r = ve[n];

          var s = [];

          for (; i < t.length; i++) {
            var _r19 = e.parse(t[i], i, Yt);

            if (!_r19) return null;
            s.push(_r19);
          }

          return new be(r, s);
        }
      }]);

      return be;
    }();

    var we = /*#__PURE__*/function () {
      function we(t) {
        _classCallCheck(this, we);

        this.type = Jt, this.sections = t;
      }

      _createClass(we, [{
        key: "evaluate",
        value: function evaluate(t) {
          return new he(this.sections.map(function (e) {
            var r = e.content.evaluate(t);
            return ye(r) === Qt ? new ce("", r, null, null, null) : new ce(me(r), null, e.scale ? e.scale.evaluate(t) : null, e.font ? e.font.evaluate(t).join(",") : null, e.textColor ? e.textColor.evaluate(t) : null);
          }));
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          for (var _e19 of this.sections) {
            t(_e19.content), _e19.scale && t(_e19.scale), _e19.font && t(_e19.font), _e19.textColor && t(_e19.textColor);
          }
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["format"];

          for (var _e20 of this.sections) {
            t.push(_e20.content.serialize());
            var _r20 = {};
            _e20.scale && (_r20["font-scale"] = _e20.scale.serialize()), _e20.font && (_r20["text-font"] = _e20.font.serialize()), _e20.textColor && (_r20["text-color"] = _e20.textColor.serialize()), t.push(_r20);
          }

          return t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 2) return e.error("Expected at least one argument.");
          var r = t[1];
          if (!Array.isArray(r) && "object" == _typeof(r)) return e.error("First argument must be an image or text section.");
          var i = [];
          var n = !1;

          for (var _r21 = 1; _r21 <= t.length - 1; ++_r21) {
            var _s4 = t[_r21];

            if (n && "object" == _typeof(_s4) && !Array.isArray(_s4)) {
              n = !1;
              var _t11 = null;
              if (_s4["font-scale"] && (_t11 = e.parse(_s4["font-scale"], 1, Gt), !_t11)) return null;
              var _r22 = null;
              if (_s4["text-font"] && (_r22 = e.parse(_s4["text-font"], 1, te(Zt)), !_r22)) return null;
              var _a3 = null;
              if (_s4["text-color"] && (_a3 = e.parse(_s4["text-color"], 1, Kt), !_a3)) return null;
              var _o2 = i[i.length - 1];
              _o2.scale = _t11, _o2.font = _r22, _o2.textColor = _a3;
            } else {
              var _s5 = e.parse(t[_r21], 1, Yt);

              if (!_s5) return null;
              var _a4 = _s5.type.kind;
              if ("string" !== _a4 && "value" !== _a4 && "null" !== _a4 && "resolvedImage" !== _a4) return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");
              n = !0, i.push({
                content: _s5,
                scale: null,
                font: null,
                textColor: null
              });
            }
          }

          return new we(i);
        }
      }]);

      return we;
    }();

    var _e = /*#__PURE__*/function () {
      function _e(t) {
        _classCallCheck(this, _e);

        this.type = Qt, this.input = t;
      }

      _createClass(_e, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.input.evaluate(t),
              r = pe.fromString(e);
          return r && t.availableImages && (r.available = t.availableImages.indexOf(e) > -1), r;
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["image", this.input.serialize()];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length) return e.error("Expected two arguments.");
          var r = e.parse(t[1], 1, Zt);
          return r ? new _e(r) : e.error("No image name provided.");
        }
      }]);

      return _e;
    }();

    var ke = {
      "to-boolean": Xt,
      "to-color": Kt,
      "to-number": Gt,
      "to-string": Zt
    };

    var Ae = /*#__PURE__*/function () {
      function Ae(t, e) {
        _classCallCheck(this, Ae);

        this.type = t, this.args = e;
      }

      _createClass(Ae, [{
        key: "evaluate",
        value: function evaluate(t) {
          if ("boolean" === this.type.kind) return Boolean(this.args[0].evaluate(t));

          if ("color" === this.type.kind) {
            var _e21, _r23;

            for (var _i9 of this.args) {
              if (_e21 = _i9.evaluate(t), _r23 = null, _e21 instanceof le) return _e21;

              if ("string" == typeof _e21) {
                var _r24 = t.parseColor(_e21);

                if (_r24) return _r24;
              } else if (Array.isArray(_e21) && (_r23 = _e21.length < 3 || _e21.length > 4 ? "Invalid rbga value ".concat(JSON.stringify(_e21), ": expected an array containing either three or four numeric values.") : de(_e21[0], _e21[1], _e21[2], _e21[3]), !_r23)) return new le(_e21[0] / 255, _e21[1] / 255, _e21[2] / 255, _e21[3]);
            }

            throw new xe(_r23 || "Could not parse color from value '".concat("string" == typeof _e21 ? _e21 : String(JSON.stringify(_e21)), "'"));
          }

          if ("number" === this.type.kind) {
            var _e22 = null;

            for (var _r25 of this.args) {
              if (_e22 = _r25.evaluate(t), null === _e22) return 0;

              var _i10 = Number(_e22);

              if (!isNaN(_i10)) return _i10;
            }

            throw new xe("Could not convert ".concat(JSON.stringify(_e22), " to number."));
          }

          return "formatted" === this.type.kind ? he.fromString(me(this.args[0].evaluate(t))) : "resolvedImage" === this.type.kind ? pe.fromString(me(this.args[0].evaluate(t))) : me(this.args[0].evaluate(t));
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          this.args.forEach(t);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.args.every(function (t) {
            return t.outputDefined();
          });
        }
      }, {
        key: "serialize",
        value: function serialize() {
          if ("formatted" === this.type.kind) return new we([{
            content: this.args[0],
            scale: null,
            font: null,
            textColor: null
          }]).serialize();
          if ("resolvedImage" === this.type.kind) return new _e(this.args[0]).serialize();
          var t = ["to-".concat(this.type.kind)];
          return this.eachChild(function (e) {
            t.push(e.serialize());
          }), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 2) return e.error("Expected at least one argument.");
          var r = t[0];
          if (("to-boolean" === r || "to-string" === r) && 2 !== t.length) return e.error("Expected one argument.");
          var i = ke[r],
              n = [];

          for (var _r26 = 1; _r26 < t.length; _r26++) {
            var _i11 = e.parse(t[_r26], _r26, Yt);

            if (!_i11) return null;
            n.push(_i11);
          }

          return new Ae(i, n);
        }
      }]);

      return Ae;
    }();

    var Se = ["Unknown", "Point", "LineString", "Polygon"];

    var Ie = /*#__PURE__*/function () {
      function Ie() {
        _classCallCheck(this, Ie);

        this.globals = null, this.feature = null, this.featureState = null, this.formattedSection = null, this._parseColorCache = {}, this.availableImages = null, this.canonical = null;
      }

      _createClass(Ie, [{
        key: "id",
        value: function id() {
          return this.feature && "id" in this.feature ? this.feature.id : null;
        }
      }, {
        key: "geometryType",
        value: function geometryType() {
          return this.feature ? "number" == typeof this.feature.type ? Se[this.feature.type] : this.feature.type : null;
        }
      }, {
        key: "geometry",
        value: function geometry() {
          return this.feature && "geometry" in this.feature ? this.feature.geometry : null;
        }
      }, {
        key: "canonicalID",
        value: function canonicalID() {
          return this.canonical;
        }
      }, {
        key: "properties",
        value: function properties() {
          return this.feature && this.feature.properties || {};
        }
      }, {
        key: "parseColor",
        value: function parseColor(t) {
          var e = this._parseColorCache[t];
          return e || (e = this._parseColorCache[t] = le.parse(t)), e;
        }
      }]);

      return Ie;
    }();

    var Te = /*#__PURE__*/function () {
      function Te(t, e, r, i) {
        _classCallCheck(this, Te);

        this.name = t, this.type = e, this._evaluate = r, this.args = i;
      }

      _createClass(Te, [{
        key: "evaluate",
        value: function evaluate(t) {
          return this._evaluate(t, this.args);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          this.args.forEach(t);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return [this.name].concat(this.args.map(function (t) {
            return t.serialize();
          }));
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          var _e$errors;

          var r = t[0],
              i = Te.definitions[r];
          if (!i) return e.error("Unknown expression \"".concat(r, "\". If you wanted a literal array, use [\"literal\", [...]]."), 0);
          var n = Array.isArray(i) ? i[0] : i.type,
              s = Array.isArray(i) ? [[i[1], i[2]]] : i.overloads,
              a = s.filter(function (_ref) {
            var [e] = _ref;
            return !Array.isArray(e) || e.length === t.length - 1;
          });
          var o = null;

          for (var [_i12, _s6] of a) {
            o = new He(e.registry, e.path, null, e.scope);
            var _a5 = [];

            var _l2 = !1;

            for (var _e23 = 1; _e23 < t.length; _e23++) {
              var _r27 = t[_e23],
                  _n7 = Array.isArray(_i12) ? _i12[_e23 - 1] : _i12.type,
                  _s7 = o.parse(_r27, 1 + _a5.length, _n7);

              if (!_s7) {
                _l2 = !0;
                break;
              }

              _a5.push(_s7);
            }

            if (!_l2) if (Array.isArray(_i12) && _i12.length !== _a5.length) o.error("Expected ".concat(_i12.length, " arguments, but found ").concat(_a5.length, " instead."));else {
              for (var _t12 = 0; _t12 < _a5.length; _t12++) {
                var _e24 = Array.isArray(_i12) ? _i12[_t12] : _i12.type,
                    _r28 = _a5[_t12];

                o.concat(_t12 + 1).checkSubtype(_e24, _r28.type);
              }

              if (0 === o.errors.length) return new Te(r, n, _s6, _a5);
            }
          }

          if (1 === a.length) (_e$errors = e.errors).push.apply(_e$errors, _toConsumableArray(o.errors));else {
            var _r29 = (a.length ? a : s).map(function (_ref2) {
              var [t] = _ref2;
              return e = t, Array.isArray(e) ? "(".concat(e.map(ee).join(", "), ")") : "(".concat(ee(e.type), "...)");
              var e;
            }).join(" | "),
                _i13 = [];

            for (var _r30 = 1; _r30 < t.length; _r30++) {
              var _n8 = e.parse(t[_r30], 1 + _i13.length);

              if (!_n8) return null;

              _i13.push(ee(_n8.type));
            }

            e.error("Expected arguments of type ".concat(_r29, ", but found (").concat(_i13.join(", "), ") instead."));
          }
          return null;
        }
      }, {
        key: "register",
        value: function register(t, e) {
          Te.definitions = e;

          for (var _r31 in e) {
            t[_r31] = Te;
          }
        }
      }]);

      return Te;
    }();

    var ze = /*#__PURE__*/function () {
      function ze(t, e, r) {
        _classCallCheck(this, ze);

        this.type = Wt, this.locale = r, this.caseSensitive = t, this.diacriticSensitive = e;
      }

      _createClass(ze, [{
        key: "evaluate",
        value: function evaluate(t) {
          return new ue(this.caseSensitive.evaluate(t), this.diacriticSensitive.evaluate(t), this.locale ? this.locale.evaluate(t) : null);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.caseSensitive), t(this.diacriticSensitive), this.locale && t(this.locale);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {};
          return t["case-sensitive"] = this.caseSensitive.serialize(), t["diacritic-sensitive"] = this.diacriticSensitive.serialize(), this.locale && (t.locale = this.locale.serialize()), ["collator", t];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length) return e.error("Expected one argument.");
          var r = t[1];
          if ("object" != _typeof(r) || Array.isArray(r)) return e.error("Collator options argument must be an object.");
          var i = e.parse(void 0 !== r["case-sensitive"] && r["case-sensitive"], 1, Xt);
          if (!i) return null;
          var n = e.parse(void 0 !== r["diacritic-sensitive"] && r["diacritic-sensitive"], 1, Xt);
          if (!n) return null;
          var s = null;
          return r.locale && (s = e.parse(r.locale, 1, Zt), !s) ? null : new ze(i, n, s);
        }
      }]);

      return ze;
    }();

    function Ee(t, e) {
      t[0] = Math.min(t[0], e[0]), t[1] = Math.min(t[1], e[1]), t[2] = Math.max(t[2], e[0]), t[3] = Math.max(t[3], e[1]);
    }

    function Me(t, e) {
      return !(t[0] <= e[0] || t[2] >= e[2] || t[1] <= e[1] || t[3] >= e[3]);
    }

    function Be(t, e) {
      var r = (180 + t[0]) / 360,
          i = (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t[1] * Math.PI / 360))) / 360,
          n = Math.pow(2, e.z);
      return [Math.round(r * n * 8192), Math.round(i * n * 8192)];
    }

    function De(t, e, r) {
      var i = t[0] - e[0],
          n = t[1] - e[1],
          s = t[0] - r[0],
          a = t[1] - r[1];
      return i * a - s * n == 0 && i * s <= 0 && n * a <= 0;
    }

    function Ce(t, e) {
      var r = !1;

      for (var _a6 = 0, _o3 = e.length; _a6 < _o3; _a6++) {
        var _o4 = e[_a6];

        for (var _e25 = 0, _a7 = _o4.length; _e25 < _a7 - 1; _e25++) {
          if (De(t, _o4[_e25], _o4[_e25 + 1])) return !1;
          (n = _o4[_e25])[1] > (i = t)[1] != (s = _o4[_e25 + 1])[1] > i[1] && i[0] < (s[0] - n[0]) * (i[1] - n[1]) / (s[1] - n[1]) + n[0] && (r = !r);
        }
      }

      var i, n, s;
      return r;
    }

    function Pe(t, e) {
      for (var _r32 = 0; _r32 < e.length; _r32++) {
        if (Ce(t, e[_r32])) return !0;
      }

      return !1;
    }

    function Ve(t, e, r, i) {
      var n = i[0] - r[0],
          s = i[1] - r[1],
          a = (t[0] - r[0]) * s - n * (t[1] - r[1]),
          o = (e[0] - r[0]) * s - n * (e[1] - r[1]);
      return a > 0 && o < 0 || a < 0 && o > 0;
    }

    function Fe(t, e, r) {
      for (var _u2 of r) {
        for (var _r33 = 0; _r33 < _u2.length - 1; ++_r33) {
          if (0 != (o = [(a = _u2[_r33 + 1])[0] - (s = _u2[_r33])[0], a[1] - s[1]])[0] * (l = [(n = e)[0] - (i = t)[0], n[1] - i[1]])[1] - o[1] * l[0] && Ve(i, n, s, a) && Ve(s, a, i, n)) return !0;
        }
      }

      var i, n, s, a, o, l;
      return !1;
    }

    function Re(t, e) {
      for (var _r34 = 0; _r34 < t.length; ++_r34) {
        if (!Ce(t[_r34], e)) return !1;
      }

      for (var _r35 = 0; _r35 < t.length - 1; ++_r35) {
        if (Fe(t[_r35], t[_r35 + 1], e)) return !1;
      }

      return !0;
    }

    function Le(t, e) {
      for (var _r36 = 0; _r36 < e.length; _r36++) {
        if (Re(t, e[_r36])) return !0;
      }

      return !1;
    }

    function Ue(t, e, r) {
      var i = [];

      for (var _n9 = 0; _n9 < t.length; _n9++) {
        var _s8 = [];

        for (var _i14 = 0; _i14 < t[_n9].length; _i14++) {
          var _a8 = Be(t[_n9][_i14], r);

          Ee(e, _a8), _s8.push(_a8);
        }

        i.push(_s8);
      }

      return i;
    }

    function Oe(t, e, r) {
      var i = [];

      for (var _n10 = 0; _n10 < t.length; _n10++) {
        var _s9 = Ue(t[_n10], e, r);

        i.push(_s9);
      }

      return i;
    }

    function $e(t, e, r, i) {
      if (t[0] < r[0] || t[0] > r[2]) {
        var _e26 = .5 * i;

        var _n11 = t[0] - r[0] > _e26 ? -i : r[0] - t[0] > _e26 ? i : 0;

        0 === _n11 && (_n11 = t[0] - r[2] > _e26 ? -i : r[2] - t[0] > _e26 ? i : 0), t[0] += _n11;
      }

      Ee(e, t);
    }

    function qe(t, e, r, i) {
      var n = 8192 * Math.pow(2, i.z),
          s = [8192 * i.x, 8192 * i.y],
          a = [];

      for (var _i15 of t) {
        for (var _t13 of _i15) {
          var _i16 = [_t13.x + s[0], _t13.y + s[1]];
          $e(_i16, e, r, n), a.push(_i16);
        }
      }

      return a;
    }

    function Ne(t, e, r, i) {
      var n = 8192 * Math.pow(2, i.z),
          s = [8192 * i.x, 8192 * i.y],
          a = [];

      for (var _r37 of t) {
        var _t14 = [];

        for (var _i17 of _r37) {
          var _r38 = [_i17.x + s[0], _i17.y + s[1]];
          Ee(e, _r38), _t14.push(_r38);
        }

        a.push(_t14);
      }

      if (e[2] - e[0] <= n / 2) {
        (o = e)[0] = o[1] = 1 / 0, o[2] = o[3] = -1 / 0;

        for (var _t15 of a) {
          for (var _i18 of _t15) {
            $e(_i18, e, r, n);
          }
        }
      }

      var o;
      return a;
    }

    var je = /*#__PURE__*/function () {
      function je(t, e) {
        _classCallCheck(this, je);

        this.type = Xt, this.geojson = t, this.geometries = e;
      }

      _createClass(je, [{
        key: "evaluate",
        value: function evaluate(t) {
          if (null != t.geometry() && null != t.canonicalID()) {
            if ("Point" === t.geometryType()) return function (t, e) {
              var r = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                  i = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                  n = t.canonicalID();

              if ("Polygon" === e.type) {
                var _s10 = Ue(e.coordinates, i, n),
                    _a9 = qe(t.geometry(), r, i, n);

                if (!Me(r, i)) return !1;

                for (var _t16 of _a9) {
                  if (!Ce(_t16, _s10)) return !1;
                }
              }

              if ("MultiPolygon" === e.type) {
                var _s11 = Oe(e.coordinates, i, n),
                    _a10 = qe(t.geometry(), r, i, n);

                if (!Me(r, i)) return !1;

                for (var _t17 of _a10) {
                  if (!Pe(_t17, _s11)) return !1;
                }
              }

              return !0;
            }(t, this.geometries);
            if ("LineString" === t.geometryType()) return function (t, e) {
              var r = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                  i = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                  n = t.canonicalID();

              if ("Polygon" === e.type) {
                var _s12 = Ue(e.coordinates, i, n),
                    _a11 = Ne(t.geometry(), r, i, n);

                if (!Me(r, i)) return !1;

                for (var _t18 of _a11) {
                  if (!Re(_t18, _s12)) return !1;
                }
              }

              if ("MultiPolygon" === e.type) {
                var _s13 = Oe(e.coordinates, i, n),
                    _a12 = Ne(t.geometry(), r, i, n);

                if (!Me(r, i)) return !1;

                for (var _t19 of _a12) {
                  if (!Le(_t19, _s13)) return !1;
                }
              }

              return !0;
            }(t, this.geometries);
          }

          return !1;
        }
      }, {
        key: "eachChild",
        value: function eachChild() {}
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !0;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["within", this.geojson];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length) return e.error("'within' expression requires exactly one argument, but found ".concat(t.length - 1, " instead."));

          if (fe(t[1])) {
            var _e27 = t[1];
            if ("FeatureCollection" === _e27.type) for (var _t20 = 0; _t20 < _e27.features.length; ++_t20) {
              var _r39 = _e27.features[_t20].geometry.type;
              if ("Polygon" === _r39 || "MultiPolygon" === _r39) return new je(_e27, _e27.features[_t20].geometry);
            } else if ("Feature" === _e27.type) {
              var _t21 = _e27.geometry.type;
              if ("Polygon" === _t21 || "MultiPolygon" === _t21) return new je(_e27, _e27.geometry);
            } else if ("Polygon" === _e27.type || "MultiPolygon" === _e27.type) return new je(_e27, _e27);
          }

          return e.error("'within' expression requires valid geojson object that contains polygon geometry type.");
        }
      }]);

      return je;
    }();

    function Ge(t) {
      if (t instanceof Te) {
        if ("get" === t.name && 1 === t.args.length) return !1;
        if ("feature-state" === t.name) return !1;
        if ("has" === t.name && 1 === t.args.length) return !1;
        if ("properties" === t.name || "geometry-type" === t.name || "id" === t.name) return !1;
        if (/^filter-/.test(t.name)) return !1;
      }

      if (t instanceof je) return !1;
      var e = !0;
      return t.eachChild(function (t) {
        e && !Ge(t) && (e = !1);
      }), e;
    }

    function Ze(t) {
      if (t instanceof Te && "feature-state" === t.name) return !1;
      var e = !0;
      return t.eachChild(function (t) {
        e && !Ze(t) && (e = !1);
      }), e;
    }

    function Xe(t, e) {
      if (t instanceof Te && e.indexOf(t.name) >= 0) return !1;
      var r = !0;
      return t.eachChild(function (t) {
        r && !Xe(t, e) && (r = !1);
      }), r;
    }

    var Ke = /*#__PURE__*/function () {
      function Ke(t, e) {
        _classCallCheck(this, Ke);

        this.type = e.type, this.name = t, this.boundExpression = e;
      }

      _createClass(Ke, [{
        key: "evaluate",
        value: function evaluate(t) {
          return this.boundExpression.evaluate(t);
        }
      }, {
        key: "eachChild",
        value: function eachChild() {}
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["var", this.name];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length || "string" != typeof t[1]) return e.error("'var' expression requires exactly one string literal argument.");
          var r = t[1];
          return e.scope.has(r) ? new Ke(r, e.scope.get(r)) : e.error("Unknown variable \"".concat(r, "\". Make sure \"").concat(r, "\" has been bound in an enclosing \"let\" expression before using it."), 1);
        }
      }]);

      return Ke;
    }();

    var He = /*#__PURE__*/function () {
      function He(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
        var r = arguments.length > 2 ? arguments[2] : undefined;
        var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new Nt();
        var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];

        _classCallCheck(this, He);

        this.registry = t, this.path = e, this.key = e.map(function (t) {
          return "[".concat(t, "]");
        }).join(""), this.scope = i, this.errors = n, this.expectedType = r;
      }

      _createClass(He, [{
        key: "parse",
        value: function parse(t, e, r, i) {
          var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
          return e ? this.concat(e, r, i)._parse(t, n) : this._parse(t, n);
        }
      }, {
        key: "_parse",
        value: function _parse(t, e) {
          function r(t, e, r) {
            return "assert" === r ? new be(e, [t]) : "coerce" === r ? new Ae(e, [t]) : t;
          }

          if (null !== t && "string" != typeof t && "boolean" != typeof t && "number" != typeof t || (t = ["literal", t]), Array.isArray(t)) {
            if (0 === t.length) return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');
            var _i19 = t[0];
            if ("string" != typeof _i19) return this.error("Expression name must be a string, but found ".concat(_typeof(_i19), " instead. If you wanted a literal array, use [\"literal\", [...]]."), 0), null;
            var _n12 = this.registry[_i19];

            if (_n12) {
              var _i20 = _n12.parse(t, this);

              if (!_i20) return null;

              if (this.expectedType) {
                var _t22 = this.expectedType,
                    _n13 = _i20.type;
                if ("string" !== _t22.kind && "number" !== _t22.kind && "boolean" !== _t22.kind && "object" !== _t22.kind && "array" !== _t22.kind || "value" !== _n13.kind) {
                  if ("color" !== _t22.kind && "formatted" !== _t22.kind && "resolvedImage" !== _t22.kind || "value" !== _n13.kind && "string" !== _n13.kind) {
                    if (this.checkSubtype(_t22, _n13)) return null;
                  } else _i20 = r(_i20, _t22, e.typeAnnotation || "coerce");
                } else _i20 = r(_i20, _t22, e.typeAnnotation || "assert");
              }

              if (!(_i20 instanceof ge) && "resolvedImage" !== _i20.type.kind && function t(e) {
                if (e instanceof Ke) return t(e.boundExpression);
                if (e instanceof Te && "error" === e.name) return !1;
                if (e instanceof ze) return !1;
                if (e instanceof je) return !1;
                var r = e instanceof Ae || e instanceof be;
                var i = !0;
                return e.eachChild(function (e) {
                  i = r ? i && t(e) : i && e instanceof ge;
                }), !!i && Ge(e) && Xe(e, ["zoom", "heatmap-density", "line-progress", "sky-radial-progress", "accumulated", "is-supported-script"]);
              }(_i20)) {
                var _t23 = new Ie();

                try {
                  _i20 = new ge(_i20.type, _i20.evaluate(_t23));
                } catch (t) {
                  return this.error(t.message), null;
                }
              }

              return _i20;
            }

            return this.error("Unknown expression \"".concat(_i19, "\". If you wanted a literal array, use [\"literal\", [...]]."), 0);
          }

          return this.error(void 0 === t ? "'undefined' value invalid. Use null instead." : "object" == _typeof(t) ? 'Bare objects invalid. Use ["literal", {...}] instead.' : "Expected an array, but found ".concat(_typeof(t), " instead."));
        }
      }, {
        key: "concat",
        value: function concat(t, e, r) {
          var i = "number" == typeof t ? this.path.concat(t) : this.path,
              n = r ? this.scope.concat(r) : this.scope;
          return new He(this.registry, i, e || null, n, this.errors);
        }
      }, {
        key: "error",
        value: function error(t) {
          for (var _len3 = arguments.length, e = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
            e[_key3 - 1] = arguments[_key3];
          }

          var r = "".concat(this.key).concat(e.map(function (t) {
            return "[".concat(t, "]");
          }).join(""));
          this.errors.push(new qt(r, t));
        }
      }, {
        key: "checkSubtype",
        value: function checkSubtype(t, e) {
          var r = ie(t, e);
          return r && this.error(r), r;
        }
      }]);

      return He;
    }();

    function Ye(t, e) {
      var r = t.length - 1;
      var i,
          n,
          s = 0,
          a = r,
          o = 0;

      for (; s <= a;) {
        if (o = Math.floor((s + a) / 2), i = t[o], n = t[o + 1], i <= e) {
          if (o === r || e < n) return o;
          s = o + 1;
        } else {
          if (!(i > e)) throw new xe("Input is not a number.");
          a = o - 1;
        }
      }

      return 0;
    }

    var We = /*#__PURE__*/function () {
      function We(t, e, r) {
        _classCallCheck(this, We);

        this.type = t, this.input = e, this.labels = [], this.outputs = [];

        for (var [_t24, _e28] of r) {
          this.labels.push(_t24), this.outputs.push(_e28);
        }
      }

      _createClass(We, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.labels,
              r = this.outputs;
          if (1 === e.length) return r[0].evaluate(t);
          var i = this.input.evaluate(t);
          if (i <= e[0]) return r[0].evaluate(t);
          var n = e.length;
          return i >= e[n - 1] ? r[n - 1].evaluate(t) : r[Ye(e, i)].evaluate(t);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input);

          for (var _e29 of this.outputs) {
            t(_e29);
          }
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.outputs.every(function (t) {
            return t.outputDefined();
          });
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["step", this.input.serialize()];

          for (var _e30 = 0; _e30 < this.labels.length; _e30++) {
            _e30 > 0 && t.push(this.labels[_e30]), t.push(this.outputs[_e30].serialize());
          }

          return t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length - 1 < 4) return e.error("Expected at least 4 arguments, but found only ".concat(t.length - 1, "."));
          if ((t.length - 1) % 2 != 0) return e.error("Expected an even number of arguments.");
          var r = e.parse(t[1], 1, Gt);
          if (!r) return null;
          var i = [];
          var n = null;
          e.expectedType && "value" !== e.expectedType.kind && (n = e.expectedType);

          for (var _r40 = 1; _r40 < t.length; _r40 += 2) {
            var _s14 = 1 === _r40 ? -1 / 0 : t[_r40],
                _a13 = t[_r40 + 1],
                _o5 = _r40,
                _l3 = _r40 + 1;

            if ("number" != typeof _s14) return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.', _o5);
            if (i.length && i[i.length - 1][0] >= _s14) return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.', _o5);

            var _u3 = e.parse(_a13, _l3, n);

            if (!_u3) return null;
            n = n || _u3.type, i.push([_s14, _u3]);
          }

          return new We(n, r, i);
        }
      }]);

      return We;
    }();

    function Je(t, e, r) {
      return t * (1 - r) + e * r;
    }

    var Qe = Object.freeze({
      __proto__: null,
      number: Je,
      color: function (t, e, r) {
        return new le(Je(t.r, e.r, r), Je(t.g, e.g, r), Je(t.b, e.b, r), Je(t.a, e.a, r));
      },
      array: function (t, e, r) {
        return t.map(function (t, i) {
          return Je(t, e[i], r);
        });
      }
    });
    var tr = 6 / 29 * 3 * (6 / 29),
        er = Math.PI / 180,
        rr = 180 / Math.PI;

    function ir(t) {
      return t > .008856451679035631 ? Math.pow(t, 1 / 3) : t / tr + 4 / 29;
    }

    function nr(t) {
      return t > 6 / 29 ? t * t * t : tr * (t - 4 / 29);
    }

    function sr(t) {
      return 255 * (t <= .0031308 ? 12.92 * t : 1.055 * Math.pow(t, 1 / 2.4) - .055);
    }

    function ar(t) {
      return (t /= 255) <= .04045 ? t / 12.92 : Math.pow((t + .055) / 1.055, 2.4);
    }

    function or(t) {
      var e = ar(t.r),
          r = ar(t.g),
          i = ar(t.b),
          n = ir((.4124564 * e + .3575761 * r + .1804375 * i) / .95047),
          s = ir((.2126729 * e + .7151522 * r + .072175 * i) / 1);
      return {
        l: 116 * s - 16,
        a: 500 * (n - s),
        b: 200 * (s - ir((.0193339 * e + .119192 * r + .9503041 * i) / 1.08883)),
        alpha: t.a
      };
    }

    function lr(t) {
      var e = (t.l + 16) / 116,
          r = isNaN(t.a) ? e : e + t.a / 500,
          i = isNaN(t.b) ? e : e - t.b / 200;
      return e = 1 * nr(e), r = .95047 * nr(r), i = 1.08883 * nr(i), new le(sr(3.2404542 * r - 1.5371385 * e - .4985314 * i), sr(-.969266 * r + 1.8760108 * e + .041556 * i), sr(.0556434 * r - .2040259 * e + 1.0572252 * i), t.alpha);
    }

    function ur(t, e, r) {
      var i = e - t;
      return t + r * (i > 180 || i < -180 ? i - 360 * Math.round(i / 360) : i);
    }

    var cr = {
      forward: or,
      reverse: lr,
      interpolate: function (t, e, r) {
        return {
          l: Je(t.l, e.l, r),
          a: Je(t.a, e.a, r),
          b: Je(t.b, e.b, r),
          alpha: Je(t.alpha, e.alpha, r)
        };
      }
    },
        hr = {
      forward: function (t) {
        var {
          l: e,
          a: r,
          b: i
        } = or(t),
            n = Math.atan2(i, r) * rr;
        return {
          h: n < 0 ? n + 360 : n,
          c: Math.sqrt(r * r + i * i),
          l: e,
          alpha: t.a
        };
      },
      reverse: function (t) {
        var e = t.h * er,
            r = t.c;
        return lr({
          l: t.l,
          a: Math.cos(e) * r,
          b: Math.sin(e) * r,
          alpha: t.alpha
        });
      },
      interpolate: function (t, e, r) {
        return {
          h: ur(t.h, e.h, r),
          c: Je(t.c, e.c, r),
          l: Je(t.l, e.l, r),
          alpha: Je(t.alpha, e.alpha, r)
        };
      }
    };
    var pr = Object.freeze({
      __proto__: null,
      lab: cr,
      hcl: hr
    });

    var dr = /*#__PURE__*/function () {
      function dr(t, e, r, i, n) {
        _classCallCheck(this, dr);

        this.type = t, this.operator = e, this.interpolation = r, this.input = i, this.labels = [], this.outputs = [];

        for (var [_t25, _e31] of n) {
          this.labels.push(_t25), this.outputs.push(_e31);
        }
      }

      _createClass(dr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.labels,
              r = this.outputs;
          if (1 === e.length) return r[0].evaluate(t);
          var i = this.input.evaluate(t);
          if (i <= e[0]) return r[0].evaluate(t);
          var n = e.length;
          if (i >= e[n - 1]) return r[n - 1].evaluate(t);
          var s = Ye(e, i),
              a = dr.interpolationFactor(this.interpolation, i, e[s], e[s + 1]),
              o = r[s].evaluate(t),
              l = r[s + 1].evaluate(t);
          return "interpolate" === this.operator ? Qe[this.type.kind.toLowerCase()](o, l, a) : "interpolate-hcl" === this.operator ? hr.reverse(hr.interpolate(hr.forward(o), hr.forward(l), a)) : cr.reverse(cr.interpolate(cr.forward(o), cr.forward(l), a));
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input);

          for (var _e32 of this.outputs) {
            t(_e32);
          }
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.outputs.every(function (t) {
            return t.outputDefined();
          });
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t;
          t = "linear" === this.interpolation.name ? ["linear"] : "exponential" === this.interpolation.name ? 1 === this.interpolation.base ? ["linear"] : ["exponential", this.interpolation.base] : ["cubic-bezier"].concat(this.interpolation.controlPoints);
          var e = [this.operator, t, this.input.serialize()];

          for (var _t26 = 0; _t26 < this.labels.length; _t26++) {
            e.push(this.labels[_t26], this.outputs[_t26].serialize());
          }

          return e;
        }
      }], [{
        key: "interpolationFactor",
        value: function interpolationFactor(t, r, i, n) {
          var s = 0;
          if ("exponential" === t.name) s = fr(r, t.base, i, n);else if ("linear" === t.name) s = fr(r, 1, i, n);else if ("cubic-bezier" === t.name) {
            var _a14 = t.controlPoints;
            s = new e(_a14[0], _a14[1], _a14[2], _a14[3]).solve(fr(r, 1, i, n));
          }
          return s;
        }
      }, {
        key: "parse",
        value: function parse(t, e) {
          var [r, i, n, ...s] = t;
          if (!Array.isArray(i) || 0 === i.length) return e.error("Expected an interpolation type expression.", 1);
          if ("linear" === i[0]) i = {
            name: "linear"
          };else if ("exponential" === i[0]) {
            var _t27 = i[1];
            if ("number" != typeof _t27) return e.error("Exponential interpolation requires a numeric base.", 1, 1);
            i = {
              name: "exponential",
              base: _t27
            };
          } else {
            if ("cubic-bezier" !== i[0]) return e.error("Unknown interpolation type ".concat(String(i[0])), 1, 0);
            {
              var _t28 = i.slice(1);

              if (4 !== _t28.length || _t28.some(function (t) {
                return "number" != typeof t || t < 0 || t > 1;
              })) return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.", 1);
              i = {
                name: "cubic-bezier",
                controlPoints: _t28
              };
            }
          }
          if (t.length - 1 < 4) return e.error("Expected at least 4 arguments, but found only ".concat(t.length - 1, "."));
          if ((t.length - 1) % 2 != 0) return e.error("Expected an even number of arguments.");
          if (n = e.parse(n, 2, Gt), !n) return null;
          var a = [];
          var o = null;
          "interpolate-hcl" === r || "interpolate-lab" === r ? o = Kt : e.expectedType && "value" !== e.expectedType.kind && (o = e.expectedType);

          for (var _t29 = 0; _t29 < s.length; _t29 += 2) {
            var _r41 = s[_t29],
                _i21 = s[_t29 + 1],
                _n14 = _t29 + 3,
                _l4 = _t29 + 4;

            if ("number" != typeof _r41) return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.', _n14);
            if (a.length && a[a.length - 1][0] >= _r41) return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.', _n14);

            var _u4 = e.parse(_i21, _l4, o);

            if (!_u4) return null;
            o = o || _u4.type, a.push([_r41, _u4]);
          }

          return "number" === o.kind || "color" === o.kind || "array" === o.kind && "number" === o.itemType.kind && "number" == typeof o.N ? new dr(o, r, i, n, a) : e.error("Type ".concat(ee(o), " is not interpolatable."));
        }
      }]);

      return dr;
    }();

    function fr(t, e, r, i) {
      var n = i - r,
          s = t - r;
      return 0 === n ? 0 : 1 === e ? s / n : (Math.pow(e, s) - 1) / (Math.pow(e, n) - 1);
    }

    var yr = /*#__PURE__*/function () {
      function yr(t, e) {
        _classCallCheck(this, yr);

        this.type = t, this.args = e;
      }

      _createClass(yr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e,
              r = null,
              i = 0;

          for (var _n15 of this.args) {
            if (i++, r = _n15.evaluate(t), r && r instanceof pe && !r.available && (e || (e = r.name), r = null, i === this.args.length && (r = e)), null !== r) break;
          }

          return r;
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          this.args.forEach(t);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.args.every(function (t) {
            return t.outputDefined();
          });
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["coalesce"];
          return this.eachChild(function (e) {
            t.push(e.serialize());
          }), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 2) return e.error("Expectected at least one argument.");
          var r = null;
          var i = e.expectedType;
          i && "value" !== i.kind && (r = i);
          var n = [];

          for (var _i22 of t.slice(1)) {
            var _t30 = e.parse(_i22, 1 + n.length, r, void 0, {
              typeAnnotation: "omit"
            });

            if (!_t30) return null;
            r = r || _t30.type, n.push(_t30);
          }

          var s = i && n.some(function (t) {
            return ie(i, t.type);
          });
          return new yr(s ? Yt : r, n);
        }
      }]);

      return yr;
    }();

    var mr = /*#__PURE__*/function () {
      function mr(t, e) {
        _classCallCheck(this, mr);

        this.type = e.type, this.bindings = [].concat(t), this.result = e;
      }

      _createClass(mr, [{
        key: "evaluate",
        value: function evaluate(t) {
          return this.result.evaluate(t);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          for (var _e33 of this.bindings) {
            t(_e33[1]);
          }

          t(this.result);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.result.outputDefined();
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["let"];

          for (var [_e34, _r42] of this.bindings) {
            t.push(_e34, _r42.serialize());
          }

          return t.push(this.result.serialize()), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 4) return e.error("Expected at least 3 arguments, but found ".concat(t.length - 1, " instead."));
          var r = [];

          for (var _i23 = 1; _i23 < t.length - 1; _i23 += 2) {
            var _n16 = t[_i23];
            if ("string" != typeof _n16) return e.error("Expected string, but found ".concat(_typeof(_n16), " instead."), _i23);
            if (/[^a-zA-Z0-9_]/.test(_n16)) return e.error("Variable names must contain only alphanumeric characters or '_'.", _i23);

            var _s15 = e.parse(t[_i23 + 1], _i23 + 1);

            if (!_s15) return null;
            r.push([_n16, _s15]);
          }

          var i = e.parse(t[t.length - 1], t.length - 1, e.expectedType, r);
          return i ? new mr(r, i) : null;
        }
      }]);

      return mr;
    }();

    var gr = /*#__PURE__*/function () {
      function gr(t, e, r) {
        _classCallCheck(this, gr);

        this.type = t, this.index = e, this.input = r;
      }

      _createClass(gr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.index.evaluate(t),
              r = this.input.evaluate(t);
          if (e < 0) throw new xe("Array index out of bounds: ".concat(e, " < 0."));
          if (e >= r.length) throw new xe("Array index out of bounds: ".concat(e, " > ").concat(r.length - 1, "."));
          if (e !== Math.floor(e)) throw new xe("Array index must be an integer, but found ".concat(e, " instead."));
          return r[e];
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.index), t(this.input);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["at", this.index.serialize(), this.input.serialize()];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (3 !== t.length) return e.error("Expected 2 arguments, but found ".concat(t.length - 1, " instead."));
          var r = e.parse(t[1], 1, Gt),
              i = e.parse(t[2], 2, te(e.expectedType || Yt));
          return r && i ? new gr(i.type.itemType, r, i) : null;
        }
      }]);

      return gr;
    }();

    var xr = /*#__PURE__*/function () {
      function xr(t, e) {
        _classCallCheck(this, xr);

        this.type = Xt, this.needle = t, this.haystack = e;
      }

      _createClass(xr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.needle.evaluate(t),
              r = this.haystack.evaluate(t);
          if (!r) return !1;
          if (!se(e, ["boolean", "string", "number", "null"])) throw new xe("Expected first argument to be of type boolean, string, number or null, but found ".concat(ee(ye(e)), " instead."));
          if (!se(r, ["string", "array"])) throw new xe("Expected second argument to be of type array or string, but found ".concat(ee(ye(r)), " instead."));
          return r.indexOf(e) >= 0;
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.needle), t(this.haystack);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !0;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["in", this.needle.serialize(), this.haystack.serialize()];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (3 !== t.length) return e.error("Expected 2 arguments, but found ".concat(t.length - 1, " instead."));
          var r = e.parse(t[1], 1, Yt),
              i = e.parse(t[2], 2, Yt);
          return r && i ? ne(r.type, [Xt, Zt, Gt, jt, Yt]) ? new xr(r, i) : e.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(ee(r.type), " instead")) : null;
        }
      }]);

      return xr;
    }();

    var vr = /*#__PURE__*/function () {
      function vr(t, e, r) {
        _classCallCheck(this, vr);

        this.type = Gt, this.needle = t, this.haystack = e, this.fromIndex = r;
      }

      _createClass(vr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.needle.evaluate(t),
              r = this.haystack.evaluate(t);
          if (!se(e, ["boolean", "string", "number", "null"])) throw new xe("Expected first argument to be of type boolean, string, number or null, but found ".concat(ee(ye(e)), " instead."));
          if (!se(r, ["string", "array"])) throw new xe("Expected second argument to be of type array or string, but found ".concat(ee(ye(r)), " instead."));

          if (this.fromIndex) {
            var _i24 = this.fromIndex.evaluate(t);

            return r.indexOf(e, _i24);
          }

          return r.indexOf(e);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.needle), t(this.haystack), this.fromIndex && t(this.fromIndex);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          if (null != this.fromIndex && void 0 !== this.fromIndex) {
            var _t31 = this.fromIndex.serialize();

            return ["index-of", this.needle.serialize(), this.haystack.serialize(), _t31];
          }

          return ["index-of", this.needle.serialize(), this.haystack.serialize()];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length <= 2 || t.length >= 5) return e.error("Expected 3 or 4 arguments, but found ".concat(t.length - 1, " instead."));
          var r = e.parse(t[1], 1, Yt),
              i = e.parse(t[2], 2, Yt);
          if (!r || !i) return null;
          if (!ne(r.type, [Xt, Zt, Gt, jt, Yt])) return e.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(ee(r.type), " instead"));

          if (4 === t.length) {
            var _n17 = e.parse(t[3], 3, Gt);

            return _n17 ? new vr(r, i, _n17) : null;
          }

          return new vr(r, i);
        }
      }]);

      return vr;
    }();

    var br = /*#__PURE__*/function () {
      function br(t, e, r, i, n, s) {
        _classCallCheck(this, br);

        this.inputType = t, this.type = e, this.input = r, this.cases = i, this.outputs = n, this.otherwise = s;
      }

      _createClass(br, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.input.evaluate(t);
          return (ye(e) === this.inputType && this.outputs[this.cases[e]] || this.otherwise).evaluate(t);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input), this.outputs.forEach(t), t(this.otherwise);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.outputs.every(function (t) {
            return t.outputDefined();
          }) && this.otherwise.outputDefined();
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var _this12 = this;

          var t = ["match", this.input.serialize()],
              e = Object.keys(this.cases).sort(),
              r = [],
              i = {};

          for (var _t32 of e) {
            var _e35 = i[this.cases[_t32]];
            void 0 === _e35 ? (i[this.cases[_t32]] = r.length, r.push([this.cases[_t32], [_t32]])) : r[_e35][1].push(_t32);
          }

          var n = function (t) {
            return "number" === _this12.inputType.kind ? Number(t) : t;
          };

          for (var [_e36, _i25] of r) {
            t.push(1 === _i25.length ? n(_i25[0]) : _i25.map(n)), t.push(this.outputs[_e36].serialize());
          }

          return t.push(this.otherwise.serialize()), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 5) return e.error("Expected at least 4 arguments, but found only ".concat(t.length - 1, "."));
          if (t.length % 2 != 1) return e.error("Expected an even number of arguments.");
          var r, i;
          e.expectedType && "value" !== e.expectedType.kind && (i = e.expectedType);
          var n = {},
              s = [];

          for (var _a15 = 2; _a15 < t.length - 1; _a15 += 2) {
            var _o6 = t[_a15];
            var _l5 = t[_a15 + 1];
            Array.isArray(_o6) || (_o6 = [_o6]);

            var _u5 = e.concat(_a15);

            if (0 === _o6.length) return _u5.error("Expected at least one branch label.");

            for (var _t33 of _o6) {
              if ("number" != typeof _t33 && "string" != typeof _t33) return _u5.error("Branch labels must be numbers or strings.");
              if ("number" == typeof _t33 && Math.abs(_t33) > Number.MAX_SAFE_INTEGER) return _u5.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER, "."));
              if ("number" == typeof _t33 && Math.floor(_t33) !== _t33) return _u5.error("Numeric branch labels must be integer values.");

              if (r) {
                if (_u5.checkSubtype(r, ye(_t33))) return null;
              } else r = ye(_t33);

              if (void 0 !== n[String(_t33)]) return _u5.error("Branch labels must be unique.");
              n[String(_t33)] = s.length;
            }

            var _c2 = e.parse(_l5, _a15, i);

            if (!_c2) return null;
            i = i || _c2.type, s.push(_c2);
          }

          var a = e.parse(t[1], 1, Yt);
          if (!a) return null;
          var o = e.parse(t[t.length - 1], t.length - 1, i);
          return o ? "value" !== a.type.kind && e.concat(1).checkSubtype(r, a.type) ? null : new br(r, i, a, n, s, o) : null;
        }
      }]);

      return br;
    }();

    var wr = /*#__PURE__*/function () {
      function wr(t, e, r) {
        _classCallCheck(this, wr);

        this.type = t, this.branches = e, this.otherwise = r;
      }

      _createClass(wr, [{
        key: "evaluate",
        value: function evaluate(t) {
          for (var [_e37, _r43] of this.branches) {
            if (_e37.evaluate(t)) return _r43.evaluate(t);
          }

          return this.otherwise.evaluate(t);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          for (var [_e38, _r44] of this.branches) {
            t(_e38), t(_r44);
          }

          t(this.otherwise);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.branches.every(function (_ref3) {
            var [t, e] = _ref3;
            return e.outputDefined();
          }) && this.otherwise.outputDefined();
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["case"];
          return this.eachChild(function (e) {
            t.push(e.serialize());
          }), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 4) return e.error("Expected at least 3 arguments, but found only ".concat(t.length - 1, "."));
          if (t.length % 2 != 0) return e.error("Expected an odd number of arguments.");
          var r;
          e.expectedType && "value" !== e.expectedType.kind && (r = e.expectedType);
          var i = [];

          for (var _n18 = 1; _n18 < t.length - 1; _n18 += 2) {
            var _s16 = e.parse(t[_n18], _n18, Xt);

            if (!_s16) return null;

            var _a16 = e.parse(t[_n18 + 1], _n18 + 1, r);

            if (!_a16) return null;
            i.push([_s16, _a16]), r = r || _a16.type;
          }

          var n = e.parse(t[t.length - 1], t.length - 1, r);
          return n ? new wr(r, i, n) : null;
        }
      }]);

      return wr;
    }();

    var _r = /*#__PURE__*/function () {
      function _r(t, e, r, i) {
        _classCallCheck(this, _r);

        this.type = t, this.input = e, this.beginIndex = r, this.endIndex = i;
      }

      _createClass(_r, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.input.evaluate(t),
              r = this.beginIndex.evaluate(t);
          if (!se(e, ["string", "array"])) throw new xe("Expected first argument to be of type array or string, but found ".concat(ee(ye(e)), " instead."));

          if (this.endIndex) {
            var _i26 = this.endIndex.evaluate(t);

            return e.slice(r, _i26);
          }

          return e.slice(r);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input), t(this.beginIndex), this.endIndex && t(this.endIndex);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          if (null != this.endIndex && void 0 !== this.endIndex) {
            var _t34 = this.endIndex.serialize();

            return ["slice", this.input.serialize(), this.beginIndex.serialize(), _t34];
          }

          return ["slice", this.input.serialize(), this.beginIndex.serialize()];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length <= 2 || t.length >= 5) return e.error("Expected 3 or 4 arguments, but found ".concat(t.length - 1, " instead."));
          var r = e.parse(t[1], 1, Yt),
              i = e.parse(t[2], 2, Gt);
          if (!r || !i) return null;
          if (!ne(r.type, [te(Yt), Zt, Yt])) return e.error("Expected first argument to be of type array or string, but found ".concat(ee(r.type), " instead"));

          if (4 === t.length) {
            var _n19 = e.parse(t[3], 3, Gt);

            return _n19 ? new _r(r.type, r, i, _n19) : null;
          }

          return new _r(r.type, r, i);
        }
      }]);

      return _r;
    }();

    function kr(t, e) {
      return "==" === t || "!=" === t ? "boolean" === e.kind || "string" === e.kind || "number" === e.kind || "null" === e.kind || "value" === e.kind : "string" === e.kind || "number" === e.kind || "value" === e.kind;
    }

    function Ar(t, e, r, i) {
      return 0 === i.compare(e, r);
    }

    function Sr(t, e, r) {
      var i = "==" !== t && "!=" !== t;
      return /*#__PURE__*/function () {
        function n(t, e, r) {
          _classCallCheck(this, n);

          this.type = Xt, this.lhs = t, this.rhs = e, this.collator = r, this.hasUntypedArgument = "value" === t.type.kind || "value" === e.type.kind;
        }

        _createClass(n, [{
          key: "evaluate",
          value: function evaluate(_n20) {
            var s = this.lhs.evaluate(_n20),
                a = this.rhs.evaluate(_n20);

            if (i && this.hasUntypedArgument) {
              var _e39 = ye(s),
                  _r45 = ye(a);

              if (_e39.kind !== _r45.kind || "string" !== _e39.kind && "number" !== _e39.kind) throw new xe("Expected arguments for \"".concat(t, "\" to be (string, string) or (number, number), but found (").concat(_e39.kind, ", ").concat(_r45.kind, ") instead."));
            }

            if (this.collator && !i && this.hasUntypedArgument) {
              var _t35 = ye(s),
                  _r46 = ye(a);

              if ("string" !== _t35.kind || "string" !== _r46.kind) return e(_n20, s, a);
            }

            return this.collator ? r(_n20, s, a, this.collator.evaluate(_n20)) : e(_n20, s, a);
          }
        }, {
          key: "eachChild",
          value: function eachChild(t) {
            t(this.lhs), t(this.rhs), this.collator && t(this.collator);
          }
        }, {
          key: "outputDefined",
          value: function outputDefined() {
            return !0;
          }
        }, {
          key: "serialize",
          value: function serialize() {
            var e = [t];
            return this.eachChild(function (t) {
              e.push(t.serialize());
            }), e;
          }
        }], [{
          key: "parse",
          value: function parse(t, e) {
            if (3 !== t.length && 4 !== t.length) return e.error("Expected two or three arguments.");
            var r = t[0];
            var s = e.parse(t[1], 1, Yt);
            if (!s) return null;
            if (!kr(r, s.type)) return e.concat(1).error("\"".concat(r, "\" comparisons are not supported for type '").concat(ee(s.type), "'."));
            var a = e.parse(t[2], 2, Yt);
            if (!a) return null;
            if (!kr(r, a.type)) return e.concat(2).error("\"".concat(r, "\" comparisons are not supported for type '").concat(ee(a.type), "'."));
            if (s.type.kind !== a.type.kind && "value" !== s.type.kind && "value" !== a.type.kind) return e.error("Cannot compare types '".concat(ee(s.type), "' and '").concat(ee(a.type), "'."));
            i && ("value" === s.type.kind && "value" !== a.type.kind ? s = new be(a.type, [s]) : "value" !== s.type.kind && "value" === a.type.kind && (a = new be(s.type, [a])));
            var o = null;

            if (4 === t.length) {
              if ("string" !== s.type.kind && "string" !== a.type.kind && "value" !== s.type.kind && "value" !== a.type.kind) return e.error("Cannot use collator to compare non-string types.");
              if (o = e.parse(t[3], 3, Wt), !o) return null;
            }

            return new n(s, a, o);
          }
        }]);

        return n;
      }();
    }

    var Ir = Sr("==", function (t, e, r) {
      return e === r;
    }, Ar),
        Tr = Sr("!=", function (t, e, r) {
      return e !== r;
    }, function (t, e, r, i) {
      return !Ar(0, e, r, i);
    }),
        zr = Sr("<", function (t, e, r) {
      return e < r;
    }, function (t, e, r, i) {
      return i.compare(e, r) < 0;
    }),
        Er = Sr(">", function (t, e, r) {
      return e > r;
    }, function (t, e, r, i) {
      return i.compare(e, r) > 0;
    }),
        Mr = Sr("<=", function (t, e, r) {
      return e <= r;
    }, function (t, e, r, i) {
      return i.compare(e, r) <= 0;
    });

    var Br = /*#__PURE__*/function () {
      function Br(t, e, r, i, n) {
        _classCallCheck(this, Br);

        this.type = Zt, this.number = t, this.locale = e, this.currency = r, this.minFractionDigits = i, this.maxFractionDigits = n;
      }

      _createClass(Br, [{
        key: "evaluate",
        value: function evaluate(t) {
          return new Intl.NumberFormat(this.locale ? this.locale.evaluate(t) : [], {
            style: this.currency ? "currency" : "decimal",
            currency: this.currency ? this.currency.evaluate(t) : void 0,
            minimumFractionDigits: this.minFractionDigits ? this.minFractionDigits.evaluate(t) : void 0,
            maximumFractionDigits: this.maxFractionDigits ? this.maxFractionDigits.evaluate(t) : void 0
          }).format(this.number.evaluate(t));
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.number), this.locale && t(this.locale), this.currency && t(this.currency), this.minFractionDigits && t(this.minFractionDigits), this.maxFractionDigits && t(this.maxFractionDigits);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {};
          return this.locale && (t.locale = this.locale.serialize()), this.currency && (t.currency = this.currency.serialize()), this.minFractionDigits && (t["min-fraction-digits"] = this.minFractionDigits.serialize()), this.maxFractionDigits && (t["max-fraction-digits"] = this.maxFractionDigits.serialize()), ["number-format", this.number.serialize(), t];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (3 !== t.length) return e.error("Expected two arguments.");
          var r = e.parse(t[1], 1, Gt);
          if (!r) return null;
          var i = t[2];
          if ("object" != _typeof(i) || Array.isArray(i)) return e.error("NumberFormat options argument must be an object.");
          var n = null;
          if (i.locale && (n = e.parse(i.locale, 1, Zt), !n)) return null;
          var s = null;
          if (i.currency && (s = e.parse(i.currency, 1, Zt), !s)) return null;
          var a = null;
          if (i["min-fraction-digits"] && (a = e.parse(i["min-fraction-digits"], 1, Gt), !a)) return null;
          var o = null;
          return i["max-fraction-digits"] && (o = e.parse(i["max-fraction-digits"], 1, Gt), !o) ? null : new Br(r, n, s, a, o);
        }
      }]);

      return Br;
    }();

    var Dr = /*#__PURE__*/function () {
      function Dr(t) {
        _classCallCheck(this, Dr);

        this.type = Gt, this.input = t;
      }

      _createClass(Dr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.input.evaluate(t);
          if ("string" == typeof e) return e.length;
          if (Array.isArray(e)) return e.length;
          throw new xe("Expected value to be of type string or array, but found ".concat(ee(ye(e)), " instead."));
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["length"];
          return this.eachChild(function (e) {
            t.push(e.serialize());
          }), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length) return e.error("Expected 1 argument, but found ".concat(t.length - 1, " instead."));
          var r = e.parse(t[1], 1);
          return r ? "array" !== r.type.kind && "string" !== r.type.kind && "value" !== r.type.kind ? e.error("Expected argument of type string or array, but found ".concat(ee(r.type), " instead.")) : new Dr(r) : null;
        }
      }]);

      return Dr;
    }();

    var Cr = {
      "==": Ir,
      "!=": Tr,
      ">": Er,
      "<": zr,
      ">=": Sr(">=", function (t, e, r) {
        return e >= r;
      }, function (t, e, r, i) {
        return i.compare(e, r) >= 0;
      }),
      "<=": Mr,
      array: be,
      at: gr,
      boolean: be,
      case: wr,
      coalesce: yr,
      collator: ze,
      format: we,
      image: _e,
      in: xr,
      "index-of": vr,
      interpolate: dr,
      "interpolate-hcl": dr,
      "interpolate-lab": dr,
      length: Dr,
      let: mr,
      literal: ge,
      match: br,
      number: be,
      "number-format": Br,
      object: be,
      slice: _r,
      step: We,
      string: be,
      "to-boolean": Ae,
      "to-color": Ae,
      "to-number": Ae,
      "to-string": Ae,
      var: Ke,
      within: je
    };

    function Pr(t, _ref4) {
      var [e, r, i, n] = _ref4;
      e = e.evaluate(t), r = r.evaluate(t), i = i.evaluate(t);
      var s = n ? n.evaluate(t) : 1,
          a = de(e, r, i, s);
      if (a) throw new xe(a);
      return new le(e / 255 * s, r / 255 * s, i / 255 * s, s);
    }

    function Vr(t, e) {
      return t in e;
    }

    function Fr(t, e) {
      var r = e[t];
      return void 0 === r ? null : r;
    }

    function Rr(t) {
      return {
        type: t
      };
    }

    function Lr(t) {
      return {
        result: "success",
        value: t
      };
    }

    function Ur(t) {
      return {
        result: "error",
        value: t
      };
    }

    function Or(t) {
      return "data-driven" === t["property-type"] || "cross-faded-data-driven" === t["property-type"];
    }

    function $r(t) {
      return !!t.expression && t.expression.parameters.indexOf("zoom") > -1;
    }

    function qr(t) {
      return !!t.expression && t.expression.interpolated;
    }

    function Nr(t) {
      return t instanceof Number ? "number" : t instanceof String ? "string" : t instanceof Boolean ? "boolean" : Array.isArray(t) ? "array" : null === t ? "null" : _typeof(t);
    }

    function jr(t) {
      return "object" == _typeof(t) && null !== t && !Array.isArray(t);
    }

    function Gr(t) {
      return t;
    }

    function Zr(t, e, r) {
      return void 0 !== t ? t : void 0 !== e ? e : void 0 !== r ? r : void 0;
    }

    function Xr(t, e, r, i, n) {
      return Zr(_typeof(r) === n ? i[r] : void 0, t.default, e.default);
    }

    function Kr(t, e, r) {
      if ("number" !== Nr(r)) return Zr(t.default, e.default);
      var i = t.stops.length;
      if (1 === i) return t.stops[0][1];
      if (r <= t.stops[0][0]) return t.stops[0][1];
      if (r >= t.stops[i - 1][0]) return t.stops[i - 1][1];
      var n = Ye(t.stops.map(function (t) {
        return t[0];
      }), r);
      return t.stops[n][1];
    }

    function Hr(t, e, r) {
      var i = void 0 !== t.base ? t.base : 1;
      if ("number" !== Nr(r)) return Zr(t.default, e.default);
      var n = t.stops.length;
      if (1 === n) return t.stops[0][1];
      if (r <= t.stops[0][0]) return t.stops[0][1];
      if (r >= t.stops[n - 1][0]) return t.stops[n - 1][1];

      var s = Ye(t.stops.map(function (t) {
        return t[0];
      }), r),
          a = function (t, e, r, i) {
        var n = i - r,
            s = t - r;
        return 0 === n ? 0 : 1 === e ? s / n : (Math.pow(e, s) - 1) / (Math.pow(e, n) - 1);
      }(r, i, t.stops[s][0], t.stops[s + 1][0]),
          o = t.stops[s][1],
          l = t.stops[s + 1][1];

      var u = Qe[e.type] || Gr;

      if (t.colorSpace && "rgb" !== t.colorSpace) {
        var _e40 = pr[t.colorSpace];

        u = function (t, r) {
          return _e40.reverse(_e40.interpolate(_e40.forward(t), _e40.forward(r), a));
        };
      }

      return "function" == typeof o.evaluate ? {
        evaluate: function () {
          for (var _len4 = arguments.length, t = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
            t[_key4] = arguments[_key4];
          }

          var e = o.evaluate.apply(void 0, t),
              r = l.evaluate.apply(void 0, t);
          if (void 0 !== e && void 0 !== r) return u(e, r, a);
        }
      } : u(o, l, a);
    }

    function Yr(t, e, r) {
      return "color" === e.type ? r = le.parse(r) : "formatted" === e.type ? r = he.fromString(r.toString()) : "resolvedImage" === e.type ? r = pe.fromString(r.toString()) : Nr(r) === e.type || "enum" === e.type && e.values[r] || (r = void 0), Zr(r, t.default, e.default);
    }

    Te.register(Cr, {
      error: [{
        kind: "error"
      }, [Zt], function (t, _ref5) {
        var [e] = _ref5;
        throw new xe(e.evaluate(t));
      }],
      typeof: [Zt, [Yt], function (t, _ref6) {
        var [e] = _ref6;
        return ee(ye(e.evaluate(t)));
      }],
      "to-rgba": [te(Gt, 4), [Kt], function (t, _ref7) {
        var [e] = _ref7;
        return e.evaluate(t).toArray();
      }],
      rgb: [Kt, [Gt, Gt, Gt], Pr],
      rgba: [Kt, [Gt, Gt, Gt, Gt], Pr],
      has: {
        type: Xt,
        overloads: [[[Zt], function (t, _ref8) {
          var [e] = _ref8;
          return Vr(e.evaluate(t), t.properties());
        }], [[Zt, Ht], function (t, _ref9) {
          var [e, r] = _ref9;
          return Vr(e.evaluate(t), r.evaluate(t));
        }]]
      },
      get: {
        type: Yt,
        overloads: [[[Zt], function (t, _ref10) {
          var [e] = _ref10;
          return Fr(e.evaluate(t), t.properties());
        }], [[Zt, Ht], function (t, _ref11) {
          var [e, r] = _ref11;
          return Fr(e.evaluate(t), r.evaluate(t));
        }]]
      },
      "feature-state": [Yt, [Zt], function (t, _ref12) {
        var [e] = _ref12;
        return Fr(e.evaluate(t), t.featureState || {});
      }],
      properties: [Ht, [], function (t) {
        return t.properties();
      }],
      "geometry-type": [Zt, [], function (t) {
        return t.geometryType();
      }],
      id: [Yt, [], function (t) {
        return t.id();
      }],
      zoom: [Gt, [], function (t) {
        return t.globals.zoom;
      }],
      "heatmap-density": [Gt, [], function (t) {
        return t.globals.heatmapDensity || 0;
      }],
      "line-progress": [Gt, [], function (t) {
        return t.globals.lineProgress || 0;
      }],
      "sky-radial-progress": [Gt, [], function (t) {
        return t.globals.skyRadialProgress || 0;
      }],
      accumulated: [Yt, [], function (t) {
        return void 0 === t.globals.accumulated ? null : t.globals.accumulated;
      }],
      "+": [Gt, Rr(Gt), function (t, e) {
        var r = 0;

        for (var _i27 of e) {
          r += _i27.evaluate(t);
        }

        return r;
      }],
      "*": [Gt, Rr(Gt), function (t, e) {
        var r = 1;

        for (var _i28 of e) {
          r *= _i28.evaluate(t);
        }

        return r;
      }],
      "-": {
        type: Gt,
        overloads: [[[Gt, Gt], function (t, _ref13) {
          var [e, r] = _ref13;
          return e.evaluate(t) - r.evaluate(t);
        }], [[Gt], function (t, _ref14) {
          var [e] = _ref14;
          return -e.evaluate(t);
        }]]
      },
      "/": [Gt, [Gt, Gt], function (t, _ref15) {
        var [e, r] = _ref15;
        return e.evaluate(t) / r.evaluate(t);
      }],
      "%": [Gt, [Gt, Gt], function (t, _ref16) {
        var [e, r] = _ref16;
        return e.evaluate(t) % r.evaluate(t);
      }],
      ln2: [Gt, [], function () {
        return Math.LN2;
      }],
      pi: [Gt, [], function () {
        return Math.PI;
      }],
      e: [Gt, [], function () {
        return Math.E;
      }],
      "^": [Gt, [Gt, Gt], function (t, _ref17) {
        var [e, r] = _ref17;
        return Math.pow(e.evaluate(t), r.evaluate(t));
      }],
      sqrt: [Gt, [Gt], function (t, _ref18) {
        var [e] = _ref18;
        return Math.sqrt(e.evaluate(t));
      }],
      log10: [Gt, [Gt], function (t, _ref19) {
        var [e] = _ref19;
        return Math.log(e.evaluate(t)) / Math.LN10;
      }],
      ln: [Gt, [Gt], function (t, _ref20) {
        var [e] = _ref20;
        return Math.log(e.evaluate(t));
      }],
      log2: [Gt, [Gt], function (t, _ref21) {
        var [e] = _ref21;
        return Math.log(e.evaluate(t)) / Math.LN2;
      }],
      sin: [Gt, [Gt], function (t, _ref22) {
        var [e] = _ref22;
        return Math.sin(e.evaluate(t));
      }],
      cos: [Gt, [Gt], function (t, _ref23) {
        var [e] = _ref23;
        return Math.cos(e.evaluate(t));
      }],
      tan: [Gt, [Gt], function (t, _ref24) {
        var [e] = _ref24;
        return Math.tan(e.evaluate(t));
      }],
      asin: [Gt, [Gt], function (t, _ref25) {
        var [e] = _ref25;
        return Math.asin(e.evaluate(t));
      }],
      acos: [Gt, [Gt], function (t, _ref26) {
        var [e] = _ref26;
        return Math.acos(e.evaluate(t));
      }],
      atan: [Gt, [Gt], function (t, _ref27) {
        var [e] = _ref27;
        return Math.atan(e.evaluate(t));
      }],
      min: [Gt, Rr(Gt), function (t, e) {
        return Math.min.apply(Math, _toConsumableArray(e.map(function (e) {
          return e.evaluate(t);
        })));
      }],
      max: [Gt, Rr(Gt), function (t, e) {
        return Math.max.apply(Math, _toConsumableArray(e.map(function (e) {
          return e.evaluate(t);
        })));
      }],
      abs: [Gt, [Gt], function (t, _ref28) {
        var [e] = _ref28;
        return Math.abs(e.evaluate(t));
      }],
      round: [Gt, [Gt], function (t, _ref29) {
        var [e] = _ref29;
        var r = e.evaluate(t);
        return r < 0 ? -Math.round(-r) : Math.round(r);
      }],
      floor: [Gt, [Gt], function (t, _ref30) {
        var [e] = _ref30;
        return Math.floor(e.evaluate(t));
      }],
      ceil: [Gt, [Gt], function (t, _ref31) {
        var [e] = _ref31;
        return Math.ceil(e.evaluate(t));
      }],
      "filter-==": [Xt, [Zt, Yt], function (t, _ref32) {
        var [e, r] = _ref32;
        return t.properties()[e.value] === r.value;
      }],
      "filter-id-==": [Xt, [Yt], function (t, _ref33) {
        var [e] = _ref33;
        return t.id() === e.value;
      }],
      "filter-type-==": [Xt, [Zt], function (t, _ref34) {
        var [e] = _ref34;
        return t.geometryType() === e.value;
      }],
      "filter-<": [Xt, [Zt, Yt], function (t, _ref35) {
        var [e, r] = _ref35;
        var i = t.properties()[e.value],
            n = r.value;
        return _typeof(i) == _typeof(n) && i < n;
      }],
      "filter-id-<": [Xt, [Yt], function (t, _ref36) {
        var [e] = _ref36;
        var r = t.id(),
            i = e.value;
        return _typeof(r) == _typeof(i) && r < i;
      }],
      "filter->": [Xt, [Zt, Yt], function (t, _ref37) {
        var [e, r] = _ref37;
        var i = t.properties()[e.value],
            n = r.value;
        return _typeof(i) == _typeof(n) && i > n;
      }],
      "filter-id->": [Xt, [Yt], function (t, _ref38) {
        var [e] = _ref38;
        var r = t.id(),
            i = e.value;
        return _typeof(r) == _typeof(i) && r > i;
      }],
      "filter-<=": [Xt, [Zt, Yt], function (t, _ref39) {
        var [e, r] = _ref39;
        var i = t.properties()[e.value],
            n = r.value;
        return _typeof(i) == _typeof(n) && i <= n;
      }],
      "filter-id-<=": [Xt, [Yt], function (t, _ref40) {
        var [e] = _ref40;
        var r = t.id(),
            i = e.value;
        return _typeof(r) == _typeof(i) && r <= i;
      }],
      "filter->=": [Xt, [Zt, Yt], function (t, _ref41) {
        var [e, r] = _ref41;
        var i = t.properties()[e.value],
            n = r.value;
        return _typeof(i) == _typeof(n) && i >= n;
      }],
      "filter-id->=": [Xt, [Yt], function (t, _ref42) {
        var [e] = _ref42;
        var r = t.id(),
            i = e.value;
        return _typeof(r) == _typeof(i) && r >= i;
      }],
      "filter-has": [Xt, [Yt], function (t, _ref43) {
        var [e] = _ref43;
        return e.value in t.properties();
      }],
      "filter-has-id": [Xt, [], function (t) {
        return null !== t.id() && void 0 !== t.id();
      }],
      "filter-type-in": [Xt, [te(Zt)], function (t, _ref44) {
        var [e] = _ref44;
        return e.value.indexOf(t.geometryType()) >= 0;
      }],
      "filter-id-in": [Xt, [te(Yt)], function (t, _ref45) {
        var [e] = _ref45;
        return e.value.indexOf(t.id()) >= 0;
      }],
      "filter-in-small": [Xt, [Zt, te(Yt)], function (t, _ref46) {
        var [e, r] = _ref46;
        return r.value.indexOf(t.properties()[e.value]) >= 0;
      }],
      "filter-in-large": [Xt, [Zt, te(Yt)], function (t, _ref47) {
        var [e, r] = _ref47;
        return function (t, e, r, i) {
          for (; r <= i;) {
            var _n21 = r + i >> 1;

            if (e[_n21] === t) return !0;
            e[_n21] > t ? i = _n21 - 1 : r = _n21 + 1;
          }

          return !1;
        }(t.properties()[e.value], r.value, 0, r.value.length - 1);
      }],
      all: {
        type: Xt,
        overloads: [[[Xt, Xt], function (t, _ref48) {
          var [e, r] = _ref48;
          return e.evaluate(t) && r.evaluate(t);
        }], [Rr(Xt), function (t, e) {
          for (var _r47 of e) {
            if (!_r47.evaluate(t)) return !1;
          }

          return !0;
        }]]
      },
      any: {
        type: Xt,
        overloads: [[[Xt, Xt], function (t, _ref49) {
          var [e, r] = _ref49;
          return e.evaluate(t) || r.evaluate(t);
        }], [Rr(Xt), function (t, e) {
          for (var _r48 of e) {
            if (_r48.evaluate(t)) return !0;
          }

          return !1;
        }]]
      },
      "!": [Xt, [Xt], function (t, _ref50) {
        var [e] = _ref50;
        return !e.evaluate(t);
      }],
      "is-supported-script": [Xt, [Zt], function (t, _ref51) {
        var [e] = _ref51;
        var r = t.globals && t.globals.isSupportedScript;
        return !r || r(e.evaluate(t));
      }],
      upcase: [Zt, [Zt], function (t, _ref52) {
        var [e] = _ref52;
        return e.evaluate(t).toUpperCase();
      }],
      downcase: [Zt, [Zt], function (t, _ref53) {
        var [e] = _ref53;
        return e.evaluate(t).toLowerCase();
      }],
      concat: [Zt, Rr(Yt), function (t, e) {
        return e.map(function (e) {
          return me(e.evaluate(t));
        }).join("");
      }],
      "resolved-locale": [Zt, [Wt], function (t, _ref54) {
        var [e] = _ref54;
        return e.evaluate(t).resolvedLocale();
      }]
    });

    var Wr = /*#__PURE__*/function () {
      function Wr(t, e) {
        _classCallCheck(this, Wr);

        this.expression = t, this._warningHistory = {}, this._evaluator = new Ie(), this._defaultValue = e ? function (t) {
          return "color" === t.type && jr(t.default) ? new le(0, 0, 0, 0) : "color" === t.type ? le.parse(t.default) || null : void 0 === t.default ? null : t.default;
        }(e) : null, this._enumValues = e && "enum" === e.type ? e.values : null;
      }

      _createClass(Wr, [{
        key: "evaluateWithoutErrorHandling",
        value: function evaluateWithoutErrorHandling(t, e, r, i, n, s) {
          return this._evaluator.globals = t, this._evaluator.feature = e, this._evaluator.featureState = r, this._evaluator.canonical = i, this._evaluator.availableImages = n || null, this._evaluator.formattedSection = s, this.expression.evaluate(this._evaluator);
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, i, n, s) {
          this._evaluator.globals = t, this._evaluator.feature = e || null, this._evaluator.featureState = r || null, this._evaluator.canonical = i, this._evaluator.availableImages = n || null, this._evaluator.formattedSection = s || null;

          try {
            var _t36 = this.expression.evaluate(this._evaluator);

            if (null == _t36 || "number" == typeof _t36 && _t36 != _t36) return this._defaultValue;
            if (this._enumValues && !(_t36 in this._enumValues)) throw new xe("Expected value to be one of ".concat(Object.keys(this._enumValues).map(function (t) {
              return JSON.stringify(t);
            }).join(", "), ", but found ").concat(JSON.stringify(_t36), " instead."));
            return _t36;
          } catch (t) {
            return this._warningHistory[t.message] || (this._warningHistory[t.message] = !0, "undefined" != typeof console && console.warn(t.message)), this._defaultValue;
          }
        }
      }]);

      return Wr;
    }();

    function Jr(t) {
      return Array.isArray(t) && t.length > 0 && "string" == typeof t[0] && t[0] in Cr;
    }

    function Qr(t, e) {
      var r = new He(Cr, [], e ? function (t) {
        var e = {
          color: Kt,
          string: Zt,
          number: Gt,
          enum: Zt,
          boolean: Xt,
          formatted: Jt,
          resolvedImage: Qt
        };
        return "array" === t.type ? te(e[t.value] || Yt, t.length) : e[t.type];
      }(e) : void 0),
          i = r.parse(t, void 0, void 0, void 0, e && "string" === e.type ? {
        typeAnnotation: "coerce"
      } : void 0);
      return i ? Lr(new Wr(i, e)) : Ur(r.errors);
    }

    var ti = /*#__PURE__*/function () {
      function ti(t, e) {
        _classCallCheck(this, ti);

        this.kind = t, this._styleExpression = e, this.isStateDependent = "constant" !== t && !Ze(e.expression);
      }

      _createClass(ti, [{
        key: "evaluateWithoutErrorHandling",
        value: function evaluateWithoutErrorHandling(t, e, r, i, n, s) {
          return this._styleExpression.evaluateWithoutErrorHandling(t, e, r, i, n, s);
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, i, n, s) {
          return this._styleExpression.evaluate(t, e, r, i, n, s);
        }
      }]);

      return ti;
    }();

    var ei = /*#__PURE__*/function () {
      function ei(t, e, r, i) {
        _classCallCheck(this, ei);

        this.kind = t, this.zoomStops = r, this._styleExpression = e, this.isStateDependent = "camera" !== t && !Ze(e.expression), this.interpolationType = i;
      }

      _createClass(ei, [{
        key: "evaluateWithoutErrorHandling",
        value: function evaluateWithoutErrorHandling(t, e, r, i, n, s) {
          return this._styleExpression.evaluateWithoutErrorHandling(t, e, r, i, n, s);
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, i, n, s) {
          return this._styleExpression.evaluate(t, e, r, i, n, s);
        }
      }, {
        key: "interpolationFactor",
        value: function interpolationFactor(t, e, r) {
          return this.interpolationType ? dr.interpolationFactor(this.interpolationType, t, e, r) : 0;
        }
      }]);

      return ei;
    }();

    function ri(t, e) {
      if ("error" === (t = Qr(t, e)).result) return t;
      var r = t.value.expression,
          i = Ge(r);
      if (!i && !Or(e)) return Ur([new qt("", "data expressions not supported")]);
      var n = Xe(r, ["zoom"]);
      if (!n && !$r(e)) return Ur([new qt("", "zoom expressions not supported")]);

      var s = function t(e) {
        var r = null;
        if (e instanceof mr) r = t(e.result);else if (e instanceof yr) {
          for (var _i29 of e.args) {
            if (r = t(_i29), r) break;
          }
        } else (e instanceof We || e instanceof dr) && e.input instanceof Te && "zoom" === e.input.name && (r = e);
        return r instanceof qt || e.eachChild(function (e) {
          var i = t(e);
          i instanceof qt ? r = i : !r && i ? r = new qt("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.') : r && i && r !== i && (r = new qt("", 'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'));
        }), r;
      }(r);

      return s || n ? s instanceof qt ? Ur([s]) : s instanceof dr && !qr(e) ? Ur([new qt("", '"interpolate" expressions cannot be used with this property')]) : Lr(s ? new ei(i ? "camera" : "composite", t.value, s.labels, s instanceof dr ? s.interpolation : void 0) : new ti(i ? "constant" : "source", t.value)) : Ur([new qt("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);
    }

    var ii = /*#__PURE__*/function () {
      function ii(t, e) {
        _classCallCheck(this, ii);

        this._parameters = t, this._specification = e, Ut(this, function t(e, r) {
          var i = "color" === r.type,
              n = e.stops && "object" == _typeof(e.stops[0][0]),
              s = n || !(n || void 0 !== e.property),
              a = e.type || (qr(r) ? "exponential" : "interval");

          if (i && ((e = Ut({}, e)).stops && (e.stops = e.stops.map(function (t) {
            return [t[0], le.parse(t[1])];
          })), e.default = le.parse(e.default ? e.default : r.default)), e.colorSpace && "rgb" !== e.colorSpace && !pr[e.colorSpace]) throw new Error("Unknown color space: ".concat(e.colorSpace));
          var o, l, u;
          if ("exponential" === a) o = Hr;else if ("interval" === a) o = Kr;else if ("categorical" === a) {
            o = Xr, l = Object.create(null);

            for (var _t37 of e.stops) {
              l[_t37[0]] = _t37[1];
            }

            u = _typeof(e.stops[0][0]);
          } else {
            if ("identity" !== a) throw new Error("Unknown function type \"".concat(a, "\""));
            o = Yr;
          }

          if (n) {
            var _i30 = {},
                _n22 = [];

            for (var _t38 = 0; _t38 < e.stops.length; _t38++) {
              var _r49 = e.stops[_t38],
                  _s18 = _r49[0].zoom;
              void 0 === _i30[_s18] && (_i30[_s18] = {
                zoom: _s18,
                type: e.type,
                property: e.property,
                default: e.default,
                stops: []
              }, _n22.push(_s18)), _i30[_s18].stops.push([_r49[0].value, _r49[1]]);
            }

            var _s17 = [];

            for (var _e41 of _n22) {
              _s17.push([_i30[_e41].zoom, t(_i30[_e41], r)]);
            }

            var _a17 = {
              name: "linear"
            };
            return {
              kind: "composite",
              interpolationType: _a17,
              interpolationFactor: dr.interpolationFactor.bind(void 0, _a17),
              zoomStops: _s17.map(function (t) {
                return t[0];
              }),
              evaluate: function (_ref55, i) {
                var {
                  zoom: t
                } = _ref55;
                return Hr({
                  stops: _s17,
                  base: e.base
                }, r, t).evaluate(t, i);
              }
            };
          }

          if (s) {
            var _t39 = "exponential" === a ? {
              name: "exponential",
              base: void 0 !== e.base ? e.base : 1
            } : null;

            return {
              kind: "camera",
              interpolationType: _t39,
              interpolationFactor: dr.interpolationFactor.bind(void 0, _t39),
              zoomStops: e.stops.map(function (t) {
                return t[0];
              }),
              evaluate: function (_ref56) {
                var {
                  zoom: t
                } = _ref56;
                return o(e, r, t, l, u);
              }
            };
          }

          return {
            kind: "source",
            evaluate: function (t, i) {
              var n = i && i.properties ? i.properties[e.property] : void 0;
              return void 0 === n ? Zr(e.default, r.default) : o(e, r, n, l, u);
            }
          };
        }(this._parameters, this._specification));
      }

      _createClass(ii, null, [{
        key: "deserialize",
        value: function deserialize(t) {
          return new ii(t._parameters, t._specification);
        }
      }, {
        key: "serialize",
        value: function serialize(t) {
          return {
            _parameters: t._parameters,
            _specification: t._specification
          };
        }
      }]);

      return ii;
    }();

    function ni(t) {
      var e = t.key,
          r = t.value,
          i = t.valueSpec || {},
          n = t.objectElementValidators || {},
          s = t.style,
          a = t.styleSpec;
      var o = [];
      var l = Nr(r);
      if ("object" !== l) return [new Rt(e, r, "object expected, ".concat(l, " found"))];

      for (var _t40 in r) {
        var _l6 = _t40.split(".")[0],
            _u6 = i[_l6] || i["*"];

        var _c3 = void 0;

        if (n[_l6]) _c3 = n[_l6];else if (i[_l6]) _c3 = Mi;else if (n["*"]) _c3 = n["*"];else {
          if (!i["*"]) {
            o.push(new Rt(e, r[_t40], "unknown property \"".concat(_t40, "\"")));
            continue;
          }

          _c3 = Mi;
        }
        o = o.concat(_c3({
          key: (e ? "".concat(e, ".") : e) + _t40,
          value: r[_t40],
          valueSpec: _u6,
          style: s,
          styleSpec: a,
          object: r,
          objectKey: _t40
        }, r));
      }

      for (var _t41 in i) {
        n[_t41] || i[_t41].required && void 0 === i[_t41].default && void 0 === r[_t41] && o.push(new Rt(e, r, "missing required property \"".concat(_t41, "\"")));
      }

      return o;
    }

    function si(t) {
      var e = t.value,
          r = t.valueSpec,
          i = t.style,
          n = t.styleSpec,
          s = t.key,
          a = t.arrayElementValidator || Mi;
      if ("array" !== Nr(e)) return [new Rt(s, e, "array expected, ".concat(Nr(e), " found"))];
      if (r.length && e.length !== r.length) return [new Rt(s, e, "array length ".concat(r.length, " expected, length ").concat(e.length, " found"))];
      if (r["min-length"] && e.length < r["min-length"]) return [new Rt(s, e, "array length at least ".concat(r["min-length"], " expected, length ").concat(e.length, " found"))];
      var o = {
        type: r.value,
        values: r.values,
        minimum: r.minimum,
        maximum: r.maximum
      };
      n.$version < 7 && (o.function = r.function), "object" === Nr(r.value) && (o = r.value);
      var l = [];

      for (var _t42 = 0; _t42 < e.length; _t42++) {
        l = l.concat(a({
          array: e,
          arrayIndex: _t42,
          value: e[_t42],
          valueSpec: o,
          style: i,
          styleSpec: n,
          key: "".concat(s, "[").concat(_t42, "]")
        }));
      }

      return l;
    }

    function ai(t) {
      var e = t.key,
          r = t.value,
          i = t.valueSpec;
      var n = Nr(r);
      if ("number" === n && r != r && (n = "NaN"), "number" !== n) return [new Rt(e, r, "number expected, ".concat(n, " found"))];

      if ("minimum" in i) {
        var _n23 = i.minimum;
        if ("array" === Nr(i.minimum) && (_n23 = i.minimum[t.arrayIndex]), r < _n23) return [new Rt(e, r, "".concat(r, " is less than the minimum value ").concat(_n23))];
      }

      if ("maximum" in i) {
        var _n24 = i.maximum;
        if ("array" === Nr(i.maximum) && (_n24 = i.maximum[t.arrayIndex]), r > _n24) return [new Rt(e, r, "".concat(r, " is greater than the maximum value ").concat(_n24))];
      }

      return [];
    }

    function oi(t) {
      var e = t.valueSpec,
          r = Ot(t.value.type);
      var i,
          n,
          s,
          a = {};
      var o = "categorical" !== r && void 0 === t.value.property,
          l = !o,
          u = "array" === Nr(t.value.stops) && "array" === Nr(t.value.stops[0]) && "object" === Nr(t.value.stops[0][0]),
          c = ni({
        key: t.key,
        value: t.value,
        valueSpec: t.styleSpec.function,
        style: t.style,
        styleSpec: t.styleSpec,
        objectElementValidators: {
          stops: function (t) {
            if ("identity" === r) return [new Rt(t.key, t.value, 'identity function may not have a "stops" property')];
            var e = [];
            var i = t.value;
            return e = e.concat(si({
              key: t.key,
              value: i,
              valueSpec: t.valueSpec,
              style: t.style,
              styleSpec: t.styleSpec,
              arrayElementValidator: h
            })), "array" === Nr(i) && 0 === i.length && e.push(new Rt(t.key, i, "array must have at least one stop")), e;
          },
          default: function (t) {
            return Mi({
              key: t.key,
              value: t.value,
              valueSpec: e,
              style: t.style,
              styleSpec: t.styleSpec
            });
          }
        }
      });
      return "identity" === r && o && c.push(new Rt(t.key, t.value, 'missing required property "property"')), "identity" === r || t.value.stops || c.push(new Rt(t.key, t.value, 'missing required property "stops"')), "exponential" === r && t.valueSpec.expression && !qr(t.valueSpec) && c.push(new Rt(t.key, t.value, "exponential functions not supported")), t.styleSpec.$version >= 8 && (l && !Or(t.valueSpec) ? c.push(new Rt(t.key, t.value, "property functions not supported")) : o && !$r(t.valueSpec) && c.push(new Rt(t.key, t.value, "zoom functions not supported"))), "categorical" !== r && !u || void 0 !== t.value.property || c.push(new Rt(t.key, t.value, '"property" property is required')), c;

      function h(t) {
        var r = [];
        var i = t.value,
            o = t.key;
        if ("array" !== Nr(i)) return [new Rt(o, i, "array expected, ".concat(Nr(i), " found"))];
        if (2 !== i.length) return [new Rt(o, i, "array length 2 expected, length ".concat(i.length, " found"))];

        if (u) {
          if ("object" !== Nr(i[0])) return [new Rt(o, i, "object expected, ".concat(Nr(i[0]), " found"))];
          if (void 0 === i[0].zoom) return [new Rt(o, i, "object stop key must have zoom")];
          if (void 0 === i[0].value) return [new Rt(o, i, "object stop key must have value")];
          if (s && s > Ot(i[0].zoom)) return [new Rt(o, i[0].zoom, "stop zoom values must appear in ascending order")];
          Ot(i[0].zoom) !== s && (s = Ot(i[0].zoom), n = void 0, a = {}), r = r.concat(ni({
            key: "".concat(o, "[0]"),
            value: i[0],
            valueSpec: {
              zoom: {}
            },
            style: t.style,
            styleSpec: t.styleSpec,
            objectElementValidators: {
              zoom: ai,
              value: p
            }
          }));
        } else r = r.concat(p({
          key: "".concat(o, "[0]"),
          value: i[0],
          valueSpec: {},
          style: t.style,
          styleSpec: t.styleSpec
        }, i));

        return Jr($t(i[1])) ? r.concat([new Rt("".concat(o, "[1]"), i[1], "expressions are not allowed in function stops.")]) : r.concat(Mi({
          key: "".concat(o, "[1]"),
          value: i[1],
          valueSpec: e,
          style: t.style,
          styleSpec: t.styleSpec
        }));
      }

      function p(t, s) {
        var o = Nr(t.value),
            l = Ot(t.value),
            u = null !== t.value ? t.value : s;

        if (i) {
          if (o !== i) return [new Rt(t.key, u, "".concat(o, " stop domain type must match previous stop domain type ").concat(i))];
        } else i = o;

        if ("number" !== o && "string" !== o && "boolean" !== o) return [new Rt(t.key, u, "stop domain value must be a number, string, or boolean")];

        if ("number" !== o && "categorical" !== r) {
          var _i31 = "number expected, ".concat(o, " found");

          return Or(e) && void 0 === r && (_i31 += '\nIf you intended to use a categorical function, specify `"type": "categorical"`.'), [new Rt(t.key, u, _i31)];
        }

        return "categorical" !== r || "number" !== o || isFinite(l) && Math.floor(l) === l ? "categorical" !== r && "number" === o && void 0 !== n && l < n ? [new Rt(t.key, u, "stop domain values must appear in ascending order")] : (n = l, "categorical" === r && l in a ? [new Rt(t.key, u, "stop domain values must be unique")] : (a[l] = !0, [])) : [new Rt(t.key, u, "integer expected, found ".concat(l))];
      }
    }

    function li(t) {
      var e = ("property" === t.expressionContext ? ri : Qr)($t(t.value), t.valueSpec);
      if ("error" === e.result) return e.value.map(function (e) {
        return new Rt("".concat(t.key).concat(e.key), t.value, e.message);
      });
      var r = e.value.expression || e.value._styleExpression.expression;
      if ("property" === t.expressionContext && "text-font" === t.propertyKey && !r.outputDefined()) return [new Rt(t.key, t.value, "Invalid data expression for \"".concat(t.propertyKey, "\". Output values must be contained as literals within the expression."))];
      if ("property" === t.expressionContext && "layout" === t.propertyType && !Ze(r)) return [new Rt(t.key, t.value, '"feature-state" data expressions are not supported with layout properties.')];
      if ("filter" === t.expressionContext && !Ze(r)) return [new Rt(t.key, t.value, '"feature-state" data expressions are not supported with filters.')];

      if (t.expressionContext && 0 === t.expressionContext.indexOf("cluster")) {
        if (!Xe(r, ["zoom", "feature-state"])) return [new Rt(t.key, t.value, '"zoom" and "feature-state" expressions are not supported with cluster properties.')];
        if ("cluster-initial" === t.expressionContext && !Ge(r)) return [new Rt(t.key, t.value, "Feature data expressions are not supported with initial expression part of cluster properties.")];
      }

      return [];
    }

    function ui(t) {
      var e = t.key,
          r = t.value,
          i = t.valueSpec,
          n = [];
      return Array.isArray(i.values) ? -1 === i.values.indexOf(Ot(r)) && n.push(new Rt(e, r, "expected one of [".concat(i.values.join(", "), "], ").concat(JSON.stringify(r), " found"))) : -1 === Object.keys(i.values).indexOf(Ot(r)) && n.push(new Rt(e, r, "expected one of [".concat(Object.keys(i.values).join(", "), "], ").concat(JSON.stringify(r), " found"))), n;
    }

    function ci(t) {
      if (!0 === t || !1 === t) return !0;
      if (!Array.isArray(t) || 0 === t.length) return !1;

      switch (t[0]) {
        case "has":
          return t.length >= 2 && "$id" !== t[1] && "$type" !== t[1];

        case "in":
          return t.length >= 3 && ("string" != typeof t[1] || Array.isArray(t[2]));

        case "!in":
        case "!has":
        case "none":
          return !1;

        case "==":
        case "!=":
        case ">":
        case ">=":
        case "<":
        case "<=":
          return 3 !== t.length || Array.isArray(t[1]) || Array.isArray(t[2]);

        case "any":
        case "all":
          for (var _e42 of t.slice(1)) {
            if (!ci(_e42) && "boolean" != typeof _e42) return !1;
          }

          return !0;

        default:
          return !0;
      }
    }

    var hi = {
      type: "boolean",
      default: !1,
      transition: !1,
      "property-type": "data-driven",
      expression: {
        interpolated: !1,
        parameters: ["zoom", "feature"]
      }
    };

    function pi(t) {
      if (null == t) return {
        filter: function () {
          return !0;
        },
        needGeometry: !1
      };
      ci(t) || (t = fi(t));
      var e = Qr(t, hi);
      if ("error" === e.result) throw new Error(e.value.map(function (t) {
        return "".concat(t.key, ": ").concat(t.message);
      }).join(", "));
      return {
        filter: function (t, r, i) {
          return e.value.evaluate(t, r, {}, i);
        },
        needGeometry: function t(e) {
          if (!Array.isArray(e)) return !1;
          if ("within" === e[0]) return !0;

          for (var _r50 = 1; _r50 < e.length; _r50++) {
            if (t(e[_r50])) return !0;
          }

          return !1;
        }(t)
      };
    }

    function di(t, e) {
      return t < e ? -1 : t > e ? 1 : 0;
    }

    function fi(t) {
      if (!t) return !0;
      var e = t[0];
      return t.length <= 1 ? "any" !== e : "==" === e ? yi(t[1], t[2], "==") : "!=" === e ? xi(yi(t[1], t[2], "==")) : "<" === e || ">" === e || "<=" === e || ">=" === e ? yi(t[1], t[2], e) : "any" === e ? (r = t.slice(1), ["any"].concat(r.map(fi))) : "all" === e ? ["all"].concat(t.slice(1).map(fi)) : "none" === e ? ["all"].concat(t.slice(1).map(fi).map(xi)) : "in" === e ? mi(t[1], t.slice(2)) : "!in" === e ? xi(mi(t[1], t.slice(2))) : "has" === e ? gi(t[1]) : "!has" === e ? xi(gi(t[1])) : "within" !== e || t;
      var r;
    }

    function yi(t, e, r) {
      switch (t) {
        case "$type":
          return ["filter-type-".concat(r), e];

        case "$id":
          return ["filter-id-".concat(r), e];

        default:
          return ["filter-".concat(r), t, e];
      }
    }

    function mi(t, e) {
      if (0 === e.length) return !1;

      switch (t) {
        case "$type":
          return ["filter-type-in", ["literal", e]];

        case "$id":
          return ["filter-id-in", ["literal", e]];

        default:
          return e.length > 200 && !e.some(function (t) {
            return _typeof(t) != _typeof(e[0]);
          }) ? ["filter-in-large", t, ["literal", e.sort(di)]] : ["filter-in-small", t, ["literal", e]];
      }
    }

    function gi(t) {
      switch (t) {
        case "$type":
          return !0;

        case "$id":
          return ["filter-has-id"];

        default:
          return ["filter-has", t];
      }
    }

    function xi(t) {
      return ["!", t];
    }

    function vi(t) {
      return ci($t(t.value)) ? li(Ut({}, t, {
        expressionContext: "filter",
        valueSpec: {
          value: "boolean"
        }
      })) : function t(e) {
        var r = e.value,
            i = e.key;
        if ("array" !== Nr(r)) return [new Rt(i, r, "array expected, ".concat(Nr(r), " found"))];
        var n = e.styleSpec;
        var s,
            a = [];
        if (r.length < 1) return [new Rt(i, r, "filter array must have at least 1 element")];

        switch (a = a.concat(ui({
          key: "".concat(i, "[0]"),
          value: r[0],
          valueSpec: n.filter_operator,
          style: e.style,
          styleSpec: e.styleSpec
        })), Ot(r[0])) {
          case "<":
          case "<=":
          case ">":
          case ">=":
            r.length >= 2 && "$type" === Ot(r[1]) && a.push(new Rt(i, r, "\"$type\" cannot be use with operator \"".concat(r[0], "\"")));

          case "==":
          case "!=":
            3 !== r.length && a.push(new Rt(i, r, "filter array for operator \"".concat(r[0], "\" must have 3 elements")));

          case "in":
          case "!in":
            r.length >= 2 && (s = Nr(r[1]), "string" !== s && a.push(new Rt("".concat(i, "[1]"), r[1], "string expected, ".concat(s, " found"))));

            for (var _t43 = 2; _t43 < r.length; _t43++) {
              s = Nr(r[_t43]), "$type" === Ot(r[1]) ? a = a.concat(ui({
                key: "".concat(i, "[").concat(_t43, "]"),
                value: r[_t43],
                valueSpec: n.geometry_type,
                style: e.style,
                styleSpec: e.styleSpec
              })) : "string" !== s && "number" !== s && "boolean" !== s && a.push(new Rt("".concat(i, "[").concat(_t43, "]"), r[_t43], "string, number, or boolean expected, ".concat(s, " found")));
            }

            break;

          case "any":
          case "all":
          case "none":
            for (var _n25 = 1; _n25 < r.length; _n25++) {
              a = a.concat(t({
                key: "".concat(i, "[").concat(_n25, "]"),
                value: r[_n25],
                style: e.style,
                styleSpec: e.styleSpec
              }));
            }

            break;

          case "has":
          case "!has":
            s = Nr(r[1]), 2 !== r.length ? a.push(new Rt(i, r, "filter array for \"".concat(r[0], "\" operator must have 2 elements"))) : "string" !== s && a.push(new Rt("".concat(i, "[1]"), r[1], "string expected, ".concat(s, " found")));
            break;

          case "within":
            s = Nr(r[1]), 2 !== r.length ? a.push(new Rt(i, r, "filter array for \"".concat(r[0], "\" operator must have 2 elements"))) : "object" !== s && a.push(new Rt("".concat(i, "[1]"), r[1], "object expected, ".concat(s, " found")));
        }

        return a;
      }(t);
    }

    function bi(t, e) {
      var r = t.key,
          i = t.style,
          n = t.styleSpec,
          s = t.value,
          a = t.objectKey,
          o = n["".concat(e, "_").concat(t.layerType)];
      if (!o) return [];
      var l = a.match(/^(.*)-transition$/);
      if ("paint" === e && l && o[l[1]] && o[l[1]].transition) return Mi({
        key: r,
        value: s,
        valueSpec: n.transition,
        style: i,
        styleSpec: n
      });
      var u = t.valueSpec || o[a];
      if (!u) return [new Rt(r, s, "unknown property \"".concat(a, "\""))];
      var c;
      if ("string" === Nr(s) && Or(u) && !u.tokens && (c = /^{([^}]+)}$/.exec(s))) return [new Rt(r, s, "\"".concat(a, "\" does not support interpolation syntax\n") + "Use an identity property function instead: `{ \"type\": \"identity\", \"property\": ".concat(JSON.stringify(c[1]), " }`."))];
      var h = [];
      return "symbol" === t.layerType && ("text-field" === a && i && !i.glyphs && h.push(new Rt(r, s, 'use of "text-field" requires a style "glyphs" property')), "text-font" === a && jr($t(s)) && "identity" === Ot(s.type) && h.push(new Rt(r, s, '"text-font" does not support identity functions'))), h.concat(Mi({
        key: t.key,
        value: s,
        valueSpec: u,
        style: i,
        styleSpec: n,
        expressionContext: "property",
        propertyType: e,
        propertyKey: a
      }));
    }

    function wi(t) {
      return bi(t, "paint");
    }

    function _i(t) {
      return bi(t, "layout");
    }

    function ki(t) {
      var e = [];
      var r = t.value,
          i = t.key,
          n = t.style,
          s = t.styleSpec;
      r.type || r.ref || e.push(new Rt(i, r, 'either "type" or "ref" is required'));
      var a = Ot(r.type);
      var o = Ot(r.ref);

      if (r.id) {
        var _s19 = Ot(r.id);

        for (var _a18 = 0; _a18 < t.arrayIndex; _a18++) {
          var _t44 = n.layers[_a18];
          Ot(_t44.id) === _s19 && e.push(new Rt(i, r.id, "duplicate layer id \"".concat(r.id, "\", previously used at line ").concat(_t44.id.__line__)));
        }
      }

      if ("ref" in r) {
        var _t45;

        ["type", "source", "source-layer", "filter", "layout"].forEach(function (t) {
          t in r && e.push(new Rt(i, r[t], "\"".concat(t, "\" is prohibited for ref layers")));
        }), n.layers.forEach(function (e) {
          Ot(e.id) === o && (_t45 = e);
        }), _t45 ? _t45.ref ? e.push(new Rt(i, r.ref, "ref cannot reference another ref layer")) : a = Ot(_t45.type) : e.push(new Rt(i, r.ref, "ref layer \"".concat(o, "\" not found")));
      } else if ("background" !== a && "sky" !== a) if (r.source) {
        var _t46 = n.sources && n.sources[r.source],
            _s20 = _t46 && Ot(_t46.type);

        _t46 ? "vector" === _s20 && "raster" === a ? e.push(new Rt(i, r.source, "layer \"".concat(r.id, "\" requires a raster source"))) : "raster" === _s20 && "raster" !== a ? e.push(new Rt(i, r.source, "layer \"".concat(r.id, "\" requires a vector source"))) : "vector" !== _s20 || r["source-layer"] ? "raster-dem" === _s20 && "hillshade" !== a ? e.push(new Rt(i, r.source, "raster-dem source can only be used with layer type 'hillshade'.")) : "line" !== a || !r.paint || !r.paint["line-gradient"] || "geojson" === _s20 && _t46.lineMetrics || e.push(new Rt(i, r, "layer \"".concat(r.id, "\" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled."))) : e.push(new Rt(i, r, "layer \"".concat(r.id, "\" must specify a \"source-layer\""))) : e.push(new Rt(i, r.source, "source \"".concat(r.source, "\" not found")));
      } else e.push(new Rt(i, r, 'missing required property "source"'));

      return e = e.concat(ni({
        key: i,
        value: r,
        valueSpec: s.layer,
        style: t.style,
        styleSpec: t.styleSpec,
        objectElementValidators: {
          "*": function () {
            return [];
          },
          type: function () {
            return Mi({
              key: "".concat(i, ".type"),
              value: r.type,
              valueSpec: s.layer.type,
              style: t.style,
              styleSpec: t.styleSpec,
              object: r,
              objectKey: "type"
            });
          },
          filter: vi,
          layout: function (t) {
            return ni({
              layer: r,
              key: t.key,
              value: t.value,
              style: t.style,
              styleSpec: t.styleSpec,
              objectElementValidators: {
                "*": function (t) {
                  return _i(Ut({
                    layerType: a
                  }, t));
                }
              }
            });
          },
          paint: function (t) {
            return ni({
              layer: r,
              key: t.key,
              value: t.value,
              style: t.style,
              styleSpec: t.styleSpec,
              objectElementValidators: {
                "*": function (t) {
                  return wi(Ut({
                    layerType: a
                  }, t));
                }
              }
            });
          }
        }
      })), e;
    }

    function Ai(t) {
      var e = t.value,
          r = t.key,
          i = Nr(e);
      return "string" !== i ? [new Rt(r, e, "string expected, ".concat(i, " found"))] : [];
    }

    var Si = {
      promoteId: function (_ref57) {
        var {
          key: t,
          value: e
        } = _ref57;
        if ("string" === Nr(e)) return Ai({
          key: t,
          value: e
        });
        {
          var _r51 = [];

          for (var _i32 in e) {
            _r51.push.apply(_r51, _toConsumableArray(Ai({
              key: "".concat(t, ".").concat(_i32),
              value: e[_i32]
            })));
          }

          return _r51;
        }
      }
    };

    function Ii(t) {
      var e = t.value,
          r = t.key,
          i = t.styleSpec,
          n = t.style;
      if (!e.type) return [new Rt(r, e, '"type" is required')];
      var s = Ot(e.type);
      var a;

      switch (s) {
        case "vector":
        case "raster":
        case "raster-dem":
          return a = ni({
            key: r,
            value: e,
            valueSpec: i["source_".concat(s.replace("-", "_"))],
            style: t.style,
            styleSpec: i,
            objectElementValidators: Si
          }), a;

        case "geojson":
          if (a = ni({
            key: r,
            value: e,
            valueSpec: i.source_geojson,
            style: n,
            styleSpec: i,
            objectElementValidators: Si
          }), e.cluster) for (var _t47 in e.clusterProperties) {
            var _a19, _a20;

            var [_i33, _n26] = e.clusterProperties[_t47],
                _s21 = "string" == typeof _i33 ? [_i33, ["accumulated"], ["get", _t47]] : _i33;

            (_a19 = a).push.apply(_a19, _toConsumableArray(li({
              key: "".concat(r, ".").concat(_t47, ".map"),
              value: _n26,
              expressionContext: "cluster-map"
            }))), (_a20 = a).push.apply(_a20, _toConsumableArray(li({
              key: "".concat(r, ".").concat(_t47, ".reduce"),
              value: _s21,
              expressionContext: "cluster-reduce"
            })));
          }
          return a;

        case "video":
          return ni({
            key: r,
            value: e,
            valueSpec: i.source_video,
            style: n,
            styleSpec: i
          });

        case "image":
          return ni({
            key: r,
            value: e,
            valueSpec: i.source_image,
            style: n,
            styleSpec: i
          });

        case "canvas":
          return [new Rt(r, null, "Please use runtime APIs to add canvas sources, rather than including them in stylesheets.", "source.canvas")];

        default:
          return ui({
            key: "".concat(r, ".type"),
            value: e.type,
            valueSpec: {
              values: ["vector", "raster", "raster-dem", "geojson", "video", "image"]
            },
            style: n,
            styleSpec: i
          });
      }
    }

    function Ti(t) {
      var e = t.value,
          r = t.styleSpec,
          i = r.light,
          n = t.style;
      var s = [];
      var a = Nr(e);
      if (void 0 === e) return s;
      if ("object" !== a) return s = s.concat([new Rt("light", e, "object expected, ".concat(a, " found"))]), s;

      for (var _t48 in e) {
        var _a21 = _t48.match(/^(.*)-transition$/);

        s = s.concat(_a21 && i[_a21[1]] && i[_a21[1]].transition ? Mi({
          key: _t48,
          value: e[_t48],
          valueSpec: r.transition,
          style: n,
          styleSpec: r
        }) : i[_t48] ? Mi({
          key: _t48,
          value: e[_t48],
          valueSpec: i[_t48],
          style: n,
          styleSpec: r
        }) : [new Rt(_t48, e[_t48], "unknown property \"".concat(_t48, "\""))]);
      }

      return s;
    }

    function zi(t) {
      var e = t.value,
          r = t.key,
          i = t.style,
          n = t.styleSpec,
          s = n.terrain;
      var a = [];
      var o = Nr(e);
      if (void 0 === e) return a;
      if ("object" !== o) return a = a.concat([new Rt("terrain", e, "object expected, ".concat(o, " found"))]), a;

      for (var _t49 in e) {
        var _r52 = _t49.match(/^(.*)-transition$/);

        a = a.concat(_r52 && s[_r52[1]] && s[_r52[1]].transition ? Mi({
          key: _t49,
          value: e[_t49],
          valueSpec: n.transition,
          style: i,
          styleSpec: n
        }) : s[_t49] ? Mi({
          key: _t49,
          value: e[_t49],
          valueSpec: s[_t49],
          style: i,
          styleSpec: n
        }) : [new Rt(_t49, e[_t49], "unknown property \"".concat(_t49, "\""))]);
      }

      if (e.source) {
        var _t50 = i.sources && i.sources[e.source],
            _n27 = _t50 && Ot(_t50.type);

        _t50 ? "raster-dem" !== _n27 && a.push(new Rt(r, e.source, "terrain cannot be used with a source of type ".concat(_n27, ", it only be used with a \"raster-dem\" source type"))) : a.push(new Rt(r, e.source, "source \"".concat(e.source, "\" not found")));
      } else a.push(new Rt(r, e, 'terrain is missing required property "source"'));

      return a;
    }

    var Ei = {
      "*": function () {
        return [];
      },
      array: si,
      boolean: function (t) {
        var e = t.value,
            r = t.key,
            i = Nr(e);
        return "boolean" !== i ? [new Rt(r, e, "boolean expected, ".concat(i, " found"))] : [];
      },
      number: ai,
      color: function (t) {
        var e = t.key,
            r = t.value,
            i = Nr(r);
        return "string" !== i ? [new Rt(e, r, "color expected, ".concat(i, " found"))] : null === oe(r) ? [new Rt(e, r, "color expected, \"".concat(r, "\" found"))] : [];
      },
      constants: Lt,
      enum: ui,
      filter: vi,
      function: oi,
      layer: ki,
      object: ni,
      source: Ii,
      light: Ti,
      terrain: zi,
      string: Ai,
      formatted: function (t) {
        return 0 === Ai(t).length ? [] : li(t);
      },
      resolvedImage: function (t) {
        return 0 === Ai(t).length ? [] : li(t);
      }
    };

    function Mi(t) {
      var e = t.value,
          r = t.valueSpec,
          i = t.styleSpec;
      return r.expression && jr(Ot(e)) ? oi(t) : r.expression && Jr($t(e)) ? li(t) : r.type && Ei[r.type] ? Ei[r.type](t) : ni(Ut({}, t, {
        valueSpec: r.type ? i[r.type] : r
      }));
    }

    function Bi(t) {
      var e = t.value,
          r = t.key,
          i = Ai(t);
      return i.length || (-1 === e.indexOf("{fontstack}") && i.push(new Rt(r, e, '"glyphs" url must include a "{fontstack}" token')), -1 === e.indexOf("{range}") && i.push(new Rt(r, e, '"glyphs" url must include a "{range}" token'))), i;
    }

    function Di(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Ft;
      var r = [];
      return r = r.concat(Mi({
        key: "",
        value: t,
        valueSpec: e.$root,
        styleSpec: e,
        style: t,
        objectElementValidators: {
          glyphs: Bi,
          "*": function () {
            return [];
          }
        }
      })), t.constants && (r = r.concat(Lt({
        key: "constants",
        value: t.constants,
        style: t,
        styleSpec: e
      }))), Ci(r);
    }

    function Ci(t) {
      return [].concat(t).sort(function (t, e) {
        return t.line - e.line;
      });
    }

    function Pi(t) {
      return function () {
        for (var _len5 = arguments.length, e = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
          e[_key5] = arguments[_key5];
        }

        return Ci(t.apply(this, e));
      };
    }

    Di.source = Pi(Ii), Di.light = Pi(Ti), Di.terrain = Pi(zi), Di.layer = Pi(ki), Di.filter = Pi(vi), Di.paintProperty = Pi(wi), Di.layoutProperty = Pi(_i);
    var Vi = Di,
        Fi = Vi.light,
        Ri = Vi.paintProperty,
        Li = Vi.layoutProperty;

    function Ui(t, e) {
      var r = !1;
      if (e && e.length) for (var _i34 of e) {
        t.fire(new Pt(new Error(_i34.message))), r = !0;
      }
      return r;
    }

    var Oi = $i;

    function $i(t, e, r) {
      var i = this.cells = [];

      if (t instanceof ArrayBuffer) {
        this.arrayBuffer = t;
        var n = new Int32Array(this.arrayBuffer);
        t = n[0], this.d = (e = n[1]) + 2 * (r = n[2]);

        for (var s = 0; s < this.d * this.d; s++) {
          var a = n[3 + s],
              o = n[3 + s + 1];
          i.push(a === o ? null : n.subarray(a, o));
        }

        var l = n[3 + i.length + 1];
        this.keys = n.subarray(n[3 + i.length], l), this.bboxes = n.subarray(l), this.insert = this._insertReadonly;
      } else {
        this.d = e + 2 * r;

        for (var u = 0; u < this.d * this.d; u++) {
          i.push([]);
        }

        this.keys = [], this.bboxes = [];
      }

      this.n = e, this.extent = t, this.padding = r, this.scale = e / t, this.uid = 0;
      var c = r / e * t;
      this.min = -c, this.max = t + c;
    }

    $i.prototype.insert = function (t, e, r, i, n) {
      this._forEachCell(e, r, i, n, this._insertCell, this.uid++), this.keys.push(t), this.bboxes.push(e), this.bboxes.push(r), this.bboxes.push(i), this.bboxes.push(n);
    }, $i.prototype._insertReadonly = function () {
      throw "Cannot insert into a GridIndex created from an ArrayBuffer.";
    }, $i.prototype._insertCell = function (t, e, r, i, n, s) {
      this.cells[n].push(s);
    }, $i.prototype.query = function (t, e, r, i, n) {
      var s = this.min,
          a = this.max;
      if (t <= s && e <= s && a <= r && a <= i && !n) return Array.prototype.slice.call(this.keys);
      var o = [];
      return this._forEachCell(t, e, r, i, this._queryCell, o, {}, n), o;
    }, $i.prototype._queryCell = function (t, e, r, i, n, s, a, o) {
      var l = this.cells[n];
      if (null !== l) for (var u = this.keys, c = this.bboxes, h = 0; h < l.length; h++) {
        var p = l[h];

        if (void 0 === a[p]) {
          var d = 4 * p;
          (o ? o(c[d + 0], c[d + 1], c[d + 2], c[d + 3]) : t <= c[d + 2] && e <= c[d + 3] && r >= c[d + 0] && i >= c[d + 1]) ? (a[p] = !0, s.push(u[p])) : a[p] = !1;
        }
      }
    }, $i.prototype._forEachCell = function (t, e, r, i, n, s, a, o) {
      for (var l = this._convertToCellCoord(t), u = this._convertToCellCoord(e), c = this._convertToCellCoord(r), h = this._convertToCellCoord(i), p = l; p <= c; p++) {
        for (var d = u; d <= h; d++) {
          var f = this.d * d + p;
          if ((!o || o(this._convertFromCellCoord(p), this._convertFromCellCoord(d), this._convertFromCellCoord(p + 1), this._convertFromCellCoord(d + 1))) && n.call(this, t, e, r, i, f, s, a, o)) return;
        }
      }
    }, $i.prototype._convertFromCellCoord = function (t) {
      return (t - this.padding) / this.scale;
    }, $i.prototype._convertToCellCoord = function (t) {
      return Math.max(0, Math.min(this.d - 1, Math.floor(t * this.scale) + this.padding));
    }, $i.prototype.toArrayBuffer = function () {
      if (this.arrayBuffer) return this.arrayBuffer;

      for (var t = this.cells, e = 3 + this.cells.length + 1 + 1, r = 0, i = 0; i < this.cells.length; i++) {
        r += this.cells[i].length;
      }

      var n = new Int32Array(e + r + this.keys.length + this.bboxes.length);
      n[0] = this.extent, n[1] = this.n, n[2] = this.padding;

      for (var s = e, a = 0; a < t.length; a++) {
        var o = t[a];
        n[3 + a] = s, n.set(o, s), s += o.length;
      }

      return n[3 + t.length] = s, n.set(this.keys, s), n[3 + t.length + 1] = s += this.keys.length, n.set(this.bboxes, s), s += this.bboxes.length, n.buffer;
    };
    var {
      ImageData: qi,
      ImageBitmap: Ni
    } = s,
        ji = {};

    function Gi(t, e) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      Object.defineProperty(e, "_classRegistryKey", {
        value: t,
        writeable: !1
      }), ji[t] = {
        klass: e,
        omit: r.omit || [],
        shallow: r.shallow || []
      };
    }

    Gi("Object", Object), Oi.serialize = function (t, e) {
      var r = t.toArrayBuffer();
      return e && e.push(r), {
        buffer: r
      };
    }, Oi.deserialize = function (t) {
      return new Oi(t.buffer);
    }, Gi("Grid", Oi), Gi("Color", le), Gi("Error", Error), Gi("ResolvedImage", pe), Gi("StylePropertyFunction", ii), Gi("StyleExpression", Wr, {
      omit: ["_evaluator"]
    }), Gi("ZoomDependentExpression", ei), Gi("ZoomConstantExpression", ti), Gi("CompoundExpression", Te, {
      omit: ["_evaluate"]
    });

    for (var _t51 in Cr) {
      Cr[_t51]._classRegistryKey || Gi("Expression_".concat(_t51), Cr[_t51]);
    }

    function Zi(t) {
      return t && "undefined" != typeof ArrayBuffer && (t instanceof ArrayBuffer || t.constructor && "ArrayBuffer" === t.constructor.name);
    }

    function Xi(t) {
      return Ni && t instanceof Ni;
    }

    function Ki(t, e) {
      if (null == t || "boolean" == typeof t || "number" == typeof t || "string" == typeof t || t instanceof Boolean || t instanceof Number || t instanceof String || t instanceof Date || t instanceof RegExp) return t;
      if (Zi(t) || Xi(t)) return e && e.push(t), t;

      if (ArrayBuffer.isView(t)) {
        var _r53 = t;
        return e && e.push(_r53.buffer), _r53;
      }

      if (t instanceof qi) return e && e.push(t.data.buffer), t;

      if (Array.isArray(t)) {
        var _r54 = [];

        for (var _i35 of t) {
          _r54.push(Ki(_i35, e));
        }

        return _r54;
      }

      if ("object" == _typeof(t)) {
        var _r55 = t.constructor,
            _i36 = _r55._classRegistryKey;
        if (!_i36) throw new Error("can't serialize object of unregistered class");

        var _n28 = _r55.serialize ? _r55.serialize(t, e) : {};

        if (!_r55.serialize) {
          for (var _r56 in t) {
            if (!t.hasOwnProperty(_r56)) continue;
            if (ji[_i36].omit.indexOf(_r56) >= 0) continue;
            var _s22 = t[_r56];
            _n28[_r56] = ji[_i36].shallow.indexOf(_r56) >= 0 ? _s22 : Ki(_s22, e);
          }

          t instanceof Error && (_n28.message = t.message);
        }

        if (_n28.$name) throw new Error("$name property is reserved for worker serialization logic.");
        return "Object" !== _i36 && (_n28.$name = _i36), _n28;
      }

      throw new Error("can't serialize object of type ".concat(_typeof(t)));
    }

    function Hi(t) {
      if (null == t || "boolean" == typeof t || "number" == typeof t || "string" == typeof t || t instanceof Boolean || t instanceof Number || t instanceof String || t instanceof Date || t instanceof RegExp || Zi(t) || Xi(t) || ArrayBuffer.isView(t) || t instanceof qi) return t;
      if (Array.isArray(t)) return t.map(Hi);

      if ("object" == _typeof(t)) {
        var _e43 = t.$name || "Object",
            {
          klass: _r57
        } = ji[_e43];

        if (!_r57) throw new Error("can't deserialize unregistered class ".concat(_e43));
        if (_r57.deserialize) return _r57.deserialize(t);

        var _i37 = Object.create(_r57.prototype);

        for (var _r58 of Object.keys(t)) {
          if ("$name" === _r58) continue;
          var _n29 = t[_r58];
          _i37[_r58] = ji[_e43].shallow.indexOf(_r58) >= 0 ? _n29 : Hi(_n29);
        }

        return _i37;
      }

      throw new Error("can't deserialize object of type ".concat(_typeof(t)));
    }

    var Yi = /*#__PURE__*/function () {
      function Yi() {
        _classCallCheck(this, Yi);

        this.first = !0;
      }

      _createClass(Yi, [{
        key: "update",
        value: function update(t, e) {
          var r = Math.floor(t);
          return this.first ? (this.first = !1, this.lastIntegerZoom = r, this.lastIntegerZoomTime = 0, this.lastZoom = t, this.lastFloorZoom = r, !0) : (this.lastFloorZoom > r ? (this.lastIntegerZoom = r + 1, this.lastIntegerZoomTime = e) : this.lastFloorZoom < r && (this.lastIntegerZoom = r, this.lastIntegerZoomTime = e), t !== this.lastZoom && (this.lastZoom = t, this.lastFloorZoom = r, !0));
        }
      }]);

      return Yi;
    }();

    var Wi = function (t) {
      return t >= 1536 && t <= 1791;
    },
        Ji = function (t) {
      return t >= 1872 && t <= 1919;
    },
        Qi = function (t) {
      return t >= 2208 && t <= 2303;
    },
        tn = function (t) {
      return t >= 11904 && t <= 12031;
    },
        en = function (t) {
      return t >= 12032 && t <= 12255;
    },
        rn = function (t) {
      return t >= 12272 && t <= 12287;
    },
        nn = function (t) {
      return t >= 12288 && t <= 12351;
    },
        sn = function (t) {
      return t >= 12352 && t <= 12447;
    },
        an = function (t) {
      return t >= 12448 && t <= 12543;
    },
        on = function (t) {
      return t >= 12544 && t <= 12591;
    },
        ln = function (t) {
      return t >= 12704 && t <= 12735;
    },
        un = function (t) {
      return t >= 12736 && t <= 12783;
    },
        cn = function (t) {
      return t >= 12784 && t <= 12799;
    },
        hn = function (t) {
      return t >= 12800 && t <= 13055;
    },
        pn = function (t) {
      return t >= 13056 && t <= 13311;
    },
        dn = function (t) {
      return t >= 13312 && t <= 19903;
    },
        fn = function (t) {
      return t >= 19968 && t <= 40959;
    },
        yn = function (t) {
      return t >= 40960 && t <= 42127;
    },
        mn = function (t) {
      return t >= 42128 && t <= 42191;
    },
        gn = function (t) {
      return t >= 44032 && t <= 55215;
    },
        xn = function (t) {
      return t >= 63744 && t <= 64255;
    },
        vn = function (t) {
      return t >= 64336 && t <= 65023;
    },
        bn = function (t) {
      return t >= 65040 && t <= 65055;
    },
        wn = function (t) {
      return t >= 65072 && t <= 65103;
    },
        _n = function (t) {
      return t >= 65104 && t <= 65135;
    },
        kn = function (t) {
      return t >= 65136 && t <= 65279;
    },
        An = function (t) {
      return t >= 65280 && t <= 65519;
    };

    function Sn(t) {
      for (var _e44 of t) {
        if (zn(_e44.charCodeAt(0))) return !0;
      }

      return !1;
    }

    function In(t) {
      for (var _e45 of t) {
        if (!Tn(_e45.charCodeAt(0))) return !1;
      }

      return !0;
    }

    function Tn(t) {
      return !(Wi(t) || Ji(t) || Qi(t) || vn(t) || kn(t));
    }

    function zn(t) {
      return !(746 !== t && 747 !== t && (t < 4352 || !(ln(t) || on(t) || wn(t) && !(t >= 65097 && t <= 65103) || xn(t) || pn(t) || tn(t) || un(t) || !(!nn(t) || t >= 12296 && t <= 12305 || t >= 12308 && t <= 12319 || 12336 === t) || dn(t) || fn(t) || hn(t) || function (t) {
        return t >= 12592 && t <= 12687;
      }(t) || function (t) {
        return t >= 43360 && t <= 43391;
      }(t) || function (t) {
        return t >= 55216 && t <= 55295;
      }(t) || function (t) {
        return t >= 4352 && t <= 4607;
      }(t) || gn(t) || sn(t) || rn(t) || function (t) {
        return t >= 12688 && t <= 12703;
      }(t) || en(t) || cn(t) || an(t) && 12540 !== t || !(!An(t) || 65288 === t || 65289 === t || 65293 === t || t >= 65306 && t <= 65310 || 65339 === t || 65341 === t || 65343 === t || t >= 65371 && t <= 65503 || 65507 === t || t >= 65512 && t <= 65519) || !(!_n(t) || t >= 65112 && t <= 65118 || t >= 65123 && t <= 65126) || function (t) {
        return t >= 5120 && t <= 5759;
      }(t) || function (t) {
        return t >= 6320 && t <= 6399;
      }(t) || bn(t) || function (t) {
        return t >= 19904 && t <= 19967;
      }(t) || yn(t) || mn(t))));
    }

    function En(t) {
      return !(zn(t) || function (t) {
        return !!(function (t) {
          return t >= 128 && t <= 255;
        }(t) && (167 === t || 169 === t || 174 === t || 177 === t || 188 === t || 189 === t || 190 === t || 215 === t || 247 === t) || function (t) {
          return t >= 8192 && t <= 8303;
        }(t) && (8214 === t || 8224 === t || 8225 === t || 8240 === t || 8241 === t || 8251 === t || 8252 === t || 8258 === t || 8263 === t || 8264 === t || 8265 === t || 8273 === t) || function (t) {
          return t >= 8448 && t <= 8527;
        }(t) || function (t) {
          return t >= 8528 && t <= 8591;
        }(t) || function (t) {
          return t >= 8960 && t <= 9215;
        }(t) && (t >= 8960 && t <= 8967 || t >= 8972 && t <= 8991 || t >= 8996 && t <= 9e3 || 9003 === t || t >= 9085 && t <= 9114 || t >= 9150 && t <= 9165 || 9167 === t || t >= 9169 && t <= 9179 || t >= 9186 && t <= 9215) || function (t) {
          return t >= 9216 && t <= 9279;
        }(t) && 9251 !== t || function (t) {
          return t >= 9280 && t <= 9311;
        }(t) || function (t) {
          return t >= 9312 && t <= 9471;
        }(t) || function (t) {
          return t >= 9632 && t <= 9727;
        }(t) || function (t) {
          return t >= 9728 && t <= 9983;
        }(t) && !(t >= 9754 && t <= 9759) || function (t) {
          return t >= 11008 && t <= 11263;
        }(t) && (t >= 11026 && t <= 11055 || t >= 11088 && t <= 11097 || t >= 11192 && t <= 11243) || nn(t) || an(t) || function (t) {
          return t >= 57344 && t <= 63743;
        }(t) || wn(t) || _n(t) || An(t) || 8734 === t || 8756 === t || 8757 === t || t >= 9984 && t <= 10087 || t >= 10102 && t <= 10131 || 65532 === t || 65533 === t);
      }(t));
    }

    function Mn(t) {
      return t >= 1424 && t <= 2303 || vn(t) || kn(t);
    }

    function Bn(t, e) {
      return !(!e && Mn(t) || t >= 2304 && t <= 3583 || t >= 3840 && t <= 4255 || function (t) {
        return t >= 6016 && t <= 6143;
      }(t));
    }

    function Dn(t) {
      for (var _e46 of t) {
        if (Mn(_e46.charCodeAt(0))) return !0;
      }

      return !1;
    }

    var Cn = null,
        Pn = "unavailable",
        Vn = null;

    var Fn = function (t) {
      t && "string" == typeof t && t.indexOf("NetworkError") > -1 && (Pn = "error"), Cn && Cn(t);
    };

    function Rn() {
      Ln.fire(new Ct("pluginStateChange", {
        pluginStatus: Pn,
        pluginURL: Vn
      }));
    }

    var Ln = new Vt(),
        Un = function () {
      return Pn;
    },
        On = function () {
      if ("deferred" !== Pn || !Vn) throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");
      Pn = "loading", Rn(), Vn && kt({
        url: Vn
      }, function (t) {
        t ? Fn(t) : (Pn = "loaded", Rn());
      });
    },
        $n = {
      applyArabicShaping: null,
      processBidirectionalText: null,
      processStyledBidirectionalText: null,
      isLoaded: function () {
        return "loaded" === Pn || null != $n.applyArabicShaping;
      },
      isLoading: function () {
        return "loading" === Pn;
      },
      setState: function (t) {
        Pn = t.pluginStatus, Vn = t.pluginURL;
      },
      isParsed: function () {
        return null != $n.applyArabicShaping && null != $n.processBidirectionalText && null != $n.processStyledBidirectionalText;
      },
      getPluginURL: function () {
        return Vn;
      }
    };

    var qn = /*#__PURE__*/function () {
      function qn(t, e) {
        _classCallCheck(this, qn);

        this.zoom = t, e ? (this.now = e.now, this.fadeDuration = e.fadeDuration, this.zoomHistory = e.zoomHistory, this.transition = e.transition) : (this.now = 0, this.fadeDuration = 0, this.zoomHistory = new Yi(), this.transition = {});
      }

      _createClass(qn, [{
        key: "isSupportedScript",
        value: function isSupportedScript(t) {
          return function (t, e) {
            for (var _r59 of t) {
              if (!Bn(_r59.charCodeAt(0), e)) return !1;
            }

            return !0;
          }(t, $n.isLoaded());
        }
      }, {
        key: "crossFadingFactor",
        value: function crossFadingFactor() {
          return 0 === this.fadeDuration ? 1 : Math.min((this.now - this.zoomHistory.lastIntegerZoomTime) / this.fadeDuration, 1);
        }
      }, {
        key: "getCrossfadeParameters",
        value: function getCrossfadeParameters() {
          var t = this.zoom,
              e = t - Math.floor(t),
              r = this.crossFadingFactor();
          return t > this.zoomHistory.lastIntegerZoom ? {
            fromScale: 2,
            toScale: 1,
            t: e + (1 - e) * r
          } : {
            fromScale: .5,
            toScale: 1,
            t: 1 - (1 - r) * e
          };
        }
      }]);

      return qn;
    }();

    var Nn = /*#__PURE__*/function () {
      function Nn(t, e) {
        _classCallCheck(this, Nn);

        this.property = t, this.value = e, this.expression = function (t, e) {
          if (jr(t)) return new ii(t, e);

          if (Jr(t)) {
            var _r60 = ri(t, e);

            if ("error" === _r60.result) throw new Error(_r60.value.map(function (t) {
              return "".concat(t.key, ": ").concat(t.message);
            }).join(", "));
            return _r60.value;
          }

          {
            var _r61 = t;
            return "string" == typeof t && "color" === e.type && (_r61 = le.parse(t)), {
              kind: "constant",
              evaluate: function () {
                return _r61;
              }
            };
          }
        }(void 0 === e ? t.specification.default : e, t.specification);
      }

      _createClass(Nn, [{
        key: "isDataDriven",
        value: function isDataDriven() {
          return "source" === this.expression.kind || "composite" === this.expression.kind;
        }
      }, {
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r) {
          return this.property.possiblyEvaluate(this, t, e, r);
        }
      }]);

      return Nn;
    }();

    var jn = /*#__PURE__*/function () {
      function jn(t) {
        _classCallCheck(this, jn);

        this.property = t, this.value = new Nn(t, void 0);
      }

      _createClass(jn, [{
        key: "transitioned",
        value: function transitioned(t, e) {
          return new Zn(this.property, this.value, e, x({}, t.transition, this.transition), t.now);
        }
      }, {
        key: "untransitioned",
        value: function untransitioned() {
          return new Zn(this.property, this.value, null, {}, 0);
        }
      }]);

      return jn;
    }();

    var Gn = /*#__PURE__*/function () {
      function Gn(t) {
        _classCallCheck(this, Gn);

        this._properties = t, this._values = Object.create(t.defaultTransitionablePropertyValues);
      }

      _createClass(Gn, [{
        key: "getValue",
        value: function getValue(t) {
          return T(this._values[t].value.value);
        }
      }, {
        key: "setValue",
        value: function setValue(t, e) {
          this._values.hasOwnProperty(t) || (this._values[t] = new jn(this._values[t].property)), this._values[t].value = new Nn(this._values[t].property, null === e ? void 0 : T(e));
        }
      }, {
        key: "getTransition",
        value: function getTransition(t) {
          return T(this._values[t].transition);
        }
      }, {
        key: "setTransition",
        value: function setTransition(t, e) {
          this._values.hasOwnProperty(t) || (this._values[t] = new jn(this._values[t].property)), this._values[t].transition = T(e) || void 0;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {};

          for (var _e47 of Object.keys(this._values)) {
            var _r62 = this.getValue(_e47);

            void 0 !== _r62 && (t[_e47] = _r62);

            var _i38 = this.getTransition(_e47);

            void 0 !== _i38 && (t["".concat(_e47, "-transition")] = _i38);
          }

          return t;
        }
      }, {
        key: "transitioned",
        value: function transitioned(t, e) {
          var r = new Xn(this._properties);

          for (var _i39 of Object.keys(this._values)) {
            r._values[_i39] = this._values[_i39].transitioned(t, e._values[_i39]);
          }

          return r;
        }
      }, {
        key: "untransitioned",
        value: function untransitioned() {
          var t = new Xn(this._properties);

          for (var _e48 of Object.keys(this._values)) {
            t._values[_e48] = this._values[_e48].untransitioned();
          }

          return t;
        }
      }]);

      return Gn;
    }();

    var Zn = /*#__PURE__*/function () {
      function Zn(t, e, r, i, n) {
        _classCallCheck(this, Zn);

        this.property = t, this.value = e, this.begin = n + i.delay || 0, this.end = this.begin + i.duration || 0, t.specification.transition && (i.delay || i.duration) && (this.prior = r);
      }

      _createClass(Zn, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r) {
          var i = t.now || 0,
              n = this.value.possiblyEvaluate(t, e, r),
              s = this.prior;

          if (s) {
            if (i > this.end) return this.prior = null, n;
            if (this.value.isDataDriven()) return this.prior = null, n;
            if (i < this.begin) return s.possiblyEvaluate(t, e, r);
            {
              var _a22 = (i - this.begin) / (this.end - this.begin);

              return this.property.interpolate(s.possiblyEvaluate(t, e, r), n, h(_a22));
            }
          }

          return n;
        }
      }]);

      return Zn;
    }();

    var Xn = /*#__PURE__*/function () {
      function Xn(t) {
        _classCallCheck(this, Xn);

        this._properties = t, this._values = Object.create(t.defaultTransitioningPropertyValues);
      }

      _createClass(Xn, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r) {
          var i = new Yn(this._properties);

          for (var _n30 of Object.keys(this._values)) {
            i._values[_n30] = this._values[_n30].possiblyEvaluate(t, e, r);
          }

          return i;
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          for (var _t52 of Object.keys(this._values)) {
            if (this._values[_t52].prior) return !0;
          }

          return !1;
        }
      }]);

      return Xn;
    }();

    var Kn = /*#__PURE__*/function () {
      function Kn(t) {
        _classCallCheck(this, Kn);

        this._properties = t, this._values = Object.create(t.defaultPropertyValues);
      }

      _createClass(Kn, [{
        key: "getValue",
        value: function getValue(t) {
          return T(this._values[t].value);
        }
      }, {
        key: "setValue",
        value: function setValue(t, e) {
          this._values[t] = new Nn(this._values[t].property, null === e ? void 0 : T(e));
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {};

          for (var _e49 of Object.keys(this._values)) {
            var _r63 = this.getValue(_e49);

            void 0 !== _r63 && (t[_e49] = _r63);
          }

          return t;
        }
      }, {
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r) {
          var i = new Yn(this._properties);

          for (var _n31 of Object.keys(this._values)) {
            i._values[_n31] = this._values[_n31].possiblyEvaluate(t, e, r);
          }

          return i;
        }
      }]);

      return Kn;
    }();

    var Hn = /*#__PURE__*/function () {
      function Hn(t, e, r) {
        _classCallCheck(this, Hn);

        this.property = t, this.value = e, this.parameters = r;
      }

      _createClass(Hn, [{
        key: "isConstant",
        value: function isConstant() {
          return "constant" === this.value.kind;
        }
      }, {
        key: "constantOr",
        value: function constantOr(t) {
          return "constant" === this.value.kind ? this.value.value : t;
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, i) {
          return this.property.evaluate(this.value, this.parameters, t, e, r, i);
        }
      }]);

      return Hn;
    }();

    var Yn = /*#__PURE__*/function () {
      function Yn(t) {
        _classCallCheck(this, Yn);

        this._properties = t, this._values = Object.create(t.defaultPossiblyEvaluatedValues);
      }

      _createClass(Yn, [{
        key: "get",
        value: function get(t) {
          return this._values[t];
        }
      }]);

      return Yn;
    }();

    var Wn = /*#__PURE__*/function () {
      function Wn(t) {
        _classCallCheck(this, Wn);

        this.specification = t;
      }

      _createClass(Wn, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e) {
          return t.expression.evaluate(e);
        }
      }, {
        key: "interpolate",
        value: function interpolate(t, e, r) {
          var i = Qe[this.specification.type];
          return i ? i(t, e, r) : t;
        }
      }]);

      return Wn;
    }();

    var Jn = /*#__PURE__*/function () {
      function Jn(t, e) {
        _classCallCheck(this, Jn);

        this.specification = t, this.overrides = e;
      }

      _createClass(Jn, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r, i) {
          return new Hn(this, "constant" === t.expression.kind || "camera" === t.expression.kind ? {
            kind: "constant",
            value: t.expression.evaluate(e, null, {}, r, i)
          } : t.expression, e);
        }
      }, {
        key: "interpolate",
        value: function interpolate(t, e, r) {
          if ("constant" !== t.value.kind || "constant" !== e.value.kind) return t;
          if (void 0 === t.value.value || void 0 === e.value.value) return new Hn(this, {
            kind: "constant",
            value: void 0
          }, t.parameters);
          var i = Qe[this.specification.type];
          return i ? new Hn(this, {
            kind: "constant",
            value: i(t.value.value, e.value.value, r)
          }, t.parameters) : t;
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, i, n, s) {
          return "constant" === t.kind ? t.value : t.evaluate(e, r, i, n, s);
        }
      }]);

      return Jn;
    }();

    var Qn = /*#__PURE__*/function (_Jn) {
      _inherits(Qn, _Jn);

      var _super7 = _createSuper(Qn);

      function Qn() {
        _classCallCheck(this, Qn);

        return _super7.apply(this, arguments);
      }

      _createClass(Qn, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r, i) {
          if (void 0 === t.value) return new Hn(this, {
            kind: "constant",
            value: void 0
          }, e);

          if ("constant" === t.expression.kind) {
            var _n32 = t.expression.evaluate(e, null, {}, r, i),
                _s23 = "resolvedImage" === t.property.specification.type && "string" != typeof _n32 ? _n32.name : _n32,
                _a23 = this._calculate(_s23, _s23, _s23, e);

            return new Hn(this, {
              kind: "constant",
              value: _a23
            }, e);
          }

          if ("camera" === t.expression.kind) {
            var _r64 = this._calculate(t.expression.evaluate({
              zoom: e.zoom - 1
            }), t.expression.evaluate({
              zoom: e.zoom
            }), t.expression.evaluate({
              zoom: e.zoom + 1
            }), e);

            return new Hn(this, {
              kind: "constant",
              value: _r64
            }, e);
          }

          return new Hn(this, t.expression, e);
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, i, n, s) {
          if ("source" === t.kind) {
            var _a24 = t.evaluate(e, r, i, n, s);

            return this._calculate(_a24, _a24, _a24, e);
          }

          return "composite" === t.kind ? this._calculate(t.evaluate({
            zoom: Math.floor(e.zoom) - 1
          }, r, i), t.evaluate({
            zoom: Math.floor(e.zoom)
          }, r, i), t.evaluate({
            zoom: Math.floor(e.zoom) + 1
          }, r, i), e) : t.value;
        }
      }, {
        key: "_calculate",
        value: function _calculate(t, e, r, i) {
          return i.zoom > i.zoomHistory.lastIntegerZoom ? {
            from: t,
            to: e
          } : {
            from: r,
            to: e
          };
        }
      }, {
        key: "interpolate",
        value: function interpolate(t) {
          return t;
        }
      }]);

      return Qn;
    }(Jn);

    var ts = /*#__PURE__*/function () {
      function ts(t) {
        _classCallCheck(this, ts);

        this.specification = t;
      }

      _createClass(ts, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r, i) {
          if (void 0 !== t.value) {
            if ("constant" === t.expression.kind) {
              var _n33 = t.expression.evaluate(e, null, {}, r, i);

              return this._calculate(_n33, _n33, _n33, e);
            }

            return this._calculate(t.expression.evaluate(new qn(Math.floor(e.zoom - 1), e)), t.expression.evaluate(new qn(Math.floor(e.zoom), e)), t.expression.evaluate(new qn(Math.floor(e.zoom + 1), e)), e);
          }
        }
      }, {
        key: "_calculate",
        value: function _calculate(t, e, r, i) {
          return i.zoom > i.zoomHistory.lastIntegerZoom ? {
            from: t,
            to: e
          } : {
            from: r,
            to: e
          };
        }
      }, {
        key: "interpolate",
        value: function interpolate(t) {
          return t;
        }
      }]);

      return ts;
    }();

    var es = /*#__PURE__*/function () {
      function es(t) {
        _classCallCheck(this, es);

        this.specification = t;
      }

      _createClass(es, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r, i) {
          return !!t.expression.evaluate(e, null, {}, r, i);
        }
      }, {
        key: "interpolate",
        value: function interpolate() {
          return !1;
        }
      }]);

      return es;
    }();

    var rs = function rs(t) {
      _classCallCheck(this, rs);

      this.properties = t, this.defaultPropertyValues = {}, this.defaultTransitionablePropertyValues = {}, this.defaultTransitioningPropertyValues = {}, this.defaultPossiblyEvaluatedValues = {}, this.overridableProperties = [];

      for (var _e50 in t) {
        var _r65 = t[_e50];
        _r65.specification.overridable && this.overridableProperties.push(_e50);

        var _i40 = this.defaultPropertyValues[_e50] = new Nn(_r65, void 0),
            _n34 = this.defaultTransitionablePropertyValues[_e50] = new jn(_r65);

        this.defaultTransitioningPropertyValues[_e50] = _n34.untransitioned(), this.defaultPossiblyEvaluatedValues[_e50] = _i40.possiblyEvaluate({});
      }
    };

    function is(t, e) {
      return 256 * (t = f(Math.floor(t), 0, 255)) + f(Math.floor(e), 0, 255);
    }

    Gi("DataDrivenProperty", Jn), Gi("DataConstantProperty", Wn), Gi("CrossFadedDataDrivenProperty", Qn), Gi("CrossFadedProperty", ts), Gi("ColorRampProperty", es);
    var ns = {
      Int8: Int8Array,
      Uint8: Uint8Array,
      Int16: Int16Array,
      Uint16: Uint16Array,
      Int32: Int32Array,
      Uint32: Uint32Array,
      Float32: Float32Array
    };

    var ss = function ss(t, e) {
      _classCallCheck(this, ss);

      this._structArray = t, this._pos1 = e * this.size, this._pos2 = this._pos1 / 2, this._pos4 = this._pos1 / 4, this._pos8 = this._pos1 / 8;
    };

    var as = /*#__PURE__*/function () {
      function as() {
        _classCallCheck(this, as);

        this.isTransferred = !1, this.capacity = -1, this.resize(0);
      }

      _createClass(as, [{
        key: "_trim",
        value: function _trim() {
          this.length !== this.capacity && (this.capacity = this.length, this.arrayBuffer = this.arrayBuffer.slice(0, this.length * this.bytesPerElement), this._refreshViews());
        }
      }, {
        key: "clear",
        value: function clear() {
          this.length = 0;
        }
      }, {
        key: "resize",
        value: function resize(t) {
          this.reserve(t), this.length = t;
        }
      }, {
        key: "reserve",
        value: function reserve(t) {
          if (t > this.capacity) {
            this.capacity = Math.max(t, Math.floor(5 * this.capacity), 128), this.arrayBuffer = new ArrayBuffer(this.capacity * this.bytesPerElement);
            var _e51 = this.uint8;
            this._refreshViews(), _e51 && this.uint8.set(_e51);
          }
        }
      }, {
        key: "_refreshViews",
        value: function _refreshViews() {
          throw new Error("_refreshViews() must be implemented by each concrete StructArray layout");
        }
      }], [{
        key: "serialize",
        value: function serialize(t, e) {
          return t._trim(), e && (t.isTransferred = !0, e.push(t.arrayBuffer)), {
            length: t.length,
            arrayBuffer: t.arrayBuffer
          };
        }
      }, {
        key: "deserialize",
        value: function deserialize(t) {
          var e = Object.create(this.prototype);
          return e.arrayBuffer = t.arrayBuffer, e.length = t.length, e.capacity = t.arrayBuffer.byteLength / e.bytesPerElement, e._refreshViews(), e;
        }
      }]);

      return as;
    }();

    function os(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var r = 0,
          i = 0;
      return {
        members: t.map(function (t) {
          var n = ns[t.type].BYTES_PER_ELEMENT,
              s = r = ls(r, Math.max(e, n)),
              a = t.components || 1;
          return i = Math.max(i, n), r += n * a, {
            name: t.name,
            type: t.type,
            components: a,
            offset: s
          };
        }),
        size: ls(r, Math.max(i, e)),
        alignment: e
      };
    }

    function ls(t, e) {
      return Math.ceil(t / e) * e;
    }

    var us = /*#__PURE__*/function (_as) {
      _inherits(us, _as);

      var _super8 = _createSuper(us);

      function us() {
        _classCallCheck(this, us);

        return _super8.apply(this, arguments);
      }

      _createClass(us, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e) {
          var r = this.length;
          return this.resize(r + 1), this.emplace(r, t, e);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r) {
          var i = 2 * t;
          return this.int16[i + 0] = e, this.int16[i + 1] = r, t;
        }
      }]);

      return us;
    }(as);

    us.prototype.bytesPerElement = 4, Gi("StructArrayLayout2i4", us);

    var cs = /*#__PURE__*/function (_as2) {
      _inherits(cs, _as2);

      var _super9 = _createSuper(cs);

      function cs() {
        _classCallCheck(this, cs);

        return _super9.apply(this, arguments);
      }

      _createClass(cs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i) {
          var n = this.length;
          return this.resize(n + 1), this.emplace(n, t, e, r, i);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n) {
          var s = 4 * t;
          return this.int16[s + 0] = e, this.int16[s + 1] = r, this.int16[s + 2] = i, this.int16[s + 3] = n, t;
        }
      }]);

      return cs;
    }(as);

    cs.prototype.bytesPerElement = 8, Gi("StructArrayLayout4i8", cs);

    var hs = /*#__PURE__*/function (_as3) {
      _inherits(hs, _as3);

      var _super10 = _createSuper(hs);

      function hs() {
        _classCallCheck(this, hs);

        return _super10.apply(this, arguments);
      }

      _createClass(hs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i, n, s, a) {
          var o = this.length;
          return this.resize(o + 1), this.emplace(o, t, e, r, i, n, s, a);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n, s, a, o) {
          var l = 6 * t,
              u = 12 * t,
              c = 3 * t;
          return this.int16[l + 0] = e, this.int16[l + 1] = r, this.uint8[u + 4] = i, this.uint8[u + 5] = n, this.uint8[u + 6] = s, this.uint8[u + 7] = a, this.float32[c + 2] = o, t;
        }
      }]);

      return hs;
    }(as);

    hs.prototype.bytesPerElement = 12, Gi("StructArrayLayout2i4ub1f12", hs);

    var ps = /*#__PURE__*/function (_as4) {
      _inherits(ps, _as4);

      var _super11 = _createSuper(ps);

      function ps() {
        _classCallCheck(this, ps);

        return _super11.apply(this, arguments);
      }

      _createClass(ps, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e) {
          var r = this.length;
          return this.resize(r + 1), this.emplace(r, t, e);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r) {
          var i = 2 * t;
          return this.float32[i + 0] = e, this.float32[i + 1] = r, t;
        }
      }]);

      return ps;
    }(as);

    ps.prototype.bytesPerElement = 8, Gi("StructArrayLayout2f8", ps);

    var ds = /*#__PURE__*/function (_as5) {
      _inherits(ds, _as5);

      var _super12 = _createSuper(ds);

      function ds() {
        _classCallCheck(this, ds);

        return _super12.apply(this, arguments);
      }

      _createClass(ds, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i, n, s, a, o, l, u) {
          var c = this.length;
          return this.resize(c + 1), this.emplace(c, t, e, r, i, n, s, a, o, l, u);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n, s, a, o, l, u, c) {
          var h = 10 * t;
          return this.uint16[h + 0] = e, this.uint16[h + 1] = r, this.uint16[h + 2] = i, this.uint16[h + 3] = n, this.uint16[h + 4] = s, this.uint16[h + 5] = a, this.uint16[h + 6] = o, this.uint16[h + 7] = l, this.uint16[h + 8] = u, this.uint16[h + 9] = c, t;
        }
      }]);

      return ds;
    }(as);

    ds.prototype.bytesPerElement = 20, Gi("StructArrayLayout10ui20", ds);

    var fs = /*#__PURE__*/function (_as6) {
      _inherits(fs, _as6);

      var _super13 = _createSuper(fs);

      function fs() {
        _classCallCheck(this, fs);

        return _super13.apply(this, arguments);
      }

      _createClass(fs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i, n, s, a, o, l, u, c, h) {
          var p = this.length;
          return this.resize(p + 1), this.emplace(p, t, e, r, i, n, s, a, o, l, u, c, h);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n, s, a, o, l, u, c, h, p) {
          var d = 12 * t;
          return this.int16[d + 0] = e, this.int16[d + 1] = r, this.int16[d + 2] = i, this.int16[d + 3] = n, this.uint16[d + 4] = s, this.uint16[d + 5] = a, this.uint16[d + 6] = o, this.uint16[d + 7] = l, this.int16[d + 8] = u, this.int16[d + 9] = c, this.int16[d + 10] = h, this.int16[d + 11] = p, t;
        }
      }]);

      return fs;
    }(as);

    fs.prototype.bytesPerElement = 24, Gi("StructArrayLayout4i4ui4i24", fs);

    var ys = /*#__PURE__*/function (_as7) {
      _inherits(ys, _as7);

      var _super14 = _createSuper(ys);

      function ys() {
        _classCallCheck(this, ys);

        return _super14.apply(this, arguments);
      }

      _createClass(ys, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r) {
          var i = this.length;
          return this.resize(i + 1), this.emplace(i, t, e, r);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i) {
          var n = 3 * t;
          return this.float32[n + 0] = e, this.float32[n + 1] = r, this.float32[n + 2] = i, t;
        }
      }]);

      return ys;
    }(as);

    ys.prototype.bytesPerElement = 12, Gi("StructArrayLayout3f12", ys);

    var ms = /*#__PURE__*/function (_as8) {
      _inherits(ms, _as8);

      var _super15 = _createSuper(ms);

      function ms() {
        _classCallCheck(this, ms);

        return _super15.apply(this, arguments);
      }

      _createClass(ms, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t) {
          var e = this.length;
          return this.resize(e + 1), this.emplace(e, t);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e) {
          return this.uint32[1 * t + 0] = e, t;
        }
      }]);

      return ms;
    }(as);

    ms.prototype.bytesPerElement = 4, Gi("StructArrayLayout1ul4", ms);

    var gs = /*#__PURE__*/function (_as9) {
      _inherits(gs, _as9);

      var _super16 = _createSuper(gs);

      function gs() {
        _classCallCheck(this, gs);

        return _super16.apply(this, arguments);
      }

      _createClass(gs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i, n, s, a, o, l, u) {
          var c = this.length;
          return this.resize(c + 1), this.emplace(c, t, e, r, i, n, s, a, o, l, u);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n, s, a, o, l, u, c) {
          var h = 16 * t,
              p = 8 * t;
          return this.int16[h + 0] = e, this.int16[h + 1] = r, this.float32[p + 1] = i, this.float32[p + 2] = n, this.float32[p + 3] = s, this.float32[p + 4] = a, this.int16[h + 10] = o, this.uint32[p + 6] = l, this.uint16[h + 14] = u, this.uint16[h + 15] = c, t;
        }
      }]);

      return gs;
    }(as);

    gs.prototype.bytesPerElement = 32, Gi("StructArrayLayout2i4f1i1ul2ui32", gs);

    var xs = /*#__PURE__*/function (_as10) {
      _inherits(xs, _as10);

      var _super17 = _createSuper(xs);

      function xs() {
        _classCallCheck(this, xs);

        return _super17.apply(this, arguments);
      }

      _createClass(xs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i, n, s) {
          var a = this.length;
          return this.resize(a + 1), this.emplace(a, t, e, r, i, n, s);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n, s, a) {
          var o = 6 * t;
          return this.int16[o + 0] = e, this.int16[o + 1] = r, this.int16[o + 2] = i, this.int16[o + 3] = n, this.int16[o + 4] = s, this.int16[o + 5] = a, t;
        }
      }]);

      return xs;
    }(as);

    xs.prototype.bytesPerElement = 12, Gi("StructArrayLayout2i2i2i12", xs);

    var vs = /*#__PURE__*/function (_as11) {
      _inherits(vs, _as11);

      var _super18 = _createSuper(vs);

      function vs() {
        _classCallCheck(this, vs);

        return _super18.apply(this, arguments);
      }

      _createClass(vs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i, n) {
          var s = this.length;
          return this.resize(s + 1), this.emplace(s, t, e, r, i, n);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n, s) {
          var a = 4 * t,
              o = 8 * t;
          return this.float32[a + 0] = e, this.float32[a + 1] = r, this.float32[a + 2] = i, this.int16[o + 6] = n, this.int16[o + 7] = s, t;
        }
      }]);

      return vs;
    }(as);

    vs.prototype.bytesPerElement = 16, Gi("StructArrayLayout2f1f2i16", vs);

    var bs = /*#__PURE__*/function (_as12) {
      _inherits(bs, _as12);

      var _super19 = _createSuper(bs);

      function bs() {
        _classCallCheck(this, bs);

        return _super19.apply(this, arguments);
      }

      _createClass(bs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i) {
          var n = this.length;
          return this.resize(n + 1), this.emplace(n, t, e, r, i);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n) {
          var s = 12 * t,
              a = 3 * t;
          return this.uint8[s + 0] = e, this.uint8[s + 1] = r, this.float32[a + 1] = i, this.float32[a + 2] = n, t;
        }
      }]);

      return bs;
    }(as);

    bs.prototype.bytesPerElement = 12, Gi("StructArrayLayout2ub2f12", bs);

    var ws = /*#__PURE__*/function (_as13) {
      _inherits(ws, _as13);

      var _super20 = _createSuper(ws);

      function ws() {
        _classCallCheck(this, ws);

        return _super20.apply(this, arguments);
      }

      _createClass(ws, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r) {
          var i = this.length;
          return this.resize(i + 1), this.emplace(i, t, e, r);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i) {
          var n = 3 * t;
          return this.uint16[n + 0] = e, this.uint16[n + 1] = r, this.uint16[n + 2] = i, t;
        }
      }]);

      return ws;
    }(as);

    ws.prototype.bytesPerElement = 6, Gi("StructArrayLayout3ui6", ws);

    var _s = /*#__PURE__*/function (_as14) {
      _inherits(_s, _as14);

      var _super21 = _createSuper(_s);

      function _s() {
        _classCallCheck(this, _s);

        return _super21.apply(this, arguments);
      }

      _createClass(_s, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i, n, s, a, o, l, u, c, h, p, d, f, y, m) {
          var g = this.length;
          return this.resize(g + 1), this.emplace(g, t, e, r, i, n, s, a, o, l, u, c, h, p, d, f, y, m);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n, s, a, o, l, u, c, h, p, d, f, y, m, g) {
          var x = 24 * t,
              v = 12 * t,
              b = 48 * t;
          return this.int16[x + 0] = e, this.int16[x + 1] = r, this.uint16[x + 2] = i, this.uint16[x + 3] = n, this.uint32[v + 2] = s, this.uint32[v + 3] = a, this.uint32[v + 4] = o, this.uint16[x + 10] = l, this.uint16[x + 11] = u, this.uint16[x + 12] = c, this.float32[v + 7] = h, this.float32[v + 8] = p, this.uint8[b + 36] = d, this.uint8[b + 37] = f, this.uint8[b + 38] = y, this.uint32[v + 10] = m, this.int16[x + 22] = g, t;
        }
      }]);

      return _s;
    }(as);

    _s.prototype.bytesPerElement = 48, Gi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48", _s);

    var ks = /*#__PURE__*/function (_as15) {
      _inherits(ks, _as15);

      var _super22 = _createSuper(ks);

      function ks() {
        _classCallCheck(this, ks);

        return _super22.apply(this, arguments);
      }

      _createClass(ks, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i, n, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b, w, _, k, A, S, I, T) {
          var z = this.length;
          return this.resize(z + 1), this.emplace(z, t, e, r, i, n, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b, w, _, k, A, S, I, T);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b, w, _, k, A, S, I, T, z) {
          var E = 34 * t,
              M = 17 * t;
          return this.int16[E + 0] = e, this.int16[E + 1] = r, this.int16[E + 2] = i, this.int16[E + 3] = n, this.int16[E + 4] = s, this.int16[E + 5] = a, this.int16[E + 6] = o, this.int16[E + 7] = l, this.uint16[E + 8] = u, this.uint16[E + 9] = c, this.uint16[E + 10] = h, this.uint16[E + 11] = p, this.uint16[E + 12] = d, this.uint16[E + 13] = f, this.uint16[E + 14] = y, this.uint16[E + 15] = m, this.uint16[E + 16] = g, this.uint16[E + 17] = x, this.uint16[E + 18] = v, this.uint16[E + 19] = b, this.uint16[E + 20] = w, this.uint16[E + 21] = _, this.uint16[E + 22] = k, this.uint32[M + 12] = A, this.float32[M + 13] = S, this.float32[M + 14] = I, this.float32[M + 15] = T, this.float32[M + 16] = z, t;
        }
      }]);

      return ks;
    }(as);

    ks.prototype.bytesPerElement = 68, Gi("StructArrayLayout8i15ui1ul4f68", ks);

    var As = /*#__PURE__*/function (_as16) {
      _inherits(As, _as16);

      var _super23 = _createSuper(As);

      function As() {
        _classCallCheck(this, As);

        return _super23.apply(this, arguments);
      }

      _createClass(As, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t) {
          var e = this.length;
          return this.resize(e + 1), this.emplace(e, t);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e) {
          return this.float32[1 * t + 0] = e, t;
        }
      }]);

      return As;
    }(as);

    As.prototype.bytesPerElement = 4, Gi("StructArrayLayout1f4", As);

    var Ss = /*#__PURE__*/function (_as17) {
      _inherits(Ss, _as17);

      var _super24 = _createSuper(Ss);

      function Ss() {
        _classCallCheck(this, Ss);

        return _super24.apply(this, arguments);
      }

      _createClass(Ss, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r) {
          var i = this.length;
          return this.resize(i + 1), this.emplace(i, t, e, r);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i) {
          var n = 3 * t;
          return this.int16[n + 0] = e, this.int16[n + 1] = r, this.int16[n + 2] = i, t;
        }
      }]);

      return Ss;
    }(as);

    Ss.prototype.bytesPerElement = 6, Gi("StructArrayLayout3i6", Ss);

    var Is = /*#__PURE__*/function (_as18) {
      _inherits(Is, _as18);

      var _super25 = _createSuper(Is);

      function Is() {
        _classCallCheck(this, Is);

        return _super25.apply(this, arguments);
      }

      _createClass(Is, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i) {
          var n = this.length;
          return this.resize(n + 1), this.emplace(n, t, e, r, i);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n) {
          var s = 6 * t;
          return this.uint32[3 * t + 0] = e, this.uint16[s + 2] = r, this.uint16[s + 3] = i, this.uint16[s + 4] = n, t;
        }
      }]);

      return Is;
    }(as);

    Is.prototype.bytesPerElement = 12, Gi("StructArrayLayout1ul3ui12", Is);

    var Ts = /*#__PURE__*/function (_as19) {
      _inherits(Ts, _as19);

      var _super26 = _createSuper(Ts);

      function Ts() {
        _classCallCheck(this, Ts);

        return _super26.apply(this, arguments);
      }

      _createClass(Ts, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e) {
          var r = this.length;
          return this.resize(r + 1), this.emplace(r, t, e);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r) {
          var i = 2 * t;
          return this.uint16[i + 0] = e, this.uint16[i + 1] = r, t;
        }
      }]);

      return Ts;
    }(as);

    Ts.prototype.bytesPerElement = 4, Gi("StructArrayLayout2ui4", Ts);

    var zs = /*#__PURE__*/function (_as20) {
      _inherits(zs, _as20);

      var _super27 = _createSuper(zs);

      function zs() {
        _classCallCheck(this, zs);

        return _super27.apply(this, arguments);
      }

      _createClass(zs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t) {
          var e = this.length;
          return this.resize(e + 1), this.emplace(e, t);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e) {
          return this.uint16[1 * t + 0] = e, t;
        }
      }]);

      return zs;
    }(as);

    zs.prototype.bytesPerElement = 2, Gi("StructArrayLayout1ui2", zs);

    var Es = /*#__PURE__*/function (_as21) {
      _inherits(Es, _as21);

      var _super28 = _createSuper(Es);

      function Es() {
        _classCallCheck(this, Es);

        return _super28.apply(this, arguments);
      }

      _createClass(Es, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, i) {
          var n = this.length;
          return this.resize(n + 1), this.emplace(n, t, e, r, i);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, i, n) {
          var s = 4 * t;
          return this.float32[s + 0] = e, this.float32[s + 1] = r, this.float32[s + 2] = i, this.float32[s + 3] = n, t;
        }
      }]);

      return Es;
    }(as);

    Es.prototype.bytesPerElement = 16, Gi("StructArrayLayout4f16", Es);

    var Ms = /*#__PURE__*/function (_ss) {
      _inherits(Ms, _ss);

      var _super29 = _createSuper(Ms);

      function Ms() {
        _classCallCheck(this, Ms);

        return _super29.apply(this, arguments);
      }

      _createClass(Ms, [{
        key: "anchorPointX",
        get: function () {
          return this._structArray.int16[this._pos2 + 0];
        }
      }, {
        key: "anchorPointY",
        get: function () {
          return this._structArray.int16[this._pos2 + 1];
        }
      }, {
        key: "x1",
        get: function () {
          return this._structArray.float32[this._pos4 + 1];
        }
      }, {
        key: "y1",
        get: function () {
          return this._structArray.float32[this._pos4 + 2];
        }
      }, {
        key: "x2",
        get: function () {
          return this._structArray.float32[this._pos4 + 3];
        }
      }, {
        key: "y2",
        get: function () {
          return this._structArray.float32[this._pos4 + 4];
        }
      }, {
        key: "padding",
        get: function () {
          return this._structArray.int16[this._pos2 + 10];
        }
      }, {
        key: "featureIndex",
        get: function () {
          return this._structArray.uint32[this._pos4 + 6];
        }
      }, {
        key: "sourceLayerIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 14];
        }
      }, {
        key: "bucketIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 15];
        }
      }, {
        key: "anchorPoint",
        get: function () {
          return new i(this.anchorPointX, this.anchorPointY);
        }
      }]);

      return Ms;
    }(ss);

    Ms.prototype.size = 32;

    var Bs = /*#__PURE__*/function (_gs) {
      _inherits(Bs, _gs);

      var _super30 = _createSuper(Bs);

      function Bs() {
        _classCallCheck(this, Bs);

        return _super30.apply(this, arguments);
      }

      _createClass(Bs, [{
        key: "get",
        value: function get(t) {
          return new Ms(this, t);
        }
      }]);

      return Bs;
    }(gs);

    Gi("CollisionBoxArray", Bs);

    var Ds = /*#__PURE__*/function (_ss2) {
      _inherits(Ds, _ss2);

      var _super31 = _createSuper(Ds);

      function Ds() {
        _classCallCheck(this, Ds);

        return _super31.apply(this, arguments);
      }

      _createClass(Ds, [{
        key: "anchorX",
        get: function () {
          return this._structArray.int16[this._pos2 + 0];
        }
      }, {
        key: "anchorY",
        get: function () {
          return this._structArray.int16[this._pos2 + 1];
        }
      }, {
        key: "glyphStartIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 2];
        }
      }, {
        key: "numGlyphs",
        get: function () {
          return this._structArray.uint16[this._pos2 + 3];
        }
      }, {
        key: "vertexStartIndex",
        get: function () {
          return this._structArray.uint32[this._pos4 + 2];
        }
      }, {
        key: "lineStartIndex",
        get: function () {
          return this._structArray.uint32[this._pos4 + 3];
        }
      }, {
        key: "lineLength",
        get: function () {
          return this._structArray.uint32[this._pos4 + 4];
        }
      }, {
        key: "segment",
        get: function () {
          return this._structArray.uint16[this._pos2 + 10];
        }
      }, {
        key: "lowerSize",
        get: function () {
          return this._structArray.uint16[this._pos2 + 11];
        }
      }, {
        key: "upperSize",
        get: function () {
          return this._structArray.uint16[this._pos2 + 12];
        }
      }, {
        key: "lineOffsetX",
        get: function () {
          return this._structArray.float32[this._pos4 + 7];
        }
      }, {
        key: "lineOffsetY",
        get: function () {
          return this._structArray.float32[this._pos4 + 8];
        }
      }, {
        key: "writingMode",
        get: function () {
          return this._structArray.uint8[this._pos1 + 36];
        }
      }, {
        key: "placedOrientation",
        get: function () {
          return this._structArray.uint8[this._pos1 + 37];
        },
        set: function (t) {
          this._structArray.uint8[this._pos1 + 37] = t;
        }
      }, {
        key: "hidden",
        get: function () {
          return this._structArray.uint8[this._pos1 + 38];
        },
        set: function (t) {
          this._structArray.uint8[this._pos1 + 38] = t;
        }
      }, {
        key: "crossTileID",
        get: function () {
          return this._structArray.uint32[this._pos4 + 10];
        },
        set: function (t) {
          this._structArray.uint32[this._pos4 + 10] = t;
        }
      }, {
        key: "associatedIconIndex",
        get: function () {
          return this._structArray.int16[this._pos2 + 22];
        }
      }]);

      return Ds;
    }(ss);

    Ds.prototype.size = 48;

    var Cs = /*#__PURE__*/function (_s24) {
      _inherits(Cs, _s24);

      var _super32 = _createSuper(Cs);

      function Cs() {
        _classCallCheck(this, Cs);

        return _super32.apply(this, arguments);
      }

      _createClass(Cs, [{
        key: "get",
        value: function get(t) {
          return new Ds(this, t);
        }
      }]);

      return Cs;
    }(_s);

    Gi("PlacedSymbolArray", Cs);

    var Ps = /*#__PURE__*/function (_ss3) {
      _inherits(Ps, _ss3);

      var _super33 = _createSuper(Ps);

      function Ps() {
        _classCallCheck(this, Ps);

        return _super33.apply(this, arguments);
      }

      _createClass(Ps, [{
        key: "anchorX",
        get: function () {
          return this._structArray.int16[this._pos2 + 0];
        }
      }, {
        key: "anchorY",
        get: function () {
          return this._structArray.int16[this._pos2 + 1];
        }
      }, {
        key: "rightJustifiedTextSymbolIndex",
        get: function () {
          return this._structArray.int16[this._pos2 + 2];
        }
      }, {
        key: "centerJustifiedTextSymbolIndex",
        get: function () {
          return this._structArray.int16[this._pos2 + 3];
        }
      }, {
        key: "leftJustifiedTextSymbolIndex",
        get: function () {
          return this._structArray.int16[this._pos2 + 4];
        }
      }, {
        key: "verticalPlacedTextSymbolIndex",
        get: function () {
          return this._structArray.int16[this._pos2 + 5];
        }
      }, {
        key: "placedIconSymbolIndex",
        get: function () {
          return this._structArray.int16[this._pos2 + 6];
        }
      }, {
        key: "verticalPlacedIconSymbolIndex",
        get: function () {
          return this._structArray.int16[this._pos2 + 7];
        }
      }, {
        key: "key",
        get: function () {
          return this._structArray.uint16[this._pos2 + 8];
        }
      }, {
        key: "textBoxStartIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 9];
        }
      }, {
        key: "textBoxEndIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 10];
        }
      }, {
        key: "verticalTextBoxStartIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 11];
        }
      }, {
        key: "verticalTextBoxEndIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 12];
        }
      }, {
        key: "iconBoxStartIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 13];
        }
      }, {
        key: "iconBoxEndIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 14];
        }
      }, {
        key: "verticalIconBoxStartIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 15];
        }
      }, {
        key: "verticalIconBoxEndIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 16];
        }
      }, {
        key: "featureIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 17];
        }
      }, {
        key: "numHorizontalGlyphVertices",
        get: function () {
          return this._structArray.uint16[this._pos2 + 18];
        }
      }, {
        key: "numVerticalGlyphVertices",
        get: function () {
          return this._structArray.uint16[this._pos2 + 19];
        }
      }, {
        key: "numIconVertices",
        get: function () {
          return this._structArray.uint16[this._pos2 + 20];
        }
      }, {
        key: "numVerticalIconVertices",
        get: function () {
          return this._structArray.uint16[this._pos2 + 21];
        }
      }, {
        key: "useRuntimeCollisionCircles",
        get: function () {
          return this._structArray.uint16[this._pos2 + 22];
        }
      }, {
        key: "crossTileID",
        get: function () {
          return this._structArray.uint32[this._pos4 + 12];
        },
        set: function (t) {
          this._structArray.uint32[this._pos4 + 12] = t;
        }
      }, {
        key: "textBoxScale",
        get: function () {
          return this._structArray.float32[this._pos4 + 13];
        }
      }, {
        key: "textOffset0",
        get: function () {
          return this._structArray.float32[this._pos4 + 14];
        }
      }, {
        key: "textOffset1",
        get: function () {
          return this._structArray.float32[this._pos4 + 15];
        }
      }, {
        key: "collisionCircleDiameter",
        get: function () {
          return this._structArray.float32[this._pos4 + 16];
        }
      }]);

      return Ps;
    }(ss);

    Ps.prototype.size = 68;

    var Vs = /*#__PURE__*/function (_ks) {
      _inherits(Vs, _ks);

      var _super34 = _createSuper(Vs);

      function Vs() {
        _classCallCheck(this, Vs);

        return _super34.apply(this, arguments);
      }

      _createClass(Vs, [{
        key: "get",
        value: function get(t) {
          return new Ps(this, t);
        }
      }]);

      return Vs;
    }(ks);

    Gi("SymbolInstanceArray", Vs);

    var Fs = /*#__PURE__*/function (_As) {
      _inherits(Fs, _As);

      var _super35 = _createSuper(Fs);

      function Fs() {
        _classCallCheck(this, Fs);

        return _super35.apply(this, arguments);
      }

      _createClass(Fs, [{
        key: "getoffsetX",
        value: function getoffsetX(t) {
          return this.float32[1 * t + 0];
        }
      }]);

      return Fs;
    }(As);

    Gi("GlyphOffsetArray", Fs);

    var Rs = /*#__PURE__*/function (_Ss) {
      _inherits(Rs, _Ss);

      var _super36 = _createSuper(Rs);

      function Rs() {
        _classCallCheck(this, Rs);

        return _super36.apply(this, arguments);
      }

      _createClass(Rs, [{
        key: "getx",
        value: function getx(t) {
          return this.int16[3 * t + 0];
        }
      }, {
        key: "gety",
        value: function gety(t) {
          return this.int16[3 * t + 1];
        }
      }, {
        key: "gettileUnitDistanceFromAnchor",
        value: function gettileUnitDistanceFromAnchor(t) {
          return this.int16[3 * t + 2];
        }
      }]);

      return Rs;
    }(Ss);

    Gi("SymbolLineVertexArray", Rs);

    var Ls = /*#__PURE__*/function (_ss4) {
      _inherits(Ls, _ss4);

      var _super37 = _createSuper(Ls);

      function Ls() {
        _classCallCheck(this, Ls);

        return _super37.apply(this, arguments);
      }

      _createClass(Ls, [{
        key: "featureIndex",
        get: function () {
          return this._structArray.uint32[this._pos4 + 0];
        }
      }, {
        key: "sourceLayerIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 2];
        }
      }, {
        key: "bucketIndex",
        get: function () {
          return this._structArray.uint16[this._pos2 + 3];
        }
      }, {
        key: "layoutVertexArrayOffset",
        get: function () {
          return this._structArray.uint16[this._pos2 + 4];
        }
      }]);

      return Ls;
    }(ss);

    Ls.prototype.size = 12;

    var Us = /*#__PURE__*/function (_Is) {
      _inherits(Us, _Is);

      var _super38 = _createSuper(Us);

      function Us() {
        _classCallCheck(this, Us);

        return _super38.apply(this, arguments);
      }

      _createClass(Us, [{
        key: "get",
        value: function get(t) {
          return new Ls(this, t);
        }
      }]);

      return Us;
    }(Is);

    Gi("FeatureIndexArray", Us);

    var Os = /*#__PURE__*/function (_ss5) {
      _inherits(Os, _ss5);

      var _super39 = _createSuper(Os);

      function Os() {
        _classCallCheck(this, Os);

        return _super39.apply(this, arguments);
      }

      _createClass(Os, [{
        key: "a_centroid_pos0",
        get: function () {
          return this._structArray.uint16[this._pos2 + 0];
        }
      }, {
        key: "a_centroid_pos1",
        get: function () {
          return this._structArray.uint16[this._pos2 + 1];
        }
      }]);

      return Os;
    }(ss);

    Os.prototype.size = 4;

    var $s = /*#__PURE__*/function (_Ts) {
      _inherits($s, _Ts);

      var _super40 = _createSuper($s);

      function $s() {
        _classCallCheck(this, $s);

        return _super40.apply(this, arguments);
      }

      _createClass($s, [{
        key: "get",
        value: function get(t) {
          return new Os(this, t);
        }
      }]);

      return $s;
    }(Ts);

    Gi("FillExtrusionCentroidArray", $s);
    var qs = os([{
      name: "a_pattern_to",
      components: 4,
      type: "Uint16"
    }, {
      name: "a_pattern_from",
      components: 4,
      type: "Uint16"
    }, {
      name: "a_pixel_ratio_to",
      components: 1,
      type: "Uint16"
    }, {
      name: "a_pixel_ratio_from",
      components: 1,
      type: "Uint16"
    }]);
    var Ns = ae(function (t) {
      t.exports = function (t, e) {
        var r, i, n, s, a, o, l, u;

        for (i = t.length - (r = 3 & t.length), n = e, a = 3432918353, o = 461845907, u = 0; u < i;) {
          l = 255 & t.charCodeAt(u) | (255 & t.charCodeAt(++u)) << 8 | (255 & t.charCodeAt(++u)) << 16 | (255 & t.charCodeAt(++u)) << 24, ++u, n = 27492 + (65535 & (s = 5 * (65535 & (n = (n ^= l = (65535 & (l = (l = (65535 & l) * a + (((l >>> 16) * a & 65535) << 16) & 4294967295) << 15 | l >>> 17)) * o + (((l >>> 16) * o & 65535) << 16) & 4294967295) << 13 | n >>> 19)) + ((5 * (n >>> 16) & 65535) << 16) & 4294967295)) + ((58964 + (s >>> 16) & 65535) << 16);
        }

        switch (l = 0, r) {
          case 3:
            l ^= (255 & t.charCodeAt(u + 2)) << 16;

          case 2:
            l ^= (255 & t.charCodeAt(u + 1)) << 8;

          case 1:
            n ^= l = (65535 & (l = (l = (65535 & (l ^= 255 & t.charCodeAt(u))) * a + (((l >>> 16) * a & 65535) << 16) & 4294967295) << 15 | l >>> 17)) * o + (((l >>> 16) * o & 65535) << 16) & 4294967295;
        }

        return n ^= t.length, n = 2246822507 * (65535 & (n ^= n >>> 16)) + ((2246822507 * (n >>> 16) & 65535) << 16) & 4294967295, n = 3266489909 * (65535 & (n ^= n >>> 13)) + ((3266489909 * (n >>> 16) & 65535) << 16) & 4294967295, (n ^= n >>> 16) >>> 0;
      };
    }),
        js = ae(function (t) {
      t.exports = function (t, e) {
        for (var r, i = t.length, n = e ^ i, s = 0; i >= 4;) {
          r = 1540483477 * (65535 & (r = 255 & t.charCodeAt(s) | (255 & t.charCodeAt(++s)) << 8 | (255 & t.charCodeAt(++s)) << 16 | (255 & t.charCodeAt(++s)) << 24)) + ((1540483477 * (r >>> 16) & 65535) << 16), n = 1540483477 * (65535 & n) + ((1540483477 * (n >>> 16) & 65535) << 16) ^ (r = 1540483477 * (65535 & (r ^= r >>> 24)) + ((1540483477 * (r >>> 16) & 65535) << 16)), i -= 4, ++s;
        }

        switch (i) {
          case 3:
            n ^= (255 & t.charCodeAt(s + 2)) << 16;

          case 2:
            n ^= (255 & t.charCodeAt(s + 1)) << 8;

          case 1:
            n = 1540483477 * (65535 & (n ^= 255 & t.charCodeAt(s))) + ((1540483477 * (n >>> 16) & 65535) << 16);
        }

        return n = 1540483477 * (65535 & (n ^= n >>> 13)) + ((1540483477 * (n >>> 16) & 65535) << 16), (n ^= n >>> 15) >>> 0;
      };
    }),
        Gs = Ns,
        Zs = js;
    Gs.murmur3 = Ns, Gs.murmur2 = Zs;

    var Xs = /*#__PURE__*/function () {
      function Xs() {
        _classCallCheck(this, Xs);

        this.ids = [], this.positions = [], this.indexed = !1;
      }

      _createClass(Xs, [{
        key: "add",
        value: function add(t, e, r, i) {
          this.ids.push(Ks(t)), this.positions.push(e, r, i);
        }
      }, {
        key: "getPositions",
        value: function getPositions(t) {
          var e = Ks(t);
          var r = 0,
              i = this.ids.length - 1;

          for (; r < i;) {
            var _t53 = r + i >> 1;

            this.ids[_t53] >= e ? i = _t53 : r = _t53 + 1;
          }

          var n = [];

          for (; this.ids[r] === e;) {
            n.push({
              index: this.positions[3 * r],
              start: this.positions[3 * r + 1],
              end: this.positions[3 * r + 2]
            }), r++;
          }

          return n;
        }
      }], [{
        key: "serialize",
        value: function serialize(t, e) {
          var r = new Float64Array(t.ids),
              i = new Uint32Array(t.positions);
          return function t(e, r, i, n) {
            for (; i < n;) {
              var _s25 = e[i + n >> 1];

              var _a25 = i - 1,
                  _o7 = n + 1;

              for (;;) {
                do {
                  _a25++;
                } while (e[_a25] < _s25);

                do {
                  _o7--;
                } while (e[_o7] > _s25);

                if (_a25 >= _o7) break;
                Hs(e, _a25, _o7), Hs(r, 3 * _a25, 3 * _o7), Hs(r, 3 * _a25 + 1, 3 * _o7 + 1), Hs(r, 3 * _a25 + 2, 3 * _o7 + 2);
              }

              _o7 - i < n - _o7 ? (t(e, r, i, _o7), i = _o7 + 1) : (t(e, r, _o7 + 1, n), n = _o7);
            }
          }(r, i, 0, r.length - 1), e && e.push(r.buffer, i.buffer), {
            ids: r,
            positions: i
          };
        }
      }, {
        key: "deserialize",
        value: function deserialize(t) {
          var e = new Xs();
          return e.ids = t.ids, e.positions = t.positions, e.indexed = !0, e;
        }
      }]);

      return Xs;
    }();

    function Ks(t) {
      var e = +t;
      return !isNaN(e) && e <= o ? e : Gs(String(t));
    }

    function Hs(t, e, r) {
      var i = t[e];
      t[e] = t[r], t[r] = i;
    }

    Gi("FeaturePositionMap", Xs);

    var Ys = function Ys(t, e) {
      _classCallCheck(this, Ys);

      this.gl = t.gl, this.location = e;
    };

    var Ws = /*#__PURE__*/function (_Ys) {
      _inherits(Ws, _Ys);

      var _super41 = _createSuper(Ws);

      function Ws(t, e) {
        var _this13;

        _classCallCheck(this, Ws);

        _this13 = _super41.call(this, t, e), _this13.current = 0;
        return _this13;
      }

      _createClass(Ws, [{
        key: "set",
        value: function set(t) {
          this.current !== t && (this.current = t, this.gl.uniform1f(this.location, t));
        }
      }]);

      return Ws;
    }(Ys);

    var Js = /*#__PURE__*/function (_Ys2) {
      _inherits(Js, _Ys2);

      var _super42 = _createSuper(Js);

      function Js(t, e) {
        var _this14;

        _classCallCheck(this, Js);

        _this14 = _super42.call(this, t, e), _this14.current = [0, 0, 0, 0];
        return _this14;
      }

      _createClass(Js, [{
        key: "set",
        value: function set(t) {
          t[0] === this.current[0] && t[1] === this.current[1] && t[2] === this.current[2] && t[3] === this.current[3] || (this.current = t, this.gl.uniform4f(this.location, t[0], t[1], t[2], t[3]));
        }
      }]);

      return Js;
    }(Ys);

    var Qs = /*#__PURE__*/function (_Ys3) {
      _inherits(Qs, _Ys3);

      var _super43 = _createSuper(Qs);

      function Qs(t, e) {
        var _this15;

        _classCallCheck(this, Qs);

        _this15 = _super43.call(this, t, e), _this15.current = le.transparent;
        return _this15;
      }

      _createClass(Qs, [{
        key: "set",
        value: function set(t) {
          t.r === this.current.r && t.g === this.current.g && t.b === this.current.b && t.a === this.current.a || (this.current = t, this.gl.uniform4f(this.location, t.r, t.g, t.b, t.a));
        }
      }]);

      return Qs;
    }(Ys);

    var ta = new Float32Array(16),
        ea = new Float32Array(9);

    function ra(t) {
      return [is(255 * t.r, 255 * t.g), is(255 * t.b, 255 * t.a)];
    }

    var ia = /*#__PURE__*/function () {
      function ia(t, e, r) {
        _classCallCheck(this, ia);

        this.value = t, this.uniformNames = e.map(function (t) {
          return "u_".concat(t);
        }), this.type = r;
      }

      _createClass(ia, [{
        key: "setUniform",
        value: function setUniform(t, e, r) {
          t.set(r.constantOr(this.value));
        }
      }, {
        key: "getBinding",
        value: function getBinding(t, e, r) {
          return "color" === this.type ? new Qs(t, e) : new Ws(t, e);
        }
      }]);

      return ia;
    }();

    var na = /*#__PURE__*/function () {
      function na(t, e) {
        _classCallCheck(this, na);

        this.uniformNames = e.map(function (t) {
          return "u_".concat(t);
        }), this.patternFrom = null, this.patternTo = null, this.pixelRatioFrom = 1, this.pixelRatioTo = 1;
      }

      _createClass(na, [{
        key: "setConstantPatternPositions",
        value: function setConstantPatternPositions(t, e) {
          this.pixelRatioFrom = e.pixelRatio, this.pixelRatioTo = t.pixelRatio, this.patternFrom = e.tlbr, this.patternTo = t.tlbr;
        }
      }, {
        key: "setUniform",
        value: function setUniform(t, e, r, i) {
          var n = "u_pattern_to" === i ? this.patternTo : "u_pattern_from" === i ? this.patternFrom : "u_pixel_ratio_to" === i ? this.pixelRatioTo : "u_pixel_ratio_from" === i ? this.pixelRatioFrom : null;
          n && t.set(n);
        }
      }, {
        key: "getBinding",
        value: function getBinding(t, e, r) {
          return "u_pattern" === r.substr(0, 9) ? new Js(t, e) : new Ws(t, e);
        }
      }]);

      return na;
    }();

    var sa = /*#__PURE__*/function () {
      function sa(t, e, r, i) {
        _classCallCheck(this, sa);

        this.expression = t, this.type = r, this.maxValue = 0, this.paintVertexAttributes = e.map(function (t) {
          return {
            name: "a_".concat(t),
            type: "Float32",
            components: "color" === r ? 2 : 1,
            offset: 0
          };
        }), this.paintVertexArray = new i();
      }

      _createClass(sa, [{
        key: "populatePaintArray",
        value: function populatePaintArray(t, e, r, i, n) {
          var s = this.paintVertexArray.length,
              a = this.expression.evaluate(new qn(0), e, {}, i, [], n);
          this.paintVertexArray.resize(t), this._setPaintValue(s, t, a);
        }
      }, {
        key: "updatePaintArray",
        value: function updatePaintArray(t, e, r, i) {
          var n = this.expression.evaluate({
            zoom: 0
          }, r, i);

          this._setPaintValue(t, e, n);
        }
      }, {
        key: "_setPaintValue",
        value: function _setPaintValue(t, e, r) {
          if ("color" === this.type) {
            var _i41 = ra(r);

            for (var _r66 = t; _r66 < e; _r66++) {
              this.paintVertexArray.emplace(_r66, _i41[0], _i41[1]);
            }
          } else {
            for (var _i42 = t; _i42 < e; _i42++) {
              this.paintVertexArray.emplace(_i42, r);
            }

            this.maxValue = Math.max(this.maxValue, Math.abs(r));
          }
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.paintVertexBuffer && this.paintVertexBuffer.destroy();
        }
      }]);

      return sa;
    }();

    var aa = /*#__PURE__*/function () {
      function aa(t, e, r, i, n, s) {
        _classCallCheck(this, aa);

        this.expression = t, this.uniformNames = e.map(function (t) {
          return "u_".concat(t, "_t");
        }), this.type = r, this.useIntegerZoom = i, this.zoom = n, this.maxValue = 0, this.paintVertexAttributes = e.map(function (t) {
          return {
            name: "a_".concat(t),
            type: "Float32",
            components: "color" === r ? 4 : 2,
            offset: 0
          };
        }), this.paintVertexArray = new s();
      }

      _createClass(aa, [{
        key: "populatePaintArray",
        value: function populatePaintArray(t, e, r, i, n) {
          var s = this.expression.evaluate(new qn(this.zoom), e, {}, i, [], n),
              a = this.expression.evaluate(new qn(this.zoom + 1), e, {}, i, [], n),
              o = this.paintVertexArray.length;
          this.paintVertexArray.resize(t), this._setPaintValue(o, t, s, a);
        }
      }, {
        key: "updatePaintArray",
        value: function updatePaintArray(t, e, r, i) {
          var n = this.expression.evaluate({
            zoom: this.zoom
          }, r, i),
              s = this.expression.evaluate({
            zoom: this.zoom + 1
          }, r, i);

          this._setPaintValue(t, e, n, s);
        }
      }, {
        key: "_setPaintValue",
        value: function _setPaintValue(t, e, r, i) {
          if ("color" === this.type) {
            var _n35 = ra(r),
                _s26 = ra(i);

            for (var _r67 = t; _r67 < e; _r67++) {
              this.paintVertexArray.emplace(_r67, _n35[0], _n35[1], _s26[0], _s26[1]);
            }
          } else {
            for (var _n36 = t; _n36 < e; _n36++) {
              this.paintVertexArray.emplace(_n36, r, i);
            }

            this.maxValue = Math.max(this.maxValue, Math.abs(r), Math.abs(i));
          }
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.paintVertexBuffer && this.paintVertexBuffer.destroy();
        }
      }, {
        key: "setUniform",
        value: function setUniform(t, e) {
          var r = this.useIntegerZoom ? Math.floor(e.zoom) : e.zoom,
              i = f(this.expression.interpolationFactor(r, this.zoom, this.zoom + 1), 0, 1);
          t.set(i);
        }
      }, {
        key: "getBinding",
        value: function getBinding(t, e, r) {
          return new Ws(t, e);
        }
      }]);

      return aa;
    }();

    var oa = /*#__PURE__*/function () {
      function oa(t, e, r, i, n, s, a) {
        _classCallCheck(this, oa);

        this.expression = t, this.type = r, this.useIntegerZoom = i, this.zoom = n, this.layerId = a;

        for (var _t54 = 0; _t54 < e.length; ++_t54) {
          ;
        }

        this.zoomInPaintVertexArray = new s(), this.zoomOutPaintVertexArray = new s();
      }

      _createClass(oa, [{
        key: "populatePaintArray",
        value: function populatePaintArray(t, e, r) {
          var i = this.zoomInPaintVertexArray.length;
          this.zoomInPaintVertexArray.resize(t), this.zoomOutPaintVertexArray.resize(t), this._setPaintValues(i, t, e.patterns && e.patterns[this.layerId], r);
        }
      }, {
        key: "updatePaintArray",
        value: function updatePaintArray(t, e, r, i, n) {
          this._setPaintValues(t, e, r.patterns && r.patterns[this.layerId], n);
        }
      }, {
        key: "_setPaintValues",
        value: function _setPaintValues(t, e, r, i) {
          if (!i || !r) return;
          var {
            min: n,
            mid: s,
            max: a
          } = r,
              o = i[n],
              l = i[s],
              u = i[a];
          if (o && l && u) for (var _r68 = t; _r68 < e; _r68++) {
            this.zoomInPaintVertexArray.emplace(_r68, l.tl[0], l.tl[1], l.br[0], l.br[1], o.tl[0], o.tl[1], o.br[0], o.br[1], l.pixelRatio, o.pixelRatio), this.zoomOutPaintVertexArray.emplace(_r68, l.tl[0], l.tl[1], l.br[0], l.br[1], u.tl[0], u.tl[1], u.br[0], u.br[1], l.pixelRatio, u.pixelRatio);
          }
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.zoomInPaintVertexArray && this.zoomInPaintVertexArray.arrayBuffer && this.zoomOutPaintVertexArray && this.zoomOutPaintVertexArray.arrayBuffer && (this.zoomInPaintVertexBuffer = t.createVertexBuffer(this.zoomInPaintVertexArray, qs.members, this.expression.isStateDependent), this.zoomOutPaintVertexBuffer = t.createVertexBuffer(this.zoomOutPaintVertexArray, qs.members, this.expression.isStateDependent));
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.zoomOutPaintVertexBuffer && this.zoomOutPaintVertexBuffer.destroy(), this.zoomInPaintVertexBuffer && this.zoomInPaintVertexBuffer.destroy();
        }
      }]);

      return oa;
    }();

    var la = /*#__PURE__*/function () {
      function la(t, e) {
        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {
          return !0;
        };

        _classCallCheck(this, la);

        this.binders = {}, this._buffers = [];
        var i = [];

        for (var _n37 in t.paint._values) {
          if (!r(_n37)) continue;

          var _s27 = t.paint.get(_n37);

          if (!(_s27 instanceof Hn && Or(_s27.property.specification))) continue;

          var _a26 = ca(_n37, t.type),
              _o8 = _s27.value,
              _l7 = _s27.property.specification.type,
              _u7 = _s27.property.useIntegerZoom,
              _c4 = _s27.property.specification["property-type"],
              _h2 = "cross-faded" === _c4 || "cross-faded-data-driven" === _c4;

          if ("constant" === _o8.kind) this.binders[_n37] = _h2 ? new na(_o8.value, _a26) : new ia(_o8.value, _a26, _l7), i.push("/u_".concat(_n37));else if ("source" === _o8.kind || _h2) {
            var _r69 = ha(_n37, _l7, "source");

            this.binders[_n37] = _h2 ? new oa(_o8, _a26, _l7, _u7, e, _r69, t.id) : new sa(_o8, _a26, _l7, _r69), i.push("/a_".concat(_n37));
          } else {
            var _t55 = ha(_n37, _l7, "composite");

            this.binders[_n37] = new aa(_o8, _a26, _l7, _u7, e, _t55), i.push("/z_".concat(_n37));
          }
        }

        this.cacheKey = i.sort().join("");
      }

      _createClass(la, [{
        key: "getMaxValue",
        value: function getMaxValue(t) {
          var e = this.binders[t];
          return e instanceof sa || e instanceof aa ? e.maxValue : 0;
        }
      }, {
        key: "populatePaintArrays",
        value: function populatePaintArrays(t, e, r, i, n) {
          for (var _s28 in this.binders) {
            var _a27 = this.binders[_s28];
            (_a27 instanceof sa || _a27 instanceof aa || _a27 instanceof oa) && _a27.populatePaintArray(t, e, r, i, n);
          }
        }
      }, {
        key: "setConstantPatternPositions",
        value: function setConstantPatternPositions(t, e) {
          for (var _r70 in this.binders) {
            var _i43 = this.binders[_r70];
            _i43 instanceof na && _i43.setConstantPatternPositions(t, e);
          }
        }
      }, {
        key: "updatePaintArrays",
        value: function updatePaintArrays(t, e, r, i, n) {
          var s = !1;

          for (var _a28 in t) {
            var _o9 = e.getPositions(_a28);

            for (var _e52 of _o9) {
              var _o10 = r.feature(_e52.index);

              for (var _r71 in this.binders) {
                var _l8 = this.binders[_r71];

                if ((_l8 instanceof sa || _l8 instanceof aa || _l8 instanceof oa) && !0 === _l8.expression.isStateDependent) {
                  var _u8 = i.paint.get(_r71);

                  _l8.expression = _u8.value, _l8.updatePaintArray(_e52.start, _e52.end, _o10, t[_a28], n), s = !0;
                }
              }
            }
          }

          return s;
        }
      }, {
        key: "defines",
        value: function defines() {
          var t = [];

          for (var _e53 in this.binders) {
            var _r72 = this.binders[_e53];
            (_r72 instanceof ia || _r72 instanceof na) && t.push.apply(t, _toConsumableArray(_r72.uniformNames.map(function (t) {
              return "#define HAS_UNIFORM_".concat(t);
            })));
          }

          return t;
        }
      }, {
        key: "getBinderAttributes",
        value: function getBinderAttributes() {
          var t = [];

          for (var _e54 in this.binders) {
            var _r73 = this.binders[_e54];
            if (_r73 instanceof sa || _r73 instanceof aa) for (var _e55 = 0; _e55 < _r73.paintVertexAttributes.length; _e55++) {
              t.push(_r73.paintVertexAttributes[_e55].name);
            } else if (_r73 instanceof oa) for (var _e56 = 0; _e56 < qs.members.length; _e56++) {
              t.push(qs.members[_e56].name);
            }
          }

          return t;
        }
      }, {
        key: "getBinderUniforms",
        value: function getBinderUniforms() {
          var t = [];

          for (var _e57 in this.binders) {
            var _r74 = this.binders[_e57];
            if (_r74 instanceof ia || _r74 instanceof na || _r74 instanceof aa) for (var _e58 of _r74.uniformNames) {
              t.push(_e58);
            }
          }

          return t;
        }
      }, {
        key: "getPaintVertexBuffers",
        value: function getPaintVertexBuffers() {
          return this._buffers;
        }
      }, {
        key: "getUniforms",
        value: function getUniforms(t, e) {
          var r = [];

          for (var _i44 in this.binders) {
            var _n38 = this.binders[_i44];
            if (_n38 instanceof ia || _n38 instanceof na || _n38 instanceof aa) for (var _s29 of _n38.uniformNames) {
              if (e[_s29]) {
                var _a29 = _n38.getBinding(t, e[_s29], _s29);

                r.push({
                  name: _s29,
                  property: _i44,
                  binding: _a29
                });
              }
            }
          }

          return r;
        }
      }, {
        key: "setUniforms",
        value: function setUniforms(t, e, r, i) {
          for (var {
            name: _t56,
            property: _n39,
            binding: _s30
          } of e) {
            this.binders[_n39].setUniform(_s30, i, r.get(_n39), _t56);
          }
        }
      }, {
        key: "updatePaintBuffers",
        value: function updatePaintBuffers(t) {
          this._buffers = [];

          for (var _e59 in this.binders) {
            var _r75 = this.binders[_e59];

            if (t && _r75 instanceof oa) {
              var _e60 = 2 === t.fromScale ? _r75.zoomInPaintVertexBuffer : _r75.zoomOutPaintVertexBuffer;

              _e60 && this._buffers.push(_e60);
            } else (_r75 instanceof sa || _r75 instanceof aa) && _r75.paintVertexBuffer && this._buffers.push(_r75.paintVertexBuffer);
          }
        }
      }, {
        key: "upload",
        value: function upload(t) {
          for (var _e61 in this.binders) {
            var _r76 = this.binders[_e61];
            (_r76 instanceof sa || _r76 instanceof aa || _r76 instanceof oa) && _r76.upload(t);
          }

          this.updatePaintBuffers();
        }
      }, {
        key: "destroy",
        value: function destroy() {
          for (var _t57 in this.binders) {
            var _e62 = this.binders[_t57];
            (_e62 instanceof sa || _e62 instanceof aa || _e62 instanceof oa) && _e62.destroy();
          }
        }
      }]);

      return la;
    }();

    var ua = /*#__PURE__*/function () {
      function ua(t, e) {
        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {
          return !0;
        };

        _classCallCheck(this, ua);

        this.programConfigurations = {};

        for (var _i45 of t) {
          this.programConfigurations[_i45.id] = new la(_i45, e, r);
        }

        this.needsUpload = !1, this._featureMap = new Xs(), this._bufferOffset = 0;
      }

      _createClass(ua, [{
        key: "populatePaintArrays",
        value: function populatePaintArrays(t, e, r, i, n, s) {
          for (var _r77 in this.programConfigurations) {
            this.programConfigurations[_r77].populatePaintArrays(t, e, i, n, s);
          }

          void 0 !== e.id && this._featureMap.add(e.id, r, this._bufferOffset, t), this._bufferOffset = t, this.needsUpload = !0;
        }
      }, {
        key: "updatePaintArrays",
        value: function updatePaintArrays(t, e, r, i) {
          for (var _n40 of r) {
            this.needsUpload = this.programConfigurations[_n40.id].updatePaintArrays(t, this._featureMap, e, _n40, i) || this.needsUpload;
          }
        }
      }, {
        key: "get",
        value: function get(t) {
          return this.programConfigurations[t];
        }
      }, {
        key: "upload",
        value: function upload(t) {
          if (this.needsUpload) {
            for (var _e63 in this.programConfigurations) {
              this.programConfigurations[_e63].upload(t);
            }

            this.needsUpload = !1;
          }
        }
      }, {
        key: "destroy",
        value: function destroy() {
          for (var _t58 in this.programConfigurations) {
            this.programConfigurations[_t58].destroy();
          }
        }
      }]);

      return ua;
    }();

    function ca(t, e) {
      return {
        "text-opacity": ["opacity"],
        "icon-opacity": ["opacity"],
        "text-color": ["fill_color"],
        "icon-color": ["fill_color"],
        "text-halo-color": ["halo_color"],
        "icon-halo-color": ["halo_color"],
        "text-halo-blur": ["halo_blur"],
        "icon-halo-blur": ["halo_blur"],
        "text-halo-width": ["halo_width"],
        "icon-halo-width": ["halo_width"],
        "line-gap-width": ["gapwidth"],
        "line-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
        "fill-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
        "fill-extrusion-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"]
      }[t] || [t.replace("".concat(e, "-"), "").replace(/-/g, "_")];
    }

    function ha(t, e, r) {
      var i = {
        color: {
          source: ps,
          composite: Es
        },
        number: {
          source: As,
          composite: ps
        }
      },
          n = function (t) {
        return {
          "line-pattern": {
            source: ds,
            composite: ds
          },
          "fill-pattern": {
            source: ds,
            composite: ds
          },
          "fill-extrusion-pattern": {
            source: ds,
            composite: ds
          }
        }[t];
      }(t);

      return n && n[r] || i[e][r];
    }

    Gi("ConstantBinder", ia), Gi("CrossFadedConstantBinder", na), Gi("SourceExpressionBinder", sa), Gi("CrossFadedCompositeBinder", oa), Gi("CompositeExpressionBinder", aa), Gi("ProgramConfiguration", la, {
      omit: ["_buffers"]
    }), Gi("ProgramConfigurationSet", ua);

    var pa = /*#__PURE__*/function (_Vt) {
      _inherits(pa, _Vt);

      var _super44 = _createSuper(pa);

      function pa(t, e) {
        var _this16;

        _classCallCheck(this, pa);

        if (_this16 = _super44.call(this), _this16.id = t.id, _this16.type = t.type, _this16._featureFilter = {
          filter: function () {
            return !0;
          },
          needGeometry: !1
        }, "custom" !== t.type && (_this16.metadata = (t = t).metadata, _this16.minzoom = t.minzoom, _this16.maxzoom = t.maxzoom, "background" !== t.type && "sky" !== t.type && (_this16.source = t.source, _this16.sourceLayer = t["source-layer"], _this16.filter = t.filter), e.layout && (_this16._unevaluatedLayout = new Kn(e.layout)), e.paint)) {
          _this16._transitionablePaint = new Gn(e.paint);

          for (var _e64 in t.paint) {
            _this16.setPaintProperty(_e64, t.paint[_e64], {
              validate: !1
            });
          }

          for (var _e65 in t.layout) {
            _this16.setLayoutProperty(_e65, t.layout[_e65], {
              validate: !1
            });
          }

          _this16._transitioningPaint = _this16._transitionablePaint.untransitioned(), _this16.paint = new Yn(e.paint);
        }

        return _possibleConstructorReturn(_this16);
      }

      _createClass(pa, [{
        key: "getCrossfadeParameters",
        value: function getCrossfadeParameters() {
          return this._crossfadeParameters;
        }
      }, {
        key: "getLayoutProperty",
        value: function getLayoutProperty(t) {
          return "visibility" === t ? this.visibility : this._unevaluatedLayout.getValue(t);
        }
      }, {
        key: "setLayoutProperty",
        value: function setLayoutProperty(t, e) {
          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
          null != e && this._validate(Li, "layers.".concat(this.id, ".layout.").concat(t), t, e, r) || ("visibility" !== t ? this._unevaluatedLayout.setValue(t, e) : this.visibility = e);
        }
      }, {
        key: "getPaintProperty",
        value: function getPaintProperty(t) {
          return A(t, "-transition") ? this._transitionablePaint.getTransition(t.slice(0, -"-transition".length)) : this._transitionablePaint.getValue(t);
        }
      }, {
        key: "setPaintProperty",
        value: function setPaintProperty(t, e) {
          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
          if (null != e && this._validate(Ri, "layers.".concat(this.id, ".paint.").concat(t), t, e, r)) return !1;
          if (A(t, "-transition")) return this._transitionablePaint.setTransition(t.slice(0, -"-transition".length), e || void 0), !1;
          {
            var _r78 = this._transitionablePaint._values[t],
                _i46 = "cross-faded-data-driven" === _r78.property.specification["property-type"],
                _n41 = _r78.value.isDataDriven(),
                _s31 = _r78.value;

            this._transitionablePaint.setValue(t, e), this._handleSpecialPaintPropertyUpdate(t);
            var _a30 = this._transitionablePaint._values[t].value;
            return _a30.isDataDriven() || _n41 || _i46 || this._handleOverridablePaintPropertyUpdate(t, _s31, _a30);
          }
        }
      }, {
        key: "_handleSpecialPaintPropertyUpdate",
        value: function _handleSpecialPaintPropertyUpdate(t) {}
      }, {
        key: "getProgramIds",
        value: function getProgramIds() {
          return null;
        }
      }, {
        key: "getProgramConfiguration",
        value: function getProgramConfiguration(t) {
          return null;
        }
      }, {
        key: "_handleOverridablePaintPropertyUpdate",
        value: function _handleOverridablePaintPropertyUpdate(t, e, r) {
          return !1;
        }
      }, {
        key: "isHidden",
        value: function isHidden(t) {
          return !!(this.minzoom && t < this.minzoom) || !!(this.maxzoom && t >= this.maxzoom) || "none" === this.visibility;
        }
      }, {
        key: "updateTransitions",
        value: function updateTransitions(t) {
          this._transitioningPaint = this._transitionablePaint.transitioned(t, this._transitioningPaint);
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return this._transitioningPaint.hasTransition();
        }
      }, {
        key: "recalculate",
        value: function recalculate(t, e) {
          t.getCrossfadeParameters && (this._crossfadeParameters = t.getCrossfadeParameters()), this._unevaluatedLayout && (this.layout = this._unevaluatedLayout.possiblyEvaluate(t, void 0, e)), this.paint = this._transitioningPaint.possiblyEvaluate(t, void 0, e);
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {
            id: this.id,
            type: this.type,
            source: this.source,
            "source-layer": this.sourceLayer,
            metadata: this.metadata,
            minzoom: this.minzoom,
            maxzoom: this.maxzoom,
            filter: this.filter,
            layout: this._unevaluatedLayout && this._unevaluatedLayout.serialize(),
            paint: this._transitionablePaint && this._transitionablePaint.serialize()
          };
          return this.visibility && (t.layout = t.layout || {}, t.layout.visibility = this.visibility), I(t, function (t, e) {
            return !(void 0 === t || "layout" === e && !Object.keys(t).length || "paint" === e && !Object.keys(t).length);
          });
        }
      }, {
        key: "_validate",
        value: function _validate(t, e, r, i) {
          var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
          return (!n || !1 !== n.validate) && Ui(this, t.call(Vi, {
            key: e,
            layerType: this.type,
            objectKey: r,
            value: i,
            styleSpec: Ft,
            style: {
              glyphs: !0,
              sprite: !0
            }
          }));
        }
      }, {
        key: "is3D",
        value: function is3D() {
          return !1;
        }
      }, {
        key: "isSky",
        value: function isSky() {
          return !1;
        }
      }, {
        key: "isTileClipped",
        value: function isTileClipped() {
          return !1;
        }
      }, {
        key: "hasOffscreenPass",
        value: function hasOffscreenPass() {
          return !1;
        }
      }, {
        key: "resize",
        value: function resize() {}
      }, {
        key: "isStateDependent",
        value: function isStateDependent() {
          for (var _t59 in this.paint._values) {
            var _e66 = this.paint.get(_t59);

            if (_e66 instanceof Hn && Or(_e66.property.specification) && ("source" === _e66.value.kind || "composite" === _e66.value.kind) && _e66.value.isStateDependent) return !0;
          }

          return !1;
        }
      }]);

      return pa;
    }(Vt);

    var da = os([{
      name: "a_pos",
      components: 2,
      type: "Int16"
    }], 4),
        {
      members: fa
    } = da;

    var ya = /*#__PURE__*/function () {
      function ya() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

        _classCallCheck(this, ya);

        this.segments = t;
      }

      _createClass(ya, [{
        key: "prepareSegment",
        value: function prepareSegment(t, e, r, i) {
          var n = this.segments[this.segments.length - 1];
          return t > ya.MAX_VERTEX_ARRAY_LENGTH && E("Max vertices per segment is ".concat(ya.MAX_VERTEX_ARRAY_LENGTH, ": bucket requested ").concat(t)), (!n || n.vertexLength + t > ya.MAX_VERTEX_ARRAY_LENGTH || n.sortKey !== i) && (n = {
            vertexOffset: e.length,
            primitiveOffset: r.length,
            vertexLength: 0,
            primitiveLength: 0
          }, void 0 !== i && (n.sortKey = i), this.segments.push(n)), n;
        }
      }, {
        key: "get",
        value: function get() {
          return this.segments;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          for (var _t60 of this.segments) {
            for (var _e67 in _t60.vaos) {
              _t60.vaos[_e67].destroy();
            }
          }
        }
      }], [{
        key: "simpleSegment",
        value: function simpleSegment(t, e, r, i) {
          return new ya([{
            vertexOffset: t,
            primitiveOffset: e,
            vertexLength: r,
            primitiveLength: i,
            vaos: {},
            sortKey: 0
          }]);
        }
      }]);

      return ya;
    }();

    ya.MAX_VERTEX_ARRAY_LENGTH = Math.pow(2, 16) - 1, Gi("SegmentVector", ya);
    var ma = Math.pow(2, 14) - 1,
        ga = -ma - 1;

    function xa(t) {
      var e = 8192 / t.extent,
          r = t.loadGeometry();

      for (var _t61 = 0; _t61 < r.length; _t61++) {
        var _i47 = r[_t61];

        for (var _t62 = 0; _t62 < _i47.length; _t62++) {
          var _r79 = _i47[_t62],
              _n42 = Math.round(_r79.x * e),
              _s32 = Math.round(_r79.y * e);

          _r79.x = f(_n42, ga, ma), _r79.y = f(_s32, ga, ma), (_n42 < _r79.x || _n42 > _r79.x + 1 || _s32 < _r79.y || _s32 > _r79.y + 1) && E("Geometry exceeds allowed extent, reduce your vector tile buffer size");
        }
      }

      return r;
    }

    function va(t, e) {
      return {
        type: t.type,
        id: t.id,
        properties: t.properties,
        geometry: e ? xa(t) : []
      };
    }

    function ba(t, e, r, i, n) {
      t.emplaceBack(2 * e + (i + 1) / 2, 2 * r + (n + 1) / 2);
    }

    var wa = /*#__PURE__*/function () {
      function wa(t) {
        _classCallCheck(this, wa);

        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
          return t.id;
        }), this.index = t.index, this.hasPattern = !1, this.layoutVertexArray = new us(), this.indexArray = new ws(), this.segments = new ya(), this.programConfigurations = new ua(t.layers, t.zoom), this.stateDependentLayerIds = this.layers.filter(function (t) {
          return t.isStateDependent();
        }).map(function (t) {
          return t.id;
        });
      }

      _createClass(wa, [{
        key: "populate",
        value: function populate(t, e, r) {
          var i = this.layers[0],
              n = [];
          var s = null;
          "circle" === i.type && (s = i.layout.get("circle-sort-key"));

          for (var {
            feature: _e68,
            id: _i48,
            index: _a31,
            sourceLayerIndex: _o11
          } of t) {
            var _t63 = this.layers[0]._featureFilter.needGeometry,
                _l9 = va(_e68, _t63);

            if (!this.layers[0]._featureFilter.filter(new qn(this.zoom), _l9, r)) continue;

            var _u9 = s ? s.evaluate(_l9, {}, r) : void 0,
                _c5 = {
              id: _i48,
              properties: _e68.properties,
              type: _e68.type,
              sourceLayerIndex: _o11,
              index: _a31,
              geometry: _t63 ? _l9.geometry : xa(_e68),
              patterns: {},
              sortKey: _u9
            };

            n.push(_c5);
          }

          s && n.sort(function (t, e) {
            return t.sortKey - e.sortKey;
          });

          for (var _i49 of n) {
            var {
              geometry: _n43,
              index: _s33,
              sourceLayerIndex: _a32
            } = _i49,
                _o12 = t[_s33].feature;
            this.addFeature(_i49, _n43, _s33, r), e.featureIndex.insert(_o12, _n43, _s33, _a32, this.index);
          }
        }
      }, {
        key: "update",
        value: function update(t, e, r) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.layoutVertexArray.length;
        }
      }, {
        key: "uploadPending",
        value: function uploadPending() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, fa), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }
      }, {
        key: "addFeature",
        value: function addFeature(t, e, r, i) {
          for (var _r80 of e) {
            for (var _e69 of _r80) {
              var _r81 = _e69.x,
                  _i50 = _e69.y;
              if (_r81 < 0 || _r81 >= 8192 || _i50 < 0 || _i50 >= 8192) continue;

              var _n44 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray, t.sortKey),
                  _s34 = _n44.vertexLength;

              ba(this.layoutVertexArray, _r81, _i50, -1, -1), ba(this.layoutVertexArray, _r81, _i50, 1, -1), ba(this.layoutVertexArray, _r81, _i50, 1, 1), ba(this.layoutVertexArray, _r81, _i50, -1, 1), this.indexArray.emplaceBack(_s34, _s34 + 1, _s34 + 2), this.indexArray.emplaceBack(_s34, _s34 + 3, _s34 + 2), _n44.vertexLength += 4, _n44.primitiveLength += 2;
            }
          }

          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, {}, i);
        }
      }]);

      return wa;
    }();

    function _a(t, e) {
      for (var _r82 = 0; _r82 < t.length; _r82++) {
        if (Ba(e, t[_r82])) return !0;
      }

      for (var _r83 = 0; _r83 < e.length; _r83++) {
        if (Ba(t, e[_r83])) return !0;
      }

      return !!Ia(t, e);
    }

    function ka(t, e, r) {
      return !!Ba(t, e) || !!za(e, t, r);
    }

    function Aa(t, e) {
      if (1 === t.length) return Ma(e, t[0]);

      for (var _r84 = 0; _r84 < e.length; _r84++) {
        var _i51 = e[_r84];

        for (var _e70 = 0; _e70 < _i51.length; _e70++) {
          if (Ba(t, _i51[_e70])) return !0;
        }
      }

      for (var _r85 = 0; _r85 < t.length; _r85++) {
        if (Ma(e, t[_r85])) return !0;
      }

      for (var _r86 = 0; _r86 < e.length; _r86++) {
        if (Ia(t, e[_r86])) return !0;
      }

      return !1;
    }

    function Sa(t, e, r) {
      if (t.length > 1) {
        if (Ia(t, e)) return !0;

        for (var _i52 = 0; _i52 < e.length; _i52++) {
          if (za(e[_i52], t, r)) return !0;
        }
      }

      for (var _i53 = 0; _i53 < t.length; _i53++) {
        if (za(t[_i53], e, r)) return !0;
      }

      return !1;
    }

    function Ia(t, e) {
      if (0 === t.length || 0 === e.length) return !1;

      for (var _r87 = 0; _r87 < t.length - 1; _r87++) {
        var _i54 = t[_r87],
            _n45 = t[_r87 + 1];

        for (var _t64 = 0; _t64 < e.length - 1; _t64++) {
          if (Ta(_i54, _n45, e[_t64], e[_t64 + 1])) return !0;
        }
      }

      return !1;
    }

    function Ta(t, e, r, i) {
      return M(t, r, i) !== M(e, r, i) && M(t, e, r) !== M(t, e, i);
    }

    function za(t, e, r) {
      var i = r * r;
      if (1 === e.length) return t.distSqr(e[0]) < i;

      for (var _r88 = 1; _r88 < e.length; _r88++) {
        if (Ea(t, e[_r88 - 1], e[_r88]) < i) return !0;
      }

      return !1;
    }

    function Ea(t, e, r) {
      var i = e.distSqr(r);
      if (0 === i) return t.distSqr(e);
      var n = ((t.x - e.x) * (r.x - e.x) + (t.y - e.y) * (r.y - e.y)) / i;
      return t.distSqr(n < 0 ? e : n > 1 ? r : r.sub(e)._mult(n)._add(e));
    }

    function Ma(t, e) {
      var r,
          i,
          n,
          s = !1;

      for (var _a33 = 0; _a33 < t.length; _a33++) {
        r = t[_a33];

        for (var _t65 = 0, _a34 = r.length - 1; _t65 < r.length; _a34 = _t65++) {
          i = r[_t65], n = r[_a34], i.y > e.y != n.y > e.y && e.x < (n.x - i.x) * (e.y - i.y) / (n.y - i.y) + i.x && (s = !s);
        }
      }

      return s;
    }

    function Ba(t, e) {
      var r = !1;

      for (var _i55 = 0, _n46 = t.length - 1; _i55 < t.length; _n46 = _i55++) {
        var _s35 = t[_i55],
            _a35 = t[_n46];
        _s35.y > e.y != _a35.y > e.y && e.x < (_a35.x - _s35.x) * (e.y - _s35.y) / (_a35.y - _s35.y) + _s35.x && (r = !r);
      }

      return r;
    }

    function Da(t, e, r, n, s) {
      for (var _i56 of t) {
        if (e <= _i56.x && r <= _i56.y && n >= _i56.x && s >= _i56.y) return !0;
      }

      var a = [new i(e, r), new i(e, s), new i(n, s), new i(n, r)];
      if (t.length > 2) for (var _e71 of a) {
        if (Ba(t, _e71)) return !0;
      }

      for (var _e72 = 0; _e72 < t.length - 1; _e72++) {
        if (Ca(t[_e72], t[_e72 + 1], a)) return !0;
      }

      return !1;
    }

    function Ca(t, e, r) {
      var i = r[0],
          n = r[2];
      if (t.x < i.x && e.x < i.x || t.x > n.x && e.x > n.x || t.y < i.y && e.y < i.y || t.y > n.y && e.y > n.y) return !1;
      var s = M(t, e, r[0]);
      return s !== M(t, e, r[1]) || s !== M(t, e, r[2]) || s !== M(t, e, r[3]);
    }

    function Pa(t, e, r) {
      var i = e.paint.get(t).value;
      return "constant" === i.kind ? i.value : r.programConfigurations.get(e.id).getMaxValue(t);
    }

    function Va(t) {
      return Math.sqrt(t[0] * t[0] + t[1] * t[1]);
    }

    function Fa(t, e, r, n, s) {
      if (!e[0] && !e[1]) return t;

      var a = i.convert(e)._mult(s);

      "viewport" === r && a._rotate(-n);
      var o = [];

      for (var _e73 = 0; _e73 < t.length; _e73++) {
        o.push(t[_e73].sub(a));
      }

      return o;
    }

    function Ra(t, e, r, n) {
      var s = i.convert(t)._mult(n);

      return "viewport" === e && s._rotate(-r), s;
    }

    Gi("CircleBucket", wa, {
      omit: ["layers"]
    });
    var La = new rs({
      "circle-sort-key": new Jn(Ft.layout_circle["circle-sort-key"])
    });
    var Ua = {
      paint: new rs({
        "circle-radius": new Jn(Ft.paint_circle["circle-radius"]),
        "circle-color": new Jn(Ft.paint_circle["circle-color"]),
        "circle-blur": new Jn(Ft.paint_circle["circle-blur"]),
        "circle-opacity": new Jn(Ft.paint_circle["circle-opacity"]),
        "circle-translate": new Wn(Ft.paint_circle["circle-translate"]),
        "circle-translate-anchor": new Wn(Ft.paint_circle["circle-translate-anchor"]),
        "circle-pitch-scale": new Wn(Ft.paint_circle["circle-pitch-scale"]),
        "circle-pitch-alignment": new Wn(Ft.paint_circle["circle-pitch-alignment"]),
        "circle-stroke-width": new Jn(Ft.paint_circle["circle-stroke-width"]),
        "circle-stroke-color": new Jn(Ft.paint_circle["circle-stroke-color"]),
        "circle-stroke-opacity": new Jn(Ft.paint_circle["circle-stroke-opacity"])
      }),
      layout: La
    },
        Oa = "undefined" != typeof Float32Array ? Float32Array : Array;

    function $a() {
      var t = new Oa(9);
      return Oa != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[5] = 0, t[6] = 0, t[7] = 0), t[0] = 1, t[4] = 1, t[8] = 1, t;
    }

    function qa(t) {
      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = 1, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 1, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;
    }

    function Na(t, e, r) {
      var i = e[0],
          n = e[1],
          s = e[2],
          a = e[3],
          o = e[4],
          l = e[5],
          u = e[6],
          c = e[7],
          h = e[8],
          p = e[9],
          d = e[10],
          f = e[11],
          y = e[12],
          m = e[13],
          g = e[14],
          x = e[15],
          v = r[0],
          b = r[1],
          w = r[2],
          _ = r[3];
      return t[0] = v * i + b * o + w * h + _ * y, t[1] = v * n + b * l + w * p + _ * m, t[2] = v * s + b * u + w * d + _ * g, t[3] = v * a + b * c + w * f + _ * x, t[4] = (v = r[4]) * i + (b = r[5]) * o + (w = r[6]) * h + (_ = r[7]) * y, t[5] = v * n + b * l + w * p + _ * m, t[6] = v * s + b * u + w * d + _ * g, t[7] = v * a + b * c + w * f + _ * x, t[8] = (v = r[8]) * i + (b = r[9]) * o + (w = r[10]) * h + (_ = r[11]) * y, t[9] = v * n + b * l + w * p + _ * m, t[10] = v * s + b * u + w * d + _ * g, t[11] = v * a + b * c + w * f + _ * x, t[12] = (v = r[12]) * i + (b = r[13]) * o + (w = r[14]) * h + (_ = r[15]) * y, t[13] = v * n + b * l + w * p + _ * m, t[14] = v * s + b * u + w * d + _ * g, t[15] = v * a + b * c + w * f + _ * x, t;
    }

    Math.hypot || (Math.hypot = function () {
      for (var t = 0, e = arguments.length; e--;) {
        t += arguments[e] * arguments[e];
      }

      return Math.sqrt(t);
    });
    var ja = Na;

    function Ga() {
      var t = new Oa(3);
      return Oa != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0), t;
    }

    function Za(t) {
      var e = new Oa(3);
      return e[0] = t[0], e[1] = t[1], e[2] = t[2], e;
    }

    function Xa(t) {
      return Math.hypot(t[0], t[1], t[2]);
    }

    function Ka(t, e, r) {
      var i = new Oa(3);
      return i[0] = t, i[1] = e, i[2] = r, i;
    }

    function Ha(t, e, r) {
      return t[0] = e[0] + r[0], t[1] = e[1] + r[1], t[2] = e[2] + r[2], t;
    }

    function Ya(t, e, r) {
      return t[0] = e[0] - r[0], t[1] = e[1] - r[1], t[2] = e[2] - r[2], t;
    }

    function Wa(t, e, r) {
      return t[0] = e[0] * r, t[1] = e[1] * r, t[2] = e[2] * r, t;
    }

    function Ja(t, e, r, i) {
      return t[0] = e[0] + r[0] * i, t[1] = e[1] + r[1] * i, t[2] = e[2] + r[2] * i, t;
    }

    function Qa(t, e) {
      var r = e[0],
          i = e[1],
          n = e[2],
          s = r * r + i * i + n * n;
      return s > 0 && (s = 1 / Math.sqrt(s)), t[0] = e[0] * s, t[1] = e[1] * s, t[2] = e[2] * s, t;
    }

    function to(t, e) {
      return t[0] * e[0] + t[1] * e[1] + t[2] * e[2];
    }

    function eo(t, e, r) {
      var i = e[0],
          n = e[1],
          s = e[2],
          a = r[0],
          o = r[1],
          l = r[2];
      return t[0] = n * l - s * o, t[1] = s * a - i * l, t[2] = i * o - n * a, t;
    }

    function ro(t, e, r) {
      var i = e[0],
          n = e[1],
          s = e[2],
          a = r[3] * i + r[7] * n + r[11] * s + r[15];
      return t[0] = (r[0] * i + r[4] * n + r[8] * s + r[12]) / (a = a || 1), t[1] = (r[1] * i + r[5] * n + r[9] * s + r[13]) / a, t[2] = (r[2] * i + r[6] * n + r[10] * s + r[14]) / a, t;
    }

    function io(t, e, r) {
      var i = r[0],
          n = r[1],
          s = r[2],
          a = e[0],
          o = e[1],
          l = e[2],
          u = n * l - s * o,
          c = s * a - i * l,
          h = i * o - n * a,
          p = n * h - s * c,
          d = s * u - i * h,
          f = i * c - n * u,
          y = 2 * r[3];
      return c *= y, h *= y, d *= 2, f *= 2, t[0] = a + (u *= y) + (p *= 2), t[1] = o + c + d, t[2] = l + h + f, t;
    }

    var no,
        so = Ya,
        ao = Xa;

    function oo(t, e, r) {
      var i = e[0],
          n = e[1],
          s = e[2],
          a = e[3];
      return t[0] = r[0] * i + r[4] * n + r[8] * s + r[12] * a, t[1] = r[1] * i + r[5] * n + r[9] * s + r[13] * a, t[2] = r[2] * i + r[6] * n + r[10] * s + r[14] * a, t[3] = r[3] * i + r[7] * n + r[11] * s + r[15] * a, t;
    }

    function lo() {
      var t = new Oa(4);
      return Oa != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0), t[3] = 1, t;
    }

    function uo(t) {
      return t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 1, t;
    }

    function co(t, e, r) {
      r *= .5;
      var i = e[0],
          n = e[1],
          s = e[2],
          a = e[3],
          o = Math.sin(r),
          l = Math.cos(r);
      return t[0] = i * l + a * o, t[1] = n * l + s * o, t[2] = s * l - n * o, t[3] = a * l - i * o, t;
    }

    Ga(), no = new Oa(4), Oa != Float32Array && (no[0] = 0, no[1] = 0, no[2] = 0, no[3] = 0), Ga(), Ka(1, 0, 0), Ka(0, 1, 0), lo(), lo(), $a();

    var ho = /*#__PURE__*/function () {
      function ho(t, e) {
        _classCallCheck(this, ho);

        this.points = t, this.planes = e;
      }

      _createClass(ho, null, [{
        key: "fromInvProjectionMatrix",
        value: function fromInvProjectionMatrix(t, e, r) {
          var i = Math.pow(2, r),
              n = [[-1, 1, -1, 1], [1, 1, -1, 1], [1, -1, -1, 1], [-1, -1, -1, 1], [-1, 1, 1, 1], [1, 1, 1, 1], [1, -1, 1, 1], [-1, -1, 1, 1]].map(function (r) {
            var n = oo([], r, t),
                s = 1 / n[3] / e * i;
            return function (t, e, r) {
              return t[0] = e[0] * r[0], t[1] = e[1] * r[1], t[2] = e[2] * r[2], t[3] = e[3] * r[3], t;
            }(n, n, [s, s, 1 / n[3], s]);
          }),
              s = [[0, 1, 2], [6, 5, 4], [0, 3, 7], [2, 1, 5], [3, 2, 6], [0, 4, 5]].map(function (t) {
            var e = Qa([], eo([], so([], n[t[0]], n[t[1]]), so([], n[t[2]], n[t[1]]))),
                r = -to(e, n[t[1]]);
            return e.concat(r);
          });
          return new ho(n, s);
        }
      }]);

      return ho;
    }();

    var po = /*#__PURE__*/function () {
      function po(t, e) {
        _classCallCheck(this, po);

        this.min = t, this.max = e, this.center = Wa([], Ha([], this.min, this.max), .5);
      }

      _createClass(po, [{
        key: "quadrant",
        value: function quadrant(t) {
          var e = [t % 2 == 0, t < 2],
              r = Za(this.min),
              i = Za(this.max);

          for (var _t66 = 0; _t66 < e.length; _t66++) {
            r[_t66] = e[_t66] ? this.min[_t66] : this.center[_t66], i[_t66] = e[_t66] ? this.center[_t66] : this.max[_t66];
          }

          return i[2] = this.max[2], new po(r, i);
        }
      }, {
        key: "distanceX",
        value: function distanceX(t) {
          return Math.max(Math.min(this.max[0], t[0]), this.min[0]) - t[0];
        }
      }, {
        key: "distanceY",
        value: function distanceY(t) {
          return Math.max(Math.min(this.max[1], t[1]), this.min[1]) - t[1];
        }
      }, {
        key: "distanceZ",
        value: function distanceZ(t) {
          return Math.max(Math.min(this.max[2], t[2]), this.min[2]) - t[2];
        }
      }, {
        key: "intersects",
        value: function intersects(t) {
          var e = [[this.min[0], this.min[1], this.min[2], 1], [this.max[0], this.min[1], this.min[2], 1], [this.max[0], this.max[1], this.min[2], 1], [this.min[0], this.max[1], this.min[2], 1], [this.min[0], this.min[1], this.max[2], 1], [this.max[0], this.min[1], this.max[2], 1], [this.max[0], this.max[1], this.max[2], 1], [this.min[0], this.max[1], this.max[2], 1]];
          var r = !0;

          for (var _s36 = 0; _s36 < t.planes.length; _s36++) {
            var _a36 = t.planes[_s36];
            var _o13 = 0;

            for (var _t67 = 0; _t67 < e.length; _t67++) {
              _o13 += (i = _a36)[0] * (n = e[_t67])[0] + i[1] * n[1] + i[2] * n[2] + i[3] * n[3] >= 0;
            }

            if (0 === _o13) return 0;
            _o13 !== e.length && (r = !1);
          }

          var i, n;
          if (r) return 2;

          for (var _e74 = 0; _e74 < 3; _e74++) {
            var _r89 = Number.MAX_VALUE,
                _i57 = -Number.MAX_VALUE;

            for (var _n47 = 0; _n47 < t.points.length; _n47++) {
              var _s37 = t.points[_n47][_e74] - this.min[_e74];

              _r89 = Math.min(_r89, _s37), _i57 = Math.max(_i57, _s37);
            }

            if (_i57 < 0 || _r89 > this.max[_e74] - this.min[_e74]) return 0;
          }

          return 1;
        }
      }]);

      return po;
    }();

    function fo(t, e, r) {
      var n = oo([], [t.x, t.y, e, 1], r);
      return new i(n[0] / n[3], n[1] / n[3]);
    }

    var yo = Ka(0, 0, 0),
        mo = Ka(0, 0, 1);

    function go(t, e) {
      var r = Ga();
      return yo[2] = e, t.intersectsPlane(yo, mo, r), new i(r[0], r[1]);
    }

    var xo = /*#__PURE__*/function (_wa) {
      _inherits(xo, _wa);

      var _super45 = _createSuper(xo);

      function xo() {
        _classCallCheck(this, xo);

        return _super45.apply(this, arguments);
      }

      return xo;
    }(wa);

    function vo(t, _ref58, i, n) {
      var {
        width: e,
        height: r
      } = _ref58;

      if (n) {
        if (n instanceof Uint8ClampedArray) n = new Uint8Array(n.buffer);else if (n.length !== e * r * i) throw new RangeError("mismatched image size");
      } else n = new Uint8Array(e * r * i);

      return t.width = e, t.height = r, t.data = n, t;
    }

    function bo(t, _ref59, i) {
      var {
        width: e,
        height: r
      } = _ref59;
      if (e === t.width && r === t.height) return;
      var n = vo({}, {
        width: e,
        height: r
      }, i);
      wo(t, n, {
        x: 0,
        y: 0
      }, {
        x: 0,
        y: 0
      }, {
        width: Math.min(t.width, e),
        height: Math.min(t.height, r)
      }, i), t.width = e, t.height = r, t.data = n.data;
    }

    function wo(t, e, r, i, n, s) {
      if (0 === n.width || 0 === n.height) return e;
      if (n.width > t.width || n.height > t.height || r.x > t.width - n.width || r.y > t.height - n.height) throw new RangeError("out of range source coordinates for image copy");
      if (n.width > e.width || n.height > e.height || i.x > e.width - n.width || i.y > e.height - n.height) throw new RangeError("out of range destination coordinates for image copy");
      var a = t.data,
          o = e.data;

      for (var _l10 = 0; _l10 < n.height; _l10++) {
        var _u10 = ((r.y + _l10) * t.width + r.x) * s,
            _c6 = ((i.y + _l10) * e.width + i.x) * s;

        for (var _t68 = 0; _t68 < n.width * s; _t68++) {
          o[_c6 + _t68] = a[_u10 + _t68];
        }
      }

      return e;
    }

    Gi("HeatmapBucket", xo, {
      omit: ["layers"]
    });

    var _o = /*#__PURE__*/function () {
      function _o(t, e) {
        _classCallCheck(this, _o);

        vo(this, t, 1, e);
      }

      _createClass(_o, [{
        key: "resize",
        value: function resize(t) {
          bo(this, t, 1);
        }
      }, {
        key: "clone",
        value: function clone() {
          return new _o({
            width: this.width,
            height: this.height
          }, new Uint8Array(this.data));
        }
      }], [{
        key: "copy",
        value: function copy(t, e, r, i, n) {
          wo(t, e, r, i, n, 1);
        }
      }]);

      return _o;
    }();

    var ko = /*#__PURE__*/function () {
      function ko(t, e) {
        _classCallCheck(this, ko);

        vo(this, t, 4, e);
      }

      _createClass(ko, [{
        key: "resize",
        value: function resize(t) {
          bo(this, t, 4);
        }
      }, {
        key: "replace",
        value: function replace(t, e) {
          e ? this.data.set(t) : this.data = t instanceof Uint8ClampedArray ? new Uint8Array(t.buffer) : t;
        }
      }, {
        key: "clone",
        value: function clone() {
          return new ko({
            width: this.width,
            height: this.height
          }, new Uint8Array(this.data));
        }
      }], [{
        key: "copy",
        value: function copy(t, e, r, i, n) {
          wo(t, e, r, i, n, 4);
        }
      }]);

      return ko;
    }();

    Gi("AlphaImage", _o), Gi("RGBAImage", ko);
    var Ao = {
      paint: new rs({
        "heatmap-radius": new Jn(Ft.paint_heatmap["heatmap-radius"]),
        "heatmap-weight": new Jn(Ft.paint_heatmap["heatmap-weight"]),
        "heatmap-intensity": new Wn(Ft.paint_heatmap["heatmap-intensity"]),
        "heatmap-color": new es(Ft.paint_heatmap["heatmap-color"]),
        "heatmap-opacity": new Wn(Ft.paint_heatmap["heatmap-opacity"])
      })
    };

    function So(t) {
      var e = {},
          r = t.resolution || 256,
          i = t.clips ? t.clips.length : 1,
          n = t.image || new ko({
        width: r,
        height: i
      }),
          s = function (r, i, s) {
        e[t.evaluationKey] = s;
        var a = t.expression.evaluate(e);
        n.data[r + i + 0] = Math.floor(255 * a.r / a.a), n.data[r + i + 1] = Math.floor(255 * a.g / a.a), n.data[r + i + 2] = Math.floor(255 * a.b / a.a), n.data[r + i + 3] = Math.floor(255 * a.a);
      };

      if (t.clips) for (var _e75 = 0, _n48 = 0; _e75 < i; ++_e75, _n48 += 4 * r) {
        for (var _i58 = 0, _a37 = 0; _i58 < r; _i58++, _a37 += 4) {
          var _o14 = _i58 / (r - 1),
              {
            start: _l11,
            end: _u11
          } = t.clips[_e75];

          s(_n48, _a37, _l11 * (1 - _o14) + _u11 * _o14);
        }
      } else for (var _t69 = 0, _e76 = 0; _t69 < r; _t69++, _e76 += 4) {
        s(0, _e76, _t69 / (r - 1));
      }
      return n;
    }

    var Io = {
      paint: new rs({
        "hillshade-illumination-direction": new Wn(Ft.paint_hillshade["hillshade-illumination-direction"]),
        "hillshade-illumination-anchor": new Wn(Ft.paint_hillshade["hillshade-illumination-anchor"]),
        "hillshade-exaggeration": new Wn(Ft.paint_hillshade["hillshade-exaggeration"]),
        "hillshade-shadow-color": new Wn(Ft.paint_hillshade["hillshade-shadow-color"]),
        "hillshade-highlight-color": new Wn(Ft.paint_hillshade["hillshade-highlight-color"]),
        "hillshade-accent-color": new Wn(Ft.paint_hillshade["hillshade-accent-color"])
      })
    };
    var To = os([{
      name: "a_pos",
      components: 2,
      type: "Int16"
    }], 4),
        {
      members: zo
    } = To;
    var Eo = Bo,
        Mo = Bo;

    function Bo(t, e, r) {
      r = r || 2;
      var i,
          n,
          s,
          a,
          o,
          l,
          u,
          c = e && e.length,
          h = c ? e[0] * r : t.length,
          p = Do(t, 0, h, r, !0),
          d = [];
      if (!p || p.next === p.prev) return d;

      if (c && (p = function (t, e, r, i) {
        var n,
            s,
            a,
            o = [];

        for (n = 0, s = e.length; n < s; n++) {
          (a = Do(t, e[n] * i, n < s - 1 ? e[n + 1] * i : t.length, i, !1)) === a.next && (a.steiner = !0), o.push(No(a));
        }

        for (o.sort(Uo), n = 0; n < o.length; n++) {
          Oo(o[n], r), r = Co(r, r.next);
        }

        return r;
      }(t, e, p, r)), t.length > 80 * r) {
        i = s = t[0], n = a = t[1];

        for (var f = r; f < h; f += r) {
          (o = t[f]) < i && (i = o), (l = t[f + 1]) < n && (n = l), o > s && (s = o), l > a && (a = l);
        }

        u = 0 !== (u = Math.max(s - i, a - n)) ? 1 / u : 0;
      }

      return Po(p, d, r, i, n, u), d;
    }

    function Do(t, e, r, i, n) {
      var s, a;
      if (n === rl(t, e, r, i) > 0) for (s = e; s < r; s += i) {
        a = Qo(s, t[s], t[s + 1], a);
      } else for (s = r - i; s >= e; s -= i) {
        a = Qo(s, t[s], t[s + 1], a);
      }
      return a && Xo(a, a.next) && (tl(a), a = a.next), a;
    }

    function Co(t, e) {
      if (!t) return t;
      e || (e = t);
      var r,
          i = t;

      do {
        if (r = !1, i.steiner || !Xo(i, i.next) && 0 !== Zo(i.prev, i, i.next)) i = i.next;else {
          if (tl(i), (i = e = i.prev) === i.next) break;
          r = !0;
        }
      } while (r || i !== e);

      return e;
    }

    function Po(t, e, r, i, n, s, a) {
      if (t) {
        !a && s && function (t, e, r, i) {
          var n = t;

          do {
            null === n.z && (n.z = qo(n.x, n.y, e, r, i)), n.prevZ = n.prev, n.nextZ = n.next, n = n.next;
          } while (n !== t);

          n.prevZ.nextZ = null, n.prevZ = null, function (t) {
            var e,
                r,
                i,
                n,
                s,
                a,
                o,
                l,
                u = 1;

            do {
              for (r = t, t = null, s = null, a = 0; r;) {
                for (a++, i = r, o = 0, e = 0; e < u && (o++, i = i.nextZ); e++) {
                  ;
                }

                for (l = u; o > 0 || l > 0 && i;) {
                  0 !== o && (0 === l || !i || r.z <= i.z) ? (n = r, r = r.nextZ, o--) : (n = i, i = i.nextZ, l--), s ? s.nextZ = n : t = n, n.prevZ = s, s = n;
                }

                r = i;
              }

              s.nextZ = null, u *= 2;
            } while (a > 1);
          }(n);
        }(t, i, n, s);

        for (var o, l, u = t; t.prev !== t.next;) {
          if (o = t.prev, l = t.next, s ? Fo(t, i, n, s) : Vo(t)) e.push(o.i / r), e.push(t.i / r), e.push(l.i / r), tl(t), t = l.next, u = l.next;else if ((t = l) === u) {
            a ? 1 === a ? Po(t = Ro(Co(t), e, r), e, r, i, n, s, 2) : 2 === a && Lo(t, e, r, i, n, s) : Po(Co(t), e, r, i, n, s, 1);
            break;
          }
        }
      }
    }

    function Vo(t) {
      var e = t.prev,
          r = t,
          i = t.next;
      if (Zo(e, r, i) >= 0) return !1;

      for (var n = t.next.next; n !== t.prev;) {
        if (jo(e.x, e.y, r.x, r.y, i.x, i.y, n.x, n.y) && Zo(n.prev, n, n.next) >= 0) return !1;
        n = n.next;
      }

      return !0;
    }

    function Fo(t, e, r, i) {
      var n = t.prev,
          s = t,
          a = t.next;
      if (Zo(n, s, a) >= 0) return !1;

      for (var o = n.x > s.x ? n.x > a.x ? n.x : a.x : s.x > a.x ? s.x : a.x, l = n.y > s.y ? n.y > a.y ? n.y : a.y : s.y > a.y ? s.y : a.y, u = qo(n.x < s.x ? n.x < a.x ? n.x : a.x : s.x < a.x ? s.x : a.x, n.y < s.y ? n.y < a.y ? n.y : a.y : s.y < a.y ? s.y : a.y, e, r, i), c = qo(o, l, e, r, i), h = t.prevZ, p = t.nextZ; h && h.z >= u && p && p.z <= c;) {
        if (h !== t.prev && h !== t.next && jo(n.x, n.y, s.x, s.y, a.x, a.y, h.x, h.y) && Zo(h.prev, h, h.next) >= 0) return !1;
        if (h = h.prevZ, p !== t.prev && p !== t.next && jo(n.x, n.y, s.x, s.y, a.x, a.y, p.x, p.y) && Zo(p.prev, p, p.next) >= 0) return !1;
        p = p.nextZ;
      }

      for (; h && h.z >= u;) {
        if (h !== t.prev && h !== t.next && jo(n.x, n.y, s.x, s.y, a.x, a.y, h.x, h.y) && Zo(h.prev, h, h.next) >= 0) return !1;
        h = h.prevZ;
      }

      for (; p && p.z <= c;) {
        if (p !== t.prev && p !== t.next && jo(n.x, n.y, s.x, s.y, a.x, a.y, p.x, p.y) && Zo(p.prev, p, p.next) >= 0) return !1;
        p = p.nextZ;
      }

      return !0;
    }

    function Ro(t, e, r) {
      var i = t;

      do {
        var n = i.prev,
            s = i.next.next;
        !Xo(n, s) && Ko(n, i, i.next, s) && Wo(n, s) && Wo(s, n) && (e.push(n.i / r), e.push(i.i / r), e.push(s.i / r), tl(i), tl(i.next), i = t = s), i = i.next;
      } while (i !== t);

      return Co(i);
    }

    function Lo(t, e, r, i, n, s) {
      var a = t;

      do {
        for (var o = a.next.next; o !== a.prev;) {
          if (a.i !== o.i && Go(a, o)) {
            var l = Jo(a, o);
            return a = Co(a, a.next), l = Co(l, l.next), Po(a, e, r, i, n, s), void Po(l, e, r, i, n, s);
          }

          o = o.next;
        }

        a = a.next;
      } while (a !== t);
    }

    function Uo(t, e) {
      return t.x - e.x;
    }

    function Oo(t, e) {
      if (e = function (t, e) {
        var r,
            i = e,
            n = t.x,
            s = t.y,
            a = -1 / 0;

        do {
          if (s <= i.y && s >= i.next.y && i.next.y !== i.y) {
            var o = i.x + (s - i.y) * (i.next.x - i.x) / (i.next.y - i.y);

            if (o <= n && o > a) {
              if (a = o, o === n) {
                if (s === i.y) return i;
                if (s === i.next.y) return i.next;
              }

              r = i.x < i.next.x ? i : i.next;
            }
          }

          i = i.next;
        } while (i !== e);

        if (!r) return null;
        if (n === a) return r;
        var l,
            u = r,
            c = r.x,
            h = r.y,
            p = 1 / 0;
        i = r;

        do {
          n >= i.x && i.x >= c && n !== i.x && jo(s < h ? n : a, s, c, h, s < h ? a : n, s, i.x, i.y) && (l = Math.abs(s - i.y) / (n - i.x), Wo(i, t) && (l < p || l === p && (i.x > r.x || i.x === r.x && $o(r, i))) && (r = i, p = l)), i = i.next;
        } while (i !== u);

        return r;
      }(t, e)) {
        var r = Jo(e, t);
        Co(e, e.next), Co(r, r.next);
      }
    }

    function $o(t, e) {
      return Zo(t.prev, t, e.prev) < 0 && Zo(e.next, t, t.next) < 0;
    }

    function qo(t, e, r, i, n) {
      return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - r) * n) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - i) * n) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1;
    }

    function No(t) {
      var e = t,
          r = t;

      do {
        (e.x < r.x || e.x === r.x && e.y < r.y) && (r = e), e = e.next;
      } while (e !== t);

      return r;
    }

    function jo(t, e, r, i, n, s, a, o) {
      return (n - a) * (e - o) - (t - a) * (s - o) >= 0 && (t - a) * (i - o) - (r - a) * (e - o) >= 0 && (r - a) * (s - o) - (n - a) * (i - o) >= 0;
    }

    function Go(t, e) {
      return t.next.i !== e.i && t.prev.i !== e.i && !function (t, e) {
        var r = t;

        do {
          if (r.i !== t.i && r.next.i !== t.i && r.i !== e.i && r.next.i !== e.i && Ko(r, r.next, t, e)) return !0;
          r = r.next;
        } while (r !== t);

        return !1;
      }(t, e) && (Wo(t, e) && Wo(e, t) && function (t, e) {
        var r = t,
            i = !1,
            n = (t.x + e.x) / 2,
            s = (t.y + e.y) / 2;

        do {
          r.y > s != r.next.y > s && r.next.y !== r.y && n < (r.next.x - r.x) * (s - r.y) / (r.next.y - r.y) + r.x && (i = !i), r = r.next;
        } while (r !== t);

        return i;
      }(t, e) && (Zo(t.prev, t, e.prev) || Zo(t, e.prev, e)) || Xo(t, e) && Zo(t.prev, t, t.next) > 0 && Zo(e.prev, e, e.next) > 0);
    }

    function Zo(t, e, r) {
      return (e.y - t.y) * (r.x - e.x) - (e.x - t.x) * (r.y - e.y);
    }

    function Xo(t, e) {
      return t.x === e.x && t.y === e.y;
    }

    function Ko(t, e, r, i) {
      var n = Yo(Zo(t, e, r)),
          s = Yo(Zo(t, e, i)),
          a = Yo(Zo(r, i, t)),
          o = Yo(Zo(r, i, e));
      return n !== s && a !== o || !(0 !== n || !Ho(t, r, e)) || !(0 !== s || !Ho(t, i, e)) || !(0 !== a || !Ho(r, t, i)) || !(0 !== o || !Ho(r, e, i));
    }

    function Ho(t, e, r) {
      return e.x <= Math.max(t.x, r.x) && e.x >= Math.min(t.x, r.x) && e.y <= Math.max(t.y, r.y) && e.y >= Math.min(t.y, r.y);
    }

    function Yo(t) {
      return t > 0 ? 1 : t < 0 ? -1 : 0;
    }

    function Wo(t, e) {
      return Zo(t.prev, t, t.next) < 0 ? Zo(t, e, t.next) >= 0 && Zo(t, t.prev, e) >= 0 : Zo(t, e, t.prev) < 0 || Zo(t, t.next, e) < 0;
    }

    function Jo(t, e) {
      var r = new el(t.i, t.x, t.y),
          i = new el(e.i, e.x, e.y),
          n = t.next,
          s = e.prev;
      return t.next = e, e.prev = t, r.next = n, n.prev = r, i.next = r, r.prev = i, s.next = i, i.prev = s, i;
    }

    function Qo(t, e, r, i) {
      var n = new el(t, e, r);
      return i ? (n.next = i.next, n.prev = i, i.next.prev = n, i.next = n) : (n.prev = n, n.next = n), n;
    }

    function tl(t) {
      t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), t.nextZ && (t.nextZ.prevZ = t.prevZ);
    }

    function el(t, e, r) {
      this.i = t, this.x = e, this.y = r, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1;
    }

    function rl(t, e, r, i) {
      for (var n = 0, s = e, a = r - i; s < r; s += i) {
        n += (t[a] - t[s]) * (t[s + 1] + t[a + 1]), a = s;
      }

      return n;
    }

    function il(t, e, r, i, n) {
      !function t(e, r, i, n, s) {
        for (; n > i;) {
          if (n - i > 600) {
            var a = n - i + 1,
                o = r - i + 1,
                l = Math.log(a),
                u = .5 * Math.exp(2 * l / 3),
                c = .5 * Math.sqrt(l * u * (a - u) / a) * (o - a / 2 < 0 ? -1 : 1);
            t(e, r, Math.max(i, Math.floor(r - o * u / a + c)), Math.min(n, Math.floor(r + (a - o) * u / a + c)), s);
          }

          var h = e[r],
              p = i,
              d = n;

          for (nl(e, i, r), s(e[n], h) > 0 && nl(e, i, n); p < d;) {
            for (nl(e, p, d), p++, d--; s(e[p], h) < 0;) {
              p++;
            }

            for (; s(e[d], h) > 0;) {
              d--;
            }
          }

          0 === s(e[i], h) ? nl(e, i, d) : nl(e, ++d, n), d <= r && (i = d + 1), r <= d && (n = d - 1);
        }
      }(t, e, r || 0, i || t.length - 1, n || sl);
    }

    function nl(t, e, r) {
      var i = t[e];
      t[e] = t[r], t[r] = i;
    }

    function sl(t, e) {
      return t < e ? -1 : t > e ? 1 : 0;
    }

    function al(t, e) {
      var r = t.length;
      if (r <= 1) return [t];
      var i = [];
      var n, s;

      for (var _e77 = 0; _e77 < r; _e77++) {
        var _r90 = B(t[_e77]);

        0 !== _r90 && (t[_e77].area = Math.abs(_r90), void 0 === s && (s = _r90 < 0), s === _r90 < 0 ? (n && i.push(n), n = [t[_e77]]) : n.push(t[_e77]));
      }

      if (n && i.push(n), e > 1) for (var _t70 = 0; _t70 < i.length; _t70++) {
        i[_t70].length <= e || (il(i[_t70], e, 1, i[_t70].length - 1, ol), i[_t70] = i[_t70].slice(0, e));
      }
      return i;
    }

    function ol(t, e) {
      return e.area - t.area;
    }

    function ll(t, e, r) {
      var i = r.patternDependencies;
      var n = !1;

      for (var _r91 of e) {
        var _e78 = _r91.paint.get("".concat(t, "-pattern"));

        _e78.isConstant() || (n = !0);

        var _s38 = _e78.constantOr(null);

        _s38 && (n = !0, i[_s38.to] = !0, i[_s38.from] = !0);
      }

      return n;
    }

    function ul(t, e, r, i, n) {
      var s = n.patternDependencies;

      for (var _a38 of e) {
        var _e79 = _a38.paint.get("".concat(t, "-pattern")).value;

        if ("constant" !== _e79.kind) {
          var _t71 = _e79.evaluate({
            zoom: i - 1
          }, r, {}, n.availableImages),
              _o15 = _e79.evaluate({
            zoom: i
          }, r, {}, n.availableImages),
              _l12 = _e79.evaluate({
            zoom: i + 1
          }, r, {}, n.availableImages);

          _t71 = _t71 && _t71.name ? _t71.name : _t71, _o15 = _o15 && _o15.name ? _o15.name : _o15, _l12 = _l12 && _l12.name ? _l12.name : _l12, s[_t71] = !0, s[_o15] = !0, s[_l12] = !0, r.patterns[_a38.id] = {
            min: _t71,
            mid: _o15,
            max: _l12
          };
        }
      }

      return r;
    }

    Bo.deviation = function (t, e, r, i) {
      var n = e && e.length,
          s = Math.abs(rl(t, 0, n ? e[0] * r : t.length, r));
      if (n) for (var a = 0, o = e.length; a < o; a++) {
        s -= Math.abs(rl(t, e[a] * r, a < o - 1 ? e[a + 1] * r : t.length, r));
      }
      var l = 0;

      for (a = 0; a < i.length; a += 3) {
        var u = i[a] * r,
            c = i[a + 1] * r,
            h = i[a + 2] * r;
        l += Math.abs((t[u] - t[h]) * (t[c + 1] - t[u + 1]) - (t[u] - t[c]) * (t[h + 1] - t[u + 1]));
      }

      return 0 === s && 0 === l ? 0 : Math.abs((l - s) / s);
    }, Bo.flatten = function (t) {
      for (var e = t[0][0].length, r = {
        vertices: [],
        holes: [],
        dimensions: e
      }, i = 0, n = 0; n < t.length; n++) {
        for (var s = 0; s < t[n].length; s++) {
          for (var a = 0; a < e; a++) {
            r.vertices.push(t[n][s][a]);
          }
        }

        n > 0 && r.holes.push(i += t[n - 1].length);
      }

      return r;
    }, Eo.default = Mo;

    var cl = /*#__PURE__*/function () {
      function cl(t) {
        _classCallCheck(this, cl);

        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
          return t.id;
        }), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.layoutVertexArray = new us(), this.indexArray = new ws(), this.indexArray2 = new Ts(), this.programConfigurations = new ua(t.layers, t.zoom), this.segments = new ya(), this.segments2 = new ya(), this.stateDependentLayerIds = this.layers.filter(function (t) {
          return t.isStateDependent();
        }).map(function (t) {
          return t.id;
        });
      }

      _createClass(cl, [{
        key: "populate",
        value: function populate(t, e, r) {
          this.hasPattern = ll("fill", this.layers, e);
          var i = this.layers[0].layout.get("fill-sort-key"),
              n = [];

          for (var {
            feature: _s39,
            id: _a39,
            index: _o16,
            sourceLayerIndex: _l13
          } of t) {
            var _t72 = this.layers[0]._featureFilter.needGeometry,
                _u12 = va(_s39, _t72);

            if (!this.layers[0]._featureFilter.filter(new qn(this.zoom), _u12, r)) continue;

            var _c7 = i ? i.evaluate(_u12, {}, r, e.availableImages) : void 0,
                _h3 = {
              id: _a39,
              properties: _s39.properties,
              type: _s39.type,
              sourceLayerIndex: _l13,
              index: _o16,
              geometry: _t72 ? _u12.geometry : xa(_s39),
              patterns: {},
              sortKey: _c7
            };

            n.push(_h3);
          }

          i && n.sort(function (t, e) {
            return t.sortKey - e.sortKey;
          });

          for (var _i59 of n) {
            var {
              geometry: _n49,
              index: _s40,
              sourceLayerIndex: _a40
            } = _i59;

            if (this.hasPattern) {
              var _t73 = ul("fill", this.layers, _i59, this.zoom, e);

              this.patternFeatures.push(_t73);
            } else this.addFeature(_i59, _n49, _s40, r, {});

            e.featureIndex.insert(t[_s40].feature, _n49, _s40, _a40, this.index);
          }
        }
      }, {
        key: "update",
        value: function update(t, e, r) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }
      }, {
        key: "addFeatures",
        value: function addFeatures(t, e, r) {
          for (var _t74 of this.patternFeatures) {
            this.addFeature(_t74, _t74.geometry, _t74.index, e, r);
          }
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.layoutVertexArray.length;
        }
      }, {
        key: "uploadPending",
        value: function uploadPending() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, zo), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.indexBuffer2 = t.createIndexBuffer(this.indexArray2)), this.programConfigurations.upload(t), this.uploaded = !0;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.indexBuffer2.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.segments2.destroy());
        }
      }, {
        key: "addFeature",
        value: function addFeature(t, e, r, i, n) {
          for (var _t75 of al(e, 500)) {
            var _e80 = 0;

            for (var _r93 of _t75) {
              _e80 += _r93.length;
            }

            var _r92 = this.segments.prepareSegment(_e80, this.layoutVertexArray, this.indexArray),
                _i60 = _r92.vertexLength,
                _n50 = [],
                _s41 = [];

            for (var _e81 of _t75) {
              if (0 === _e81.length) continue;
              _e81 !== _t75[0] && _s41.push(_n50.length / 2);

              var _r94 = this.segments2.prepareSegment(_e81.length, this.layoutVertexArray, this.indexArray2),
                  _i61 = _r94.vertexLength;

              this.layoutVertexArray.emplaceBack(_e81[0].x, _e81[0].y), this.indexArray2.emplaceBack(_i61 + _e81.length - 1, _i61), _n50.push(_e81[0].x), _n50.push(_e81[0].y);

              for (var _t76 = 1; _t76 < _e81.length; _t76++) {
                this.layoutVertexArray.emplaceBack(_e81[_t76].x, _e81[_t76].y), this.indexArray2.emplaceBack(_i61 + _t76 - 1, _i61 + _t76), _n50.push(_e81[_t76].x), _n50.push(_e81[_t76].y);
              }

              _r94.vertexLength += _e81.length, _r94.primitiveLength += _e81.length;
            }

            var _a41 = Eo(_n50, _s41);

            for (var _t77 = 0; _t77 < _a41.length; _t77 += 3) {
              this.indexArray.emplaceBack(_i60 + _a41[_t77], _i60 + _a41[_t77 + 1], _i60 + _a41[_t77 + 2]);
            }

            _r92.vertexLength += _e80, _r92.primitiveLength += _a41.length / 3;
          }

          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, n, i);
        }
      }]);

      return cl;
    }();

    Gi("FillBucket", cl, {
      omit: ["layers", "patternFeatures"]
    });
    var hl = new rs({
      "fill-sort-key": new Jn(Ft.layout_fill["fill-sort-key"])
    });
    var pl = {
      paint: new rs({
        "fill-antialias": new Wn(Ft.paint_fill["fill-antialias"]),
        "fill-opacity": new Jn(Ft.paint_fill["fill-opacity"]),
        "fill-color": new Jn(Ft.paint_fill["fill-color"]),
        "fill-outline-color": new Jn(Ft.paint_fill["fill-outline-color"]),
        "fill-translate": new Wn(Ft.paint_fill["fill-translate"]),
        "fill-translate-anchor": new Wn(Ft.paint_fill["fill-translate-anchor"]),
        "fill-pattern": new Qn(Ft.paint_fill["fill-pattern"])
      }),
      layout: hl
    };
    var dl = os([{
      name: "a_pos_normal_ed",
      components: 4,
      type: "Int16"
    }]),
        fl = os([{
      name: "a_centroid_pos",
      components: 2,
      type: "Uint16"
    }]),
        {
      members: yl
    } = dl;
    var ml = gl;

    function gl(t, e, r, i, n) {
      this.properties = {}, this.extent = r, this.type = 0, this._pbf = t, this._geometry = -1, this._keys = i, this._values = n, t.readFields(xl, this, e);
    }

    function xl(t, e, r) {
      1 == t ? e.id = r.readVarint() : 2 == t ? function (t, e) {
        for (var r = t.readVarint() + t.pos; t.pos < r;) {
          var i = e._keys[t.readVarint()],
              n = e._values[t.readVarint()];

          e.properties[i] = n;
        }
      }(r, e) : 3 == t ? e.type = r.readVarint() : 4 == t && (e._geometry = r.pos);
    }

    function vl(t) {
      for (var e, r, i = 0, n = 0, s = t.length, a = s - 1; n < s; a = n++) {
        i += ((r = t[a]).x - (e = t[n]).x) * (e.y + r.y);
      }

      return i;
    }

    gl.types = ["Unknown", "Point", "LineString", "Polygon"], gl.prototype.loadGeometry = function () {
      var t = this._pbf;
      t.pos = this._geometry;

      for (var e, r = t.readVarint() + t.pos, n = 1, s = 0, a = 0, o = 0, l = []; t.pos < r;) {
        if (s <= 0) {
          var u = t.readVarint();
          n = 7 & u, s = u >> 3;
        }

        if (s--, 1 === n || 2 === n) a += t.readSVarint(), o += t.readSVarint(), 1 === n && (e && l.push(e), e = []), e.push(new i(a, o));else {
          if (7 !== n) throw new Error("unknown command " + n);
          e && e.push(e[0].clone());
        }
      }

      return e && l.push(e), l;
    }, gl.prototype.bbox = function () {
      var t = this._pbf;
      t.pos = this._geometry;

      for (var e = t.readVarint() + t.pos, r = 1, i = 0, n = 0, s = 0, a = 1 / 0, o = -1 / 0, l = 1 / 0, u = -1 / 0; t.pos < e;) {
        if (i <= 0) {
          var c = t.readVarint();
          r = 7 & c, i = c >> 3;
        }

        if (i--, 1 === r || 2 === r) (n += t.readSVarint()) < a && (a = n), n > o && (o = n), (s += t.readSVarint()) < l && (l = s), s > u && (u = s);else if (7 !== r) throw new Error("unknown command " + r);
      }

      return [a, l, o, u];
    }, gl.prototype.toGeoJSON = function (t, e, r) {
      var i,
          n,
          s = this.extent * Math.pow(2, r),
          a = this.extent * t,
          o = this.extent * e,
          l = this.loadGeometry(),
          u = gl.types[this.type];

      function c(t) {
        for (var e = 0; e < t.length; e++) {
          var r = t[e];
          t[e] = [360 * (r.x + a) / s - 180, 360 / Math.PI * Math.atan(Math.exp((180 - 360 * (r.y + o) / s) * Math.PI / 180)) - 90];
        }
      }

      switch (this.type) {
        case 1:
          var h = [];

          for (i = 0; i < l.length; i++) {
            h[i] = l[i][0];
          }

          c(l = h);
          break;

        case 2:
          for (i = 0; i < l.length; i++) {
            c(l[i]);
          }

          break;

        case 3:
          for (l = function (t) {
            var e = t.length;
            if (e <= 1) return [t];

            for (var r, i, n = [], s = 0; s < e; s++) {
              var a = vl(t[s]);
              0 !== a && (void 0 === i && (i = a < 0), i === a < 0 ? (r && n.push(r), r = [t[s]]) : r.push(t[s]));
            }

            return r && n.push(r), n;
          }(l), i = 0; i < l.length; i++) {
            for (n = 0; n < l[i].length; n++) {
              c(l[i][n]);
            }
          }

      }

      1 === l.length ? l = l[0] : u = "Multi" + u;
      var p = {
        type: "Feature",
        geometry: {
          type: u,
          coordinates: l
        },
        properties: this.properties
      };
      return "id" in this && (p.id = this.id), p;
    };
    var bl = wl;

    function wl(t, e) {
      this.version = 1, this.name = null, this.extent = 4096, this.length = 0, this._pbf = t, this._keys = [], this._values = [], this._features = [], t.readFields(_l, this, e), this.length = this._features.length;
    }

    function _l(t, e, r) {
      15 === t ? e.version = r.readVarint() : 1 === t ? e.name = r.readString() : 5 === t ? e.extent = r.readVarint() : 2 === t ? e._features.push(r.pos) : 3 === t ? e._keys.push(r.readString()) : 4 === t && e._values.push(function (t) {
        for (var e = null, r = t.readVarint() + t.pos; t.pos < r;) {
          var i = t.readVarint() >> 3;
          e = 1 === i ? t.readString() : 2 === i ? t.readFloat() : 3 === i ? t.readDouble() : 4 === i ? t.readVarint64() : 5 === i ? t.readVarint() : 6 === i ? t.readSVarint() : 7 === i ? t.readBoolean() : null;
        }

        return e;
      }(r));
    }

    function kl(t, e, r) {
      if (3 === t) {
        var i = new bl(r, r.readVarint() + r.pos);
        i.length && (e[i.name] = i);
      }
    }

    wl.prototype.feature = function (t) {
      if (t < 0 || t >= this._features.length) throw new Error("feature index out of bounds");
      this._pbf.pos = this._features[t];

      var e = this._pbf.readVarint() + this._pbf.pos;

      return new ml(this._pbf, e, this.extent, this._keys, this._values);
    };

    var Al = {
      VectorTile: function (t, e) {
        this.layers = t.readFields(kl, {}, e);
      },
      VectorTileFeature: ml,
      VectorTileLayer: bl
    };
    var Sl = Al.VectorTileFeature.types,
        Il = Math.pow(2, 13);

    function Tl(t, e, r, i, n, s, a, o) {
      t.emplaceBack((e << 1) + a, (r << 1) + s, (Math.floor(i * Il) << 1) + n, Math.round(o));
    }

    var zl = /*#__PURE__*/function () {
      function zl() {
        _classCallCheck(this, zl);

        this.acc = new i(0, 0), this.polyCount = [];
      }

      _createClass(zl, [{
        key: "startRing",
        value: function startRing(t) {
          this.currentPolyCount = {
            edges: 0,
            top: 0
          }, this.polyCount.push(this.currentPolyCount), this.min || (this.min = new i(t.x, t.y), this.max = new i(t.x, t.y));
        }
      }, {
        key: "append",
        value: function append(t, e) {
          this.currentPolyCount.edges++, this.acc._add(t);
          var r = !!this.borders;
          var i = this.min,
              n = this.max;
          t.x < i.x ? (i.x = t.x, r = !0) : t.x > n.x && (n.x = t.x, r = !0), t.y < i.y ? (i.y = t.y, r = !0) : t.y > n.y && (n.y = t.y, r = !0), ((0 === t.x || 8192 === t.x) && t.x === e.x) != ((0 === t.y || 8192 === t.y) && t.y === e.y) && this.processBorderOverlap(t, e), r && this.checkBorderIntersection(t, e);
        }
      }, {
        key: "checkBorderIntersection",
        value: function checkBorderIntersection(t, e) {
          e.x < 0 != t.x < 0 && this.addBorderIntersection(0, Je(e.y, t.y, (0 - e.x) / (t.x - e.x))), e.x > 8192 != t.x > 8192 && this.addBorderIntersection(1, Je(e.y, t.y, (8192 - e.x) / (t.x - e.x))), e.y < 0 != t.y < 0 && this.addBorderIntersection(2, Je(e.x, t.x, (0 - e.y) / (t.y - e.y))), e.y > 8192 != t.y > 8192 && this.addBorderIntersection(3, Je(e.x, t.x, (8192 - e.y) / (t.y - e.y)));
        }
      }, {
        key: "addBorderIntersection",
        value: function addBorderIntersection(t, e) {
          this.borders || (this.borders = [[Number.MAX_VALUE, -Number.MAX_VALUE], [Number.MAX_VALUE, -Number.MAX_VALUE], [Number.MAX_VALUE, -Number.MAX_VALUE], [Number.MAX_VALUE, -Number.MAX_VALUE]]);
          var r = this.borders[t];
          e < r[0] && (r[0] = e), e > r[1] && (r[1] = e);
        }
      }, {
        key: "processBorderOverlap",
        value: function processBorderOverlap(t, e) {
          if (t.x === e.x) {
            if (t.y === e.y) return;

            var _r95 = 0 === t.x ? 0 : 1;

            this.addBorderIntersection(_r95, e.y), this.addBorderIntersection(_r95, t.y);
          } else {
            var _r96 = 0 === t.y ? 2 : 3;

            this.addBorderIntersection(_r96, e.x), this.addBorderIntersection(_r96, t.x);
          }
        }
      }, {
        key: "centroid",
        value: function centroid() {
          var t = this.polyCount.reduce(function (t, e) {
            return t + e.edges;
          }, 0);
          return 0 !== t ? this.acc.div(t)._round() : new i(0, 0);
        }
      }, {
        key: "span",
        value: function span() {
          return new i(this.max.x - this.min.x, this.max.y - this.min.y);
        }
      }, {
        key: "intersectsCount",
        value: function intersectsCount() {
          return this.borders.reduce(function (t, e) {
            return t + +(e[0] !== Number.MAX_VALUE);
          }, 0);
        }
      }]);

      return zl;
    }();

    var El = /*#__PURE__*/function () {
      function El(t) {
        _classCallCheck(this, El);

        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
          return t.id;
        }), this.index = t.index, this.hasPattern = !1, this.layoutVertexArray = new cs(), this.centroidVertexArray = new $s(), this.indexArray = new ws(), this.programConfigurations = new ua(t.layers, t.zoom), this.segments = new ya(), this.stateDependentLayerIds = this.layers.filter(function (t) {
          return t.isStateDependent();
        }).map(function (t) {
          return t.id;
        }), this.enableTerrain = t.enableTerrain;
      }

      _createClass(El, [{
        key: "populate",
        value: function populate(t, e, r) {
          this.features = [], this.hasPattern = ll("fill-extrusion", this.layers, e), this.featuresOnBorder = [], this.borders = [[], [], [], []], this.borderDone = [!1, !1, !1, !1], this.tileToMeter = function (t) {
            var e = Math.exp(Math.PI * (1 - t.y / (1 << t.z) * 2));
            return 80150034 * e / (e * e + 1) / 8192 / (1 << t.z);
          }(r);

          for (var {
            feature: _i62,
            id: _n51,
            index: _s42,
            sourceLayerIndex: _a42
          } of t) {
            var _t78 = this.layers[0]._featureFilter.needGeometry,
                _o17 = va(_i62, _t78);

            if (!this.layers[0]._featureFilter.filter(new qn(this.zoom), _o17, r)) continue;
            var _l14 = {
              id: _n51,
              sourceLayerIndex: _a42,
              index: _s42,
              geometry: _t78 ? _o17.geometry : xa(_i62),
              properties: _i62.properties,
              type: _i62.type,
              patterns: {}
            },
                _u13 = this.layoutVertexArray.length;
            this.hasPattern ? this.features.push(ul("fill-extrusion", this.layers, _l14, this.zoom, e)) : this.addFeature(_l14, _l14.geometry, _s42, r, {}), e.featureIndex.insert(_i62, _l14.geometry, _s42, _a42, this.index, _u13);
          }

          this.sortBorders();
        }
      }, {
        key: "addFeatures",
        value: function addFeatures(t, e, r) {
          for (var _t79 of this.features) {
            var {
              geometry: _i63
            } = _t79;
            this.addFeature(_t79, _i63, _t79.index, e, r);
          }

          this.sortBorders();
        }
      }, {
        key: "update",
        value: function update(t, e, r) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.layoutVertexArray.length;
        }
      }, {
        key: "uploadPending",
        value: function uploadPending() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, yl), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }
      }, {
        key: "uploadCentroid",
        value: function uploadCentroid(t) {
          0 !== this.centroidVertexArray.length && (this.centroidVertexBuffer ? this.needsCentroidUpdate && this.centroidVertexBuffer.updateData(this.centroidVertexArray) : this.centroidVertexBuffer = t.createVertexBuffer(this.centroidVertexArray, fl.members, !0), this.needsCentroidUpdate = !1);
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.centroidVertexBuffer && this.centroidVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }
      }, {
        key: "addFeature",
        value: function addFeature(t, e, r, i, n) {
          var s = this.enableTerrain && t.properties && t.properties.hasOwnProperty("type") && t.properties.hasOwnProperty("height") && "Polygon" === Sl[t.type] ? new zl() : null;

          for (var _r97 of al(e, 500)) {
            var _e82 = 0,
                _i64 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray);

            if (0 === _r97.length || (a = _r97[0]).every(function (t) {
              return t.x <= 0;
            }) || a.every(function (t) {
              return t.x >= 8192;
            }) || a.every(function (t) {
              return t.y <= 0;
            }) || a.every(function (t) {
              return t.y >= 8192;
            })) continue;

            for (var _t80 = 0; _t80 < _r97.length; _t80++) {
              var _n53 = _r97[_t80];
              if (0 === _n53.length) continue;
              _e82 += _n53.length;
              var _a43 = 0;
              s && s.startRing(_n53[0]);

              for (var _t81 = 0; _t81 < _n53.length; _t81++) {
                var _e83 = _n53[_t81];

                if (_t81 >= 1) {
                  var _r98 = _n53[_t81 - 1];

                  if (!Ml(_e83, _r98)) {
                    s && s.append(_e83, _r98), _i64.vertexLength + 4 > ya.MAX_VERTEX_ARRAY_LENGTH && (_i64 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray));

                    var _t82 = _e83.sub(_r98)._perp(),
                        _n54 = _t82.x / (Math.abs(_t82.x) + Math.abs(_t82.y)),
                        _o19 = _t82.y > 0 ? 1 : 0,
                        _l16 = _r98.dist(_e83);

                    _a43 + _l16 > 32768 && (_a43 = 0), Tl(this.layoutVertexArray, _e83.x, _e83.y, _n54, _o19, 0, 0, _a43), Tl(this.layoutVertexArray, _e83.x, _e83.y, _n54, _o19, 0, 1, _a43), _a43 += _l16, Tl(this.layoutVertexArray, _r98.x, _r98.y, _n54, _o19, 0, 0, _a43), Tl(this.layoutVertexArray, _r98.x, _r98.y, _n54, _o19, 0, 1, _a43);
                    var _u15 = _i64.vertexLength;
                    this.indexArray.emplaceBack(_u15, _u15 + 2, _u15 + 1), this.indexArray.emplaceBack(_u15 + 1, _u15 + 2, _u15 + 3), _i64.vertexLength += 4, _i64.primitiveLength += 2;
                  }
                }
              }
            }

            if (_i64.vertexLength + _e82 > ya.MAX_VERTEX_ARRAY_LENGTH && (_i64 = this.segments.prepareSegment(_e82, this.layoutVertexArray, this.indexArray)), "Polygon" !== Sl[t.type]) continue;
            var _n52 = [],
                _o18 = [],
                _l15 = _i64.vertexLength;

            for (var _t83 = 0; _t83 < _r97.length; _t83++) {
              var _e84 = _r97[_t83];

              if (0 !== _e84.length) {
                _e84 !== _r97[0] && _o18.push(_n52.length / 2);

                for (var _t84 = 0; _t84 < _e84.length; _t84++) {
                  var _r99 = _e84[_t84];
                  Tl(this.layoutVertexArray, _r99.x, _r99.y, 0, 0, 1, 1, 0), _n52.push(_r99.x), _n52.push(_r99.y), s && s.currentPolyCount.top++;
                }
              }
            }

            var _u14 = Eo(_n52, _o18);

            for (var _t85 = 0; _t85 < _u14.length; _t85 += 3) {
              this.indexArray.emplaceBack(_l15 + _u14[_t85], _l15 + _u14[_t85 + 2], _l15 + _u14[_t85 + 1]);
            }

            _i64.primitiveLength += _u14.length / 3, _i64.vertexLength += _e82;
          }

          var a;

          if (s && s.polyCount.length > 0) {
            if (s.borders) {
              s.vertexArrayOffset = this.centroidVertexArray.length;

              var _t86 = s.borders,
                  _e85 = this.featuresOnBorder.push(s) - 1;

              for (var _r100 = 0; _r100 < 4; _r100++) {
                _t86[_r100][0] !== Number.MAX_VALUE && this.borders[_r100].push(_e85);
              }
            }

            this.encodeCentroid(s.borders ? void 0 : s.centroid(), s);
          }

          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, n, i);
        }
      }, {
        key: "sortBorders",
        value: function sortBorders() {
          var _this17 = this;

          var _loop = function (_t87) {
            _this17.borders[_t87].sort(function (e, r) {
              return _this17.featuresOnBorder[e].borders[_t87][0] - _this17.featuresOnBorder[r].borders[_t87][0];
            });
          };

          for (var _t87 = 0; _t87 < 4; _t87++) {
            _loop(_t87);
          }
        }
      }, {
        key: "encodeCentroid",
        value: function encodeCentroid(t, e) {
          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !0;
          var i, n;
          if (t) {
            if (0 !== t.y) {
              var _r101 = e.span()._mult(this.tileToMeter);

              i = (Math.max(t.x, 1) << 3) + Math.min(7, Math.round(_r101.x / 10)), n = (Math.max(t.y, 1) << 3) + Math.min(7, Math.round(_r101.y / 10));
            } else i = Math.ceil(7.3 * t.x), n = 0;
          } else i = 0, n = +r;
          var s = r ? this.centroidVertexArray.length : e.vertexArrayOffset;

          for (var _t88 of e.polyCount) {
            r && this.centroidVertexArray.resize(this.centroidVertexArray.length + 4 * _t88.edges + _t88.top);

            for (var _e86 = 0; _e86 < 2 * _t88.edges; _e86++) {
              this.centroidVertexArray.emplace(s++, 0, n), this.centroidVertexArray.emplace(s++, i, n);
            }

            for (var _e87 = 0; _e87 < _t88.top; _e87++) {
              this.centroidVertexArray.emplace(s++, i, n);
            }
          }
        }
      }]);

      return El;
    }();

    function Ml(t, e) {
      return t.x === e.x && (t.x < 0 || t.x > 8192) || t.y === e.y && (t.y < 0 || t.y > 8192);
    }

    Gi("FillExtrusionBucket", El, {
      omit: ["layers", "features"]
    }), Gi("PartMetadata", zl);
    var Bl = {
      paint: new rs({
        "fill-extrusion-opacity": new Wn(Ft["paint_fill-extrusion"]["fill-extrusion-opacity"]),
        "fill-extrusion-color": new Jn(Ft["paint_fill-extrusion"]["fill-extrusion-color"]),
        "fill-extrusion-translate": new Wn(Ft["paint_fill-extrusion"]["fill-extrusion-translate"]),
        "fill-extrusion-translate-anchor": new Wn(Ft["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),
        "fill-extrusion-pattern": new Qn(Ft["paint_fill-extrusion"]["fill-extrusion-pattern"]),
        "fill-extrusion-height": new Jn(Ft["paint_fill-extrusion"]["fill-extrusion-height"]),
        "fill-extrusion-base": new Jn(Ft["paint_fill-extrusion"]["fill-extrusion-base"]),
        "fill-extrusion-vertical-gradient": new Wn(Ft["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])
      })
    };

    function Dl(t, e) {
      return t.x * e.x + t.y * e.y;
    }

    function Cl(t, e) {
      if (1 === t.length) {
        var _r102 = 0;
        var _i65 = e[_r102++];

        var _n55;

        for (; !_n55 || _i65.equals(_n55);) {
          if (_n55 = e[_r102++], !_n55) return 1 / 0;
        }

        for (; _r102 < e.length; _r102++) {
          var _s43 = e[_r102],
              _a44 = t[0],
              _o20 = _n55.sub(_i65),
              _l17 = _s43.sub(_i65),
              _u16 = _a44.sub(_i65),
              _c8 = Dl(_o20, _o20),
              _h4 = Dl(_o20, _l17),
              _p2 = Dl(_l17, _l17),
              _d = Dl(_u16, _o20),
              _f = Dl(_u16, _l17),
              _y = _c8 * _p2 - _h4 * _h4,
              _m = (_p2 * _d - _h4 * _f) / _y,
              _g = (_c8 * _f - _h4 * _d) / _y,
              _x = _i65.z * (1 - _m - _g) + _n55.z * _m + _s43.z * _g;

          if (isFinite(_x)) return _x;
        }

        return 1 / 0;
      }

      {
        var _t89 = 1 / 0;

        for (var _r103 of e) {
          _t89 = Math.min(_t89, _r103.z);
        }

        return _t89;
      }
    }

    function Pl(t) {
      var e = new i(t[0], t[1]);
      return e.z = t[2], e;
    }

    function Vl(t, e, r, i, n, s, a, o) {
      var l = a * n.getElevationAt(t, e, !0, !0),
          u = 0 !== s[0],
          c = u ? 0 === s[1] ? a * (s[0] / 7.3) : a * function (t, e, r) {
        var i = Math.floor(e[0] / 8),
            n = Math.floor(e[1] / 8),
            s = 10 * (e[0] - 8 * i),
            a = 10 * (e[1] - 8 * n),
            o = t.getElevationAt(i, n, !0, !0),
            l = t.getMeterToDEM(r),
            u = Math.floor(.5 * (s * l - 1)),
            c = Math.floor(.5 * (a * l - 1)),
            h = t.tileCoordToPixel(i, n),
            p = 2 * u + 1,
            d = 2 * c + 1,
            f = function (t, e, r, i, n) {
          return [t.getElevationAtPixel(e, r, !0), t.getElevationAtPixel(e + n, r, !0), t.getElevationAtPixel(e, r + n, !0), t.getElevationAtPixel(e + i, r + n, !0)];
        }(t, h.x - u, h.y - c, p, d),
            y = Math.abs(f[0] - f[1]),
            m = Math.abs(f[2] - f[3]),
            g = Math.abs(f[0] - f[2]) + Math.abs(f[1] - f[3]),
            x = Math.min(.25, .5 * l * (y + m) / p),
            v = Math.min(.25, .5 * l * g / d);

        return o + Math.max(x * s, v * a);
      }(n, s, o) : l;
      return {
        base: l + (0 === r) ? -1 : r,
        top: u ? Math.max(c + i, l + r + 2) : l + i
      };
    }

    var Fl = os([{
      name: "a_pos_normal",
      components: 2,
      type: "Int16"
    }, {
      name: "a_data",
      components: 4,
      type: "Uint8"
    }, {
      name: "a_linesofar",
      components: 1,
      type: "Float32"
    }], 4),
        {
      members: Rl
    } = Fl,
        Ll = os([{
      name: "a_uv_x",
      components: 1,
      type: "Float32"
    }, {
      name: "a_split_index",
      components: 1,
      type: "Float32"
    }]),
        {
      members: Ul
    } = Ll,
        Ol = Al.VectorTileFeature.types,
        $l = Math.cos(Math.PI / 180 * 37.5);

    var ql = /*#__PURE__*/function () {
      function ql(t) {
        var _this18 = this;

        _classCallCheck(this, ql);

        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
          return t.id;
        }), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.lineClipsArray = [], this.gradients = {}, this.layers.forEach(function (t) {
          _this18.gradients[t.id] = {};
        }), this.layoutVertexArray = new hs(), this.layoutVertexArray2 = new ps(), this.indexArray = new ws(), this.programConfigurations = new ua(t.layers, t.zoom), this.segments = new ya(), this.maxLineLength = 0, this.stateDependentLayerIds = this.layers.filter(function (t) {
          return t.isStateDependent();
        }).map(function (t) {
          return t.id;
        });
      }

      _createClass(ql, [{
        key: "populate",
        value: function populate(t, e, r) {
          this.hasPattern = ll("line", this.layers, e);
          var i = this.layers[0].layout.get("line-sort-key"),
              n = [];

          for (var {
            feature: _e88,
            id: _s44,
            index: _a45,
            sourceLayerIndex: _o21
          } of t) {
            var _t90 = this.layers[0]._featureFilter.needGeometry,
                _l18 = va(_e88, _t90);

            if (!this.layers[0]._featureFilter.filter(new qn(this.zoom), _l18, r)) continue;

            var _u17 = i ? i.evaluate(_l18, {}, r) : void 0,
                _c9 = {
              id: _s44,
              properties: _e88.properties,
              type: _e88.type,
              sourceLayerIndex: _o21,
              index: _a45,
              geometry: _t90 ? _l18.geometry : xa(_e88),
              patterns: {},
              sortKey: _u17
            };

            n.push(_c9);
          }

          i && n.sort(function (t, e) {
            return t.sortKey - e.sortKey;
          });

          for (var _i66 of n) {
            var {
              geometry: _n56,
              index: _s45,
              sourceLayerIndex: _a46
            } = _i66;

            if (this.hasPattern) {
              var _t91 = ul("line", this.layers, _i66, this.zoom, e);

              this.patternFeatures.push(_t91);
            } else this.addFeature(_i66, _n56, _s45, r, {});

            e.featureIndex.insert(t[_s45].feature, _n56, _s45, _a46, this.index);
          }
        }
      }, {
        key: "update",
        value: function update(t, e, r) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }
      }, {
        key: "addFeatures",
        value: function addFeatures(t, e, r) {
          for (var _t92 of this.patternFeatures) {
            this.addFeature(_t92, _t92.geometry, _t92.index, e, r);
          }
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.layoutVertexArray.length;
        }
      }, {
        key: "uploadPending",
        value: function uploadPending() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.uploaded || (0 !== this.layoutVertexArray2.length && (this.layoutVertexBuffer2 = t.createVertexBuffer(this.layoutVertexArray2, Ul)), this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Rl), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }
      }, {
        key: "lineFeatureClips",
        value: function lineFeatureClips(t) {
          if (t.properties && t.properties.hasOwnProperty("mapbox_clip_start") && t.properties.hasOwnProperty("mapbox_clip_end")) return {
            start: +t.properties.mapbox_clip_start,
            end: +t.properties.mapbox_clip_end
          };
        }
      }, {
        key: "addFeature",
        value: function addFeature(t, e, r, i, n) {
          var s = this.layers[0].layout,
              a = s.get("line-join").evaluate(t, {}),
              o = s.get("line-cap"),
              l = s.get("line-miter-limit"),
              u = s.get("line-round-limit");
          this.lineClips = this.lineFeatureClips(t);

          for (var _r104 of e) {
            this.addLine(_r104, t, a, o, l, u);
          }

          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, n, i);
        }
      }, {
        key: "addLine",
        value: function addLine(t, e, r, i, n, s) {
          if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, this.lineSoFar = 0, this.lineClips) {
            this.lineClipsArray.push(this.lineClips);

            for (var _e89 = 0; _e89 < t.length - 1; _e89++) {
              this.totalDistance += t[_e89].dist(t[_e89 + 1]);
            }

            this.updateScaledDistance(), this.maxLineLength = Math.max(this.maxLineLength, this.totalDistance);
          }

          var a = "Polygon" === Ol[e.type];
          var o = t.length;

          for (; o >= 2 && t[o - 1].equals(t[o - 2]);) {
            o--;
          }

          var l = 0;

          for (; l < o - 1 && t[l].equals(t[l + 1]);) {
            l++;
          }

          if (o < (a ? 3 : 2)) return;
          "bevel" === r && (n = 1.05);
          var u = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0,
              c = this.segments.prepareSegment(10 * o, this.layoutVertexArray, this.indexArray);
          var h,
              p = void 0,
              d = void 0,
              f = void 0,
              y = void 0;
          this.e1 = this.e2 = -1, a && (h = t[o - 2], y = t[l].sub(h)._unit()._perp());

          for (var _e90 = l; _e90 < o; _e90++) {
            if (d = _e90 === o - 1 ? a ? t[l + 1] : void 0 : t[_e90 + 1], d && t[_e90].equals(d)) continue;
            y && (f = y), h && (p = h), h = t[_e90], y = d ? d.sub(h)._unit()._perp() : f, f = f || y;

            var _m2 = f.add(y);

            0 === _m2.x && 0 === _m2.y || _m2._unit();

            var _g2 = f.x * y.x + f.y * y.y,
                _x2 = _m2.x * y.x + _m2.y * y.y,
                _v = 0 !== _x2 ? 1 / _x2 : 1 / 0,
                _b = 2 * Math.sqrt(2 - 2 * _x2),
                _w = _x2 < $l && p && d,
                _2 = f.x * y.y - f.y * y.x > 0;

            if (_w && _e90 > l) {
              var _t93 = h.dist(p);

              if (_t93 > 2 * u) {
                var _e91 = h.sub(h.sub(p)._mult(u / _t93)._round());

                this.updateDistance(p, _e91), this.addCurrentVertex(_e91, f, 0, 0, c), p = _e91;
              }
            }

            var _k = p && d;

            var _A = _k ? r : a ? "butt" : i;

            if (_k && "round" === _A && (_v < s ? _A = "miter" : _v <= 2 && (_A = "fakeround")), "miter" === _A && _v > n && (_A = "bevel"), "bevel" === _A && (_v > 2 && (_A = "flipbevel"), _v < n && (_A = "miter")), p && this.updateDistance(p, h), "miter" === _A) _m2._mult(_v), this.addCurrentVertex(h, _m2, 0, 0, c);else if ("flipbevel" === _A) {
              if (_v > 100) _m2 = y.mult(-1);else {
                var _t94 = _v * f.add(y).mag() / f.sub(y).mag();

                _m2._perp()._mult(_t94 * (_2 ? -1 : 1));
              }
              this.addCurrentVertex(h, _m2, 0, 0, c), this.addCurrentVertex(h, _m2.mult(-1), 0, 0, c);
            } else if ("bevel" === _A || "fakeround" === _A) {
              var _t95 = -Math.sqrt(_v * _v - 1),
                  _e92 = _2 ? _t95 : 0,
                  _r105 = _2 ? 0 : _t95;

              if (p && this.addCurrentVertex(h, f, _e92, _r105, c), "fakeround" === _A) {
                var _t96 = Math.round(180 * _b / Math.PI / 20);

                for (var _e93 = 1; _e93 < _t96; _e93++) {
                  var _r106 = _e93 / _t96;

                  if (.5 !== _r106) {
                    var _t97 = _r106 - .5;

                    _r106 += _r106 * _t97 * (_r106 - 1) * ((1.0904 + _g2 * (_g2 * (3.55645 - 1.43519 * _g2) - 3.2452)) * _t97 * _t97 + (.848013 + _g2 * (.215638 * _g2 - 1.06021)));
                  }

                  var _i67 = y.sub(f)._mult(_r106)._add(f)._unit()._mult(_2 ? -1 : 1);

                  this.addHalfVertex(h, _i67.x, _i67.y, !1, _2, 0, c);
                }
              }

              d && this.addCurrentVertex(h, y, -_e92, -_r105, c);
            } else if ("butt" === _A) this.addCurrentVertex(h, _m2, 0, 0, c);else if ("square" === _A) {
              var _t98 = p ? 1 : -1;

              this.addCurrentVertex(h, _m2, _t98, _t98, c);
            } else "round" === _A && (p && (this.addCurrentVertex(h, f, 0, 0, c), this.addCurrentVertex(h, f, 1, 1, c, !0)), d && (this.addCurrentVertex(h, y, -1, -1, c, !0), this.addCurrentVertex(h, y, 0, 0, c)));

            if (_w && _e90 < o - 1) {
              var _t99 = h.dist(d);

              if (_t99 > 2 * u) {
                var _e94 = h.add(d.sub(h)._mult(u / _t99)._round());

                this.updateDistance(h, _e94), this.addCurrentVertex(_e94, y, 0, 0, c), h = _e94;
              }
            }
          }
        }
      }, {
        key: "addCurrentVertex",
        value: function addCurrentVertex(t, e, r, i, n) {
          var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : !1;
          var a = e.y * i - e.x,
              o = -e.y - e.x * i;
          this.addHalfVertex(t, e.x + e.y * r, e.y - e.x * r, s, !1, r, n), this.addHalfVertex(t, a, o, s, !0, -i, n);
        }
      }, {
        key: "addHalfVertex",
        value: function addHalfVertex(_ref60, r, i, n, s, a, o) {
          var {
            x: t,
            y: e
          } = _ref60;
          this.layoutVertexArray.emplaceBack((t << 1) + (n ? 1 : 0), (e << 1) + (s ? 1 : 0), Math.round(63 * r) + 128, Math.round(63 * i) + 128, 1 + (0 === a ? 0 : a < 0 ? -1 : 1), 0, this.lineSoFar), this.lineClips && this.layoutVertexArray2.emplaceBack(this.scaledDistance, this.lineClipsArray.length);
          var l = o.vertexLength++;
          this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, l), o.primitiveLength++), s ? this.e2 = l : this.e1 = l;
        }
      }, {
        key: "updateScaledDistance",
        value: function updateScaledDistance() {
          if (this.lineClips) {
            var _t100 = this.totalDistance / (this.lineClips.end - this.lineClips.start);

            this.scaledDistance = this.distance / this.totalDistance, this.lineSoFar = _t100 * this.lineClips.start + this.distance;
          } else this.lineSoFar = this.distance;
        }
      }, {
        key: "updateDistance",
        value: function updateDistance(t, e) {
          this.distance += t.dist(e), this.updateScaledDistance();
        }
      }]);

      return ql;
    }();

    Gi("LineBucket", ql, {
      omit: ["layers", "patternFeatures"]
    });
    var Nl = new rs({
      "line-cap": new Wn(Ft.layout_line["line-cap"]),
      "line-join": new Jn(Ft.layout_line["line-join"]),
      "line-miter-limit": new Wn(Ft.layout_line["line-miter-limit"]),
      "line-round-limit": new Wn(Ft.layout_line["line-round-limit"]),
      "line-sort-key": new Jn(Ft.layout_line["line-sort-key"])
    });
    var jl = {
      paint: new rs({
        "line-opacity": new Jn(Ft.paint_line["line-opacity"]),
        "line-color": new Jn(Ft.paint_line["line-color"]),
        "line-translate": new Wn(Ft.paint_line["line-translate"]),
        "line-translate-anchor": new Wn(Ft.paint_line["line-translate-anchor"]),
        "line-width": new Jn(Ft.paint_line["line-width"]),
        "line-gap-width": new Jn(Ft.paint_line["line-gap-width"]),
        "line-offset": new Jn(Ft.paint_line["line-offset"]),
        "line-blur": new Jn(Ft.paint_line["line-blur"]),
        "line-dasharray": new ts(Ft.paint_line["line-dasharray"]),
        "line-pattern": new Qn(Ft.paint_line["line-pattern"]),
        "line-gradient": new es(Ft.paint_line["line-gradient"])
      }),
      layout: Nl
    };
    var Gl = new ( /*#__PURE__*/function (_Jn2) {
      _inherits(_class4, _Jn2);

      var _super46 = _createSuper(_class4);

      function _class4() {
        _classCallCheck(this, _class4);

        return _super46.apply(this, arguments);
      }

      _createClass(_class4, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e) {
          return e = new qn(Math.floor(e.zoom), {
            now: e.now,
            fadeDuration: e.fadeDuration,
            zoomHistory: e.zoomHistory,
            transition: e.transition
          }), _get(_getPrototypeOf(_class4.prototype), "possiblyEvaluate", this).call(this, t, e);
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, i) {
          return e = x({}, e, {
            zoom: Math.floor(e.zoom)
          }), _get(_getPrototypeOf(_class4.prototype), "evaluate", this).call(this, t, e, r, i);
        }
      }]);

      return _class4;
    }(Jn))(jl.paint.properties["line-width"].specification);

    function Zl(t, e) {
      return e > 0 ? e + 2 * t : t;
    }

    Gl.useIntegerZoom = !0;
    var Xl = os([{
      name: "a_pos_offset",
      components: 4,
      type: "Int16"
    }, {
      name: "a_data",
      components: 4,
      type: "Uint16"
    }, {
      name: "a_pixeloffset",
      components: 4,
      type: "Int16"
    }], 4),
        Kl = os([{
      name: "a_projected_pos",
      components: 3,
      type: "Float32"
    }], 4),
        Hl = (os([{
      name: "a_fade_opacity",
      components: 1,
      type: "Uint32"
    }], 4), os([{
      name: "a_placed",
      components: 2,
      type: "Uint8"
    }, {
      name: "a_shift",
      components: 2,
      type: "Float32"
    }])),
        Yl = os([{
      name: "a_size_scale",
      components: 1,
      type: "Float32"
    }, {
      name: "a_padding",
      components: 2,
      type: "Float32"
    }]),
        Wl = (os([{
      type: "Int16",
      name: "anchorPointX"
    }, {
      type: "Int16",
      name: "anchorPointY"
    }, {
      type: "Float32",
      name: "x1"
    }, {
      type: "Float32",
      name: "y1"
    }, {
      type: "Float32",
      name: "x2"
    }, {
      type: "Float32",
      name: "y2"
    }, {
      type: "Int16",
      name: "padding"
    }, {
      type: "Uint32",
      name: "featureIndex"
    }, {
      type: "Uint16",
      name: "sourceLayerIndex"
    }, {
      type: "Uint16",
      name: "bucketIndex"
    }]), os([{
      name: "a_pos",
      components: 2,
      type: "Int16"
    }, {
      name: "a_anchor_pos",
      components: 2,
      type: "Int16"
    }, {
      name: "a_extrude",
      components: 2,
      type: "Int16"
    }], 4)),
        Jl = os([{
      name: "a_pos_2f",
      components: 2,
      type: "Float32"
    }, {
      name: "a_radius",
      components: 1,
      type: "Float32"
    }, {
      name: "a_flags",
      components: 2,
      type: "Int16"
    }], 4);

    function Ql(t, e) {
      var {
        expression: r
      } = e;
      if ("constant" === r.kind) return {
        kind: "constant",
        layoutSize: r.evaluate(new qn(t + 1))
      };
      if ("source" === r.kind) return {
        kind: "source"
      };
      {
        var {
          zoomStops: _e95,
          interpolationType: _i68
        } = r;
        var _n57 = 0;

        for (; _n57 < _e95.length && _e95[_n57] <= t;) {
          _n57++;
        }

        _n57 = Math.max(0, _n57 - 1);
        var _s46 = _n57;

        for (; _s46 < _e95.length && _e95[_s46] < t + 1;) {
          _s46++;
        }

        _s46 = Math.min(_e95.length - 1, _s46);
        var _a47 = _e95[_n57],
            _o22 = _e95[_s46];
        return "composite" === r.kind ? {
          kind: "composite",
          minZoom: _a47,
          maxZoom: _o22,
          interpolationType: _i68
        } : {
          kind: "camera",
          minZoom: _a47,
          maxZoom: _o22,
          minSize: r.evaluate(new qn(_a47)),
          maxSize: r.evaluate(new qn(_o22)),
          interpolationType: _i68
        };
      }
    }

    function tu(t, _ref61, _ref62) {
      var {
        uSize: e,
        uSizeT: r
      } = _ref61;
      var {
        lowerSize: i,
        upperSize: n
      } = _ref62;
      return "source" === t.kind ? i / 128 : "composite" === t.kind ? Je(i / 128, n / 128, r) : e;
    }

    function eu(t, e) {
      var r = 0,
          i = 0;
      if ("constant" === t.kind) i = t.layoutSize;else if ("source" !== t.kind) {
        var {
          interpolationType: _n58,
          minZoom: _s47,
          maxZoom: _a48
        } = t,
            _o23 = _n58 ? f(dr.interpolationFactor(_n58, e, _s47, _a48), 0, 1) : 0;

        "camera" === t.kind ? i = Je(t.minSize, t.maxSize, _o23) : r = _o23;
      }
      return {
        uSizeT: r,
        uSize: i
      };
    }

    os([{
      name: "triangle",
      components: 3,
      type: "Uint16"
    }]), os([{
      type: "Int16",
      name: "anchorX"
    }, {
      type: "Int16",
      name: "anchorY"
    }, {
      type: "Uint16",
      name: "glyphStartIndex"
    }, {
      type: "Uint16",
      name: "numGlyphs"
    }, {
      type: "Uint32",
      name: "vertexStartIndex"
    }, {
      type: "Uint32",
      name: "lineStartIndex"
    }, {
      type: "Uint32",
      name: "lineLength"
    }, {
      type: "Uint16",
      name: "segment"
    }, {
      type: "Uint16",
      name: "lowerSize"
    }, {
      type: "Uint16",
      name: "upperSize"
    }, {
      type: "Float32",
      name: "lineOffsetX"
    }, {
      type: "Float32",
      name: "lineOffsetY"
    }, {
      type: "Uint8",
      name: "writingMode"
    }, {
      type: "Uint8",
      name: "placedOrientation"
    }, {
      type: "Uint8",
      name: "hidden"
    }, {
      type: "Uint32",
      name: "crossTileID"
    }, {
      type: "Int16",
      name: "associatedIconIndex"
    }]), os([{
      type: "Int16",
      name: "anchorX"
    }, {
      type: "Int16",
      name: "anchorY"
    }, {
      type: "Int16",
      name: "rightJustifiedTextSymbolIndex"
    }, {
      type: "Int16",
      name: "centerJustifiedTextSymbolIndex"
    }, {
      type: "Int16",
      name: "leftJustifiedTextSymbolIndex"
    }, {
      type: "Int16",
      name: "verticalPlacedTextSymbolIndex"
    }, {
      type: "Int16",
      name: "placedIconSymbolIndex"
    }, {
      type: "Int16",
      name: "verticalPlacedIconSymbolIndex"
    }, {
      type: "Uint16",
      name: "key"
    }, {
      type: "Uint16",
      name: "textBoxStartIndex"
    }, {
      type: "Uint16",
      name: "textBoxEndIndex"
    }, {
      type: "Uint16",
      name: "verticalTextBoxStartIndex"
    }, {
      type: "Uint16",
      name: "verticalTextBoxEndIndex"
    }, {
      type: "Uint16",
      name: "iconBoxStartIndex"
    }, {
      type: "Uint16",
      name: "iconBoxEndIndex"
    }, {
      type: "Uint16",
      name: "verticalIconBoxStartIndex"
    }, {
      type: "Uint16",
      name: "verticalIconBoxEndIndex"
    }, {
      type: "Uint16",
      name: "featureIndex"
    }, {
      type: "Uint16",
      name: "numHorizontalGlyphVertices"
    }, {
      type: "Uint16",
      name: "numVerticalGlyphVertices"
    }, {
      type: "Uint16",
      name: "numIconVertices"
    }, {
      type: "Uint16",
      name: "numVerticalIconVertices"
    }, {
      type: "Uint16",
      name: "useRuntimeCollisionCircles"
    }, {
      type: "Uint32",
      name: "crossTileID"
    }, {
      type: "Float32",
      name: "textBoxScale"
    }, {
      type: "Float32",
      components: 2,
      name: "textOffset"
    }, {
      type: "Float32",
      name: "collisionCircleDiameter"
    }]), os([{
      type: "Float32",
      name: "offsetX"
    }]), os([{
      type: "Int16",
      name: "x"
    }, {
      type: "Int16",
      name: "y"
    }, {
      type: "Int16",
      name: "tileUnitDistanceFromAnchor"
    }]);
    var ru = Object.freeze({
      __proto__: null,
      getSizeData: Ql,
      evaluateSizeForFeature: tu,
      evaluateSizeForZoom: eu,
      SIZE_PACK_FACTOR: 128
    });

    function iu(t, e, r) {
      return t.sections.forEach(function (t) {
        t.text = function (t, e, r) {
          var i = e.layout.get("text-transform").evaluate(r, {});
          return "uppercase" === i ? t = t.toLocaleUpperCase() : "lowercase" === i && (t = t.toLocaleLowerCase()), $n.applyArabicShaping && (t = $n.applyArabicShaping(t)), t;
        }(t.text, e, r);
      }), t;
    }

    var nu = {
      "!": "ï¸",
      "#": "ï¼",
      $: "ï¼",
      "%": "ï¼",
      "&": "ï¼",
      "(": "ï¸µ",
      ")": "ï¸¶",
      "*": "ï¼",
      "+": "ï¼",
      ",": "ï¸",
      "-": "ï¸²",
      ".": "ã»",
      "/": "ï¼",
      ":": "ï¸",
      ";": "ï¸",
      "<": "ï¸¿",
      "=": "ï¼",
      ">": "ï¹",
      "?": "ï¸",
      "@": "ï¼ ",
      "[": "ï¹",
      "\\": "ï¼¼",
      "]": "ï¹",
      "^": "ï¼¾",
      _: "ï¸³",
      "`": "ï½",
      "{": "ï¸·",
      "|": "â",
      "}": "ï¸¸",
      "~": "ï½",
      "Â¢": "ï¿ ",
      "Â£": "ï¿¡",
      "Â¥": "ï¿¥",
      "Â¦": "ï¿¤",
      "Â¬": "ï¿¢",
      "Â¯": "ï¿£",
      "â": "ï¸²",
      "â": "ï¸±",
      "â": "ï¹",
      "â": "ï¹",
      "â": "ï¹",
      "â": "ï¹",
      "â¦": "ï¸",
      "â§": "ã»",
      "â©": "ï¿¦",
      "ã": "ï¸",
      "ã": "ï¸",
      "ã": "ï¸¿",
      "ã": "ï¹",
      "ã": "ï¸½",
      "ã": "ï¸¾",
      "ã": "ï¹",
      "ã": "ï¹",
      "ã": "ï¹",
      "ã": "ï¹",
      "ã": "ï¸»",
      "ã": "ï¸¼",
      "ã": "ï¸¹",
      "ã": "ï¸º",
      "ã": "ï¸",
      "ã": "ï¸",
      "ï¼": "ï¸",
      "ï¼": "ï¸µ",
      "ï¼": "ï¸¶",
      "ï¼": "ï¸",
      "ï¼": "ï¸²",
      "ï¼": "ã»",
      "ï¼": "ï¸",
      "ï¼": "ï¸",
      "ï¼": "ï¸¿",
      "ï¼": "ï¹",
      "ï¼": "ï¸",
      "ï¼»": "ï¹",
      "ï¼½": "ï¹",
      "ï¼¿": "ï¸³",
      "ï½": "ï¸·",
      "ï½": "â",
      "ï½": "ï¸¸",
      "ï½": "ï¸µ",
      "ï½ ": "ï¸¶",
      "ï½¡": "ï¸",
      "ï½¢": "ï¹",
      "ï½£": "ï¹"
    };

    var su = function (t, e, r, i, n) {
      var s,
          a,
          o = 8 * n - i - 1,
          l = (1 << o) - 1,
          u = l >> 1,
          c = -7,
          h = r ? n - 1 : 0,
          p = r ? -1 : 1,
          d = t[e + h];

      for (h += p, s = d & (1 << -c) - 1, d >>= -c, c += o; c > 0; s = 256 * s + t[e + h], h += p, c -= 8) {
        ;
      }

      for (a = s & (1 << -c) - 1, s >>= -c, c += i; c > 0; a = 256 * a + t[e + h], h += p, c -= 8) {
        ;
      }

      if (0 === s) s = 1 - u;else {
        if (s === l) return a ? NaN : 1 / 0 * (d ? -1 : 1);
        a += Math.pow(2, i), s -= u;
      }
      return (d ? -1 : 1) * a * Math.pow(2, s - i);
    },
        au = function (t, e, r, i, n, s) {
      var a,
          o,
          l,
          u = 8 * s - n - 1,
          c = (1 << u) - 1,
          h = c >> 1,
          p = 23 === n ? Math.pow(2, -24) - Math.pow(2, -77) : 0,
          d = i ? 0 : s - 1,
          f = i ? 1 : -1,
          y = e < 0 || 0 === e && 1 / e < 0 ? 1 : 0;

      for (e = Math.abs(e), isNaN(e) || e === 1 / 0 ? (o = isNaN(e) ? 1 : 0, a = c) : (a = Math.floor(Math.log(e) / Math.LN2), e * (l = Math.pow(2, -a)) < 1 && (a--, l *= 2), (e += a + h >= 1 ? p / l : p * Math.pow(2, 1 - h)) * l >= 2 && (a++, l /= 2), a + h >= c ? (o = 0, a = c) : a + h >= 1 ? (o = (e * l - 1) * Math.pow(2, n), a += h) : (o = e * Math.pow(2, h - 1) * Math.pow(2, n), a = 0)); n >= 8; t[r + d] = 255 & o, d += f, o /= 256, n -= 8) {
        ;
      }

      for (a = a << n | o, u += n; u > 0; t[r + d] = 255 & a, d += f, a /= 256, u -= 8) {
        ;
      }

      t[r + d - f] |= 128 * y;
    },
        ou = lu;

    function lu(t) {
      this.buf = ArrayBuffer.isView && ArrayBuffer.isView(t) ? t : new Uint8Array(t || 0), this.pos = 0, this.type = 0, this.length = this.buf.length;
    }

    lu.Varint = 0, lu.Fixed64 = 1, lu.Bytes = 2, lu.Fixed32 = 5;
    var uu = "undefined" == typeof TextDecoder ? null : new TextDecoder("utf8");

    function cu(t) {
      return t.type === lu.Bytes ? t.readVarint() + t.pos : t.pos + 1;
    }

    function hu(t, e, r) {
      return r ? 4294967296 * e + (t >>> 0) : 4294967296 * (e >>> 0) + (t >>> 0);
    }

    function pu(t, e, r) {
      var i = e <= 16383 ? 1 : e <= 2097151 ? 2 : e <= 268435455 ? 3 : Math.floor(Math.log(e) / (7 * Math.LN2));
      r.realloc(i);

      for (var n = r.pos - 1; n >= t; n--) {
        r.buf[n + i] = r.buf[n];
      }
    }

    function du(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeVarint(t[r]);
      }
    }

    function fu(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeSVarint(t[r]);
      }
    }

    function yu(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeFloat(t[r]);
      }
    }

    function mu(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeDouble(t[r]);
      }
    }

    function gu(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeBoolean(t[r]);
      }
    }

    function xu(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeFixed32(t[r]);
      }
    }

    function vu(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeSFixed32(t[r]);
      }
    }

    function bu(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeFixed64(t[r]);
      }
    }

    function wu(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeSFixed64(t[r]);
      }
    }

    function _u(t, e) {
      return (t[e] | t[e + 1] << 8 | t[e + 2] << 16) + 16777216 * t[e + 3];
    }

    function ku(t, e, r) {
      t[r] = e, t[r + 1] = e >>> 8, t[r + 2] = e >>> 16, t[r + 3] = e >>> 24;
    }

    function Au(t, e) {
      return (t[e] | t[e + 1] << 8 | t[e + 2] << 16) + (t[e + 3] << 24);
    }

    function Su(t, e, r) {
      1 === t && r.readMessage(Iu, e);
    }

    function Iu(t, e, r) {
      if (3 === t) {
        var {
          id: _t101,
          bitmap: _i69,
          width: _n59,
          height: _s48,
          left: _a49,
          top: _o24,
          advance: _l19
        } = r.readMessage(Tu, {});
        e.push({
          id: _t101,
          bitmap: new _o({
            width: _n59 + 6,
            height: _s48 + 6
          }, _i69),
          metrics: {
            width: _n59,
            height: _s48,
            left: _a49,
            top: _o24,
            advance: _l19
          }
        });
      }
    }

    function Tu(t, e, r) {
      1 === t ? e.id = r.readVarint() : 2 === t ? e.bitmap = r.readBytes() : 3 === t ? e.width = r.readVarint() : 4 === t ? e.height = r.readVarint() : 5 === t ? e.left = r.readSVarint() : 6 === t ? e.top = r.readSVarint() : 7 === t && (e.advance = r.readVarint());
    }

    function zu(t) {
      var e = 0,
          r = 0;

      for (var _i70 of t) {
        e += _i70.w * _i70.h, r = Math.max(r, _i70.w);
      }

      t.sort(function (t, e) {
        return e.h - t.h;
      });
      var i = [{
        x: 0,
        y: 0,
        w: Math.max(Math.ceil(Math.sqrt(e / .95)), r),
        h: 1 / 0
      }];
      var n = 0,
          s = 0;

      for (var _e96 of t) {
        for (var _t102 = i.length - 1; _t102 >= 0; _t102--) {
          var _r107 = i[_t102];

          if (!(_e96.w > _r107.w || _e96.h > _r107.h)) {
            if (_e96.x = _r107.x, _e96.y = _r107.y, s = Math.max(s, _e96.y + _e96.h), n = Math.max(n, _e96.x + _e96.w), _e96.w === _r107.w && _e96.h === _r107.h) {
              var _e97 = i.pop();

              _t102 < i.length && (i[_t102] = _e97);
            } else _e96.h === _r107.h ? (_r107.x += _e96.w, _r107.w -= _e96.w) : _e96.w === _r107.w ? (_r107.y += _e96.h, _r107.h -= _e96.h) : (i.push({
              x: _r107.x + _e96.w,
              y: _r107.y,
              w: _r107.w - _e96.w,
              h: _e96.h
            }), _r107.y += _e96.h, _r107.h -= _e96.h);

            break;
          }
        }
      }

      return {
        w: n,
        h: s,
        fill: e / (n * s) || 0
      };
    }

    lu.prototype = {
      destroy: function () {
        this.buf = null;
      },
      readFields: function (t, e, r) {
        for (r = r || this.length; this.pos < r;) {
          var i = this.readVarint(),
              n = i >> 3,
              s = this.pos;
          this.type = 7 & i, t(n, e, this), this.pos === s && this.skip(i);
        }

        return e;
      },
      readMessage: function (t, e) {
        return this.readFields(t, e, this.readVarint() + this.pos);
      },
      readFixed32: function () {
        var t = _u(this.buf, this.pos);

        return this.pos += 4, t;
      },
      readSFixed32: function () {
        var t = Au(this.buf, this.pos);
        return this.pos += 4, t;
      },
      readFixed64: function () {
        var t = _u(this.buf, this.pos) + 4294967296 * _u(this.buf, this.pos + 4);

        return this.pos += 8, t;
      },
      readSFixed64: function () {
        var t = _u(this.buf, this.pos) + 4294967296 * Au(this.buf, this.pos + 4);
        return this.pos += 8, t;
      },
      readFloat: function () {
        var t = su(this.buf, this.pos, !0, 23, 4);
        return this.pos += 4, t;
      },
      readDouble: function () {
        var t = su(this.buf, this.pos, !0, 52, 8);
        return this.pos += 8, t;
      },
      readVarint: function (t) {
        var e,
            r,
            i = this.buf;
        return e = 127 & (r = i[this.pos++]), r < 128 ? e : (e |= (127 & (r = i[this.pos++])) << 7, r < 128 ? e : (e |= (127 & (r = i[this.pos++])) << 14, r < 128 ? e : (e |= (127 & (r = i[this.pos++])) << 21, r < 128 ? e : function (t, e, r) {
          var i,
              n,
              s = r.buf;
          if (i = (112 & (n = s[r.pos++])) >> 4, n < 128) return hu(t, i, e);
          if (i |= (127 & (n = s[r.pos++])) << 3, n < 128) return hu(t, i, e);
          if (i |= (127 & (n = s[r.pos++])) << 10, n < 128) return hu(t, i, e);
          if (i |= (127 & (n = s[r.pos++])) << 17, n < 128) return hu(t, i, e);
          if (i |= (127 & (n = s[r.pos++])) << 24, n < 128) return hu(t, i, e);
          if (i |= (1 & (n = s[r.pos++])) << 31, n < 128) return hu(t, i, e);
          throw new Error("Expected varint not more than 10 bytes");
        }(e |= (15 & (r = i[this.pos])) << 28, t, this))));
      },
      readVarint64: function () {
        return this.readVarint(!0);
      },
      readSVarint: function () {
        var t = this.readVarint();
        return t % 2 == 1 ? (t + 1) / -2 : t / 2;
      },
      readBoolean: function () {
        return Boolean(this.readVarint());
      },
      readString: function () {
        var t = this.readVarint() + this.pos,
            e = this.pos;
        return this.pos = t, t - e >= 12 && uu ? function (t, e, r) {
          return uu.decode(t.subarray(e, r));
        }(this.buf, e, t) : function (t, e, r) {
          for (var i = "", n = e; n < r;) {
            var s,
                a,
                o,
                l = t[n],
                u = null,
                c = l > 239 ? 4 : l > 223 ? 3 : l > 191 ? 2 : 1;
            if (n + c > r) break;
            1 === c ? l < 128 && (u = l) : 2 === c ? 128 == (192 & (s = t[n + 1])) && (u = (31 & l) << 6 | 63 & s) <= 127 && (u = null) : 3 === c ? (a = t[n + 2], 128 == (192 & (s = t[n + 1])) && 128 == (192 & a) && ((u = (15 & l) << 12 | (63 & s) << 6 | 63 & a) <= 2047 || u >= 55296 && u <= 57343) && (u = null)) : 4 === c && (a = t[n + 2], o = t[n + 3], 128 == (192 & (s = t[n + 1])) && 128 == (192 & a) && 128 == (192 & o) && ((u = (15 & l) << 18 | (63 & s) << 12 | (63 & a) << 6 | 63 & o) <= 65535 || u >= 1114112) && (u = null)), null === u ? (u = 65533, c = 1) : u > 65535 && (u -= 65536, i += String.fromCharCode(u >>> 10 & 1023 | 55296), u = 56320 | 1023 & u), i += String.fromCharCode(u), n += c;
          }

          return i;
        }(this.buf, e, t);
      },
      readBytes: function () {
        var t = this.readVarint() + this.pos,
            e = this.buf.subarray(this.pos, t);
        return this.pos = t, e;
      },
      readPackedVarint: function (t, e) {
        if (this.type !== lu.Bytes) return t.push(this.readVarint(e));
        var r = cu(this);

        for (t = t || []; this.pos < r;) {
          t.push(this.readVarint(e));
        }

        return t;
      },
      readPackedSVarint: function (t) {
        if (this.type !== lu.Bytes) return t.push(this.readSVarint());
        var e = cu(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readSVarint());
        }

        return t;
      },
      readPackedBoolean: function (t) {
        if (this.type !== lu.Bytes) return t.push(this.readBoolean());
        var e = cu(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readBoolean());
        }

        return t;
      },
      readPackedFloat: function (t) {
        if (this.type !== lu.Bytes) return t.push(this.readFloat());
        var e = cu(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readFloat());
        }

        return t;
      },
      readPackedDouble: function (t) {
        if (this.type !== lu.Bytes) return t.push(this.readDouble());
        var e = cu(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readDouble());
        }

        return t;
      },
      readPackedFixed32: function (t) {
        if (this.type !== lu.Bytes) return t.push(this.readFixed32());
        var e = cu(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readFixed32());
        }

        return t;
      },
      readPackedSFixed32: function (t) {
        if (this.type !== lu.Bytes) return t.push(this.readSFixed32());
        var e = cu(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readSFixed32());
        }

        return t;
      },
      readPackedFixed64: function (t) {
        if (this.type !== lu.Bytes) return t.push(this.readFixed64());
        var e = cu(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readFixed64());
        }

        return t;
      },
      readPackedSFixed64: function (t) {
        if (this.type !== lu.Bytes) return t.push(this.readSFixed64());
        var e = cu(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readSFixed64());
        }

        return t;
      },
      skip: function (t) {
        var e = 7 & t;
        if (e === lu.Varint) for (; this.buf[this.pos++] > 127;) {
          ;
        } else if (e === lu.Bytes) this.pos = this.readVarint() + this.pos;else if (e === lu.Fixed32) this.pos += 4;else {
          if (e !== lu.Fixed64) throw new Error("Unimplemented type: " + e);
          this.pos += 8;
        }
      },
      writeTag: function (t, e) {
        this.writeVarint(t << 3 | e);
      },
      realloc: function (t) {
        for (var e = this.length || 16; e < this.pos + t;) {
          e *= 2;
        }

        if (e !== this.length) {
          var r = new Uint8Array(e);
          r.set(this.buf), this.buf = r, this.length = e;
        }
      },
      finish: function () {
        return this.length = this.pos, this.pos = 0, this.buf.subarray(0, this.length);
      },
      writeFixed32: function (t) {
        this.realloc(4), ku(this.buf, t, this.pos), this.pos += 4;
      },
      writeSFixed32: function (t) {
        this.realloc(4), ku(this.buf, t, this.pos), this.pos += 4;
      },
      writeFixed64: function (t) {
        this.realloc(8), ku(this.buf, -1 & t, this.pos), ku(this.buf, Math.floor(t * (1 / 4294967296)), this.pos + 4), this.pos += 8;
      },
      writeSFixed64: function (t) {
        this.realloc(8), ku(this.buf, -1 & t, this.pos), ku(this.buf, Math.floor(t * (1 / 4294967296)), this.pos + 4), this.pos += 8;
      },
      writeVarint: function (t) {
        (t = +t || 0) > 268435455 || t < 0 ? function (t, e) {
          var r, i;
          if (t >= 0 ? (r = t % 4294967296 | 0, i = t / 4294967296 | 0) : (i = ~(-t / 4294967296), 4294967295 ^ (r = ~(-t % 4294967296)) ? r = r + 1 | 0 : (r = 0, i = i + 1 | 0)), t >= 0x10000000000000000 || t < -0x10000000000000000) throw new Error("Given varint doesn't fit into 10 bytes");
          e.realloc(10), function (t, e, r) {
            r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, r.buf[r.pos] = 127 & (t >>>= 7);
          }(r, 0, e), function (t, e) {
            var r = (7 & t) << 4;
            e.buf[e.pos++] |= r | ((t >>>= 3) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t)))));
          }(i, e);
        }(t, this) : (this.realloc(4), this.buf[this.pos++] = 127 & t | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = 127 & (t >>>= 7) | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = 127 & (t >>>= 7) | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = t >>> 7 & 127))));
      },
      writeSVarint: function (t) {
        this.writeVarint(t < 0 ? 2 * -t - 1 : 2 * t);
      },
      writeBoolean: function (t) {
        this.writeVarint(Boolean(t));
      },
      writeString: function (t) {
        t = String(t), this.realloc(4 * t.length), this.pos++;
        var e = this.pos;

        this.pos = function (t, e, r) {
          for (var i, n, s = 0; s < e.length; s++) {
            if ((i = e.charCodeAt(s)) > 55295 && i < 57344) {
              if (!n) {
                i > 56319 || s + 1 === e.length ? (t[r++] = 239, t[r++] = 191, t[r++] = 189) : n = i;
                continue;
              }

              if (i < 56320) {
                t[r++] = 239, t[r++] = 191, t[r++] = 189, n = i;
                continue;
              }

              i = n - 55296 << 10 | i - 56320 | 65536, n = null;
            } else n && (t[r++] = 239, t[r++] = 191, t[r++] = 189, n = null);

            i < 128 ? t[r++] = i : (i < 2048 ? t[r++] = i >> 6 | 192 : (i < 65536 ? t[r++] = i >> 12 | 224 : (t[r++] = i >> 18 | 240, t[r++] = i >> 12 & 63 | 128), t[r++] = i >> 6 & 63 | 128), t[r++] = 63 & i | 128);
          }

          return r;
        }(this.buf, t, this.pos);

        var r = this.pos - e;
        r >= 128 && pu(e, r, this), this.pos = e - 1, this.writeVarint(r), this.pos += r;
      },
      writeFloat: function (t) {
        this.realloc(4), au(this.buf, t, this.pos, !0, 23, 4), this.pos += 4;
      },
      writeDouble: function (t) {
        this.realloc(8), au(this.buf, t, this.pos, !0, 52, 8), this.pos += 8;
      },
      writeBytes: function (t) {
        var e = t.length;
        this.writeVarint(e), this.realloc(e);

        for (var r = 0; r < e; r++) {
          this.buf[this.pos++] = t[r];
        }
      },
      writeRawMessage: function (t, e) {
        this.pos++;
        var r = this.pos;
        t(e, this);
        var i = this.pos - r;
        i >= 128 && pu(r, i, this), this.pos = r - 1, this.writeVarint(i), this.pos += i;
      },
      writeMessage: function (t, e, r) {
        this.writeTag(t, lu.Bytes), this.writeRawMessage(e, r);
      },
      writePackedVarint: function (t, e) {
        e.length && this.writeMessage(t, du, e);
      },
      writePackedSVarint: function (t, e) {
        e.length && this.writeMessage(t, fu, e);
      },
      writePackedBoolean: function (t, e) {
        e.length && this.writeMessage(t, gu, e);
      },
      writePackedFloat: function (t, e) {
        e.length && this.writeMessage(t, yu, e);
      },
      writePackedDouble: function (t, e) {
        e.length && this.writeMessage(t, mu, e);
      },
      writePackedFixed32: function (t, e) {
        e.length && this.writeMessage(t, xu, e);
      },
      writePackedSFixed32: function (t, e) {
        e.length && this.writeMessage(t, vu, e);
      },
      writePackedFixed64: function (t, e) {
        e.length && this.writeMessage(t, bu, e);
      },
      writePackedSFixed64: function (t, e) {
        e.length && this.writeMessage(t, wu, e);
      },
      writeBytesField: function (t, e) {
        this.writeTag(t, lu.Bytes), this.writeBytes(e);
      },
      writeFixed32Field: function (t, e) {
        this.writeTag(t, lu.Fixed32), this.writeFixed32(e);
      },
      writeSFixed32Field: function (t, e) {
        this.writeTag(t, lu.Fixed32), this.writeSFixed32(e);
      },
      writeFixed64Field: function (t, e) {
        this.writeTag(t, lu.Fixed64), this.writeFixed64(e);
      },
      writeSFixed64Field: function (t, e) {
        this.writeTag(t, lu.Fixed64), this.writeSFixed64(e);
      },
      writeVarintField: function (t, e) {
        this.writeTag(t, lu.Varint), this.writeVarint(e);
      },
      writeSVarintField: function (t, e) {
        this.writeTag(t, lu.Varint), this.writeSVarint(e);
      },
      writeStringField: function (t, e) {
        this.writeTag(t, lu.Bytes), this.writeString(e);
      },
      writeFloatField: function (t, e) {
        this.writeTag(t, lu.Fixed32), this.writeFloat(e);
      },
      writeDoubleField: function (t, e) {
        this.writeTag(t, lu.Fixed64), this.writeDouble(e);
      },
      writeBooleanField: function (t, e) {
        this.writeVarintField(t, Boolean(e));
      }
    };

    var Eu = /*#__PURE__*/function () {
      function Eu(t, _ref63) {
        var {
          pixelRatio: e,
          version: r,
          stretchX: i,
          stretchY: n,
          content: s
        } = _ref63;

        _classCallCheck(this, Eu);

        this.paddedRect = t, this.pixelRatio = e, this.stretchX = i, this.stretchY = n, this.content = s, this.version = r;
      }

      _createClass(Eu, [{
        key: "tl",
        get: function () {
          return [this.paddedRect.x + 1, this.paddedRect.y + 1];
        }
      }, {
        key: "br",
        get: function () {
          return [this.paddedRect.x + this.paddedRect.w - 1, this.paddedRect.y + this.paddedRect.h - 1];
        }
      }, {
        key: "tlbr",
        get: function () {
          return this.tl.concat(this.br);
        }
      }, {
        key: "displaySize",
        get: function () {
          return [(this.paddedRect.w - 2) / this.pixelRatio, (this.paddedRect.h - 2) / this.pixelRatio];
        }
      }]);

      return Eu;
    }();

    var Mu = /*#__PURE__*/function () {
      function Mu(t, e) {
        _classCallCheck(this, Mu);

        var r = {},
            i = {};
        this.haveRenderCallbacks = [];
        var n = [];
        this.addImages(t, r, n), this.addImages(e, i, n);
        var {
          w: s,
          h: a
        } = zu(n),
            o = new ko({
          width: s || 1,
          height: a || 1
        });

        for (var _e98 in t) {
          var _i71 = t[_e98],
              _n60 = r[_e98].paddedRect;
          ko.copy(_i71.data, o, {
            x: 0,
            y: 0
          }, {
            x: _n60.x + 1,
            y: _n60.y + 1
          }, _i71.data);
        }

        for (var _t103 in e) {
          var _r108 = e[_t103],
              _n61 = i[_t103].paddedRect,
              _s49 = _n61.x + 1,
              _a50 = _n61.y + 1,
              _l20 = _r108.data.width,
              _u18 = _r108.data.height;

          ko.copy(_r108.data, o, {
            x: 0,
            y: 0
          }, {
            x: _s49,
            y: _a50
          }, _r108.data), ko.copy(_r108.data, o, {
            x: 0,
            y: _u18 - 1
          }, {
            x: _s49,
            y: _a50 - 1
          }, {
            width: _l20,
            height: 1
          }), ko.copy(_r108.data, o, {
            x: 0,
            y: 0
          }, {
            x: _s49,
            y: _a50 + _u18
          }, {
            width: _l20,
            height: 1
          }), ko.copy(_r108.data, o, {
            x: _l20 - 1,
            y: 0
          }, {
            x: _s49 - 1,
            y: _a50
          }, {
            width: 1,
            height: _u18
          }), ko.copy(_r108.data, o, {
            x: 0,
            y: 0
          }, {
            x: _s49 + _l20,
            y: _a50
          }, {
            width: 1,
            height: _u18
          });
        }

        this.image = o, this.iconPositions = r, this.patternPositions = i;
      }

      _createClass(Mu, [{
        key: "addImages",
        value: function addImages(t, e, r) {
          for (var _i72 in t) {
            var _n62 = t[_i72],
                _s50 = {
              x: 0,
              y: 0,
              w: _n62.data.width + 2,
              h: _n62.data.height + 2
            };
            r.push(_s50), e[_i72] = new Eu(_s50, _n62), _n62.hasRenderCallback && this.haveRenderCallbacks.push(_i72);
          }
        }
      }, {
        key: "patchUpdatedImages",
        value: function patchUpdatedImages(t, e) {
          t.dispatchRenderCallbacks(this.haveRenderCallbacks);

          for (var _r109 in t.updatedImages) {
            this.patchUpdatedImage(this.iconPositions[_r109], t.getImage(_r109), e), this.patchUpdatedImage(this.patternPositions[_r109], t.getImage(_r109), e);
          }
        }
      }, {
        key: "patchUpdatedImage",
        value: function patchUpdatedImage(t, e, r) {
          if (!t || !e) return;
          if (t.version === e.version) return;
          t.version = e.version;
          var [i, n] = t.tl;
          r.update(e.data, void 0, {
            x: i,
            y: n
          });
        }
      }]);

      return Mu;
    }();

    Gi("ImagePosition", Eu), Gi("ImageAtlas", Mu);
    var Bu = {
      horizontal: 1,
      vertical: 2,
      horizontalOnly: 3
    };

    var Du = /*#__PURE__*/function () {
      function Du() {
        _classCallCheck(this, Du);

        this.scale = 1, this.fontStack = "", this.imageName = null;
      }

      _createClass(Du, null, [{
        key: "forText",
        value: function forText(t, e) {
          var r = new Du();
          return r.scale = t || 1, r.fontStack = e, r;
        }
      }, {
        key: "forImage",
        value: function forImage(t) {
          var e = new Du();
          return e.imageName = t, e;
        }
      }]);

      return Du;
    }();

    var Cu = /*#__PURE__*/function () {
      function Cu() {
        _classCallCheck(this, Cu);

        this.text = "", this.sectionIndex = [], this.sections = [], this.imageSectionID = null;
      }

      _createClass(Cu, [{
        key: "length",
        value: function length() {
          return this.text.length;
        }
      }, {
        key: "getSection",
        value: function getSection(t) {
          return this.sections[this.sectionIndex[t]];
        }
      }, {
        key: "getSectionIndex",
        value: function getSectionIndex(t) {
          return this.sectionIndex[t];
        }
      }, {
        key: "getCharCode",
        value: function getCharCode(t) {
          return this.text.charCodeAt(t);
        }
      }, {
        key: "verticalizePunctuation",
        value: function verticalizePunctuation() {
          this.text = function (t) {
            var e = "";

            for (var _r110 = 0; _r110 < t.length; _r110++) {
              var _i73 = t.charCodeAt(_r110 + 1) || null,
                  _n63 = t.charCodeAt(_r110 - 1) || null;

              e += _i73 && En(_i73) && !nu[t[_r110 + 1]] || _n63 && En(_n63) && !nu[t[_r110 - 1]] || !nu[t[_r110]] ? t[_r110] : nu[t[_r110]];
            }

            return e;
          }(this.text);
        }
      }, {
        key: "trim",
        value: function trim() {
          var t = 0;

          for (var _e99 = 0; _e99 < this.text.length && Vu[this.text.charCodeAt(_e99)]; _e99++) {
            t++;
          }

          var e = this.text.length;

          for (var _r111 = this.text.length - 1; _r111 >= 0 && _r111 >= t && Vu[this.text.charCodeAt(_r111)]; _r111--) {
            e--;
          }

          this.text = this.text.substring(t, e), this.sectionIndex = this.sectionIndex.slice(t, e);
        }
      }, {
        key: "substring",
        value: function substring(t, e) {
          var r = new Cu();
          return r.text = this.text.substring(t, e), r.sectionIndex = this.sectionIndex.slice(t, e), r.sections = this.sections, r;
        }
      }, {
        key: "toString",
        value: function toString() {
          return this.text;
        }
      }, {
        key: "getMaxScale",
        value: function getMaxScale() {
          var _this19 = this;

          return this.sectionIndex.reduce(function (t, e) {
            return Math.max(t, _this19.sections[e].scale);
          }, 0);
        }
      }, {
        key: "addTextSection",
        value: function addTextSection(t, e) {
          this.text += t.text, this.sections.push(Du.forText(t.scale, t.fontStack || e));
          var r = this.sections.length - 1;

          for (var _e100 = 0; _e100 < t.text.length; ++_e100) {
            this.sectionIndex.push(r);
          }
        }
      }, {
        key: "addImageSection",
        value: function addImageSection(t) {
          var e = t.image ? t.image.name : "";
          if (0 === e.length) return void E("Can't add FormattedSection with an empty image.");
          var r = this.getNextImageSectionCharCode();
          r ? (this.text += String.fromCharCode(r), this.sections.push(Du.forImage(e)), this.sectionIndex.push(this.sections.length - 1)) : E("Reached maximum number of images 6401");
        }
      }, {
        key: "getNextImageSectionCharCode",
        value: function getNextImageSectionCharCode() {
          return this.imageSectionID ? this.imageSectionID >= 63743 ? null : ++this.imageSectionID : (this.imageSectionID = 57344, this.imageSectionID);
        }
      }], [{
        key: "fromFeature",
        value: function fromFeature(t, e) {
          var r = new Cu();

          for (var _i74 = 0; _i74 < t.sections.length; _i74++) {
            var _n64 = t.sections[_i74];
            _n64.image ? r.addImageSection(_n64) : r.addTextSection(_n64, e);
          }

          return r;
        }
      }]);

      return Cu;
    }();

    function Pu(t, e, r, i, n, s, a, o, l, u, c, h, p, d, f, y) {
      var m = Cu.fromFeature(t, n);
      var g;
      h === Bu.vertical && m.verticalizePunctuation();
      var {
        processBidirectionalText: x,
        processStyledBidirectionalText: v
      } = $n;

      if (x && 1 === m.sections.length) {
        g = [];

        var _t104 = x(m.toString(), $u(m, u, s, e, i, d, f));

        for (var _e101 of _t104) {
          var _t105 = new Cu();

          _t105.text = _e101, _t105.sections = m.sections;

          for (var _r112 = 0; _r112 < _e101.length; _r112++) {
            _t105.sectionIndex.push(0);
          }

          g.push(_t105);
        }
      } else if (v) {
        g = [];

        var _t106 = v(m.text, m.sectionIndex, $u(m, u, s, e, i, d, f));

        for (var _e102 of _t106) {
          var _t107 = new Cu();

          _t107.text = _e102[0], _t107.sectionIndex = _e102[1], _t107.sections = m.sections, g.push(_t107);
        }
      } else g = function (t, e) {
        var r = [],
            i = t.text;
        var n = 0;

        for (var _i75 of e) {
          r.push(t.substring(n, _i75)), n = _i75;
        }

        return n < i.length && r.push(t.substring(n, i.length)), r;
      }(m, $u(m, u, s, e, i, d, f));

      var b = [],
          w = {
        positionedLines: b,
        text: m.toString(),
        top: c[1],
        bottom: c[1],
        left: c[0],
        right: c[0],
        writingMode: h,
        iconsInText: !1,
        verticalizable: !1
      };
      return function (t, e, r, i, n, s, a, o, l, u, c, h) {
        var p = 0,
            d = -17,
            f = 0,
            y = 0;
        var m = "right" === o ? 1 : "left" === o ? 0 : .5;
        var g = 0;

        for (var _a51 of n) {
          _a51.trim();

          var _n65 = _a51.getMaxScale(),
              _o25 = 24 * (_n65 - 1),
              _v2 = {
            positionedGlyphs: [],
            lineOffset: 0
          };

          t.positionedLines[g] = _v2;
          var _b2 = _v2.positionedGlyphs;
          var _w2 = 0;

          if (!_a51.length()) {
            d += s, ++g;
            continue;
          }

          for (var _s51 = 0; _s51 < _a51.length(); _s51++) {
            var _f2 = _a51.getSection(_s51),
                _y2 = _a51.getSectionIndex(_s51),
                _m3 = _a51.getCharCode(_s51);

            var _g3 = 0,
                _v3 = null,
                _4 = null,
                _k2 = null,
                _A2 = 24;

            var _S = !(l === Bu.horizontal || !c && !zn(_m3) || c && (Vu[_m3] || (x = _m3, Wi(x) || Ji(x) || Qi(x) || vn(x) || kn(x))));

            if (_f2.imageName) {
              var _e103 = i[_f2.imageName];
              if (!_e103) continue;
              _k2 = _f2.imageName, t.iconsInText = t.iconsInText || !0, _4 = _e103.paddedRect;
              var _r113 = _e103.displaySize;
              _f2.scale = 24 * _f2.scale / h, _v3 = {
                width: _r113[0],
                height: _r113[1],
                left: 1,
                top: -3,
                advance: _S ? _r113[1] : _r113[0],
                localGlyph: !1
              }, _g3 = _o25 + (24 - _r113[1] * _f2.scale), _A2 = _v3.advance;

              var _s52 = _S ? _r113[0] * _f2.scale - 24 * _n65 : _r113[1] * _f2.scale - 24 * _n65;

              _s52 > 0 && _s52 > _w2 && (_w2 = _s52);
            } else {
              var _t108 = r[_f2.fontStack],
                  _i76 = _t108 && _t108[_m3];

              if (_i76 && _i76.rect) _4 = _i76.rect, _v3 = _i76.metrics;else {
                var _t109 = e[_f2.fontStack],
                    _r114 = _t109 && _t109[_m3];

                if (!_r114) continue;
                _v3 = _r114.metrics;
              }
              _g3 = 24 * (_n65 - _f2.scale);
            }

            _S ? (t.verticalizable = !0, _b2.push({
              glyph: _m3,
              imageName: _k2,
              x: p,
              y: d + _g3,
              vertical: _S,
              scale: _f2.scale,
              localGlyph: _v3.localGlyph,
              fontStack: _f2.fontStack,
              sectionIndex: _y2,
              metrics: _v3,
              rect: _4
            }), p += _A2 * _f2.scale + u) : (_b2.push({
              glyph: _m3,
              imageName: _k2,
              x: p,
              y: d + _g3,
              vertical: _S,
              scale: _f2.scale,
              localGlyph: _v3.localGlyph,
              fontStack: _f2.fontStack,
              sectionIndex: _y2,
              metrics: _v3,
              rect: _4
            }), p += _v3.advance * _f2.scale + u);
          }

          0 !== _b2.length && (f = Math.max(p - u, f), Nu(_b2, 0, _b2.length - 1, m, _w2)), p = 0;

          var _3 = s * _n65 + _w2;

          _v2.lineOffset = Math.max(_w2, _o25), d += _3, y = Math.max(_3, y), ++g;
        }

        var x;
        var v = d - -17,
            {
          horizontalAlign: b,
          verticalAlign: w
        } = qu(a);
        (function (t, e, r, i, n, s, a, o, l) {
          var u = (e - r) * n;
          var c = 0;
          c = s !== a ? -o * i - -17 : (-i * l + .5) * a;

          for (var _e104 of t) {
            for (var _t110 of _e104.positionedGlyphs) {
              _t110.x += u, _t110.y += c;
            }
          }
        })(t.positionedLines, m, b, w, f, y, s, v, n.length), t.top += -w * v, t.bottom = t.top + v, t.left += -b * f, t.right = t.left + f;
      }(w, e, r, i, g, a, o, l, h, u, p, y), !function (t) {
        for (var _e105 of t) {
          if (0 !== _e105.positionedGlyphs.length) return !1;
        }

        return !0;
      }(b) && w;
    }

    var Vu = {
      9: !0,
      10: !0,
      11: !0,
      12: !0,
      13: !0,
      32: !0
    },
        Fu = {
      10: !0,
      32: !0,
      38: !0,
      40: !0,
      41: !0,
      43: !0,
      45: !0,
      47: !0,
      173: !0,
      183: !0,
      8203: !0,
      8208: !0,
      8211: !0,
      8231: !0
    };

    function Ru(t, e, r, i, n, s) {
      if (e.imageName) {
        var _t111 = i[e.imageName];
        return _t111 ? _t111.displaySize[0] * e.scale * 24 / s + n : 0;
      }

      {
        var _i77 = r[e.fontStack],
            _s53 = _i77 && _i77[t];

        return _s53 ? _s53.metrics.advance * e.scale + n : 0;
      }
    }

    function Lu(t, e, r, i) {
      var n = Math.pow(t - e, 2);
      return i ? t < e ? n / 2 : 2 * n : n + Math.abs(r) * r;
    }

    function Uu(t, e, r) {
      var i = 0;
      return 10 === t && (i -= 1e4), r && (i += 150), 40 !== t && 65288 !== t || (i += 50), 41 !== e && 65289 !== e || (i += 50), i;
    }

    function Ou(t, e, r, i, n, s) {
      var a = null,
          o = Lu(e, r, n, s);

      for (var _t112 of i) {
        var _i78 = Lu(e - _t112.x, r, n, s) + _t112.badness;

        _i78 <= o && (a = _t112, o = _i78);
      }

      return {
        index: t,
        x: e,
        priorBreak: a,
        badness: o
      };
    }

    function $u(t, e, r, i, n, s, a) {
      if ("point" !== s) return [];
      if (!t) return [];

      var o = [],
          l = function (t, e, r, i, n, s) {
        var a = 0;

        for (var _r115 = 0; _r115 < t.length(); _r115++) {
          var _o26 = t.getSection(_r115);

          a += Ru(t.getCharCode(_r115), _o26, i, n, e, s);
        }

        return a / Math.max(1, Math.ceil(a / r));
      }(t, e, r, i, n, a),
          u = t.text.indexOf("â") >= 0;

      var c = 0;

      for (var _r116 = 0; _r116 < t.length(); _r116++) {
        var _s54 = t.getSection(_r116),
            _p3 = t.getCharCode(_r116);

        if (Vu[_p3] || (c += Ru(_p3, _s54, i, n, e, a)), _r116 < t.length() - 1) {
          var _e106 = !((h = _p3) < 11904 || !(ln(h) || on(h) || wn(h) || xn(h) || pn(h) || tn(h) || un(h) || nn(h) || dn(h) || fn(h) || hn(h) || An(h) || sn(h) || rn(h) || en(h) || cn(h) || an(h) || bn(h) || mn(h) || yn(h)));

          (Fu[_p3] || _e106 || _s54.imageName) && o.push(Ou(_r116 + 1, c, l, o, Uu(_p3, t.getCharCode(_r116 + 1), _e106 && u), !1));
        }
      }

      var h;
      return function t(e) {
        return e ? t(e.priorBreak).concat(e.index) : [];
      }(Ou(t.length(), c, l, o, 0, !0));
    }

    function qu(t) {
      var e = .5,
          r = .5;

      switch (t) {
        case "right":
        case "top-right":
        case "bottom-right":
          e = 1;
          break;

        case "left":
        case "top-left":
        case "bottom-left":
          e = 0;
      }

      switch (t) {
        case "bottom":
        case "bottom-right":
        case "bottom-left":
          r = 1;
          break;

        case "top":
        case "top-right":
        case "top-left":
          r = 0;
      }

      return {
        horizontalAlign: e,
        verticalAlign: r
      };
    }

    function Nu(t, e, r, i, n) {
      if (!i && !n) return;
      var s = t[r],
          a = (t[r].x + s.metrics.advance * s.scale) * i;

      for (var _i79 = e; _i79 <= r; _i79++) {
        t[_i79].x -= a, t[_i79].y += n;
      }
    }

    function ju(t, e, r) {
      var {
        horizontalAlign: i,
        verticalAlign: n
      } = qu(r),
          s = e[0] - t.displaySize[0] * i,
          a = e[1] - t.displaySize[1] * n;
      return {
        image: t,
        top: a,
        bottom: a + t.displaySize[1],
        left: s,
        right: s + t.displaySize[0]
      };
    }

    function Gu(t, e, r, i, n, s) {
      var a = t.image;
      var o;

      if (a.content) {
        var _t113 = a.content,
            _e107 = a.pixelRatio || 1;

        o = [_t113[0] / _e107, _t113[1] / _e107, a.displaySize[0] - _t113[2] / _e107, a.displaySize[1] - _t113[3] / _e107];
      }

      var l = e.left * s,
          u = e.right * s;
      var c, h, p, d;
      "width" === r || "both" === r ? (d = n[0] + l - i[3], h = n[0] + u + i[1]) : (d = n[0] + (l + u - a.displaySize[0]) / 2, h = d + a.displaySize[0]);
      var f = e.top * s,
          y = e.bottom * s;
      return "height" === r || "both" === r ? (c = n[1] + f - i[0], p = n[1] + y + i[2]) : (c = n[1] + (f + y - a.displaySize[1]) / 2, p = c + a.displaySize[1]), {
        image: a,
        top: c,
        right: h,
        bottom: p,
        left: d,
        collisionPadding: o
      };
    }

    var Zu = /*#__PURE__*/function (_i80) {
      _inherits(Zu, _i80);

      var _super47 = _createSuper(Zu);

      function Zu(t, e, r, i) {
        var _this20;

        _classCallCheck(this, Zu);

        _this20 = _super47.call(this, t, e), _this20.angle = r, void 0 !== i && (_this20.segment = i);
        return _this20;
      }

      _createClass(Zu, [{
        key: "clone",
        value: function clone() {
          return new Zu(this.x, this.y, this.angle, this.segment);
        }
      }]);

      return Zu;
    }(i);

    function Xu(t, e, r, i, n) {
      if (void 0 === e.segment) return !0;
      var s = e,
          a = e.segment + 1,
          o = 0;

      for (; o > -r / 2;) {
        if (a--, a < 0) return !1;
        o -= t[a].dist(s), s = t[a];
      }

      o += t[a].dist(t[a + 1]), a++;
      var l = [];
      var u = 0;

      for (; o < r / 2;) {
        var _e108 = t[a],
            _r117 = t[a + 1];
        if (!_r117) return !1;

        var _s55 = t[a - 1].angleTo(_e108) - _e108.angleTo(_r117);

        for (_s55 = Math.abs((_s55 + 3 * Math.PI) % (2 * Math.PI) - Math.PI), l.push({
          distance: o,
          angleDelta: _s55
        }), u += _s55; o - l[0].distance > i;) {
          u -= l.shift().angleDelta;
        }

        if (u > n) return !1;
        a++, o += _e108.dist(_r117);
      }

      return !0;
    }

    function Ku(t) {
      var e = 0;

      for (var _r118 = 0; _r118 < t.length - 1; _r118++) {
        e += t[_r118].dist(t[_r118 + 1]);
      }

      return e;
    }

    function Hu(t, e, r) {
      return t ? .6 * e * r : 0;
    }

    function Yu(t, e) {
      return Math.max(t ? t.right - t.left : 0, e ? e.right - e.left : 0);
    }

    function Wu(t, e, r, i, n, s) {
      var a = Hu(r, n, s),
          o = Yu(r, i) * s;
      var l = 0;
      var u = Ku(t) / 2;

      for (var _r119 = 0; _r119 < t.length - 1; _r119++) {
        var _i81 = t[_r119],
            _n66 = t[_r119 + 1],
            _s56 = _i81.dist(_n66);

        if (l + _s56 > u) {
          var _c10 = (u - l) / _s56,
              _h5 = Je(_i81.x, _n66.x, _c10),
              _p4 = Je(_i81.y, _n66.y, _c10),
              _d2 = new Zu(_h5, _p4, _n66.angleTo(_i81), _r119);

          return _d2._round(), !a || Xu(t, _d2, o, a, e) ? _d2 : void 0;
        }

        l += _s56;
      }
    }

    function Ju(t, e, r, i, n, s, a, o, l) {
      var u = Hu(i, s, a),
          c = Yu(i, n),
          h = c * a,
          p = 0 === t[0].x || t[0].x === l || 0 === t[0].y || t[0].y === l;
      return e - h < e / 4 && (e = h + e / 4), function t(e, r, i, n, s, a, o, l, u) {
        var c = a / 2,
            h = Ku(e);
        var p = 0,
            d = r - i,
            f = [];

        for (var _t114 = 0; _t114 < e.length - 1; _t114++) {
          var _r120 = e[_t114],
              _o27 = e[_t114 + 1],
              _l21 = _r120.dist(_o27),
              _y3 = _o27.angleTo(_r120);

          for (; d + i < p + _l21;) {
            d += i;

            var _m4 = (d - p) / _l21,
                _g4 = Je(_r120.x, _o27.x, _m4),
                _x3 = Je(_r120.y, _o27.y, _m4);

            if (_g4 >= 0 && _g4 < u && _x3 >= 0 && _x3 < u && d - c >= 0 && d + c <= h) {
              var _r121 = new Zu(_g4, _x3, _y3, _t114);

              _r121._round(), n && !Xu(e, _r121, a, n, s) || f.push(_r121);
            }
          }

          p += _l21;
        }

        return l || f.length || o || (f = t(e, p / 2, i, n, s, a, o, !0, u)), f;
      }(t, p ? e / 2 * o % e : (c / 2 + 2 * s) * a * o % e, e, u, r, h, p, !1, l);
    }

    function Qu(t, e, r, n, s) {
      var a = [];

      for (var _o28 = 0; _o28 < t.length; _o28++) {
        var _l22 = t[_o28];

        var _u19 = void 0;

        for (var _t115 = 0; _t115 < _l22.length - 1; _t115++) {
          var _o29 = _l22[_t115],
              _c11 = _l22[_t115 + 1];
          _o29.x < e && _c11.x < e || (_o29.x < e ? _o29 = new i(e, _o29.y + (e - _o29.x) / (_c11.x - _o29.x) * (_c11.y - _o29.y))._round() : _c11.x < e && (_c11 = new i(e, _o29.y + (e - _o29.x) / (_c11.x - _o29.x) * (_c11.y - _o29.y))._round()), _o29.y < r && _c11.y < r || (_o29.y < r ? _o29 = new i(_o29.x + (r - _o29.y) / (_c11.y - _o29.y) * (_c11.x - _o29.x), r)._round() : _c11.y < r && (_c11 = new i(_o29.x + (r - _o29.y) / (_c11.y - _o29.y) * (_c11.x - _o29.x), r)._round()), _o29.x >= n && _c11.x >= n || (_o29.x >= n ? _o29 = new i(n, _o29.y + (n - _o29.x) / (_c11.x - _o29.x) * (_c11.y - _o29.y))._round() : _c11.x >= n && (_c11 = new i(n, _o29.y + (n - _o29.x) / (_c11.x - _o29.x) * (_c11.y - _o29.y))._round()), _o29.y >= s && _c11.y >= s || (_o29.y >= s ? _o29 = new i(_o29.x + (s - _o29.y) / (_c11.y - _o29.y) * (_c11.x - _o29.x), s)._round() : _c11.y >= s && (_c11 = new i(_o29.x + (s - _o29.y) / (_c11.y - _o29.y) * (_c11.x - _o29.x), s)._round()), _u19 && _o29.equals(_u19[_u19.length - 1]) || (_u19 = [_o29], a.push(_u19)), _u19.push(_c11)))));
        }
      }

      return a;
    }

    Gi("Anchor", Zu);
    var tc = ic,
        ec = ic,
        rc = 1e20;

    function ic(t, e, r, i, n, s) {
      this.fontSize = t || 24, this.buffer = void 0 === e ? 3 : e, this.cutoff = i || .25, this.fontFamily = n || "sans-serif", this.fontWeight = s || "normal", this.radius = r || 8;
      var a = this.size = this.fontSize + 2 * this.buffer,
          o = a + 2 * this.buffer;
      this.canvas = document.createElement("canvas"), this.canvas.width = this.canvas.height = a, this.ctx = this.canvas.getContext("2d"), this.ctx.font = this.fontWeight + " " + this.fontSize + "px " + this.fontFamily, this.ctx.textBaseline = "middle", this.ctx.textAlign = "left", this.ctx.fillStyle = "black", this.gridOuter = new Float64Array(o * o), this.gridInner = new Float64Array(o * o), this.f = new Float64Array(o), this.z = new Float64Array(o + 1), this.v = new Uint16Array(o), this.middle = Math.round(a / 2 * (navigator.userAgent.indexOf("Gecko/") >= 0 ? 1.2 : 1));
    }

    function nc(t, e, r, i, n, s) {
      for (var a = 0; a < e; a++) {
        sc(t, a, e, r, i, n, s);
      }

      for (var o = 0; o < r; o++) {
        sc(t, o * e, 1, e, i, n, s);
      }
    }

    function sc(t, e, r, i, n, s, a) {
      var o, l, u, c;

      for (s[0] = 0, a[0] = -rc, a[1] = rc, o = 0; o < i; o++) {
        n[o] = t[e + o * r];
      }

      for (o = 1, l = 0, u = 0; o < i; o++) {
        do {
          u = (n[o] - n[c = s[l]] + o * o - c * c) / (o - c) / 2;
        } while (u <= a[l] && --l > -1);

        s[++l] = o, a[l] = u, a[l + 1] = rc;
      }

      for (o = 0, l = 0; o < i; o++) {
        for (; a[l + 1] < o;) {
          l++;
        }

        t[e + o * r] = n[c = s[l]] + (o - c) * (o - c);
      }
    }

    ic.prototype._draw = function (t, e) {
      var r,
          i,
          n,
          s,
          a,
          o,
          l,
          u,
          c = this.ctx.measureText(t),
          h = c.width,
          p = 2 * this.buffer;
      e && void 0 !== c.actualBoundingBoxLeft ? (a = Math.floor(c.actualBoundingBoxAscent) - this.middle, o = Math.max(0, this.middle - Math.ceil(c.actualBoundingBoxAscent)), l = this.buffer, r = (i = Math.min(this.size, Math.ceil(c.actualBoundingBoxRight - c.actualBoundingBoxLeft))) + p, n = (s = Math.min(this.size - o, Math.ceil(c.actualBoundingBoxAscent + c.actualBoundingBoxDescent))) + p) : (r = i = this.size, n = s = this.size, a = 0, o = l = 0), i && s && (this.ctx.clearRect(l, o, i, s), this.ctx.fillText(t, this.buffer, this.middle), u = this.ctx.getImageData(l, o, i, s));
      var d = new Uint8ClampedArray(r * n);
      return function (t, e, r, i, n, s, a) {
        s.fill(rc, 0, e * r), a.fill(0, 0, e * r);

        for (var o = (e - i) / 2, l = 0; l < n; l++) {
          for (var u = 0; u < i; u++) {
            var c = (l + o) * e + u + o,
                h = t.data[4 * (l * i + u) + 3] / 255;
            if (1 === h) s[c] = 0, a[c] = rc;else if (0 === h) s[c] = rc, a[c] = 0;else {
              var p = Math.max(0, .5 - h),
                  d = Math.max(0, h - .5);
              s[c] = p * p, a[c] = d * d;
            }
          }
        }
      }(u, r, n, i, s, this.gridOuter, this.gridInner), nc(this.gridOuter, r, n, this.f, this.v, this.z), nc(this.gridInner, r, n, this.f, this.v, this.z), function (t, e, r, i, n, s, a) {
        for (var o = 0; o < e * r; o++) {
          var l = Math.sqrt(i[o]) - Math.sqrt(n[o]);
          t[o] = Math.round(255 - 255 * (l / s + a));
        }
      }(d, r, n, this.gridOuter, this.gridInner, this.radius, this.cutoff), {
        data: d,
        metrics: {
          width: i,
          height: s,
          sdfWidth: r,
          sdfHeight: n,
          top: a,
          left: 0,
          advance: h,
          fontAscent: c.fontBoundingBoxAscent
        }
      };
    }, ic.prototype.draw = function (t) {
      return this._draw(t, !1).data;
    }, ic.prototype.drawWithMetrics = function (t) {
      return this._draw(t, !0);
    }, tc.default = ec;
    var ac = {
      none: 0,
      ideographs: 1,
      all: 2
    };

    var oc = /*#__PURE__*/function () {
      function oc(t, e, r) {
        _classCallCheck(this, oc);

        this.requestManager = t, this.localGlyphMode = e, this.localFontFamily = r, this.entries = {}, this.localGlyphs = {
          200: {},
          400: {},
          500: {},
          900: {}
        };
      }

      _createClass(oc, [{
        key: "setURL",
        value: function setURL(t) {
          this.url = t;
        }
      }, {
        key: "getGlyphs",
        value: function getGlyphs(t, e) {
          var _this21 = this;

          var r = [];

          for (var _e109 in t) {
            for (var _i82 of t[_e109]) {
              r.push({
                stack: _e109,
                id: _i82
              });
            }
          }

          m(r, function (_ref64, r) {
            var {
              stack: t,
              id: e
            } = _ref64;
            var i = _this21.entries[t];
            i || (i = _this21.entries[t] = {
              glyphs: {},
              requests: {},
              ranges: {}
            });
            var n = i.glyphs[e];
            if (void 0 !== n) return void r(null, {
              stack: t,
              id: e,
              glyph: n
            });
            if (n = _this21._tinySDF(i, t, e), n) return i.glyphs[e] = n, void r(null, {
              stack: t,
              id: e,
              glyph: n
            });
            var s = Math.floor(e / 256);
            if (256 * s > 65535) return void r(new Error("glyphs > 65535 not supported"));
            if (i.ranges[s]) return void r(null, {
              stack: t,
              id: e,
              glyph: n
            });
            var a = i.requests[s];
            a || (a = i.requests[s] = [], oc.loadGlyphRange(t, s, _this21.url, _this21.requestManager, function (t, e) {
              if (e) {
                for (var _t116 in e) {
                  _this21._doesCharSupportLocalGlyph(+_t116) || (i.glyphs[+_t116] = e[+_t116]);
                }

                i.ranges[s] = !0;
              }

              for (var _r122 of a) {
                _r122(t, e);
              }

              delete i.requests[s];
            })), a.push(function (i, n) {
              i ? r(i) : n && r(null, {
                stack: t,
                id: e,
                glyph: n[e] || null
              });
            });
          }, function (t, r) {
            if (t) e(t);else if (r) {
              var _t117 = {};

              for (var {
                stack: _e110,
                id: _i83,
                glyph: _n67
              } of r) {
                (_t117[_e110] || (_t117[_e110] = {}))[_i83] = _n67 && {
                  id: _n67.id,
                  bitmap: _n67.bitmap.clone(),
                  metrics: _n67.metrics
                };
              }

              e(null, _t117);
            }
          });
        }
      }, {
        key: "_doesCharSupportLocalGlyph",
        value: function _doesCharSupportLocalGlyph(t) {
          return this.localGlyphMode !== ac.none && (this.localGlyphMode === ac.all ? !!this.localFontFamily : !!this.localFontFamily && (fn(t) || gn(t) || sn(t) || an(t)));
        }
      }, {
        key: "_tinySDF",
        value: function _tinySDF(t, e, r) {
          var i = this.localFontFamily;
          if (!i) return;
          if (!this._doesCharSupportLocalGlyph(r)) return;
          var n = t.tinySDF;

          if (!n) {
            var _r123 = "400";
            /bold/i.test(e) ? _r123 = "900" : /medium/i.test(e) ? _r123 = "500" : /light/i.test(e) && (_r123 = "200"), n = t.tinySDF = new oc.TinySDF(48, 6, 16, .25, i, _r123);
          }

          if (this.localGlyphs[n.fontWeight][r]) return this.localGlyphs[n.fontWeight][r];
          var {
            data: s,
            metrics: a
          } = n.drawWithMetrics(String.fromCharCode(r)),
              {
            fontAscent: o,
            sdfWidth: l,
            sdfHeight: u,
            width: c,
            height: h,
            left: p,
            top: d,
            advance: f
          } = a,
              y = (o ? o / 2 : 17) - 9;
          return this.localGlyphs[n.fontWeight][r] = {
            id: r,
            bitmap: new _o({
              width: l,
              height: u
            }, s),
            metrics: {
              width: c / 2,
              height: h / 2,
              left: p / 2,
              top: d / 2 - y,
              advance: f / 2,
              localGlyph: !0
            }
          };
        }
      }]);

      return oc;
    }();

    function lc(t, e, r, n) {
      var s = [],
          a = t.image,
          o = a.pixelRatio,
          l = a.paddedRect.w - 2,
          u = a.paddedRect.h - 2,
          c = t.right - t.left,
          h = t.bottom - t.top,
          p = a.stretchX || [[0, l]],
          d = a.stretchY || [[0, u]],
          f = function (t, e) {
        return t + e[1] - e[0];
      },
          y = p.reduce(f, 0),
          m = d.reduce(f, 0),
          g = l - y,
          x = u - m;

      var v = 0,
          b = y,
          w = 0,
          _ = m,
          k = 0,
          A = g,
          S = 0,
          I = x;

      if (a.content && n) {
        var _t118 = a.content;
        v = uc(p, 0, _t118[0]), w = uc(d, 0, _t118[1]), b = uc(p, _t118[0], _t118[2]), _ = uc(d, _t118[1], _t118[3]), k = _t118[0] - v, S = _t118[1] - w, A = _t118[2] - _t118[0] - b, I = _t118[3] - _t118[1] - _;
      }

      var T = function (n, s, l, u) {
        var p = hc(n.stretch - v, b, c, t.left),
            d = pc(n.fixed - k, A, n.stretch, y),
            f = hc(s.stretch - w, _, h, t.top),
            g = pc(s.fixed - S, I, s.stretch, m),
            x = hc(l.stretch - v, b, c, t.left),
            T = pc(l.fixed - k, A, l.stretch, y),
            z = hc(u.stretch - w, _, h, t.top),
            E = pc(u.fixed - S, I, u.stretch, m),
            M = new i(p, f),
            B = new i(x, f),
            D = new i(x, z),
            C = new i(p, z),
            P = new i(d / o, g / o),
            V = new i(T / o, E / o),
            F = e * Math.PI / 180;

        if (F) {
          var _t119 = Math.sin(F),
              _e111 = Math.cos(F),
              _r124 = [_e111, -_t119, _t119, _e111];

          M._matMult(_r124), B._matMult(_r124), C._matMult(_r124), D._matMult(_r124);
        }

        var R = n.stretch + n.fixed,
            L = s.stretch + s.fixed;
        return {
          tl: M,
          tr: B,
          bl: C,
          br: D,
          tex: {
            x: a.paddedRect.x + 1 + R,
            y: a.paddedRect.y + 1 + L,
            w: l.stretch + l.fixed - R,
            h: u.stretch + u.fixed - L
          },
          writingMode: void 0,
          glyphOffset: [0, 0],
          sectionIndex: 0,
          pixelOffsetTL: P,
          pixelOffsetBR: V,
          minFontScaleX: A / o / c,
          minFontScaleY: I / o / h,
          isSDF: r
        };
      };

      if (n && (a.stretchX || a.stretchY)) {
        var _t120 = cc(p, g, y),
            _e112 = cc(d, x, m);

        for (var _r125 = 0; _r125 < _t120.length - 1; _r125++) {
          var _i84 = _t120[_r125],
              _n68 = _t120[_r125 + 1];

          for (var _t121 = 0; _t121 < _e112.length - 1; _t121++) {
            s.push(T(_i84, _e112[_t121], _n68, _e112[_t121 + 1]));
          }
        }
      } else s.push(T({
        fixed: 0,
        stretch: -1
      }, {
        fixed: 0,
        stretch: -1
      }, {
        fixed: 0,
        stretch: l + 1
      }, {
        fixed: 0,
        stretch: u + 1
      }));

      return s;
    }

    function uc(t, e, r) {
      var i = 0;

      for (var _n69 of t) {
        i += Math.max(e, Math.min(r, _n69[1])) - Math.max(e, Math.min(r, _n69[0]));
      }

      return i;
    }

    function cc(t, e, r) {
      var i = [{
        fixed: -1,
        stretch: 0
      }];

      for (var [_e113, _r126] of t) {
        var _t122 = i[i.length - 1];
        i.push({
          fixed: _e113 - _t122.stretch,
          stretch: _t122.stretch
        }), i.push({
          fixed: _e113 - _t122.stretch,
          stretch: _t122.stretch + (_r126 - _e113)
        });
      }

      return i.push({
        fixed: e + 1,
        stretch: r
      }), i;
    }

    function hc(t, e, r, i) {
      return t / e * r + i;
    }

    function pc(t, e, r, i) {
      return t - e * r / i;
    }

    oc.loadGlyphRange = function (t, e, r, i, n) {
      var s = 256 * e,
          a = s + 255,
          o = i.transformRequest(i.normalizeGlyphsURL(r).replace("{fontstack}", t).replace("{range}", "".concat(s, "-").concat(a)), vt.Glyphs);
      kt(o, function (t, e) {
        if (t) n(t);else if (e) {
          var _t123 = {};

          for (var _r127 of function (t) {
            return new ou(t).readFields(Su, []);
          }(e)) {
            _t123[_r127.id] = _r127;
          }

          n(null, _t123);
        }
      });
    }, oc.TinySDF = tc;

    var dc = /*#__PURE__*/function () {
      function dc() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : fc;

        _classCallCheck(this, dc);

        if (this.data = t, this.length = this.data.length, this.compare = e, this.length > 0) for (var _t124 = (this.length >> 1) - 1; _t124 >= 0; _t124--) {
          this._down(_t124);
        }
      }

      _createClass(dc, [{
        key: "push",
        value: function push(t) {
          this.data.push(t), this.length++, this._up(this.length - 1);
        }
      }, {
        key: "pop",
        value: function pop() {
          if (0 === this.length) return;
          var t = this.data[0],
              e = this.data.pop();
          return this.length--, this.length > 0 && (this.data[0] = e, this._down(0)), t;
        }
      }, {
        key: "peek",
        value: function peek() {
          return this.data[0];
        }
      }, {
        key: "_up",
        value: function _up(t) {
          var {
            data: e,
            compare: r
          } = this,
              i = e[t];

          for (; t > 0;) {
            var _n70 = t - 1 >> 1,
                _s57 = e[_n70];

            if (r(i, _s57) >= 0) break;
            e[t] = _s57, t = _n70;
          }

          e[t] = i;
        }
      }, {
        key: "_down",
        value: function _down(t) {
          var {
            data: e,
            compare: r
          } = this,
              i = this.length >> 1,
              n = e[t];

          for (; t < i;) {
            var _i85 = 1 + (t << 1),
                _s58 = e[_i85];

            var _a52 = _i85 + 1;

            if (_a52 < this.length && r(e[_a52], _s58) < 0 && (_i85 = _a52, _s58 = e[_a52]), r(_s58, n) >= 0) break;
            e[t] = _s58, t = _i85;
          }

          e[t] = n;
        }
      }]);

      return dc;
    }();

    function fc(t, e) {
      return t < e ? -1 : t > e ? 1 : 0;
    }

    function yc(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;
      var n = 1 / 0,
          s = 1 / 0,
          a = -1 / 0,
          o = -1 / 0;
      var l = t[0];

      for (var _t125 = 0; _t125 < l.length; _t125++) {
        var _e114 = l[_t125];
        (!_t125 || _e114.x < n) && (n = _e114.x), (!_t125 || _e114.y < s) && (s = _e114.y), (!_t125 || _e114.x > a) && (a = _e114.x), (!_t125 || _e114.y > o) && (o = _e114.y);
      }

      var u = Math.min(a - n, o - s);
      var c = u / 2;
      var h = new dc([], mc);
      if (0 === u) return new i(n, s);

      for (var _e115 = n; _e115 < a; _e115 += u) {
        for (var _r128 = s; _r128 < o; _r128 += u) {
          h.push(new gc(_e115 + c, _r128 + c, c, t));
        }
      }

      var p = function (t) {
        var e = 0,
            r = 0,
            i = 0;
        var n = t[0];

        for (var _t126 = 0, _s59 = n.length, _a53 = _s59 - 1; _t126 < _s59; _a53 = _t126++) {
          var _s60 = n[_t126],
              _o30 = n[_a53],
              _l23 = _s60.x * _o30.y - _o30.x * _s60.y;

          r += (_s60.x + _o30.x) * _l23, i += (_s60.y + _o30.y) * _l23, e += 3 * _l23;
        }

        return new gc(r / e, i / e, 0, t);
      }(t),
          d = h.length;

      for (; h.length;) {
        var _i86 = h.pop();

        (_i86.d > p.d || !p.d) && (p = _i86, r && console.log("found best %d after %d probes", Math.round(1e4 * _i86.d) / 1e4, d)), _i86.max - p.d <= e || (c = _i86.h / 2, h.push(new gc(_i86.p.x - c, _i86.p.y - c, c, t)), h.push(new gc(_i86.p.x + c, _i86.p.y - c, c, t)), h.push(new gc(_i86.p.x - c, _i86.p.y + c, c, t)), h.push(new gc(_i86.p.x + c, _i86.p.y + c, c, t)), d += 4);
      }

      return r && (console.log("num probes: ".concat(d)), console.log("best distance: ".concat(p.d))), p.p;
    }

    function mc(t, e) {
      return e.max - t.max;
    }

    function gc(t, e, r, n) {
      this.p = new i(t, e), this.h = r, this.d = function (t, e) {
        var r = !1,
            i = 1 / 0;

        for (var _n71 = 0; _n71 < e.length; _n71++) {
          var _s61 = e[_n71];

          for (var _e116 = 0, _n72 = _s61.length, _a54 = _n72 - 1; _e116 < _n72; _a54 = _e116++) {
            var _n73 = _s61[_e116],
                _o31 = _s61[_a54];
            _n73.y > t.y != _o31.y > t.y && t.x < (_o31.x - _n73.x) * (t.y - _n73.y) / (_o31.y - _n73.y) + _n73.x && (r = !r), i = Math.min(i, Ea(t, _n73, _o31));
          }
        }

        return (r ? 1 : -1) * Math.sqrt(i);
      }(this.p, n), this.max = this.d + this.h * Math.SQRT2;
    }

    var xc = Number.POSITIVE_INFINITY;

    function vc(t, e) {
      return e[1] !== xc ? function (t, e, r) {
        var i = 0,
            n = 0;

        switch (e = Math.abs(e), r = Math.abs(r), t) {
          case "top-right":
          case "top-left":
          case "top":
            n = r - 7;
            break;

          case "bottom-right":
          case "bottom-left":
          case "bottom":
            n = 7 - r;
        }

        switch (t) {
          case "top-right":
          case "bottom-right":
          case "right":
            i = -e;
            break;

          case "top-left":
          case "bottom-left":
          case "left":
            i = e;
        }

        return [i, n];
      }(t, e[0], e[1]) : function (t, e) {
        var r = 0,
            i = 0;
        e < 0 && (e = 0);
        var n = e / Math.sqrt(2);

        switch (t) {
          case "top-right":
          case "top-left":
            i = n - 7;
            break;

          case "bottom-right":
          case "bottom-left":
            i = 7 - n;
            break;

          case "bottom":
            i = 7 - e;
            break;

          case "top":
            i = e - 7;
        }

        switch (t) {
          case "top-right":
          case "bottom-right":
            r = -n;
            break;

          case "top-left":
          case "bottom-left":
            r = n;
            break;

          case "left":
            r = e;
            break;

          case "right":
            r = -e;
        }

        return [r, i];
      }(t, e[0]);
    }

    function bc(t, e, r, i, n, s, a, o) {
      t.createArrays(), t.tilePixelRatio = 8192 / (512 * t.overscaling), t.compareText = {}, t.iconsNeedLinear = !1;
      var l = t.layers[0].layout,
          u = t.layers[0]._unevaluatedLayout._values,
          c = {};

      if ("composite" === t.textSizeData.kind) {
        var {
          minZoom: _e117,
          maxZoom: _r129
        } = t.textSizeData;
        c.compositeTextSizes = [u["text-size"].possiblyEvaluate(new qn(_e117), a), u["text-size"].possiblyEvaluate(new qn(_r129), a)];
      }

      if ("composite" === t.iconSizeData.kind) {
        var {
          minZoom: _e118,
          maxZoom: _r130
        } = t.iconSizeData;
        c.compositeIconSizes = [u["icon-size"].possiblyEvaluate(new qn(_e118), a), u["icon-size"].possiblyEvaluate(new qn(_r130), a)];
      }

      c.layoutTextSize = u["text-size"].possiblyEvaluate(new qn(o + 1), a), c.layoutIconSize = u["icon-size"].possiblyEvaluate(new qn(o + 1), a), c.textMaxSize = u["text-size"].possiblyEvaluate(new qn(18), a);
      var h = 24 * l.get("text-line-height"),
          p = "map" === l.get("text-rotation-alignment") && "point" !== l.get("symbol-placement"),
          d = l.get("text-keep-upright"),
          f = l.get("text-size");

      var _loop2 = function (_s62) {
        var o = l.get("text-font").evaluate(_s62, {}, a).join(","),
            u = f.evaluate(_s62, {}, a),
            y = c.layoutTextSize.evaluate(_s62, {}, a),
            m = (c.layoutIconSize.evaluate(_s62, {}, a), {
          horizontal: {},
          vertical: void 0
        }),
            g = _s62.text;
        var x = void 0,
            v = [0, 0];

        if (g) {
          var _i87 = g.toString(),
              _c12 = 24 * l.get("text-letter-spacing").evaluate(_s62, {}, a),
              _f3 = In(_i87) ? _c12 : 0,
              _x4 = l.get("text-anchor").evaluate(_s62, {}, a),
              _b3 = l.get("text-variable-anchor");

          if (!_b3) {
            var _t127 = l.get("text-radial-offset").evaluate(_s62, {}, a);

            v = _t127 ? vc(_x4, [24 * _t127, xc]) : l.get("text-offset").evaluate(_s62, {}, a).map(function (t) {
              return 24 * t;
            });
          }

          var _w3 = p ? "center" : l.get("text-justify").evaluate(_s62, {}, a);

          var _5 = l.get("symbol-placement"),
              _k3 = "point" === _5 ? 24 * l.get("text-max-width").evaluate(_s62, {}, a) : 0,
              _A3 = function () {
            t.allowVerticalPlacement && Sn(_i87) && (m.vertical = Pu(g, e, r, n, o, _k3, h, _x4, "left", _f3, v, Bu.vertical, !0, _5, y, u));
          };

          if (!p && _b3) {
            var _t128 = "auto" === _w3 ? _b3.map(function (t) {
              return wc(t);
            }) : [_w3];

            var _i88 = !1;

            for (var _s63 = 0; _s63 < _t128.length; _s63++) {
              var _a55 = _t128[_s63];
              if (!m.horizontal[_a55]) if (_i88) m.horizontal[_a55] = m.horizontal[0];else {
                var _t129 = Pu(g, e, r, n, o, _k3, h, "center", _a55, _f3, v, Bu.horizontal, !1, _5, y, u);

                _t129 && (m.horizontal[_a55] = _t129, _i88 = 1 === _t129.positionedLines.length);
              }
            }

            _A3();
          } else {
            "auto" === _w3 && (_w3 = wc(_x4));

            var _t130 = Pu(g, e, r, n, o, _k3, h, _x4, _w3, _f3, v, Bu.horizontal, !1, _5, y, u);

            _t130 && (m.horizontal[_w3] = _t130), _A3(), Sn(_i87) && p && d && (m.vertical = Pu(g, e, r, n, o, _k3, h, _x4, _w3, _f3, v, Bu.vertical, !1, _5, y, u));
          }
        }

        var b = !1;

        if (_s62.icon && _s62.icon.name) {
          var _e119 = i[_s62.icon.name];
          _e119 && (x = ju(n[_s62.icon.name], l.get("icon-offset").evaluate(_s62, {}, a), l.get("icon-anchor").evaluate(_s62, {}, a)), b = _e119.sdf, void 0 === t.sdfIcons ? t.sdfIcons = _e119.sdf : t.sdfIcons !== _e119.sdf && E("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"), (_e119.pixelRatio !== t.pixelRatio || 0 !== l.get("icon-rotate").constantOr(1)) && (t.iconsNeedLinear = !0));
        }

        var w = Ac(m.horizontal) || m.vertical;
        t.iconsInText = !!w && w.iconsInText, (w || x) && _c(t, _s62, m, x, i, c, y, 0, v, b, a);
      };

      for (var _s62 of t.features) {
        _loop2(_s62);
      }

      s && t.generateCollisionDebugBuffers(o, t.collisionBoxArray);
    }

    function wc(t) {
      switch (t) {
        case "right":
        case "top-right":
        case "bottom-right":
          return "right";

        case "left":
        case "top-left":
        case "bottom-left":
          return "left";
      }

      return "center";
    }

    function _c(t, e, r, i, n, s, a, o, l, u, h) {
      var p = s.textMaxSize.evaluate(e, {}, h);
      void 0 === p && (p = a);

      var d = t.layers[0].layout,
          f = d.get("icon-offset").evaluate(e, {}, h),
          y = Ac(r.horizontal),
          m = a / 24,
          g = t.tilePixelRatio * m,
          x = t.tilePixelRatio * p / 24,
          v = t.tilePixelRatio * d.get("symbol-spacing"),
          b = d.get("text-padding") * t.tilePixelRatio,
          w = d.get("icon-padding") * t.tilePixelRatio,
          _ = c(d.get("text-max-angle")),
          k = "map" === d.get("text-rotation-alignment") && "point" !== d.get("symbol-placement"),
          A = "map" === d.get("icon-rotation-alignment") && "point" !== d.get("symbol-placement"),
          S = d.get("symbol-placement"),
          I = v / 2,
          T = d.get("icon-text-fit");

      var z;
      i && "none" !== T && (t.allowVerticalPlacement && r.vertical && (z = Gu(i, r.vertical, T, d.get("icon-text-fit-padding"), f, m)), y && (i = Gu(i, y, T, d.get("icon-text-fit-padding"), f, m)));

      var M = function (o, c) {
        c.x < 0 || c.x >= 8192 || c.y < 0 || c.y >= 8192 || function (t, e, r, i, n, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b, w, _, k, A) {
          var S = t.addToLineVertexArray(e, r);
          var I,
              T,
              z,
              M,
              B,
              D,
              C,
              P = 0,
              V = 0,
              F = 0,
              R = 0,
              L = -1,
              U = -1;
          var O = {};
          var $ = Gs(""),
              q = 0,
              N = 0;

          if (void 0 === o._unevaluatedLayout.getValue("text-radial-offset") ? [q, N] = o.layout.get("text-offset").evaluate(b, {}, k).map(function (t) {
            return 24 * t;
          }) : (q = 24 * o.layout.get("text-radial-offset").evaluate(b, {}, k), N = xc), t.allowVerticalPlacement && i.vertical) {
            var _t131 = i.vertical;
            if (f) D = Ic(_t131), a && (C = Ic(a));else {
              var _r131 = o.layout.get("text-rotate").evaluate(b, {}, k) + 90;

              z = Sc(l, e, u, c, h, _t131, 0, d, _r131), a && (M = Sc(l, e, u, c, h, a, 0, g, _r131));
            }
          }

          if (n) {
            var _r132 = o.layout.get("icon-rotate").evaluate(b, {}, k),
                _i89 = "none" !== o.layout.get("icon-text-fit"),
                _s64 = lc(n, _r132, _, _i89),
                _p5 = a ? lc(a, _r132, _, _i89) : void 0;

            T = Sc(l, e, u, c, h, n, 0, g, _r132), P = 4 * _s64.length;
            var _d3 = t.iconSizeData;
            var _f4 = null;
            "source" === _d3.kind ? (_f4 = [128 * o.layout.get("icon-size").evaluate(b, {}, k)], _f4[0] > 32640 && E("".concat(t.layerIds[0], ": Value for \"icon-size\" is >= 255. Reduce your \"icon-size\"."))) : "composite" === _d3.kind && (_f4 = [128 * w.compositeIconSizes[0].evaluate(b, {}, k), 128 * w.compositeIconSizes[1].evaluate(b, {}, k)], (_f4[0] > 32640 || _f4[1] > 32640) && E("".concat(t.layerIds[0], ": Value for \"icon-size\" is >= 255. Reduce your \"icon-size\"."))), t.addSymbols(t.icon, _s64, _f4, v, x, b, !1, e, S.lineStartIndex, S.lineLength, -1, k), L = t.icon.placedSymbolArray.length - 1, _p5 && (V = 4 * _p5.length, t.addSymbols(t.icon, _p5, _f4, v, x, b, Bu.vertical, e, S.lineStartIndex, S.lineLength, -1, k), U = t.icon.placedSymbolArray.length - 1);
          }

          for (var _r133 in i.horizontal) {
            var _n74 = i.horizontal[_r133];
            I || ($ = Gs(_n74.text), f ? B = Ic(_n74) : I = Sc(l, e, u, c, h, _n74, 0, d, o.layout.get("text-rotate").evaluate(b, {}, k)));

            var _a56 = 1 === _n74.positionedLines.length;

            if (F += kc(t, e, _n74, s, o, f, b, y, S, i.vertical ? Bu.horizontal : Bu.horizontalOnly, _a56 ? Object.keys(i.horizontal) : [_r133], O, L, w, k), _a56) break;
          }

          i.vertical && (R += kc(t, e, i.vertical, s, o, f, b, y, S, Bu.vertical, ["vertical"], O, U, w, k));
          var j = -1;

          var G = function (t, e) {
            return t ? Math.max(t, e) : e;
          };

          j = G(B, j), j = G(D, j), j = G(C, j);
          var Z = j > -1 ? 1 : 0;
          Z && (j *= A / 24), t.glyphOffsetArray.length >= Vc.MAX_GLYPHS && E("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"), void 0 !== b.sortKey && t.addToSortKeyRanges(t.symbolInstances.length, b.sortKey), t.symbolInstances.emplaceBack(e.x, e.y, O.right >= 0 ? O.right : -1, O.center >= 0 ? O.center : -1, O.left >= 0 ? O.left : -1, O.vertical || -1, L, U, $, void 0 !== I ? I : t.collisionBoxArray.length, void 0 !== I ? I + 1 : t.collisionBoxArray.length, void 0 !== z ? z : t.collisionBoxArray.length, void 0 !== z ? z + 1 : t.collisionBoxArray.length, void 0 !== T ? T : t.collisionBoxArray.length, void 0 !== T ? T + 1 : t.collisionBoxArray.length, M || t.collisionBoxArray.length, M ? M + 1 : t.collisionBoxArray.length, u, F, R, P, V, Z, 0, p, q, N, j);
        }(t, c, o, r, i, n, z, t.layers[0], t.collisionBoxArray, e.index, e.sourceLayerIndex, t.index, g, b, k, l, 0, w, A, f, e, s, u, h, a);
      };

      if ("line" === S) for (var _n75 of Qu(e.geometry, 0, 0, 8192, 8192)) {
        var _e120 = Ju(_n75, v, _, r.vertical || y, i, 24, x, t.overscaling, 8192);

        for (var _r134 of _e120) {
          var _e121 = y;
          _e121 && Tc(t, _e121.text, I, _r134) || M(_n75, _r134);
        }
      } else if ("line-center" === S) {
        for (var _t132 of e.geometry) {
          if (_t132.length > 1) {
            var _e122 = Wu(_t132, _, r.vertical || y, i, 24, x);

            _e122 && M(_t132, _e122);
          }
        }
      } else if ("Polygon" === e.type) for (var _t133 of al(e.geometry, 0)) {
        var _e123 = yc(_t133, 16);

        M(_t133[0], new Zu(_e123.x, _e123.y, 0));
      } else if ("LineString" === e.type) for (var _t134 of e.geometry) {
        M(_t134, new Zu(_t134[0].x, _t134[0].y, 0));
      } else if ("Point" === e.type) for (var _t135 of e.geometry) {
        for (var _e124 of _t135) {
          M([_e124], new Zu(_e124.x, _e124.y, 0));
        }
      }
    }

    function kc(t, e, r, n, s, a, o, l, u, c, h, p, d, f, y) {
      var m = function (t, e, r, n, s, a, o, l) {
        var u = n.layout.get("text-rotate").evaluate(a, {}) * Math.PI / 180,
            c = [];

        for (var _t136 of e.positionedLines) {
          for (var _n76 of _t136.positionedGlyphs) {
            if (!_n76.rect) continue;

            var _a57 = _n76.rect || {};

            var _h6 = 4,
                _p6 = !0,
                _d4 = 1,
                _f5 = 0;

            var _y4 = (s || l) && _n76.vertical,
                _m5 = _n76.metrics.advance * _n76.scale / 2;

            if (l && e.verticalizable) {
              var _e125 = 24 * (_n76.scale - 1),
                  _r135 = (24 - _n76.metrics.width * _n76.scale) / 2;

              _f5 = _t136.lineOffset / 2 - (_n76.imageName ? -_r135 : _e125);
            }

            if (_n76.imageName) {
              var _t137 = o[_n76.imageName];
              _p6 = _t137.sdf, _d4 = _t137.pixelRatio, _h6 = 1 / _d4;
            }

            var _g5 = s ? [_n76.x + _m5, _n76.y] : [0, 0];

            var _x5 = s ? [0, 0] : [_n76.x + _m5 + r[0], _n76.y + r[1] - _f5],
                _v4 = [0, 0];

            _y4 && (_v4 = _x5, _x5 = [0, 0]);

            var _b4 = (_n76.metrics.left - _h6) * _n76.scale - _m5 + _x5[0],
                _w4 = (-_n76.metrics.top - _h6) * _n76.scale + _x5[1],
                _6 = _b4 + _a57.w * _n76.scale / (_d4 * (_n76.localGlyph ? 2 : 1)),
                _k4 = _w4 + _a57.h * _n76.scale / (_d4 * (_n76.localGlyph ? 2 : 1)),
                _A4 = new i(_b4, _w4),
                _S2 = new i(_6, _w4),
                _I = new i(_b4, _k4),
                _T = new i(_6, _k4);

            if (_y4) {
              var _t138 = new i(-_m5, _m5 - -17),
                  _e126 = -Math.PI / 2,
                  _r136 = 12 - _m5,
                  _s65 = new i(22 - _r136, -(_n76.imageName ? _r136 : 0)),
                  _a58 = _construct(i, _toConsumableArray(_v4));

              _A4._rotateAround(_e126, _t138)._add(_s65)._add(_a58), _S2._rotateAround(_e126, _t138)._add(_s65)._add(_a58), _I._rotateAround(_e126, _t138)._add(_s65)._add(_a58), _T._rotateAround(_e126, _t138)._add(_s65)._add(_a58);
            }

            if (u) {
              var _t139 = Math.sin(u),
                  _e127 = Math.cos(u),
                  _r137 = [_e127, -_t139, _t139, _e127];

              _A4._matMult(_r137), _S2._matMult(_r137), _I._matMult(_r137), _T._matMult(_r137);
            }

            var _z = new i(0, 0),
                _E = new i(0, 0);

            c.push({
              tl: _A4,
              tr: _S2,
              bl: _I,
              br: _T,
              tex: _a57,
              writingMode: e.writingMode,
              glyphOffset: _g5,
              sectionIndex: _n76.sectionIndex,
              isSDF: _p6,
              pixelOffsetTL: _z,
              pixelOffsetBR: _E,
              minFontScaleX: 0,
              minFontScaleY: 0
            });
          }
        }

        return c;
      }(0, r, l, s, a, o, n, t.allowVerticalPlacement),
          g = t.textSizeData;

      var x = null;
      "source" === g.kind ? (x = [128 * s.layout.get("text-size").evaluate(o, {}, y)], x[0] > 32640 && E("".concat(t.layerIds[0], ": Value for \"text-size\" is >= 255. Reduce your \"text-size\"."))) : "composite" === g.kind && (x = [128 * f.compositeTextSizes[0].evaluate(o, {}, y), 128 * f.compositeTextSizes[1].evaluate(o, {}, y)], (x[0] > 32640 || x[1] > 32640) && E("".concat(t.layerIds[0], ": Value for \"text-size\" is >= 255. Reduce your \"text-size\"."))), t.addSymbols(t.text, m, x, l, a, o, c, e, u.lineStartIndex, u.lineLength, d, y);

      for (var _e128 of h) {
        p[_e128] = t.text.placedSymbolArray.length - 1;
      }

      return 4 * m.length;
    }

    function Ac(t) {
      for (var _e129 in t) {
        return t[_e129];
      }

      return null;
    }

    function Sc(t, e, r, n, s, a, o, l, u) {
      var h = a.top,
          p = a.bottom,
          d = a.left,
          f = a.right;
      var y = a.collisionPadding;

      if (y && (d -= y[0], h -= y[1], f += y[2], p += y[3]), u) {
        var _t140 = new i(d, h),
            _e130 = new i(f, h),
            _r138 = new i(d, p),
            _n77 = new i(f, p),
            _s66 = c(u);

        _t140._rotate(_s66), _e130._rotate(_s66), _r138._rotate(_s66), _n77._rotate(_s66), d = Math.min(_t140.x, _e130.x, _r138.x, _n77.x), f = Math.max(_t140.x, _e130.x, _r138.x, _n77.x), h = Math.min(_t140.y, _e130.y, _r138.y, _n77.y), p = Math.max(_t140.y, _e130.y, _r138.y, _n77.y);
      }

      return t.emplaceBack(e.x, e.y, d, h, f, p, l, r, n, s), t.length - 1;
    }

    function Ic(t) {
      t.collisionPadding && (t.top -= t.collisionPadding[1], t.bottom += t.collisionPadding[3]);
      var e = t.bottom - t.top;
      return e > 0 ? Math.max(10, e) : null;
    }

    function Tc(t, e, r, i) {
      var n = t.compareText;

      if (e in n) {
        var _t141 = n[e];

        for (var _e131 = _t141.length - 1; _e131 >= 0; _e131--) {
          if (i.dist(_t141[_e131]) < r) return !0;
        }
      } else n[e] = [];

      return n[e].push(i), !1;
    }

    var zc = Al.VectorTileFeature.types,
        Ec = [{
      name: "a_fade_opacity",
      components: 1,
      type: "Uint8",
      offset: 0
    }];

    function Mc(t, e, r, i, n, s, a, o, l, u, c, h, p) {
      var d = o ? Math.min(32640, Math.round(o[0])) : 0,
          f = o ? Math.min(32640, Math.round(o[1])) : 0;
      t.emplaceBack(e, r, Math.round(32 * i), Math.round(32 * n), s, a, (d << 1) + (l ? 1 : 0), f, 16 * u, 16 * c, 256 * h, 256 * p);
    }

    function Bc(t, e, r) {
      t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r);
    }

    function Dc(t) {
      for (var _e132 of t.sections) {
        if (Dn(_e132.text)) return !0;
      }

      return !1;
    }

    var Cc = /*#__PURE__*/function () {
      function Cc(t) {
        _classCallCheck(this, Cc);

        this.layoutVertexArray = new fs(), this.indexArray = new ws(), this.programConfigurations = t, this.segments = new ya(), this.dynamicLayoutVertexArray = new ys(), this.opacityVertexArray = new ms(), this.placedSymbolArray = new Cs();
      }

      _createClass(Cc, [{
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.layoutVertexArray.length && 0 === this.indexArray.length && 0 === this.dynamicLayoutVertexArray.length && 0 === this.opacityVertexArray.length;
        }
      }, {
        key: "upload",
        value: function upload(t, e, r, i) {
          this.isEmpty() || (r && (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Xl.members), this.indexBuffer = t.createIndexBuffer(this.indexArray, e), this.dynamicLayoutVertexBuffer = t.createVertexBuffer(this.dynamicLayoutVertexArray, Kl.members, !0), this.opacityVertexBuffer = t.createVertexBuffer(this.opacityVertexArray, Ec, !0), this.opacityVertexBuffer.itemSize = 1), (r || i) && this.programConfigurations.upload(t));
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.dynamicLayoutVertexBuffer.destroy(), this.opacityVertexBuffer.destroy());
        }
      }]);

      return Cc;
    }();

    Gi("SymbolBuffers", Cc);

    var Pc = /*#__PURE__*/function () {
      function Pc(t, e, r) {
        _classCallCheck(this, Pc);

        this.layoutVertexArray = new t(), this.layoutAttributes = e, this.indexArray = new r(), this.segments = new ya(), this.collisionVertexArray = new bs(), this.collisionVertexArrayExt = new ys();
      }

      _createClass(Pc, [{
        key: "upload",
        value: function upload(t) {
          this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, this.layoutAttributes), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.collisionVertexBuffer = t.createVertexBuffer(this.collisionVertexArray, Hl.members, !0), this.collisionVertexBufferExt = t.createVertexBuffer(this.collisionVertexArrayExt, Yl.members, !0);
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.segments.destroy(), this.collisionVertexBuffer.destroy(), this.collisionVertexBufferExt.destroy());
        }
      }]);

      return Pc;
    }();

    Gi("CollisionBuffers", Pc);

    var Vc = /*#__PURE__*/function () {
      function Vc(t) {
        _classCallCheck(this, Vc);

        this.collisionBoxArray = t.collisionBoxArray, this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
          return t.id;
        }), this.index = t.index, this.pixelRatio = t.pixelRatio, this.sourceLayerIndex = t.sourceLayerIndex, this.hasPattern = !1, this.hasRTLText = !1, this.sortKeyRanges = [], this.collisionCircleArray = [], this.placementInvProjMatrix = qa([]), this.placementViewportMatrix = qa([]);
        var e = this.layers[0]._unevaluatedLayout._values;
        this.textSizeData = Ql(this.zoom, e["text-size"]), this.iconSizeData = Ql(this.zoom, e["icon-size"]);
        var r = this.layers[0].layout,
            i = r.get("symbol-sort-key"),
            n = r.get("symbol-z-order");
        this.canOverlap = r.get("text-allow-overlap") || r.get("icon-allow-overlap") || r.get("text-ignore-placement") || r.get("icon-ignore-placement"), this.sortFeaturesByKey = "viewport-y" !== n && void 0 !== i.constantOr(1), this.sortFeaturesByY = ("viewport-y" === n || "auto" === n && !this.sortFeaturesByKey) && this.canOverlap, "point" === r.get("symbol-placement") && (this.writingModes = r.get("text-writing-mode").map(function (t) {
          return Bu[t];
        })), this.stateDependentLayerIds = this.layers.filter(function (t) {
          return t.isStateDependent();
        }).map(function (t) {
          return t.id;
        }), this.sourceID = t.sourceID;
      }

      _createClass(Vc, [{
        key: "createArrays",
        value: function createArrays() {
          this.text = new Cc(new ua(this.layers, this.zoom, function (t) {
            return /^text/.test(t);
          })), this.icon = new Cc(new ua(this.layers, this.zoom, function (t) {
            return /^icon/.test(t);
          })), this.glyphOffsetArray = new Fs(), this.lineVertexArray = new Rs(), this.symbolInstances = new Vs();
        }
      }, {
        key: "calculateGlyphDependencies",
        value: function calculateGlyphDependencies(t, e, r, i, n) {
          for (var _s67 = 0; _s67 < t.length; _s67++) {
            if (e[t.charCodeAt(_s67)] = !0, (r || i) && n) {
              var _r139 = nu[t.charAt(_s67)];
              _r139 && (e[_r139.charCodeAt(0)] = !0);
            }
          }
        }
      }, {
        key: "populate",
        value: function populate(t, e, r) {
          var i = this.layers[0],
              n = i.layout,
              s = n.get("text-font"),
              a = n.get("text-field"),
              o = n.get("icon-image"),
              l = ("constant" !== a.value.kind || a.value.value instanceof he && !a.value.value.isEmpty() || a.value.value.toString().length > 0) && ("constant" !== s.value.kind || s.value.value.length > 0),
              u = "constant" !== o.value.kind || !!o.value.value || Object.keys(o.parameters).length > 0,
              c = n.get("symbol-sort-key");
          if (this.features = [], !l && !u) return;
          var h = e.iconDependencies,
              p = e.glyphDependencies,
              d = e.availableImages,
              f = new qn(this.zoom);

          for (var {
            feature: _e133,
            id: _a59,
            index: _o32,
            sourceLayerIndex: _y5
          } of t) {
            var _t142 = i._featureFilter.needGeometry,
                _m6 = va(_e133, _t142);

            if (!i._featureFilter.filter(f, _m6, r)) continue;

            var _g6 = void 0,
                _x6 = void 0;

            if (_t142 || (_m6.geometry = xa(_e133)), l) {
              var _t143 = i.getValueAndResolveTokens("text-field", _m6, r, d),
                  _e134 = he.factory(_t143);

              Dc(_e134) && (this.hasRTLText = !0), (!this.hasRTLText || "unavailable" === Un() || this.hasRTLText && $n.isParsed()) && (_g6 = iu(_e134, i, _m6));
            }

            if (u) {
              var _t144 = i.getValueAndResolveTokens("icon-image", _m6, r, d);

              _x6 = _t144 instanceof pe ? _t144 : pe.fromString(_t144);
            }

            if (!_g6 && !_x6) continue;

            var _v5 = this.sortFeaturesByKey ? c.evaluate(_m6, {}, r) : void 0;

            if (this.features.push({
              id: _a59,
              text: _g6,
              icon: _x6,
              index: _o32,
              sourceLayerIndex: _y5,
              geometry: _m6.geometry,
              properties: _e133.properties,
              type: zc[_e133.type],
              sortKey: _v5
            }), _x6 && (h[_x6.name] = !0), _g6) {
              var _t145 = s.evaluate(_m6, {}, r).join(","),
                  _e135 = "map" === n.get("text-rotation-alignment") && "point" !== n.get("symbol-placement");

              this.allowVerticalPlacement = this.writingModes && this.writingModes.indexOf(Bu.vertical) >= 0;

              for (var _r140 of _g6.sections) {
                if (_r140.image) h[_r140.image.name] = !0;else {
                  var _i90 = Sn(_g6.toString()),
                      _n78 = _r140.fontStack || _t145,
                      _s68 = p[_n78] = p[_n78] || {};

                  this.calculateGlyphDependencies(_r140.text, _s68, _e135, this.allowVerticalPlacement, _i90);
                }
              }
            }
          }

          "line" === n.get("symbol-placement") && (this.features = function (t) {
            var e = {},
                r = {},
                i = [];
            var n = 0;

            function s(e) {
              i.push(t[e]), n++;
            }

            function a(t, e, n) {
              var s = r[t];
              return delete r[t], r[e] = s, i[s].geometry[0].pop(), i[s].geometry[0] = i[s].geometry[0].concat(n[0]), s;
            }

            function o(t, r, n) {
              var s = e[r];
              return delete e[r], e[t] = s, i[s].geometry[0].shift(), i[s].geometry[0] = n[0].concat(i[s].geometry[0]), s;
            }

            function l(t, e, r) {
              var i = r ? e[0][e[0].length - 1] : e[0][0];
              return "".concat(t, ":").concat(i.x, ":").concat(i.y);
            }

            for (var _u20 = 0; _u20 < t.length; _u20++) {
              var _c13 = t[_u20],
                  _h7 = _c13.geometry,
                  _p7 = _c13.text ? _c13.text.toString() : null;

              if (!_p7) {
                s(_u20);
                continue;
              }

              var _d5 = l(_p7, _h7),
                  _f6 = l(_p7, _h7, !0);

              if (_d5 in r && _f6 in e && r[_d5] !== e[_f6]) {
                var _t146 = o(_d5, _f6, _h7),
                    _n79 = a(_d5, _f6, i[_t146].geometry);

                delete e[_d5], delete r[_f6], r[l(_p7, i[_n79].geometry, !0)] = _n79, i[_t146].geometry = null;
              } else _d5 in r ? a(_d5, _f6, _h7) : _f6 in e ? o(_d5, _f6, _h7) : (s(_u20), e[_d5] = n - 1, r[_f6] = n - 1);
            }

            return i.filter(function (t) {
              return t.geometry;
            });
          }(this.features)), this.sortFeaturesByKey && this.features.sort(function (t, e) {
            return t.sortKey - e.sortKey;
          });
        }
      }, {
        key: "update",
        value: function update(t, e, r) {
          this.stateDependentLayers.length && (this.text.programConfigurations.updatePaintArrays(t, e, this.layers, r), this.icon.programConfigurations.updatePaintArrays(t, e, this.layers, r));
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.symbolInstances.length && !this.hasRTLText;
        }
      }, {
        key: "uploadPending",
        value: function uploadPending() {
          return !this.uploaded || this.text.programConfigurations.needsUpload || this.icon.programConfigurations.needsUpload;
        }
      }, {
        key: "upload",
        value: function upload(t) {
          !this.uploaded && this.hasDebugData() && (this.textCollisionBox.upload(t), this.iconCollisionBox.upload(t)), this.text.upload(t, this.sortFeaturesByY, !this.uploaded, this.text.programConfigurations.needsUpload), this.icon.upload(t, this.sortFeaturesByY, !this.uploaded, this.icon.programConfigurations.needsUpload), this.uploaded = !0;
        }
      }, {
        key: "destroyDebugData",
        value: function destroyDebugData() {
          this.textCollisionBox.destroy(), this.iconCollisionBox.destroy();
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.text.destroy(), this.icon.destroy(), this.hasDebugData() && this.destroyDebugData();
        }
      }, {
        key: "addToLineVertexArray",
        value: function addToLineVertexArray(t, e) {
          var r = this.lineVertexArray.length;

          if (void 0 !== t.segment) {
            var _r141 = t.dist(e[t.segment + 1]),
                _i91 = t.dist(e[t.segment]);

            var _n80 = {};

            for (var _i92 = t.segment + 1; _i92 < e.length; _i92++) {
              _n80[_i92] = {
                x: e[_i92].x,
                y: e[_i92].y,
                tileUnitDistanceFromAnchor: _r141
              }, _i92 < e.length - 1 && (_r141 += e[_i92 + 1].dist(e[_i92]));
            }

            for (var _r142 = t.segment || 0; _r142 >= 0; _r142--) {
              _n80[_r142] = {
                x: e[_r142].x,
                y: e[_r142].y,
                tileUnitDistanceFromAnchor: _i91
              }, _r142 > 0 && (_i91 += e[_r142 - 1].dist(e[_r142]));
            }

            for (var _t147 = 0; _t147 < e.length; _t147++) {
              var _e136 = _n80[_t147];
              this.lineVertexArray.emplaceBack(_e136.x, _e136.y, _e136.tileUnitDistanceFromAnchor);
            }
          }

          return {
            lineStartIndex: r,
            lineLength: this.lineVertexArray.length - r
          };
        }
      }, {
        key: "addSymbols",
        value: function addSymbols(t, e, r, i, n, s, a, o, l, u, c, h) {
          var p = t.indexArray,
              d = t.layoutVertexArray,
              f = t.segments.prepareSegment(4 * e.length, d, p, this.canOverlap ? s.sortKey : void 0),
              y = this.glyphOffsetArray.length,
              m = f.vertexLength,
              g = this.allowVerticalPlacement && a === Bu.vertical ? Math.PI / 2 : 0,
              x = s.text && s.text.sections;

          for (var _i93 = 0; _i93 < e.length; _i93++) {
            var {
              tl: _n81,
              tr: _a60,
              bl: _l24,
              br: _u21,
              tex: _c14,
              pixelOffsetTL: _y6,
              pixelOffsetBR: _m7,
              minFontScaleX: _v6,
              minFontScaleY: _b5,
              glyphOffset: _w5,
              isSDF: _7,
              sectionIndex: _k5
            } = e[_i93],
                _A5 = f.vertexLength,
                _S3 = _w5[1];
            Mc(d, o.x, o.y, _n81.x, _S3 + _n81.y, _c14.x, _c14.y, r, _7, _y6.x, _y6.y, _v6, _b5), Mc(d, o.x, o.y, _a60.x, _S3 + _a60.y, _c14.x + _c14.w, _c14.y, r, _7, _m7.x, _y6.y, _v6, _b5), Mc(d, o.x, o.y, _l24.x, _S3 + _l24.y, _c14.x, _c14.y + _c14.h, r, _7, _y6.x, _m7.y, _v6, _b5), Mc(d, o.x, o.y, _u21.x, _S3 + _u21.y, _c14.x + _c14.w, _c14.y + _c14.h, r, _7, _m7.x, _m7.y, _v6, _b5), Bc(t.dynamicLayoutVertexArray, o, g), p.emplaceBack(_A5, _A5 + 1, _A5 + 2), p.emplaceBack(_A5 + 1, _A5 + 2, _A5 + 3), f.vertexLength += 4, f.primitiveLength += 2, this.glyphOffsetArray.emplaceBack(_w5[0]), _i93 !== e.length - 1 && _k5 === e[_i93 + 1].sectionIndex || t.programConfigurations.populatePaintArrays(d.length, s, s.index, {}, h, x && x[_k5]);
          }

          t.placedSymbolArray.emplaceBack(o.x, o.y, y, this.glyphOffsetArray.length - y, m, l, u, o.segment, r ? r[0] : 0, r ? r[1] : 0, i[0], i[1], a, 0, !1, 0, c);
        }
      }, {
        key: "_commitLayoutVertex",
        value: function _commitLayoutVertex(t, e, r, i, n) {
          t.emplaceBack(e.x, e.y, r, i, Math.round(n.x), Math.round(n.y));
        }
      }, {
        key: "_addCollisionDebugVertices",
        value: function _addCollisionDebugVertices(t, e, r, n, s) {
          var a = r.segments.prepareSegment(4, r.layoutVertexArray, r.indexArray),
              o = a.vertexLength,
              l = s.anchorX,
              u = s.anchorY;

          for (var _t148 = 0; _t148 < 4; _t148++) {
            r.collisionVertexArray.emplaceBack(0, 0, 0, 0);
          }

          r.collisionVertexArrayExt.emplaceBack(e, -t.padding, -t.padding), r.collisionVertexArrayExt.emplaceBack(e, t.padding, -t.padding), r.collisionVertexArrayExt.emplaceBack(e, t.padding, t.padding), r.collisionVertexArrayExt.emplaceBack(e, -t.padding, t.padding), this._commitLayoutVertex(r.layoutVertexArray, n, l, u, new i(t.x1, t.y1)), this._commitLayoutVertex(r.layoutVertexArray, n, l, u, new i(t.x2, t.y1)), this._commitLayoutVertex(r.layoutVertexArray, n, l, u, new i(t.x2, t.y2)), this._commitLayoutVertex(r.layoutVertexArray, n, l, u, new i(t.x1, t.y2)), a.vertexLength += 4;
          var c = r.indexArray;
          c.emplaceBack(o, o + 1), c.emplaceBack(o + 1, o + 2), c.emplaceBack(o + 2, o + 3), c.emplaceBack(o + 3, o), a.primitiveLength += 4;
        }
      }, {
        key: "_addTextDebugCollisionBoxes",
        value: function _addTextDebugCollisionBoxes(t, e, r, i, n, s) {
          for (var _a61 = i; _a61 < n; _a61++) {
            var _i94 = r.get(_a61),
                _n82 = this.getSymbolInstanceTextSize(t, s, e, _a61);

            this._addCollisionDebugVertices(_i94, _n82, this.textCollisionBox, _i94.anchorPoint, s);
          }
        }
      }, {
        key: "_addIconDebugCollisionBoxes",
        value: function _addIconDebugCollisionBoxes(t, e, r, i, n, s) {
          for (var _a62 = i; _a62 < n; _a62++) {
            var _i95 = r.get(_a62),
                _n83 = this.getSymbolInstanceIconSize(t, e, _a62);

            this._addCollisionDebugVertices(_i95, _n83, this.iconCollisionBox, _i95.anchorPoint, s);
          }
        }
      }, {
        key: "generateCollisionDebugBuffers",
        value: function generateCollisionDebugBuffers(t, e) {
          this.hasDebugData() && this.destroyDebugData(), this.textCollisionBox = new Pc(xs, Wl.members, Ts), this.iconCollisionBox = new Pc(xs, Wl.members, Ts);
          var r = eu(this.iconSizeData, t),
              i = eu(this.textSizeData, t);

          for (var _n84 = 0; _n84 < this.symbolInstances.length; _n84++) {
            var _s69 = this.symbolInstances.get(_n84);

            this._addTextDebugCollisionBoxes(i, t, e, _s69.textBoxStartIndex, _s69.textBoxEndIndex, _s69), this._addTextDebugCollisionBoxes(i, t, e, _s69.verticalTextBoxStartIndex, _s69.verticalTextBoxEndIndex, _s69), this._addIconDebugCollisionBoxes(r, t, e, _s69.iconBoxStartIndex, _s69.iconBoxEndIndex, _s69), this._addIconDebugCollisionBoxes(r, t, e, _s69.verticalIconBoxStartIndex, _s69.verticalIconBoxEndIndex, _s69);
          }
        }
      }, {
        key: "getSymbolInstanceTextSize",
        value: function getSymbolInstanceTextSize(t, e, r, i) {
          var n = this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex >= 0 ? e.rightJustifiedTextSymbolIndex : e.centerJustifiedTextSymbolIndex >= 0 ? e.centerJustifiedTextSymbolIndex : e.leftJustifiedTextSymbolIndex >= 0 ? e.leftJustifiedTextSymbolIndex : e.verticalPlacedTextSymbolIndex >= 0 ? e.verticalPlacedTextSymbolIndex : i),
              s = tu(this.textSizeData, t, n) / 24;
          return this.tilePixelRatio * s;
        }
      }, {
        key: "getSymbolInstanceIconSize",
        value: function getSymbolInstanceIconSize(t, e, r) {
          var i = this.icon.placedSymbolArray.get(r),
              n = tu(this.iconSizeData, t, i);
          return this.tilePixelRatio * n;
        }
      }, {
        key: "_commitDebugCollisionVertexUpdate",
        value: function _commitDebugCollisionVertexUpdate(t, e, r) {
          t.emplaceBack(e, -r, -r), t.emplaceBack(e, r, -r), t.emplaceBack(e, r, r), t.emplaceBack(e, -r, r);
        }
      }, {
        key: "_updateTextDebugCollisionBoxes",
        value: function _updateTextDebugCollisionBoxes(t, e, r, i, n, s) {
          for (var _a63 = i; _a63 < n; _a63++) {
            var _i96 = r.get(_a63),
                _n85 = this.getSymbolInstanceTextSize(t, s, e, _a63);

            this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt, _n85, _i96.padding);
          }
        }
      }, {
        key: "_updateIconDebugCollisionBoxes",
        value: function _updateIconDebugCollisionBoxes(t, e, r, i, n) {
          for (var _s70 = i; _s70 < n; _s70++) {
            var _i97 = r.get(_s70),
                _n86 = this.getSymbolInstanceIconSize(t, e, _s70);

            this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt, _n86, _i97.padding);
          }
        }
      }, {
        key: "updateCollisionDebugBuffers",
        value: function updateCollisionDebugBuffers(t, e) {
          if (!this.hasDebugData()) return;
          this.hasTextCollisionBoxData() && this.textCollisionBox.collisionVertexArrayExt.clear(), this.hasIconCollisionBoxData() && this.iconCollisionBox.collisionVertexArrayExt.clear();
          var r = eu(this.iconSizeData, t),
              i = eu(this.textSizeData, t);

          for (var _n87 = 0; _n87 < this.symbolInstances.length; _n87++) {
            var _s71 = this.symbolInstances.get(_n87);

            this._updateTextDebugCollisionBoxes(i, t, e, _s71.textBoxStartIndex, _s71.textBoxEndIndex, _s71), this._updateTextDebugCollisionBoxes(i, t, e, _s71.verticalTextBoxStartIndex, _s71.verticalTextBoxEndIndex, _s71), this._updateIconDebugCollisionBoxes(r, t, e, _s71.iconBoxStartIndex, _s71.iconBoxEndIndex), this._updateIconDebugCollisionBoxes(r, t, e, _s71.verticalIconBoxStartIndex, _s71.verticalIconBoxEndIndex);
          }

          this.hasTextCollisionBoxData() && this.textCollisionBox.collisionVertexBufferExt && this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt), this.hasIconCollisionBoxData() && this.iconCollisionBox.collisionVertexBufferExt && this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt);
        }
      }, {
        key: "_deserializeCollisionBoxesForSymbol",
        value: function _deserializeCollisionBoxesForSymbol(t, e, r, i, n, s, a, o, l) {
          var u = {};

          for (var _i98 = e; _i98 < r; _i98++) {
            var _e137 = t.get(_i98);

            u.textBox = {
              x1: _e137.x1,
              y1: _e137.y1,
              x2: _e137.x2,
              y2: _e137.y2,
              padding: _e137.padding,
              anchorPointX: _e137.anchorPointX,
              anchorPointY: _e137.anchorPointY
            }, u.textFeatureIndex = _e137.featureIndex;
            break;
          }

          for (var _e138 = i; _e138 < n; _e138++) {
            var _r143 = t.get(_e138);

            u.verticalTextBox = {
              x1: _r143.x1,
              y1: _r143.y1,
              x2: _r143.x2,
              y2: _r143.y2,
              padding: _r143.padding,
              anchorPointX: _r143.anchorPointX,
              anchorPointY: _r143.anchorPointY
            }, u.verticalTextFeatureIndex = _r143.featureIndex;
            break;
          }

          for (var _e139 = s; _e139 < a; _e139++) {
            var _r144 = t.get(_e139);

            u.iconBox = {
              x1: _r144.x1,
              y1: _r144.y1,
              x2: _r144.x2,
              y2: _r144.y2,
              padding: _r144.padding,
              anchorPointX: _r144.anchorPointX,
              anchorPointY: _r144.anchorPointY
            }, u.iconFeatureIndex = _r144.featureIndex;
            break;
          }

          for (var _e140 = o; _e140 < l; _e140++) {
            var _r145 = t.get(_e140);

            u.verticalIconBox = {
              x1: _r145.x1,
              y1: _r145.y1,
              x2: _r145.x2,
              y2: _r145.y2,
              padding: _r145.padding,
              anchorPointX: _r145.anchorPointX,
              anchorPointY: _r145.anchorPointY
            }, u.verticalIconFeatureIndex = _r145.featureIndex;
            break;
          }

          return u;
        }
      }, {
        key: "deserializeCollisionBoxes",
        value: function deserializeCollisionBoxes(t) {
          this.collisionArrays = [];

          for (var _e141 = 0; _e141 < this.symbolInstances.length; _e141++) {
            var _r146 = this.symbolInstances.get(_e141);

            this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t, _r146.textBoxStartIndex, _r146.textBoxEndIndex, _r146.verticalTextBoxStartIndex, _r146.verticalTextBoxEndIndex, _r146.iconBoxStartIndex, _r146.iconBoxEndIndex, _r146.verticalIconBoxStartIndex, _r146.verticalIconBoxEndIndex));
          }
        }
      }, {
        key: "hasTextData",
        value: function hasTextData() {
          return this.text.segments.get().length > 0;
        }
      }, {
        key: "hasIconData",
        value: function hasIconData() {
          return this.icon.segments.get().length > 0;
        }
      }, {
        key: "hasDebugData",
        value: function hasDebugData() {
          return this.textCollisionBox && this.iconCollisionBox;
        }
      }, {
        key: "hasTextCollisionBoxData",
        value: function hasTextCollisionBoxData() {
          return this.hasDebugData() && this.textCollisionBox.segments.get().length > 0;
        }
      }, {
        key: "hasIconCollisionBoxData",
        value: function hasIconCollisionBoxData() {
          return this.hasDebugData() && this.iconCollisionBox.segments.get().length > 0;
        }
      }, {
        key: "addIndicesForPlacedSymbol",
        value: function addIndicesForPlacedSymbol(t, e) {
          var r = t.placedSymbolArray.get(e),
              i = r.vertexStartIndex + 4 * r.numGlyphs;

          for (var _e142 = r.vertexStartIndex; _e142 < i; _e142 += 4) {
            t.indexArray.emplaceBack(_e142, _e142 + 1, _e142 + 2), t.indexArray.emplaceBack(_e142 + 1, _e142 + 2, _e142 + 3);
          }
        }
      }, {
        key: "getSortedSymbolIndexes",
        value: function getSortedSymbolIndexes(t) {
          if (this.sortedAngle === t && void 0 !== this.symbolInstanceIndexes) return this.symbolInstanceIndexes;
          var e = Math.sin(t),
              r = Math.cos(t),
              i = [],
              n = [],
              s = [];

          for (var _t149 = 0; _t149 < this.symbolInstances.length; ++_t149) {
            s.push(_t149);

            var _a64 = this.symbolInstances.get(_t149);

            i.push(0 | Math.round(e * _a64.anchorX + r * _a64.anchorY)), n.push(_a64.featureIndex);
          }

          return s.sort(function (t, e) {
            return i[t] - i[e] || n[e] - n[t];
          }), s;
        }
      }, {
        key: "addToSortKeyRanges",
        value: function addToSortKeyRanges(t, e) {
          var r = this.sortKeyRanges[this.sortKeyRanges.length - 1];
          r && r.sortKey === e ? r.symbolInstanceEnd = t + 1 : this.sortKeyRanges.push({
            sortKey: e,
            symbolInstanceStart: t,
            symbolInstanceEnd: t + 1
          });
        }
      }, {
        key: "sortFeatures",
        value: function sortFeatures(t) {
          var _this22 = this;

          if (this.sortFeaturesByY && this.sortedAngle !== t && !(this.text.segments.get().length > 1 || this.icon.segments.get().length > 1)) {
            this.symbolInstanceIndexes = this.getSortedSymbolIndexes(t), this.sortedAngle = t, this.text.indexArray.clear(), this.icon.indexArray.clear(), this.featureSortOrder = [];

            for (var _t150 of this.symbolInstanceIndexes) {
              var _e143 = this.symbolInstances.get(_t150);

              this.featureSortOrder.push(_e143.featureIndex), [_e143.rightJustifiedTextSymbolIndex, _e143.centerJustifiedTextSymbolIndex, _e143.leftJustifiedTextSymbolIndex].forEach(function (t, e, r) {
                t >= 0 && r.indexOf(t) === e && _this22.addIndicesForPlacedSymbol(_this22.text, t);
              }), _e143.verticalPlacedTextSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.text, _e143.verticalPlacedTextSymbolIndex), _e143.placedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, _e143.placedIconSymbolIndex), _e143.verticalPlacedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, _e143.verticalPlacedIconSymbolIndex);
            }

            this.text.indexBuffer && this.text.indexBuffer.updateData(this.text.indexArray), this.icon.indexBuffer && this.icon.indexBuffer.updateData(this.icon.indexArray);
          }
        }
      }]);

      return Vc;
    }();

    Gi("SymbolBucket", Vc, {
      omit: ["layers", "collisionBoxArray", "features", "compareText"]
    }), Vc.MAX_GLYPHS = 65535, Vc.addDynamicAttributes = Bc;
    var Fc = new rs({
      "symbol-placement": new Wn(Ft.layout_symbol["symbol-placement"]),
      "symbol-spacing": new Wn(Ft.layout_symbol["symbol-spacing"]),
      "symbol-avoid-edges": new Wn(Ft.layout_symbol["symbol-avoid-edges"]),
      "symbol-sort-key": new Jn(Ft.layout_symbol["symbol-sort-key"]),
      "symbol-z-order": new Wn(Ft.layout_symbol["symbol-z-order"]),
      "icon-allow-overlap": new Wn(Ft.layout_symbol["icon-allow-overlap"]),
      "icon-ignore-placement": new Wn(Ft.layout_symbol["icon-ignore-placement"]),
      "icon-optional": new Wn(Ft.layout_symbol["icon-optional"]),
      "icon-rotation-alignment": new Wn(Ft.layout_symbol["icon-rotation-alignment"]),
      "icon-size": new Jn(Ft.layout_symbol["icon-size"]),
      "icon-text-fit": new Wn(Ft.layout_symbol["icon-text-fit"]),
      "icon-text-fit-padding": new Wn(Ft.layout_symbol["icon-text-fit-padding"]),
      "icon-image": new Jn(Ft.layout_symbol["icon-image"]),
      "icon-rotate": new Jn(Ft.layout_symbol["icon-rotate"]),
      "icon-padding": new Wn(Ft.layout_symbol["icon-padding"]),
      "icon-keep-upright": new Wn(Ft.layout_symbol["icon-keep-upright"]),
      "icon-offset": new Jn(Ft.layout_symbol["icon-offset"]),
      "icon-anchor": new Jn(Ft.layout_symbol["icon-anchor"]),
      "icon-pitch-alignment": new Wn(Ft.layout_symbol["icon-pitch-alignment"]),
      "text-pitch-alignment": new Wn(Ft.layout_symbol["text-pitch-alignment"]),
      "text-rotation-alignment": new Wn(Ft.layout_symbol["text-rotation-alignment"]),
      "text-field": new Jn(Ft.layout_symbol["text-field"]),
      "text-font": new Jn(Ft.layout_symbol["text-font"]),
      "text-size": new Jn(Ft.layout_symbol["text-size"]),
      "text-max-width": new Jn(Ft.layout_symbol["text-max-width"]),
      "text-line-height": new Wn(Ft.layout_symbol["text-line-height"]),
      "text-letter-spacing": new Jn(Ft.layout_symbol["text-letter-spacing"]),
      "text-justify": new Jn(Ft.layout_symbol["text-justify"]),
      "text-radial-offset": new Jn(Ft.layout_symbol["text-radial-offset"]),
      "text-variable-anchor": new Wn(Ft.layout_symbol["text-variable-anchor"]),
      "text-anchor": new Jn(Ft.layout_symbol["text-anchor"]),
      "text-max-angle": new Wn(Ft.layout_symbol["text-max-angle"]),
      "text-writing-mode": new Wn(Ft.layout_symbol["text-writing-mode"]),
      "text-rotate": new Jn(Ft.layout_symbol["text-rotate"]),
      "text-padding": new Wn(Ft.layout_symbol["text-padding"]),
      "text-keep-upright": new Wn(Ft.layout_symbol["text-keep-upright"]),
      "text-transform": new Jn(Ft.layout_symbol["text-transform"]),
      "text-offset": new Jn(Ft.layout_symbol["text-offset"]),
      "text-allow-overlap": new Wn(Ft.layout_symbol["text-allow-overlap"]),
      "text-ignore-placement": new Wn(Ft.layout_symbol["text-ignore-placement"]),
      "text-optional": new Wn(Ft.layout_symbol["text-optional"])
    });
    var Rc = {
      paint: new rs({
        "icon-opacity": new Jn(Ft.paint_symbol["icon-opacity"]),
        "icon-color": new Jn(Ft.paint_symbol["icon-color"]),
        "icon-halo-color": new Jn(Ft.paint_symbol["icon-halo-color"]),
        "icon-halo-width": new Jn(Ft.paint_symbol["icon-halo-width"]),
        "icon-halo-blur": new Jn(Ft.paint_symbol["icon-halo-blur"]),
        "icon-translate": new Wn(Ft.paint_symbol["icon-translate"]),
        "icon-translate-anchor": new Wn(Ft.paint_symbol["icon-translate-anchor"]),
        "text-opacity": new Jn(Ft.paint_symbol["text-opacity"]),
        "text-color": new Jn(Ft.paint_symbol["text-color"], {
          runtimeType: Kt,
          getOverride: function (t) {
            return t.textColor;
          },
          hasOverride: function (t) {
            return !!t.textColor;
          }
        }),
        "text-halo-color": new Jn(Ft.paint_symbol["text-halo-color"]),
        "text-halo-width": new Jn(Ft.paint_symbol["text-halo-width"]),
        "text-halo-blur": new Jn(Ft.paint_symbol["text-halo-blur"]),
        "text-translate": new Wn(Ft.paint_symbol["text-translate"]),
        "text-translate-anchor": new Wn(Ft.paint_symbol["text-translate-anchor"])
      }),
      layout: Fc
    };

    var Lc = /*#__PURE__*/function () {
      function Lc(t) {
        _classCallCheck(this, Lc);

        this.type = t.property.overrides ? t.property.overrides.runtimeType : jt, this.defaultValue = t;
      }

      _createClass(Lc, [{
        key: "evaluate",
        value: function evaluate(t) {
          if (t.formattedSection) {
            var _e144 = this.defaultValue.property.overrides;
            if (_e144 && _e144.hasOverride(t.formattedSection)) return _e144.getOverride(t.formattedSection);
          }

          return t.feature && t.featureState ? this.defaultValue.evaluate(t.feature, t.featureState) : this.defaultValue.property.specification.default;
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          this.defaultValue.isConstant() || t(this.defaultValue.value._styleExpression.expression);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return null;
        }
      }]);

      return Lc;
    }();

    Gi("FormatSectionOverride", Lc, {
      omit: ["defaultValue"]
    });

    var Uc = /*#__PURE__*/function (_pa) {
      _inherits(Uc, _pa);

      var _super48 = _createSuper(Uc);

      function Uc(t) {
        _classCallCheck(this, Uc);

        return _super48.call(this, t, Rc);
      }

      _createClass(Uc, [{
        key: "recalculate",
        value: function recalculate(t, e) {
          if (_get(_getPrototypeOf(Uc.prototype), "recalculate", this).call(this, t, e), "auto" === this.layout.get("icon-rotation-alignment") && (this.layout._values["icon-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-rotation-alignment") && (this.layout._values["text-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-pitch-alignment") && (this.layout._values["text-pitch-alignment"] = this.layout.get("text-rotation-alignment")), "auto" === this.layout.get("icon-pitch-alignment") && (this.layout._values["icon-pitch-alignment"] = this.layout.get("icon-rotation-alignment")), "point" === this.layout.get("symbol-placement")) {
            var _t151 = this.layout.get("text-writing-mode");

            if (_t151) {
              var _e145 = [];

              for (var _r147 of _t151) {
                _e145.indexOf(_r147) < 0 && _e145.push(_r147);
              }

              this.layout._values["text-writing-mode"] = _e145;
            } else this.layout._values["text-writing-mode"] = ["horizontal"];
          }

          this._setPaintOverrides();
        }
      }, {
        key: "getValueAndResolveTokens",
        value: function getValueAndResolveTokens(t, e, r, i) {
          var n = this.layout.get(t).evaluate(e, {}, r, i),
              s = this._unevaluatedLayout._values[t];
          return s.isDataDriven() || Jr(s.value) || !n ? n : function (t, e) {
            return e.replace(/{([^{}]+)}/g, function (e, r) {
              return r in t ? String(t[r]) : "";
            });
          }(e.properties, n);
        }
      }, {
        key: "createBucket",
        value: function createBucket(t) {
          return new Vc(t);
        }
      }, {
        key: "queryRadius",
        value: function queryRadius() {
          return 0;
        }
      }, {
        key: "queryIntersectsFeature",
        value: function queryIntersectsFeature() {
          return !1;
        }
      }, {
        key: "_setPaintOverrides",
        value: function _setPaintOverrides() {
          for (var _t152 of Rc.paint.overridableProperties) {
            if (!Uc.hasPaintOverride(this.layout, _t152)) continue;

            var _e146 = this.paint.get(_t152),
                _r148 = new Lc(_e146),
                _i99 = new Wr(_r148, _e146.property.specification);

            var _n88 = null;
            _n88 = "constant" === _e146.value.kind || "source" === _e146.value.kind ? new ti("source", _i99) : new ei("composite", _i99, _e146.value.zoomStops, _e146.value._interpolationType), this.paint._values[_t152] = new Hn(_e146.property, _n88, _e146.parameters);
          }
        }
      }, {
        key: "_handleOverridablePaintPropertyUpdate",
        value: function _handleOverridablePaintPropertyUpdate(t, e, r) {
          return !(!this.layout || e.isDataDriven() || r.isDataDriven()) && Uc.hasPaintOverride(this.layout, t);
        }
      }, {
        key: "getProgramConfiguration",
        value: function getProgramConfiguration(t) {
          return new la(this, t);
        }
      }], [{
        key: "hasPaintOverride",
        value: function hasPaintOverride(t, e) {
          var r = t.get("text-field"),
              i = Rc.paint.properties[e];
          var n = !1;

          var s = function (t) {
            for (var _e147 of t) {
              if (i.overrides && i.overrides.hasOverride(_e147)) return void (n = !0);
            }
          };

          if ("constant" === r.value.kind && r.value.value instanceof he) s(r.value.value.sections);else if ("source" === r.value.kind) {
            var _t153 = function (e) {
              n || (e instanceof ge && ye(e.value) === Jt ? s(e.value.sections) : e instanceof we ? s(e.sections) : e.eachChild(_t153));
            },
                _e148 = r.value;

            _e148._styleExpression && _t153(_e148._styleExpression.expression);
          }
          return n;
        }
      }]);

      return Uc;
    }(pa);

    var Oc = {
      paint: new rs({
        "background-color": new Wn(Ft.paint_background["background-color"]),
        "background-pattern": new ts(Ft.paint_background["background-pattern"]),
        "background-opacity": new Wn(Ft.paint_background["background-opacity"])
      })
    },
        $c = {
      paint: new rs({
        "raster-opacity": new Wn(Ft.paint_raster["raster-opacity"]),
        "raster-hue-rotate": new Wn(Ft.paint_raster["raster-hue-rotate"]),
        "raster-brightness-min": new Wn(Ft.paint_raster["raster-brightness-min"]),
        "raster-brightness-max": new Wn(Ft.paint_raster["raster-brightness-max"]),
        "raster-saturation": new Wn(Ft.paint_raster["raster-saturation"]),
        "raster-contrast": new Wn(Ft.paint_raster["raster-contrast"]),
        "raster-resampling": new Wn(Ft.paint_raster["raster-resampling"]),
        "raster-fade-duration": new Wn(Ft.paint_raster["raster-fade-duration"])
      })
    };

    var qc = /*#__PURE__*/function (_pa2) {
      _inherits(qc, _pa2);

      var _super49 = _createSuper(qc);

      function qc(t) {
        var _this23;

        _classCallCheck(this, qc);

        _this23 = _super49.call(this, t, {}), _this23.implementation = t;
        return _this23;
      }

      _createClass(qc, [{
        key: "is3D",
        value: function is3D() {
          return "3d" === this.implementation.renderingMode;
        }
      }, {
        key: "hasOffscreenPass",
        value: function hasOffscreenPass() {
          return void 0 !== this.implementation.prerender;
        }
      }, {
        key: "recalculate",
        value: function recalculate() {}
      }, {
        key: "updateTransitions",
        value: function updateTransitions() {}
      }, {
        key: "hasTransition",
        value: function hasTransition() {}
      }, {
        key: "serialize",
        value: function serialize() {}
      }, {
        key: "onAdd",
        value: function onAdd(t) {
          this.implementation.onAdd && this.implementation.onAdd(t, t.painter.context.gl);
        }
      }, {
        key: "onRemove",
        value: function onRemove(t) {
          this.implementation.onRemove && this.implementation.onRemove(t, t.painter.context.gl);
        }
      }]);

      return qc;
    }(pa);

    var Nc = {
      paint: new rs({
        "sky-type": new Wn(Ft.paint_sky["sky-type"]),
        "sky-atmosphere-sun": new Wn(Ft.paint_sky["sky-atmosphere-sun"]),
        "sky-atmosphere-sun-intensity": new Wn(Ft.paint_sky["sky-atmosphere-sun-intensity"]),
        "sky-gradient-center": new Wn(Ft.paint_sky["sky-gradient-center"]),
        "sky-gradient-radius": new Wn(Ft.paint_sky["sky-gradient-radius"]),
        "sky-gradient": new es(Ft.paint_sky["sky-gradient"]),
        "sky-atmosphere-halo-color": new Wn(Ft.paint_sky["sky-atmosphere-halo-color"]),
        "sky-atmosphere-color": new Wn(Ft.paint_sky["sky-atmosphere-color"]),
        "sky-opacity": new Wn(Ft.paint_sky["sky-opacity"])
      })
    };

    function jc(t, e, r) {
      var i = Ka(0, 0, 1),
          n = uo(lo());
      return function (t, e, r) {
        r *= .5;
        var i = e[0],
            n = e[1],
            s = e[2],
            a = e[3],
            o = Math.sin(r),
            l = Math.cos(r);
        t[0] = i * l - s * o, t[1] = n * l + a * o, t[2] = s * l + i * o, t[3] = a * l - n * o;
      }(n, n, r ? -c(t) + Math.PI : c(t)), co(n, n, -c(e)), io(i, i, n), Qa(i, i);
    }

    var Gc = {
      circle: /*#__PURE__*/function (_pa3) {
        _inherits(circle, _pa3);

        var _super50 = _createSuper(circle);

        function circle(t) {
          _classCallCheck(this, circle);

          return _super50.call(this, t, Ua);
        }

        _createClass(circle, [{
          key: "createBucket",
          value: function createBucket(t) {
            return new wa(t);
          }
        }, {
          key: "queryRadius",
          value: function queryRadius(t) {
            var e = t;
            return Pa("circle-radius", this, e) + Pa("circle-stroke-width", this, e) + Va(this.paint.get("circle-translate"));
          }
        }, {
          key: "queryIntersectsFeature",
          value: function queryIntersectsFeature(t, e, r, i, n, s, a, o) {
            var _this24 = this;

            var l = "map" === this.paint.get("circle-pitch-alignment");
            if (l && t.queryGeometry.isAboveHorizon) return !1;
            var u = Ra(this.paint.get("circle-translate"), this.paint.get("circle-translate-anchor"), s.angle, t.pixelToTileUnitsFactor),
                c = this.paint.get("circle-radius").evaluate(e, r) + this.paint.get("circle-stroke-width").evaluate(e, r),
                h = l ? c * t.pixelToTileUnitsFactor : c;

            for (var _e149 of i) {
              var _loop3 = function (_r149) {
                var e = _r149.add(u),
                    i = o && s.elevation ? s.elevation.exaggeration() * o.getElevationAt(e.x, e.y, !0) : 0,
                    n = l ? e : fo(e, i, a),
                    c = l ? t.tilespaceRays.map(function (t) {
                  return go(t, i);
                }) : t.queryGeometry.screenGeometry;

                var p = h;
                var d = oo([], [_r149.x, _r149.y, i, 1], a);
                if ("viewport" === _this24.paint.get("circle-pitch-scale") && "map" === _this24.paint.get("circle-pitch-alignment") ? p *= d[3] / s.cameraToCenterDistance : "map" === _this24.paint.get("circle-pitch-scale") && "viewport" === _this24.paint.get("circle-pitch-alignment") && (p *= s.cameraToCenterDistance / d[3]), ka(c, n, p)) return {
                  v: !0
                };
              };

              for (var _r149 of _e149) {
                var _ret = _loop3(_r149);

                if (_typeof(_ret) === "object") return _ret.v;
              }
            }

            return !1;
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            return ["circle"];
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new la(this, t);
          }
        }]);

        return circle;
      }(pa),
      heatmap: /*#__PURE__*/function (_pa4) {
        _inherits(heatmap, _pa4);

        var _super51 = _createSuper(heatmap);

        function heatmap(t) {
          var _this25;

          _classCallCheck(this, heatmap);

          _this25 = _super51.call(this, t, Ao), _this25._updateColorRamp();
          return _this25;
        }

        _createClass(heatmap, [{
          key: "createBucket",
          value: function createBucket(t) {
            return new xo(t);
          }
        }, {
          key: "_handleSpecialPaintPropertyUpdate",
          value: function _handleSpecialPaintPropertyUpdate(t) {
            "heatmap-color" === t && this._updateColorRamp();
          }
        }, {
          key: "_updateColorRamp",
          value: function _updateColorRamp() {
            this.colorRamp = So({
              expression: this._transitionablePaint._values["heatmap-color"].value.expression,
              evaluationKey: "heatmapDensity",
              image: this.colorRamp
            }), this.colorRampTexture = null;
          }
        }, {
          key: "resize",
          value: function resize() {
            this.heatmapFbo && (this.heatmapFbo.destroy(), this.heatmapFbo = null);
          }
        }, {
          key: "queryRadius",
          value: function queryRadius() {
            return 0;
          }
        }, {
          key: "queryIntersectsFeature",
          value: function queryIntersectsFeature() {
            return !1;
          }
        }, {
          key: "hasOffscreenPass",
          value: function hasOffscreenPass() {
            return 0 !== this.paint.get("heatmap-opacity") && "none" !== this.visibility;
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            return ["heatmap", "heatmapTexture"];
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new la(this, t);
          }
        }]);

        return heatmap;
      }(pa),
      hillshade: /*#__PURE__*/function (_pa5) {
        _inherits(hillshade, _pa5);

        var _super52 = _createSuper(hillshade);

        function hillshade(t) {
          _classCallCheck(this, hillshade);

          return _super52.call(this, t, Io);
        }

        _createClass(hillshade, [{
          key: "hasOffscreenPass",
          value: function hasOffscreenPass() {
            return 0 !== this.paint.get("hillshade-exaggeration") && "none" !== this.visibility;
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            return ["hillshade", "hillshadePrepare"];
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new la(this, t);
          }
        }]);

        return hillshade;
      }(pa),
      fill: /*#__PURE__*/function (_pa6) {
        _inherits(fill, _pa6);

        var _super53 = _createSuper(fill);

        function fill(t) {
          _classCallCheck(this, fill);

          return _super53.call(this, t, pl);
        }

        _createClass(fill, [{
          key: "getProgramIds",
          value: function getProgramIds() {
            var t = this.paint.get("fill-pattern"),
                e = t && t.constantOr(1),
                r = [e ? "fillPattern" : "fill"];
            return this.paint.get("fill-antialias") && r.push(e && !this.getPaintProperty("fill-outline-color") ? "fillOutlinePattern" : "fillOutline"), r;
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new la(this, t);
          }
        }, {
          key: "recalculate",
          value: function recalculate(t, e) {
            _get(_getPrototypeOf(fill.prototype), "recalculate", this).call(this, t, e);

            var r = this.paint._values["fill-outline-color"];
            "constant" === r.value.kind && void 0 === r.value.value && (this.paint._values["fill-outline-color"] = this.paint._values["fill-color"]);
          }
        }, {
          key: "createBucket",
          value: function createBucket(t) {
            return new cl(t);
          }
        }, {
          key: "queryRadius",
          value: function queryRadius() {
            return Va(this.paint.get("fill-translate"));
          }
        }, {
          key: "queryIntersectsFeature",
          value: function queryIntersectsFeature(t, e, r, i, n, s) {
            return !t.queryGeometry.isAboveHorizon && Aa(Fa(t.tilespaceGeometry, this.paint.get("fill-translate"), this.paint.get("fill-translate-anchor"), s.angle, t.pixelToTileUnitsFactor), i);
          }
        }, {
          key: "isTileClipped",
          value: function isTileClipped() {
            return !0;
          }
        }]);

        return fill;
      }(pa),
      "fill-extrusion": /*#__PURE__*/function (_pa7) {
        _inherits(fillExtrusion, _pa7);

        var _super54 = _createSuper(fillExtrusion);

        function fillExtrusion(t) {
          _classCallCheck(this, fillExtrusion);

          return _super54.call(this, t, Bl);
        }

        _createClass(fillExtrusion, [{
          key: "createBucket",
          value: function createBucket(t) {
            return new El(t);
          }
        }, {
          key: "queryRadius",
          value: function queryRadius() {
            return Va(this.paint.get("fill-extrusion-translate"));
          }
        }, {
          key: "is3D",
          value: function is3D() {
            return !0;
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            return [this.paint.get("fill-extrusion-pattern").constantOr(1) ? "fillExtrusionPattern" : "fillExtrusion"];
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new la(this, t);
          }
        }, {
          key: "queryIntersectsFeature",
          value: function queryIntersectsFeature(t, e, r, n, s, a, o, l, u) {
            var c = Ra(this.paint.get("fill-extrusion-translate"), this.paint.get("fill-extrusion-translate-anchor"), a.angle, t.pixelToTileUnitsFactor),
                h = this.paint.get("fill-extrusion-height").evaluate(e, r),
                p = this.paint.get("fill-extrusion-base").evaluate(e, r),
                d = [0, 0],
                f = l && a.elevation,
                y = a.elevation ? a.elevation.exaggeration() : 1;

            if (f) {
              var _e150 = t.tile.getBucket(this).centroidVertexArray,
                  _r150 = u + 1;

              if (_r150 < _e150.length) {
                var _t154 = _e150.get(_r150);

                d[0] = _t154.a_centroid_pos0, d[1] = _t154.a_centroid_pos1;
              }
            }

            if (0 === d[0] && 1 === d[1]) return !1;

            var m = function (t, e, r, n, s, a, o, l, u) {
              return a ? function (t, e, r, i, n, s, a, o, l) {
                var u = [],
                    c = [],
                    h = [0, 0, 0];

                for (var _p8 of t) {
                  var _t155 = [],
                      _d6 = [];

                  for (var _u22 of _p8) {
                    var _c15 = _u22.x + i.x,
                        _p9 = _u22.y + i.y,
                        _f7 = Vl(_c15, _p9, e, r, s, a, o, l);

                    h[0] = _c15, h[1] = _p9, h[2] = _f7.base;

                    var _y7 = Pl(ro(h, h, n));

                    h[0] = _c15, h[1] = _p9, h[2] = _f7.top;

                    var _m8 = Pl(ro(h, h, n));

                    _t155.push(_y7), _d6.push(_m8);
                  }

                  u.push(_t155), c.push(_d6);
                }

                return [u, c];
              }(t, e, r, n, s, a, o, l, u) : function (t, e, r, n, s) {
                var a = [],
                    o = [],
                    l = s[8] * e,
                    u = s[9] * e,
                    c = s[10] * e,
                    h = s[11] * e,
                    p = s[8] * r,
                    d = s[9] * r,
                    f = s[10] * r,
                    y = s[11] * r;

                for (var _e151 of t) {
                  var _t156 = [],
                      _r151 = [];

                  for (var _a65 of _e151) {
                    var _e152 = _a65.x + n.x,
                        _o33 = _a65.y + n.y,
                        _m9 = s[0] * _e152 + s[4] * _o33 + s[12],
                        _g7 = s[1] * _e152 + s[5] * _o33 + s[13],
                        _x7 = s[2] * _e152 + s[6] * _o33 + s[14],
                        _v7 = s[3] * _e152 + s[7] * _o33 + s[15],
                        _b6 = _x7 + c,
                        _w6 = _v7 + h,
                        _8 = _m9 + p,
                        _k6 = _g7 + d,
                        _A6 = _x7 + f,
                        _S4 = _v7 + y,
                        _I2 = new i((_m9 + l) / _w6, (_g7 + u) / _w6);

                    _I2.z = _b6 / _w6, _t156.push(_I2);

                    var _T2 = new i(_8 / _S4, _k6 / _S4);

                    _T2.z = _A6 / _S4, _r151.push(_T2);
                  }

                  a.push(_t156), o.push(_r151);
                }

                return [a, o];
              }(t, e, r, n, s);
            }(n, p, h, c, o, f ? l : null, d, y, a.center.lat),
                g = t.queryGeometry;

            return function (t, e, r) {
              var i = 1 / 0;
              Aa(r, e) && (i = Cl(r, e[0]));

              for (var _n89 = 0; _n89 < e.length; _n89++) {
                var _s72 = e[_n89],
                    _a66 = t[_n89];

                for (var _t157 = 0; _t157 < _s72.length - 1; _t157++) {
                  var _e153 = _s72[_t157],
                      _n90 = [_e153, _s72[_t157 + 1], _a66[_t157 + 1], _a66[_t157], _e153];
                  _a(r, _n90) && (i = Math.min(i, Cl(r, _n90)));
                }
              }

              return i !== 1 / 0 && i;
            }(m[0], m[1], g.isPointQuery() ? g.screenBounds : g.screenGeometry);
          }
        }]);

        return fillExtrusion;
      }(pa),
      line: /*#__PURE__*/function (_pa8) {
        _inherits(line, _pa8);

        var _super55 = _createSuper(line);

        function line(t) {
          var _this26;

          _classCallCheck(this, line);

          _this26 = _super55.call(this, t, jl), _this26.gradientVersion = 0;
          return _this26;
        }

        _createClass(line, [{
          key: "_handleSpecialPaintPropertyUpdate",
          value: function _handleSpecialPaintPropertyUpdate(t) {
            "line-gradient" === t && (this.stepInterpolant = this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof We, this.gradientVersion = (this.gradientVersion + 1) % o);
          }
        }, {
          key: "gradientExpression",
          value: function gradientExpression() {
            return this._transitionablePaint._values["line-gradient"].value.expression;
          }
        }, {
          key: "recalculate",
          value: function recalculate(t, e) {
            _get(_getPrototypeOf(line.prototype), "recalculate", this).call(this, t, e), this.paint._values["line-floorwidth"] = Gl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value, t);
          }
        }, {
          key: "createBucket",
          value: function createBucket(t) {
            return new ql(t);
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            var t = this.paint.get("line-dasharray"),
                e = this.paint.get("line-pattern").constantOr(1),
                r = this.paint.get("line-gradient");
            return [e ? "linePattern" : t ? "lineSDF" : r ? "lineGradient" : "line"];
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new la(this, t);
          }
        }, {
          key: "queryRadius",
          value: function queryRadius(t) {
            var e = t,
                r = Zl(Pa("line-width", this, e), Pa("line-gap-width", this, e)),
                i = Pa("line-offset", this, e);
            return r / 2 + Math.abs(i) + Va(this.paint.get("line-translate"));
          }
        }, {
          key: "queryIntersectsFeature",
          value: function queryIntersectsFeature(t, e, r, n, s, a) {
            if (t.queryGeometry.isAboveHorizon) return !1;
            var o = Fa(t.tilespaceGeometry, this.paint.get("line-translate"), this.paint.get("line-translate-anchor"), a.angle, t.pixelToTileUnitsFactor),
                l = t.pixelToTileUnitsFactor / 2 * Zl(this.paint.get("line-width").evaluate(e, r), this.paint.get("line-gap-width").evaluate(e, r)),
                u = this.paint.get("line-offset").evaluate(e, r);
            return u && (n = function (t, e) {
              var r = [],
                  n = new i(0, 0);

              for (var _i100 = 0; _i100 < t.length; _i100++) {
                var _s73 = t[_i100],
                    _a67 = [];

                for (var _t158 = 0; _t158 < _s73.length; _t158++) {
                  var _r152 = _s73[_t158 - 1],
                      _i101 = _s73[_t158],
                      _o34 = _s73[_t158 + 1],
                      _l25 = 0 === _t158 ? n : _i101.sub(_r152)._unit()._perp(),
                      _u23 = _t158 === _s73.length - 1 ? n : _o34.sub(_i101)._unit()._perp(),
                      _c16 = _l25._add(_u23)._unit();

                  _c16._mult(1 / (_c16.x * _u23.x + _c16.y * _u23.y)), _a67.push(_c16._mult(e)._add(_i101));
                }

                r.push(_a67);
              }

              return r;
            }(n, u * t.pixelToTileUnitsFactor)), function (t, e, r) {
              for (var _i102 = 0; _i102 < e.length; _i102++) {
                var _n91 = e[_i102];
                if (t.length >= 3) for (var _e154 = 0; _e154 < _n91.length; _e154++) {
                  if (Ba(t, _n91[_e154])) return !0;
                }
                if (Sa(t, _n91, r)) return !0;
              }

              return !1;
            }(o, n, l);
          }
        }, {
          key: "isTileClipped",
          value: function isTileClipped() {
            return !0;
          }
        }]);

        return line;
      }(pa),
      symbol: Uc,
      background: /*#__PURE__*/function (_pa9) {
        _inherits(background, _pa9);

        var _super56 = _createSuper(background);

        function background(t) {
          _classCallCheck(this, background);

          return _super56.call(this, t, Oc);
        }

        _createClass(background, [{
          key: "getProgramIds",
          value: function getProgramIds() {
            return [this.paint.get("background-pattern") ? "backgroundPattern" : "background"];
          }
        }]);

        return background;
      }(pa),
      raster: /*#__PURE__*/function (_pa10) {
        _inherits(raster, _pa10);

        var _super57 = _createSuper(raster);

        function raster(t) {
          _classCallCheck(this, raster);

          return _super57.call(this, t, $c);
        }

        _createClass(raster, [{
          key: "getProgramIds",
          value: function getProgramIds() {
            return ["raster"];
          }
        }]);

        return raster;
      }(pa),
      sky: /*#__PURE__*/function (_pa11) {
        _inherits(sky, _pa11);

        var _super58 = _createSuper(sky);

        function sky(t) {
          var _this27;

          _classCallCheck(this, sky);

          _this27 = _super58.call(this, t, Nc), _this27._updateColorRamp();
          return _this27;
        }

        _createClass(sky, [{
          key: "_handleSpecialPaintPropertyUpdate",
          value: function _handleSpecialPaintPropertyUpdate(t) {
            "sky-gradient" === t ? this._updateColorRamp() : "sky-atmosphere-sun" !== t && "sky-atmosphere-halo-color" !== t && "sky-atmosphere-color" !== t && "sky-atmosphere-sun-intensity" !== t || (this._skyboxInvalidated = !0);
          }
        }, {
          key: "_updateColorRamp",
          value: function _updateColorRamp() {
            this.colorRamp = So({
              expression: this._transitionablePaint._values["sky-gradient"].value.expression,
              evaluationKey: "skyRadialProgress"
            }), this.colorRampTexture && (this.colorRampTexture.destroy(), this.colorRampTexture = null);
          }
        }, {
          key: "needsSkyboxCapture",
          value: function needsSkyboxCapture(t) {
            if (this._skyboxInvalidated || !this.skyboxTexture || !this.skyboxGeometry) return !0;

            if (!this.paint.get("sky-atmosphere-sun")) {
              var _e155 = t.style.light.properties.get("position");

              return this._lightPosition.azimuthal !== _e155.azimuthal || this._lightPosition.polar !== _e155.polar;
            }
          }
        }, {
          key: "getCenter",
          value: function getCenter(t, e) {
            var r = this.paint.get("sky-type");

            if ("atmosphere" === r) {
              var _r153 = this.paint.get("sky-atmosphere-sun"),
                  _i103 = !_r153,
                  _n92 = t.style.light,
                  _s74 = _n92.properties.get("position");

              return _i103 && "viewport" === _n92.properties.get("anchor") && E("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."), _i103 ? jc(_s74.azimuthal, 90 - _s74.polar, e) : jc(_r153[0], 90 - _r153[1], e);
            }

            if ("gradient" === r) {
              var _t159 = this.paint.get("sky-gradient-center");

              return jc(_t159[0], 90 - _t159[1], e);
            }
          }
        }, {
          key: "is3D",
          value: function is3D() {
            return !1;
          }
        }, {
          key: "isSky",
          value: function isSky() {
            return !0;
          }
        }, {
          key: "markSkyboxValid",
          value: function markSkyboxValid(t) {
            this._skyboxInvalidated = !1, this._lightPosition = t.style.light.properties.get("position");
          }
        }, {
          key: "hasOffscreenPass",
          value: function hasOffscreenPass() {
            return !0;
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            var t = this.paint.get("sky-type");
            return "atmosphere" === t ? ["skyboxCapture", "skybox"] : "gradient" === t ? ["skyboxGradient"] : null;
          }
        }]);

        return sky;
      }(pa)
    },
        {
      HTMLImageElement: Zc,
      HTMLCanvasElement: Xc,
      HTMLVideoElement: Kc,
      ImageData: Hc,
      ImageBitmap: Yc
    } = s;

    var Wc = /*#__PURE__*/function () {
      function Wc(t, e, r, i) {
        _classCallCheck(this, Wc);

        this.context = t, this.format = r, this.texture = t.gl.createTexture(), this.update(e, i);
      }

      _createClass(Wc, [{
        key: "update",
        value: function update(t, e, r) {
          var {
            width: i,
            height: n
          } = t,
              s = !(this.size && this.size[0] === i && this.size[1] === n || r),
              {
            context: a
          } = this,
              {
            gl: o
          } = a;
          if (this.useMipmap = Boolean(e && e.useMipmap), o.bindTexture(o.TEXTURE_2D, this.texture), a.pixelStoreUnpackFlipY.set(!1), a.pixelStoreUnpack.set(1), a.pixelStoreUnpackPremultiplyAlpha.set(this.format === o.RGBA && (!e || !1 !== e.premultiply)), s) this.size = [i, n], t instanceof Zc || t instanceof Xc || t instanceof Kc || t instanceof Hc || Yc && t instanceof Yc ? o.texImage2D(o.TEXTURE_2D, 0, this.format, this.format, o.UNSIGNED_BYTE, t) : o.texImage2D(o.TEXTURE_2D, 0, this.format, i, n, 0, this.format, o.UNSIGNED_BYTE, t.data);else {
            var {
              x: _e156,
              y: _s75
            } = r || {
              x: 0,
              y: 0
            };
            t instanceof Zc || t instanceof Xc || t instanceof Kc || t instanceof Hc || Yc && t instanceof Yc ? o.texSubImage2D(o.TEXTURE_2D, 0, _e156, _s75, o.RGBA, o.UNSIGNED_BYTE, t) : o.texSubImage2D(o.TEXTURE_2D, 0, _e156, _s75, i, n, o.RGBA, o.UNSIGNED_BYTE, t.data);
          }
          this.useMipmap && this.isSizePowerOfTwo() && o.generateMipmap(o.TEXTURE_2D);
        }
      }, {
        key: "bind",
        value: function bind(t, e, r) {
          var {
            context: i
          } = this,
              {
            gl: n
          } = i;
          n.bindTexture(n.TEXTURE_2D, this.texture), r !== n.LINEAR_MIPMAP_NEAREST || this.isSizePowerOfTwo() || (r = n.LINEAR), t !== this.filter && (n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MAG_FILTER, t), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MIN_FILTER, r || t), this.filter = t), e !== this.wrap && (n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_S, e), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_T, e), this.wrap = e);
        }
      }, {
        key: "isSizePowerOfTwo",
        value: function isSizePowerOfTwo() {
          return this.size[0] === this.size[1] && Math.log(this.size[0]) / Math.LN2 % 1 == 0;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          var {
            gl: t
          } = this.context;
          t.deleteTexture(this.texture), this.texture = null;
        }
      }]);

      return Wc;
    }();

    var Jc = /*#__PURE__*/function () {
      function Jc(t) {
        var _this28 = this;

        _classCallCheck(this, Jc);

        this._callback = t, this._triggered = !1, "undefined" != typeof MessageChannel && (this._channel = new MessageChannel(), this._channel.port2.onmessage = function () {
          _this28._triggered = !1, _this28._callback();
        });
      }

      _createClass(Jc, [{
        key: "trigger",
        value: function trigger() {
          var _this29 = this;

          this._triggered || (this._triggered = !0, this._channel ? this._channel.port1.postMessage(!0) : setTimeout(function () {
            _this29._triggered = !1, _this29._callback();
          }, 0));
        }
      }, {
        key: "remove",
        value: function remove() {
          delete this._channel, this._callback = function () {};
        }
      }]);

      return Jc;
    }();

    var Qc = s.performance;

    var th = /*#__PURE__*/function () {
      function th(t) {
        _classCallCheck(this, th);

        this._marks = {
          start: [t.url, "start"].join("#"),
          end: [t.url, "end"].join("#"),
          measure: t.url.toString()
        }, Qc.mark(this._marks.start);
      }

      _createClass(th, [{
        key: "finish",
        value: function finish() {
          Qc.mark(this._marks.end);
          var t = Qc.getEntriesByName(this._marks.measure);
          return 0 === t.length && (Qc.measure(this._marks.measure, this._marks.start, this._marks.end), t = Qc.getEntriesByName(this._marks.measure), Qc.clearMarks(this._marks.start), Qc.clearMarks(this._marks.end), Qc.clearMeasures(this._marks.measure)), t;
        }
      }]);

      return th;
    }();

    var eh = /*#__PURE__*/function () {
      function eh() {
        _classCallCheck(this, eh);

        this.tasks = {}, this.taskQueue = [], k(["process"], this), this.invoker = new Jc(this.process), this.nextId = 0;
      }

      _createClass(eh, [{
        key: "add",
        value: function add(t, e) {
          var _this30 = this;

          var r = this.nextId++;
          return this.tasks[r] = {
            fn: t,
            metadata: e,
            priority: rh(e),
            id: r
          }, this.taskQueue.push(r), this.invoker.trigger(), {
            cancel: function () {
              delete _this30.tasks[r];
            }
          };
        }
      }, {
        key: "process",
        value: function process() {
          var _this31 = this;

          D();

          try {
            if (this.taskQueue = this.taskQueue.filter(function (t) {
              return !!_this31.tasks[t];
            }), !this.taskQueue.length) return;

            var _t160 = this.pick();

            if (null === _t160) return;
            var _e157 = this.tasks[_t160];
            if (delete this.tasks[_t160], this.taskQueue.length && this.invoker.trigger(), !_e157) return;

            _e157.fn();
          } finally {}
        }
      }, {
        key: "pick",
        value: function pick() {
          var t = null,
              e = 1 / 0;

          for (var _r154 = 0; _r154 < this.taskQueue.length; _r154++) {
            var _i104 = this.tasks[this.taskQueue[_r154]];
            _i104.priority < e && (e = _i104.priority, t = _r154);
          }

          if (null === t) return null;
          var r = this.taskQueue[t];
          return this.taskQueue.splice(t, 1), r;
        }
      }, {
        key: "remove",
        value: function remove() {
          this.invoker.remove();
        }
      }]);

      return eh;
    }();

    function rh(_ref65) {
      var {
        type: t,
        isSymbolTile: e,
        zoom: r
      } = _ref65;
      return r = r || 0, "message" === t ? 0 : "maybePrepare" !== t || e ? "parseTile" !== t || e ? "parseTile" === t && e ? 300 - r : "maybePrepare" === t && e ? 400 - r : 500 : 200 - r : 100 - r;
    }

    var ih = /*#__PURE__*/function () {
      function ih(t, e) {
        _classCallCheck(this, ih);

        t && (e ? this.setSouthWest(t).setNorthEast(e) : 4 === t.length ? this.setSouthWest([t[0], t[1]]).setNorthEast([t[2], t[3]]) : this.setSouthWest(t[0]).setNorthEast(t[1]));
      }

      _createClass(ih, [{
        key: "setNorthEast",
        value: function setNorthEast(t) {
          return this._ne = t instanceof nh ? new nh(t.lng, t.lat) : nh.convert(t), this;
        }
      }, {
        key: "setSouthWest",
        value: function setSouthWest(t) {
          return this._sw = t instanceof nh ? new nh(t.lng, t.lat) : nh.convert(t), this;
        }
      }, {
        key: "extend",
        value: function extend(t) {
          var e = this._sw,
              r = this._ne;
          var i, n;
          if (t instanceof nh) i = t, n = t;else {
            if (!(t instanceof ih)) return Array.isArray(t) ? 4 === t.length || t.every(Array.isArray) ? this.extend(ih.convert(t)) : this.extend(nh.convert(t)) : this;
            if (i = t._sw, n = t._ne, !i || !n) return this;
          }
          return e || r ? (e.lng = Math.min(i.lng, e.lng), e.lat = Math.min(i.lat, e.lat), r.lng = Math.max(n.lng, r.lng), r.lat = Math.max(n.lat, r.lat)) : (this._sw = new nh(i.lng, i.lat), this._ne = new nh(n.lng, n.lat)), this;
        }
      }, {
        key: "getCenter",
        value: function getCenter() {
          return new nh((this._sw.lng + this._ne.lng) / 2, (this._sw.lat + this._ne.lat) / 2);
        }
      }, {
        key: "getSouthWest",
        value: function getSouthWest() {
          return this._sw;
        }
      }, {
        key: "getNorthEast",
        value: function getNorthEast() {
          return this._ne;
        }
      }, {
        key: "getNorthWest",
        value: function getNorthWest() {
          return new nh(this.getWest(), this.getNorth());
        }
      }, {
        key: "getSouthEast",
        value: function getSouthEast() {
          return new nh(this.getEast(), this.getSouth());
        }
      }, {
        key: "getWest",
        value: function getWest() {
          return this._sw.lng;
        }
      }, {
        key: "getSouth",
        value: function getSouth() {
          return this._sw.lat;
        }
      }, {
        key: "getEast",
        value: function getEast() {
          return this._ne.lng;
        }
      }, {
        key: "getNorth",
        value: function getNorth() {
          return this._ne.lat;
        }
      }, {
        key: "toArray",
        value: function toArray() {
          return [this._sw.toArray(), this._ne.toArray()];
        }
      }, {
        key: "toString",
        value: function toString() {
          return "LngLatBounds(".concat(this._sw.toString(), ", ").concat(this._ne.toString(), ")");
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return !(this._sw && this._ne);
        }
      }, {
        key: "contains",
        value: function contains(t) {
          var {
            lng: e,
            lat: r
          } = nh.convert(t);
          var i = this._sw.lng <= e && e <= this._ne.lng;
          return this._sw.lng > this._ne.lng && (i = this._sw.lng >= e && e >= this._ne.lng), this._sw.lat <= r && r <= this._ne.lat && i;
        }
      }], [{
        key: "convert",
        value: function convert(t) {
          return !t || t instanceof ih ? t : new ih(t);
        }
      }]);

      return ih;
    }();

    var nh = /*#__PURE__*/function () {
      function nh(t, e) {
        _classCallCheck(this, nh);

        if (isNaN(t) || isNaN(e)) throw new Error("Invalid LngLat object: (".concat(t, ", ").concat(e, ")"));
        if (this.lng = +t, this.lat = +e, this.lat > 90 || this.lat < -90) throw new Error("Invalid LngLat latitude value: must be between -90 and 90");
      }

      _createClass(nh, [{
        key: "wrap",
        value: function wrap() {
          return new nh(y(this.lng, -180, 180), this.lat);
        }
      }, {
        key: "toArray",
        value: function toArray() {
          return [this.lng, this.lat];
        }
      }, {
        key: "toString",
        value: function toString() {
          return "LngLat(".concat(this.lng, ", ").concat(this.lat, ")");
        }
      }, {
        key: "distanceTo",
        value: function distanceTo(t) {
          var e = Math.PI / 180,
              r = this.lat * e,
              i = t.lat * e,
              n = Math.sin(r) * Math.sin(i) + Math.cos(r) * Math.cos(i) * Math.cos((t.lng - this.lng) * e);
          return 6371008.8 * Math.acos(Math.min(n, 1));
        }
      }, {
        key: "toBounds",
        value: function toBounds() {
          var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
          var e = 360 * t / 40075017,
              r = e / Math.cos(Math.PI / 180 * this.lat);
          return new ih(new nh(this.lng - r, this.lat - e), new nh(this.lng + r, this.lat + e));
        }
      }], [{
        key: "convert",
        value: function convert(t) {
          if (t instanceof nh) return t;
          if (Array.isArray(t) && (2 === t.length || 3 === t.length)) return new nh(Number(t[0]), Number(t[1]));
          if (!Array.isArray(t) && "object" == _typeof(t) && null !== t) return new nh(Number("lng" in t ? t.lng : t.lon), Number(t.lat));
          throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]");
        }
      }]);

      return nh;
    }();

    var sh = 2 * Math.PI * 6371008.8;

    function ah(t) {
      return sh * Math.cos(t * Math.PI / 180);
    }

    function oh(t) {
      return (180 + t) / 360;
    }

    function lh(t) {
      return (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t * Math.PI / 360))) / 360;
    }

    function uh(t, e) {
      return t / ah(e);
    }

    function ch(t) {
      return 360 / Math.PI * Math.atan(Math.exp((180 - 360 * t) * Math.PI / 180)) - 90;
    }

    function hh(t, e) {
      return t * ah(ch(e));
    }

    var ph = /*#__PURE__*/function () {
      function ph(t, e) {
        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

        _classCallCheck(this, ph);

        this.x = +t, this.y = +e, this.z = +r;
      }

      _createClass(ph, [{
        key: "toLngLat",
        value: function toLngLat() {
          return new nh(360 * this.x - 180, ch(this.y));
        }
      }, {
        key: "toAltitude",
        value: function toAltitude() {
          return hh(this.z, this.y);
        }
      }, {
        key: "meterInMercatorCoordinateUnits",
        value: function meterInMercatorCoordinateUnits() {
          return 1 / sh * (t = ch(this.y), 1 / Math.cos(t * Math.PI / 180));
          var t;
        }
      }], [{
        key: "fromLngLat",
        value: function fromLngLat(t) {
          var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
          var r = nh.convert(t);
          return new ph(oh(r.lng), lh(r.lat), uh(e, r.lat));
        }
      }]);

      return ph;
    }();

    function dh(t, e, r) {
      var i = 2 * Math.PI * 6378137 / 256 / Math.pow(2, r);
      return [t * i - 2 * Math.PI * 6378137 / 2, e * i - 2 * Math.PI * 6378137 / 2];
    }

    var fh = /*#__PURE__*/function () {
      function fh(t, e, r) {
        _classCallCheck(this, fh);

        this.z = t, this.x = e, this.y = r, this.key = gh(0, t, t, e, r);
      }

      _createClass(fh, [{
        key: "equals",
        value: function equals(t) {
          return this.z === t.z && this.x === t.x && this.y === t.y;
        }
      }, {
        key: "url",
        value: function url(t, e) {
          var r = (n = this.y, s = this.z, a = dh(256 * (i = this.x), 256 * (n = Math.pow(2, s) - n - 1), s), o = dh(256 * (i + 1), 256 * (n + 1), s), a[0] + "," + a[1] + "," + o[0] + "," + o[1]);
          var i, n, s, a, o;

          var l = function (t, e, r) {
            var i,
                n = "";

            for (var _s76 = t; _s76 > 0; _s76--) {
              i = 1 << _s76 - 1, n += (e & i ? 1 : 0) + (r & i ? 2 : 0);
            }

            return n;
          }(this.z, this.x, this.y);

          return t[(this.x + this.y) % t.length].replace("{prefix}", (this.x % 16).toString(16) + (this.y % 16).toString(16)).replace("{z}", String(this.z)).replace("{x}", String(this.x)).replace("{y}", String("tms" === e ? Math.pow(2, this.z) - this.y - 1 : this.y)).replace("{quadkey}", l).replace("{bbox-epsg-3857}", r);
        }
      }, {
        key: "getTilePoint",
        value: function getTilePoint(t) {
          var e = Math.pow(2, this.z);
          return new i(8192 * (t.x * e - this.x), 8192 * (t.y * e - this.y));
        }
      }, {
        key: "getTileVec3",
        value: function getTileVec3(t) {
          var e = Math.pow(2, this.z);
          return Ka(8192 * (t.x * e - this.x), 8192 * (t.y * e - this.y), hh(t.z, t.y));
        }
      }, {
        key: "toString",
        value: function toString() {
          return "".concat(this.z, "/").concat(this.x, "/").concat(this.y);
        }
      }]);

      return fh;
    }();

    var yh = function yh(t, e) {
      _classCallCheck(this, yh);

      this.wrap = t, this.canonical = e, this.key = gh(t, e.z, e.z, e.x, e.y);
    };

    var mh = /*#__PURE__*/function () {
      function mh(t, e, r, i, n) {
        _classCallCheck(this, mh);

        this.overscaledZ = t, this.wrap = e, this.canonical = new fh(r, +i, +n), this.key = 0 === e && t === r ? this.canonical.key : gh(e, t, r, i, n);
      }

      _createClass(mh, [{
        key: "equals",
        value: function equals(t) {
          return this.overscaledZ === t.overscaledZ && this.wrap === t.wrap && this.canonical.equals(t.canonical);
        }
      }, {
        key: "scaledTo",
        value: function scaledTo(t) {
          var e = this.canonical.z - t;
          return t > this.canonical.z ? new mh(t, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y) : new mh(t, this.wrap, t, this.canonical.x >> e, this.canonical.y >> e);
        }
      }, {
        key: "calculateScaledKey",
        value: function calculateScaledKey(t) {
          var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;
          if (this.overscaledZ === t && e) return this.key;
          if (t > this.canonical.z) return gh(this.wrap * +e, t, this.canonical.z, this.canonical.x, this.canonical.y);
          {
            var _r155 = this.canonical.z - t;

            return gh(this.wrap * +e, t, t, this.canonical.x >> _r155, this.canonical.y >> _r155);
          }
        }
      }, {
        key: "isChildOf",
        value: function isChildOf(t) {
          if (t.wrap !== this.wrap) return !1;
          var e = this.canonical.z - t.canonical.z;
          return 0 === t.overscaledZ || t.overscaledZ < this.overscaledZ && t.canonical.x === this.canonical.x >> e && t.canonical.y === this.canonical.y >> e;
        }
      }, {
        key: "children",
        value: function children(t) {
          if (this.overscaledZ >= t) return [new mh(this.overscaledZ + 1, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y)];
          var e = this.canonical.z + 1,
              r = 2 * this.canonical.x,
              i = 2 * this.canonical.y;
          return [new mh(e, this.wrap, e, r, i), new mh(e, this.wrap, e, r + 1, i), new mh(e, this.wrap, e, r, i + 1), new mh(e, this.wrap, e, r + 1, i + 1)];
        }
      }, {
        key: "isLessThan",
        value: function isLessThan(t) {
          return this.wrap < t.wrap || !(this.wrap > t.wrap) && (this.overscaledZ < t.overscaledZ || !(this.overscaledZ > t.overscaledZ) && (this.canonical.x < t.canonical.x || !(this.canonical.x > t.canonical.x) && this.canonical.y < t.canonical.y));
        }
      }, {
        key: "wrapped",
        value: function wrapped() {
          return new mh(this.overscaledZ, 0, this.canonical.z, this.canonical.x, this.canonical.y);
        }
      }, {
        key: "unwrapTo",
        value: function unwrapTo(t) {
          return new mh(this.overscaledZ, t, this.canonical.z, this.canonical.x, this.canonical.y);
        }
      }, {
        key: "overscaleFactor",
        value: function overscaleFactor() {
          return Math.pow(2, this.overscaledZ - this.canonical.z);
        }
      }, {
        key: "toUnwrapped",
        value: function toUnwrapped() {
          return new yh(this.wrap, this.canonical);
        }
      }, {
        key: "toString",
        value: function toString() {
          return "".concat(this.overscaledZ, "/").concat(this.canonical.x, "/").concat(this.canonical.y);
        }
      }, {
        key: "getTilePoint",
        value: function getTilePoint(t) {
          return this.canonical.getTilePoint(new ph(t.x - this.wrap, t.y));
        }
      }, {
        key: "getTileVec3",
        value: function getTileVec3(t) {
          return this.canonical.getTileVec3(new ph(t.x - this.wrap, t.y, t.z));
        }
      }]);

      return mh;
    }();

    function gh(t, e, r, i, n) {
      var s = 1 << Math.min(r, 22);
      var a = s * (n % s) + i % s;
      return t && r < 22 && (a += s * s * ((t < 0 ? -2 * t - 1 : 2 * t) % (1 << 2 * (22 - r)))), 16 * (32 * a + r) + (e - r);
    }

    Gi("CanonicalTileID", fh), Gi("OverscaledTileID", mh, {
      omit: ["posMatrix"]
    });

    var xh = /*#__PURE__*/function () {
      function xh(t) {
        _classCallCheck(this, xh);

        this._stringToNumber = {}, this._numberToString = [];

        for (var _e158 = 0; _e158 < t.length; _e158++) {
          var _r156 = t[_e158];
          this._stringToNumber[_r156] = _e158, this._numberToString[_e158] = _r156;
        }
      }

      _createClass(xh, [{
        key: "encode",
        value: function encode(t) {
          return this._stringToNumber[t];
        }
      }, {
        key: "decode",
        value: function decode(t) {
          return this._numberToString[t];
        }
      }]);

      return xh;
    }();

    var vh = /*#__PURE__*/function () {
      function vh(t, e, r, i, n) {
        _classCallCheck(this, vh);

        this.type = "Feature", this._vectorTileFeature = t, t._z = e, t._x = r, t._y = i, this.properties = t.properties, this.id = n;
      }

      _createClass(vh, [{
        key: "geometry",
        get: function () {
          return void 0 === this._geometry && (this._geometry = this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x, this._vectorTileFeature._y, this._vectorTileFeature._z).geometry), this._geometry;
        },
        set: function (t) {
          this._geometry = t;
        }
      }, {
        key: "toJSON",
        value: function toJSON() {
          var t = {
            geometry: this.geometry
          };

          for (var _e159 in this) {
            "_geometry" !== _e159 && "_vectorTileFeature" !== _e159 && (t[_e159] = this[_e159]);
          }

          return t;
        }
      }]);

      return vh;
    }();

    var bh = os([{
      name: "a_pos",
      type: "Int16",
      components: 2
    }]);

    var wh = /*#__PURE__*/function () {
      function wh(t, e, r) {
        _classCallCheck(this, wh);

        this.tileID = t, this.uid = b(), this.uses = 0, this.tileSize = e, this.tileZoom = r, this.buckets = {}, this.expirationTime = null, this.queryPadding = 0, this.hasSymbolBuckets = !1, this.hasRTLText = !1, this.dependencies = {}, this.expiredRequestCount = 0, this.state = "loading";
      }

      _createClass(wh, [{
        key: "registerFadeDuration",
        value: function registerFadeDuration(t) {
          var e = t + this.timeAdded;
          e < $.now() || this.fadeEndTime && e < this.fadeEndTime || (this.fadeEndTime = e);
        }
      }, {
        key: "wasRequested",
        value: function wasRequested() {
          return "errored" === this.state || "loaded" === this.state || "reloading" === this.state;
        }
      }, {
        key: "loadVectorData",
        value: function loadVectorData(t, e, r) {
          if (this.hasData() && this.unloadVectorData(), this.state = "loaded", t) {
            t.featureIndex && (this.latestFeatureIndex = t.featureIndex, t.rawTileData ? (this.latestRawTileData = t.rawTileData, this.latestFeatureIndex.rawTileData = t.rawTileData) : this.latestRawTileData && (this.latestFeatureIndex.rawTileData = this.latestRawTileData)), this.collisionBoxArray = t.collisionBoxArray, this.buckets = function (t, e) {
              var r = {};
              if (!e) return r;

              var _loop4 = function (_i105) {
                var t = _i105.layerIds.map(function (t) {
                  return e.getLayer(t);
                }).filter(Boolean);

                if (0 !== t.length) {
                  _i105.layers = t, _i105.stateDependentLayerIds && (_i105.stateDependentLayers = _i105.stateDependentLayerIds.map(function (e) {
                    return t.filter(function (t) {
                      return t.id === e;
                    })[0];
                  }));

                  for (var _e160 of t) {
                    r[_e160.id] = _i105;
                  }
                }
              };

              for (var _i105 of t) {
                _loop4(_i105);
              }

              return r;
            }(t.buckets, e.style), this.hasSymbolBuckets = !1;

            for (var _t161 in this.buckets) {
              var _e161 = this.buckets[_t161];

              if (_e161 instanceof Vc) {
                if (this.hasSymbolBuckets = !0, !r) break;
                _e161.justReloaded = !0;
              }
            }

            if (this.hasRTLText = !1, this.hasSymbolBuckets) for (var _t162 in this.buckets) {
              var _e162 = this.buckets[_t162];

              if (_e162 instanceof Vc && _e162.hasRTLText) {
                this.hasRTLText = !0, $n.isLoading() || $n.isLoaded() || "deferred" !== Un() || On();
                break;
              }
            }
            this.queryPadding = 0;

            for (var _t163 in this.buckets) {
              var _r157 = this.buckets[_t163];
              this.queryPadding = Math.max(this.queryPadding, e.style.getLayer(_t163).queryRadius(_r157));
            }

            t.imageAtlas && (this.imageAtlas = t.imageAtlas), t.glyphAtlasImage && (this.glyphAtlasImage = t.glyphAtlasImage);
          } else this.collisionBoxArray = new Bs();
        }
      }, {
        key: "unloadVectorData",
        value: function unloadVectorData() {
          for (var _t164 in this.buckets) {
            this.buckets[_t164].destroy();
          }

          this.buckets = {}, this.imageAtlasTexture && this.imageAtlasTexture.destroy(), this.imageAtlas && (this.imageAtlas = null), this.glyphAtlasTexture && this.glyphAtlasTexture.destroy(), this.latestFeatureIndex = null, this.state = "unloaded";
        }
      }, {
        key: "getBucket",
        value: function getBucket(t) {
          return this.buckets[t.id];
        }
      }, {
        key: "upload",
        value: function upload(t) {
          for (var _e163 in this.buckets) {
            var _r158 = this.buckets[_e163];
            _r158.uploadPending() && _r158.upload(t);
          }

          var e = t.gl;
          this.imageAtlas && !this.imageAtlas.uploaded && (this.imageAtlasTexture = new Wc(t, this.imageAtlas.image, e.RGBA), this.imageAtlas.uploaded = !0), this.glyphAtlasImage && (this.glyphAtlasTexture = new Wc(t, this.glyphAtlasImage, e.ALPHA), this.glyphAtlasImage = null);
        }
      }, {
        key: "prepare",
        value: function prepare(t) {
          this.imageAtlas && this.imageAtlas.patchUpdatedImages(t, this.imageAtlasTexture);
        }
      }, {
        key: "queryRenderedFeatures",
        value: function queryRenderedFeatures(t, e, r, i, n, s, a, o) {
          return this.latestFeatureIndex && this.latestFeatureIndex.rawTileData ? this.latestFeatureIndex.query({
            tileResult: i,
            pixelPosMatrix: a,
            transform: s,
            params: n
          }, t, e, r) : {};
        }
      }, {
        key: "querySourceFeatures",
        value: function querySourceFeatures(t, e) {
          var r = this.latestFeatureIndex;
          if (!r || !r.rawTileData) return;
          var i = r.loadVTLayers(),
              n = e ? e.sourceLayer : "",
              s = i._geojsonTileLayer || i[n];
          if (!s) return;
          var a = pi(e && e.filter),
              {
            z: o,
            x: l,
            y: u
          } = this.tileID.canonical,
              c = {
            z: o,
            x: l,
            y: u
          };

          for (var _e164 = 0; _e164 < s.length; _e164++) {
            var _i106 = s.feature(_e164);

            if (a.needGeometry) {
              var _t165 = va(_i106, !0);

              if (!a.filter(new qn(this.tileID.overscaledZ), _t165, this.tileID.canonical)) continue;
            } else if (!a.filter(new qn(this.tileID.overscaledZ), _i106)) continue;

            var _h8 = r.getId(_i106, n),
                _p10 = new vh(_i106, o, l, u, _h8);

            _p10.tile = c, t.push(_p10);
          }
        }
      }, {
        key: "hasData",
        value: function hasData() {
          return "loaded" === this.state || "reloading" === this.state || "expired" === this.state;
        }
      }, {
        key: "patternsLoaded",
        value: function patternsLoaded() {
          return this.imageAtlas && !!Object.keys(this.imageAtlas.patternPositions).length;
        }
      }, {
        key: "setExpiryData",
        value: function setExpiryData(t) {
          var e = this.expirationTime;

          if (t.cacheControl) {
            var _e165 = C(t.cacheControl);

            _e165["max-age"] && (this.expirationTime = Date.now() + 1e3 * _e165["max-age"]);
          } else t.expires && (this.expirationTime = new Date(t.expires).getTime());

          if (this.expirationTime) {
            var _t166 = Date.now();

            var _r159 = !1;

            if (this.expirationTime > _t166) _r159 = !1;else if (e) {
              if (this.expirationTime < e) _r159 = !0;else {
                var _i107 = this.expirationTime - e;

                _i107 ? this.expirationTime = _t166 + Math.max(_i107, 3e4) : _r159 = !0;
              }
            } else _r159 = !0;
            _r159 ? (this.expiredRequestCount++, this.state = "expired") : this.expiredRequestCount = 0;
          }
        }
      }, {
        key: "getExpiryTimeout",
        value: function getExpiryTimeout() {
          if (this.expirationTime) return this.expiredRequestCount ? 1e3 * (1 << Math.min(this.expiredRequestCount - 1, 31)) : Math.min(this.expirationTime - new Date().getTime(), Math.pow(2, 31) - 1);
        }
      }, {
        key: "setFeatureState",
        value: function setFeatureState(t, e) {
          if (!this.latestFeatureIndex || !this.latestFeatureIndex.rawTileData || 0 === Object.keys(t).length) return;
          var r = this.latestFeatureIndex.loadVTLayers();

          for (var _i108 in this.buckets) {
            if (!e.style.hasLayer(_i108)) continue;

            var _n93 = this.buckets[_i108],
                _s77 = _n93.layers[0].sourceLayer || "_geojsonTileLayer",
                _a68 = r[_s77],
                _o35 = t[_s77];

            if (!_a68 || !_o35 || 0 === Object.keys(_o35).length) continue;

            _n93.update(_o35, _a68, this.imageAtlas && this.imageAtlas.patternPositions || {});

            var _l26 = e && e.style && e.style.getLayer(_i108);

            _l26 && (this.queryPadding = Math.max(this.queryPadding, _l26.queryRadius(_n93)));
          }
        }
      }, {
        key: "holdingForFade",
        value: function holdingForFade() {
          return void 0 !== this.symbolFadeHoldUntil;
        }
      }, {
        key: "symbolFadeFinished",
        value: function symbolFadeFinished() {
          return !this.symbolFadeHoldUntil || this.symbolFadeHoldUntil < $.now();
        }
      }, {
        key: "clearFadeHold",
        value: function clearFadeHold() {
          this.symbolFadeHoldUntil = void 0;
        }
      }, {
        key: "setHoldDuration",
        value: function setHoldDuration(t) {
          this.symbolFadeHoldUntil = $.now() + t;
        }
      }, {
        key: "setDependencies",
        value: function setDependencies(t, e) {
          var r = {};

          for (var _t167 of e) {
            r[_t167] = !0;
          }

          this.dependencies[t] = r;
        }
      }, {
        key: "hasDependency",
        value: function hasDependency(t, e) {
          for (var _r160 of t) {
            var _t168 = this.dependencies[_r160];
            if (_t168) for (var _r161 of e) {
              if (_t168[_r161]) return !0;
            }
          }

          return !1;
        }
      }, {
        key: "clearQueryDebugViz",
        value: function clearQueryDebugViz() {}
      }]);

      return wh;
    }();

    var _h = /*#__PURE__*/function () {
      function _h() {
        _classCallCheck(this, _h);

        this.state = {}, this.stateChanges = {}, this.deletedStates = {};
      }

      _createClass(_h, [{
        key: "updateState",
        value: function updateState(t, e, r) {
          var i = String(e);

          if (this.stateChanges[t] = this.stateChanges[t] || {}, this.stateChanges[t][i] = this.stateChanges[t][i] || {}, x(this.stateChanges[t][i], r), null === this.deletedStates[t]) {
            this.deletedStates[t] = {};

            for (var _e166 in this.state[t]) {
              _e166 !== i && (this.deletedStates[t][_e166] = null);
            }
          } else if (this.deletedStates[t] && null === this.deletedStates[t][i]) {
            this.deletedStates[t][i] = {};

            for (var _e167 in this.state[t][i]) {
              r[_e167] || (this.deletedStates[t][i][_e167] = null);
            }
          } else for (var _e168 in r) {
            this.deletedStates[t] && this.deletedStates[t][i] && null === this.deletedStates[t][i][_e168] && delete this.deletedStates[t][i][_e168];
          }
        }
      }, {
        key: "removeFeatureState",
        value: function removeFeatureState(t, e, r) {
          if (null === this.deletedStates[t]) return;
          var i = String(e);
          if (this.deletedStates[t] = this.deletedStates[t] || {}, r && void 0 !== e) null !== this.deletedStates[t][i] && (this.deletedStates[t][i] = this.deletedStates[t][i] || {}, this.deletedStates[t][i][r] = null);else if (void 0 !== e) {
            if (this.stateChanges[t] && this.stateChanges[t][i]) for (r in this.deletedStates[t][i] = {}, this.stateChanges[t][i]) {
              this.deletedStates[t][i][r] = null;
            } else this.deletedStates[t][i] = null;
          } else this.deletedStates[t] = null;
        }
      }, {
        key: "getState",
        value: function getState(t, e) {
          var r = String(e),
              i = x({}, (this.state[t] || {})[r], (this.stateChanges[t] || {})[r]);
          if (null === this.deletedStates[t]) return {};

          if (this.deletedStates[t]) {
            var _r162 = this.deletedStates[t][e];
            if (null === _r162) return {};

            for (var _t169 in _r162) {
              delete i[_t169];
            }
          }

          return i;
        }
      }, {
        key: "initializeTileState",
        value: function initializeTileState(t, e) {
          t.setFeatureState(this.state, e);
        }
      }, {
        key: "coalesceChanges",
        value: function coalesceChanges(t, e) {
          var r = {};

          for (var _t170 in this.stateChanges) {
            this.state[_t170] = this.state[_t170] || {};
            var _e169 = {};

            for (var _r163 in this.stateChanges[_t170]) {
              this.state[_t170][_r163] || (this.state[_t170][_r163] = {}), x(this.state[_t170][_r163], this.stateChanges[_t170][_r163]), _e169[_r163] = this.state[_t170][_r163];
            }

            r[_t170] = _e169;
          }

          for (var _t171 in this.deletedStates) {
            this.state[_t171] = this.state[_t171] || {};
            var _e170 = {};
            if (null === this.deletedStates[_t171]) for (var _r164 in this.state[_t171]) {
              _e170[_r164] = {}, this.state[_t171][_r164] = {};
            } else for (var _r165 in this.deletedStates[_t171]) {
              if (null === this.deletedStates[_t171][_r165]) this.state[_t171][_r165] = {};else for (var _e171 of Object.keys(this.deletedStates[_t171][_r165])) {
                delete this.state[_t171][_r165][_e171];
              }
              _e170[_r165] = this.state[_t171][_r165];
            }
            r[_t171] = r[_t171] || {}, x(r[_t171], _e170);
          }

          if (this.stateChanges = {}, this.deletedStates = {}, 0 !== Object.keys(r).length) for (var _i109 in t) {
            t[_i109].setFeatureState(r, e);
          }
        }
      }]);

      return _h;
    }();

    var kh = /*#__PURE__*/function () {
      function kh(t) {
        _classCallCheck(this, kh);

        this.size = t, this.minimums = [], this.maximums = [], this.leaves = [];
      }

      _createClass(kh, [{
        key: "getElevation",
        value: function getElevation(t, e) {
          var r = this.toIdx(t, e);
          return {
            min: this.minimums[r],
            max: this.maximums[r]
          };
        }
      }, {
        key: "isLeaf",
        value: function isLeaf(t, e) {
          return this.leaves[this.toIdx(t, e)];
        }
      }, {
        key: "toIdx",
        value: function toIdx(t, e) {
          return e * this.size + t;
        }
      }]);

      return kh;
    }();

    function Ah(t, e, r, i) {
      var n = 0,
          s = Number.MAX_VALUE;

      for (var _a69 = 0; _a69 < 3; _a69++) {
        if (Math.abs(i[_a69]) < 1e-15) {
          if (r[_a69] < t[_a69] || r[_a69] > e[_a69]) return null;
        } else {
          var _o36 = 1 / i[_a69];

          var _l27 = (t[_a69] - r[_a69]) * _o36,
              _u24 = (e[_a69] - r[_a69]) * _o36;

          if (_l27 > _u24) {
            var _t172 = _l27;
            _l27 = _u24, _u24 = _t172;
          }

          if (_l27 > n && (n = _l27), _u24 < s && (s = _u24), n > s) return null;
        }
      }

      return n;
    }

    function Sh(t, e, r, i, n, s, a, o, l, u, c) {
      var h = i - t,
          p = n - e,
          d = s - r,
          f = a - t,
          y = o - e,
          m = l - r,
          g = c[1] * m - c[2] * y,
          x = c[2] * f - c[0] * m,
          v = c[0] * y - c[1] * f,
          b = h * g + p * x + d * v;
      if (Math.abs(b) < 1e-15) return null;

      var w = 1 / b,
          _ = u[0] - t,
          k = u[1] - e,
          A = u[2] - r,
          S = (_ * g + k * x + A * v) * w;

      if (S < 0 || S > 1) return null;
      var I = k * d - A * p,
          T = A * h - _ * d,
          z = _ * p - k * h,
          E = (c[0] * I + c[1] * T + c[2] * z) * w;
      return E < 0 || S + E > 1 ? null : (f * I + y * T + m * z) * w;
    }

    function Ih(t, e, r) {
      return (t - e) / (r - e);
    }

    function Th(t, e, r, i, n, s, a, o, l) {
      var u = 1 << r,
          c = s - i,
          h = a - n,
          p = (t + 1) / u * c + i,
          d = (e + 0) / u * h + n,
          f = (e + 1) / u * h + n;
      o[0] = (t + 0) / u * c + i, o[1] = d, l[0] = p, l[1] = f;
    }

    var zh = /*#__PURE__*/function () {
      function zh(t) {
        _classCallCheck(this, zh);

        if (this.maximums = [], this.minimums = [], this.leaves = [], this.childOffsets = [], this.nodeCount = 0, this.dem = t, this._siblingOffset = [[0, 0], [1, 0], [0, 1], [1, 1]], !this.dem) return;

        var e = function (t) {
          var e = Math.ceil(Math.log2(t.dim / 8)),
              r = [];
          var i = Math.ceil(Math.pow(2, e));

          var n = 1 / i,
              s = function (t, e, r, i, n) {
            var s = i ? 1 : 0,
                a = (t + 1) * r - s,
                o = e * r,
                l = (e + 1) * r - s;
            n[0] = t * r, n[1] = o, n[2] = a, n[3] = l;
          };

          var a = new kh(i);
          var o = [];

          for (var _e172 = 0; _e172 < i * i; _e172++) {
            s(_e172 % i, Math.floor(_e172 / i), n, !1, o);

            var _r166 = Mh(o[0], o[1], t),
                _l28 = Mh(o[2], o[1], t),
                _u25 = Mh(o[2], o[3], t),
                _c17 = Mh(o[0], o[3], t);

            a.minimums.push(Math.min(_r166, _l28, _u25, _c17)), a.maximums.push(Math.max(_r166, _l28, _u25, _c17)), a.leaves.push(1);
          }

          for (r.push(a), i /= 2; i >= 1; i /= 2) {
            var _t173 = r[r.length - 1];
            a = new kh(i);

            for (var _e173 = 0; _e173 < i * i; _e173++) {
              s(_e173 % i, Math.floor(_e173 / i), 2, !0, o);

              var _r167 = _t173.getElevation(o[0], o[1]),
                  _n94 = _t173.getElevation(o[2], o[1]),
                  _l29 = _t173.getElevation(o[2], o[3]),
                  _u26 = _t173.getElevation(o[0], o[3]),
                  _c18 = _t173.isLeaf(o[0], o[1]),
                  _h9 = _t173.isLeaf(o[2], o[1]),
                  _p11 = _t173.isLeaf(o[2], o[3]),
                  _d7 = _t173.isLeaf(o[0], o[3]),
                  _f8 = Math.min(_r167.min, _n94.min, _l29.min, _u26.min),
                  _y8 = Math.max(_r167.max, _n94.max, _l29.max, _u26.max),
                  _m10 = _c18 && _h9 && _p11 && _d7;

              a.maximums.push(_y8), a.minimums.push(_f8), a.leaves.push(_y8 - _f8 <= 5 && _m10 ? 1 : 0);
            }

            r.push(a);
          }

          return r;
        }(this.dem),
            r = e.length - 1,
            i = e[r];

        this._addNode(i.minimums[0], i.maximums[0], i.leaves[0]), this._construct(e, 0, 0, r, 0);
      }

      _createClass(zh, [{
        key: "raycastRoot",
        value: function raycastRoot(t, e, r, i, n, s) {
          var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 1;
          return Ah([t, e, -100], [r, i, this.maximums[0] * a], n, s);
        }
      }, {
        key: "raycast",
        value: function raycast(t, e, r, i, n, s) {
          var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 1;
          if (!this.nodeCount) return null;
          var o = this.raycastRoot(t, e, r, i, n, s, a);
          if (null == o) return null;
          var l = [],
              u = [],
              c = [],
              h = [],
              p = [{
            idx: 0,
            t: o,
            nodex: 0,
            nodey: 0,
            depth: 0
          }];

          for (; p.length > 0;) {
            var {
              idx: _o37,
              t: _d8,
              nodex: _f9,
              nodey: _y9,
              depth: _m11
            } = p.pop();

            if (this.leaves[_o37]) {
              Th(_f9, _y9, _m11, t, e, r, i, c, h);

              var _o38 = 1 << _m11,
                  _l30 = (_f9 + 0) / _o38,
                  _u27 = (_f9 + 1) / _o38,
                  _p12 = (_y9 + 0) / _o38,
                  _g9 = (_y9 + 1) / _o38,
                  _x8 = Mh(_l30, _p12, this.dem) * a,
                  _v8 = Mh(_u27, _p12, this.dem) * a,
                  _b7 = Mh(_u27, _g9, this.dem) * a,
                  _w7 = Mh(_l30, _g9, this.dem) * a,
                  _9 = Sh(c[0], c[1], _x8, h[0], c[1], _v8, h[0], h[1], _b7, n, s),
                  _k7 = Sh(h[0], h[1], _b7, c[0], h[1], _w7, c[0], c[1], _x8, n, s),
                  _A7 = Math.min(null !== _9 ? _9 : Number.MAX_VALUE, null !== _k7 ? _k7 : Number.MAX_VALUE);

              if (_A7 !== Number.MAX_VALUE) return _A7;
              {
                var _t174 = Ja([], n, s, _d8);

                if (Eh(_x8, _v8, _w7, _b7, Ih(_t174[0], c[0], h[0]), Ih(_t174[1], c[1], h[1])) >= _t174[2]) return _d8;
              }
              continue;
            }

            var _g8 = 0;

            for (var _p13 = 0; _p13 < this._siblingOffset.length; _p13++) {
              Th((_f9 << 1) + this._siblingOffset[_p13][0], (_y9 << 1) + this._siblingOffset[_p13][1], _m11 + 1, t, e, r, i, c, h), c[2] = -100, h[2] = this.maximums[this.childOffsets[_o37] + _p13] * a;

              var _d9 = Ah(c, h, n, s);

              if (null != _d9) {
                var _t175 = _d9;
                l[_p13] = _t175;

                var _e174 = !1;

                for (var _r168 = 0; _r168 < _g8 && !_e174; _r168++) {
                  _t175 >= l[u[_r168]] && (u.splice(_r168, 0, _p13), _e174 = !0);
                }

                _e174 || (u[_g8] = _p13), _g8++;
              }
            }

            for (var _t176 = 0; _t176 < _g8; _t176++) {
              var _e175 = u[_t176];
              p.push({
                idx: this.childOffsets[_o37] + _e175,
                t: l[_e175],
                nodex: (_f9 << 1) + this._siblingOffset[_e175][0],
                nodey: (_y9 << 1) + this._siblingOffset[_e175][1],
                depth: _m11 + 1
              });
            }
          }

          return null;
        }
      }, {
        key: "_addNode",
        value: function _addNode(t, e, r) {
          return this.minimums.push(t), this.maximums.push(e), this.leaves.push(r), this.childOffsets.push(0), this.nodeCount++;
        }
      }, {
        key: "_construct",
        value: function _construct(t, e, r, i, n) {
          if (1 === t[i].isLeaf(e, r)) return;
          this.childOffsets[n] || (this.childOffsets[n] = this.nodeCount);
          var s = i - 1,
              a = t[s];
          var o,
              l = 0;

          for (var _t177 = 0; _t177 < this._siblingOffset.length; _t177++) {
            var _i110 = 2 * e + this._siblingOffset[_t177][0],
                _n95 = 2 * r + this._siblingOffset[_t177][1],
                _s78 = a.getElevation(_i110, _n95),
                _u28 = a.isLeaf(_i110, _n95),
                _c19 = this._addNode(_s78.min, _s78.max, _u28);

            _u28 && (l |= 1 << _t177), o || (o = _c19);
          }

          for (var _i111 = 0; _i111 < this._siblingOffset.length; _i111++) {
            l & 1 << _i111 || this._construct(t, 2 * e + this._siblingOffset[_i111][0], 2 * r + this._siblingOffset[_i111][1], s, o + _i111);
          }
        }
      }]);

      return zh;
    }();

    function Eh(t, e, r, i, n, s) {
      return Je(Je(t, r, s), Je(e, i, s), n);
    }

    function Mh(t, e, r) {
      var i = r.dim,
          n = f(t * i - .5, 0, i - 1),
          s = f(e * i - .5, 0, i - 1),
          a = Math.floor(n),
          o = Math.floor(s),
          l = Math.min(a + 1, i - 1),
          u = Math.min(o + 1, i - 1);
      return Eh(r.get(a, o), r.get(l, o), r.get(a, u), r.get(l, u), n - a, s - o);
    }

    var Bh = {
      mapbox: [6553.6, 25.6, .1, 1e4],
      terrarium: [256, 1, 1 / 256, 32768]
    };

    var Dh = /*#__PURE__*/function () {
      function Dh(t, e, r) {
        var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !1;
        var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;

        _classCallCheck(this, Dh);

        if (this.uid = t, e.height !== e.width) throw new RangeError("DEM tiles must be square");
        if (r && "mapbox" !== r && "terrarium" !== r) return E("\"".concat(r, "\" is not a valid encoding type. Valid types include \"mapbox\" and \"terrarium\"."));
        this.stride = e.height;
        var s = this.dim = e.height - 2;

        if (this.data = new Uint32Array(e.data.buffer), this.encoding = r || "mapbox", this.borderReady = i, !i) {
          for (var _t178 = 0; _t178 < s; _t178++) {
            this.data[this._idx(-1, _t178)] = this.data[this._idx(0, _t178)], this.data[this._idx(s, _t178)] = this.data[this._idx(s - 1, _t178)], this.data[this._idx(_t178, -1)] = this.data[this._idx(_t178, 0)], this.data[this._idx(_t178, s)] = this.data[this._idx(_t178, s - 1)];
          }

          this.data[this._idx(-1, -1)] = this.data[this._idx(0, 0)], this.data[this._idx(s, -1)] = this.data[this._idx(s - 1, 0)], this.data[this._idx(-1, s)] = this.data[this._idx(0, s - 1)], this.data[this._idx(s, s)] = this.data[this._idx(s - 1, s - 1)], n && this._buildQuadTree();
        }
      }

      _createClass(Dh, [{
        key: "tree",
        get: function () {
          return this._tree || this._buildQuadTree(), this._tree;
        }
      }, {
        key: "_buildQuadTree",
        value: function _buildQuadTree() {
          this._tree = new zh(this);
        }
      }, {
        key: "get",
        value: function get(t, e) {
          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;
          var i = new Uint8Array(this.data.buffer);
          r && (t = f(t, -1, this.dim), e = f(e, -1, this.dim));

          var n = 4 * this._idx(t, e);

          return ("terrarium" === this.encoding ? this._unpackTerrarium : this._unpackMapbox)(i[n], i[n + 1], i[n + 2]);
        }
      }, {
        key: "unpackVector",
        get: function () {
          return Bh[this.encoding];
        }
      }, {
        key: "_idx",
        value: function _idx(t, e) {
          if (t < -1 || t >= this.dim + 1 || e < -1 || e >= this.dim + 1) throw new RangeError("out of range source coordinates for DEM data");
          return (e + 1) * this.stride + (t + 1);
        }
      }, {
        key: "_unpackMapbox",
        value: function _unpackMapbox(t, e, r) {
          return (256 * t * 256 + 256 * e + r) / 10 - 1e4;
        }
      }, {
        key: "_unpackTerrarium",
        value: function _unpackTerrarium(t, e, r) {
          return 256 * t + e + r / 256 - 32768;
        }
      }, {
        key: "getPixels",
        value: function getPixels() {
          return new ko({
            width: this.stride,
            height: this.stride
          }, new Uint8Array(this.data.buffer));
        }
      }, {
        key: "backfillBorder",
        value: function backfillBorder(t, e, r) {
          if (this.dim !== t.dim) throw new Error("dem dimension mismatch");
          var i = e * this.dim,
              n = e * this.dim + this.dim,
              s = r * this.dim,
              a = r * this.dim + this.dim;

          switch (e) {
            case -1:
              i = n - 1;
              break;

            case 1:
              n = i + 1;
          }

          switch (r) {
            case -1:
              s = a - 1;
              break;

            case 1:
              a = s + 1;
          }

          var o = -e * this.dim,
              l = -r * this.dim;

          for (var _e176 = s; _e176 < a; _e176++) {
            for (var _r169 = i; _r169 < n; _r169++) {
              this.data[this._idx(_r169, _e176)] = t.data[this._idx(_r169 + o, _e176 + l)];
            }
          }
        }
      }, {
        key: "onDeserialize",
        value: function onDeserialize() {
          this._tree && (this._tree.dem = this);
        }
      }], [{
        key: "getUnpackVector",
        value: function getUnpackVector(t) {
          return Bh[t];
        }
      }, {
        key: "pack",
        value: function pack(t, e) {
          var r = [0, 0, 0, 0],
              i = Dh.getUnpackVector(e);
          var n = Math.floor((t + i[3]) / i[2]);
          return r[2] = n % 256, n = Math.floor(n / 256), r[1] = n % 256, n = Math.floor(n / 256), r[0] = n, r;
        }
      }]);

      return Dh;
    }();

    Gi("DEMData", Dh), Gi("DemMinMaxQuadTree", zh, {
      omit: ["dem"]
    });

    var Ch = /*#__PURE__*/function () {
      function Ch(t, e) {
        _classCallCheck(this, Ch);

        this.max = t, this.onRemove = e, this.reset();
      }

      _createClass(Ch, [{
        key: "reset",
        value: function reset() {
          for (var _t179 in this.data) {
            for (var _e177 of this.data[_t179]) {
              _e177.timeout && clearTimeout(_e177.timeout), this.onRemove(_e177.value);
            }
          }

          return this.data = {}, this.order = [], this;
        }
      }, {
        key: "add",
        value: function add(t, e, r) {
          var _this32 = this;

          var i = t.wrapped().key;
          void 0 === this.data[i] && (this.data[i] = []);
          var n = {
            value: e,
            timeout: void 0
          };

          if (void 0 !== r && (n.timeout = setTimeout(function () {
            _this32.remove(t, n);
          }, r)), this.data[i].push(n), this.order.push(i), this.order.length > this.max) {
            var _t180 = this._getAndRemoveByKey(this.order[0]);

            _t180 && this.onRemove(_t180);
          }

          return this;
        }
      }, {
        key: "has",
        value: function has(t) {
          return t.wrapped().key in this.data;
        }
      }, {
        key: "getAndRemove",
        value: function getAndRemove(t) {
          return this.has(t) ? this._getAndRemoveByKey(t.wrapped().key) : null;
        }
      }, {
        key: "_getAndRemoveByKey",
        value: function _getAndRemoveByKey(t) {
          var e = this.data[t].shift();
          return e.timeout && clearTimeout(e.timeout), 0 === this.data[t].length && delete this.data[t], this.order.splice(this.order.indexOf(t), 1), e.value;
        }
      }, {
        key: "getByKey",
        value: function getByKey(t) {
          var e = this.data[t];
          return e ? e[0].value : null;
        }
      }, {
        key: "get",
        value: function get(t) {
          return this.has(t) ? this.data[t.wrapped().key][0].value : null;
        }
      }, {
        key: "remove",
        value: function remove(t, e) {
          if (!this.has(t)) return this;
          var r = t.wrapped().key,
              i = void 0 === e ? 0 : this.data[r].indexOf(e),
              n = this.data[r][i];
          return this.data[r].splice(i, 1), n.timeout && clearTimeout(n.timeout), 0 === this.data[r].length && delete this.data[r], this.onRemove(n.value), this.order.splice(this.order.indexOf(r), 1), this;
        }
      }, {
        key: "setMaxSize",
        value: function setMaxSize(t) {
          for (this.max = t; this.order.length > this.max;) {
            var _t181 = this._getAndRemoveByKey(this.order[0]);

            _t181 && this.onRemove(_t181);
          }

          return this;
        }
      }, {
        key: "filter",
        value: function filter(t) {
          var e = [];

          for (var _r170 in this.data) {
            for (var _i112 of this.data[_r170]) {
              t(_i112.value) || e.push(_i112);
            }
          }

          for (var _t182 of e) {
            this.remove(_t182.value.tileID, _t182);
          }
        }
      }]);

      return Ch;
    }();

    var Ph = /*#__PURE__*/function () {
      function Ph(t, e, r) {
        _classCallCheck(this, Ph);

        this.context = t;
        var i = t.gl;
        this.buffer = i.createBuffer(), this.dynamicDraw = Boolean(r), this.context.unbindVAO(), t.bindElementBuffer.set(this.buffer), i.bufferData(i.ELEMENT_ARRAY_BUFFER, e.arrayBuffer, this.dynamicDraw ? i.DYNAMIC_DRAW : i.STATIC_DRAW), this.dynamicDraw || delete e.arrayBuffer;
      }

      _createClass(Ph, [{
        key: "bind",
        value: function bind() {
          this.context.bindElementBuffer.set(this.buffer);
        }
      }, {
        key: "updateData",
        value: function updateData(t) {
          var e = this.context.gl;
          this.context.unbindVAO(), this.bind(), e.bufferSubData(e.ELEMENT_ARRAY_BUFFER, 0, t.arrayBuffer);
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);
        }
      }]);

      return Ph;
    }();

    var Vh = {
      Int8: "BYTE",
      Uint8: "UNSIGNED_BYTE",
      Int16: "SHORT",
      Uint16: "UNSIGNED_SHORT",
      Int32: "INT",
      Uint32: "UNSIGNED_INT",
      Float32: "FLOAT"
    };

    var Fh = /*#__PURE__*/function () {
      function Fh(t, e, r, i) {
        _classCallCheck(this, Fh);

        this.length = e.length, this.attributes = r, this.itemSize = e.bytesPerElement, this.dynamicDraw = i, this.context = t;
        var n = t.gl;
        this.buffer = n.createBuffer(), t.bindVertexBuffer.set(this.buffer), n.bufferData(n.ARRAY_BUFFER, e.arrayBuffer, this.dynamicDraw ? n.DYNAMIC_DRAW : n.STATIC_DRAW), this.dynamicDraw || delete e.arrayBuffer;
      }

      _createClass(Fh, [{
        key: "bind",
        value: function bind() {
          this.context.bindVertexBuffer.set(this.buffer);
        }
      }, {
        key: "updateData",
        value: function updateData(t) {
          var e = this.context.gl;
          this.bind(), e.bufferSubData(e.ARRAY_BUFFER, 0, t.arrayBuffer);
        }
      }, {
        key: "enableAttributes",
        value: function enableAttributes(t, e) {
          for (var _r171 = 0; _r171 < this.attributes.length; _r171++) {
            var _i113 = e.attributes[this.attributes[_r171].name];
            void 0 !== _i113 && t.enableVertexAttribArray(_i113);
          }
        }
      }, {
        key: "setVertexAttribPointers",
        value: function setVertexAttribPointers(t, e, r) {
          for (var _i114 = 0; _i114 < this.attributes.length; _i114++) {
            var _n96 = this.attributes[_i114],
                _s79 = e.attributes[_n96.name];
            void 0 !== _s79 && t.vertexAttribPointer(_s79, _n96.components, t[Vh[_n96.type]], !1, this.itemSize, _n96.offset + this.itemSize * (r || 0));
          }
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);
        }
      }]);

      return Fh;
    }();

    var Rh = /*#__PURE__*/function () {
      function Rh(t) {
        _classCallCheck(this, Rh);

        this.gl = t.gl, this.default = this.getDefault(), this.current = this.default, this.dirty = !1;
      }

      _createClass(Rh, [{
        key: "get",
        value: function get() {
          return this.current;
        }
      }, {
        key: "set",
        value: function set(t) {}
      }, {
        key: "getDefault",
        value: function getDefault() {
          return this.default;
        }
      }, {
        key: "setDefault",
        value: function setDefault() {
          this.set(this.default);
        }
      }]);

      return Rh;
    }();

    var Lh = /*#__PURE__*/function (_Rh) {
      _inherits(Lh, _Rh);

      var _super59 = _createSuper(Lh);

      function Lh() {
        _classCallCheck(this, Lh);

        return _super59.apply(this, arguments);
      }

      _createClass(Lh, [{
        key: "getDefault",
        value: function getDefault() {
          return le.transparent;
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t.r !== e.r || t.g !== e.g || t.b !== e.b || t.a !== e.a || this.dirty) && (this.gl.clearColor(t.r, t.g, t.b, t.a), this.current = t, this.dirty = !1);
        }
      }]);

      return Lh;
    }(Rh);

    var Uh = /*#__PURE__*/function (_Rh2) {
      _inherits(Uh, _Rh2);

      var _super60 = _createSuper(Uh);

      function Uh() {
        _classCallCheck(this, Uh);

        return _super60.apply(this, arguments);
      }

      _createClass(Uh, [{
        key: "getDefault",
        value: function getDefault() {
          return 1;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.clearDepth(t), this.current = t, this.dirty = !1);
        }
      }]);

      return Uh;
    }(Rh);

    var Oh = /*#__PURE__*/function (_Rh3) {
      _inherits(Oh, _Rh3);

      var _super61 = _createSuper(Oh);

      function Oh() {
        _classCallCheck(this, Oh);

        return _super61.apply(this, arguments);
      }

      _createClass(Oh, [{
        key: "getDefault",
        value: function getDefault() {
          return 0;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.clearStencil(t), this.current = t, this.dirty = !1);
        }
      }]);

      return Oh;
    }(Rh);

    var $h = /*#__PURE__*/function (_Rh4) {
      _inherits($h, _Rh4);

      var _super62 = _createSuper($h);

      function $h() {
        _classCallCheck(this, $h);

        return _super62.apply(this, arguments);
      }

      _createClass($h, [{
        key: "getDefault",
        value: function getDefault() {
          return [!0, !0, !0, !0];
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || t[3] !== e[3] || this.dirty) && (this.gl.colorMask(t[0], t[1], t[2], t[3]), this.current = t, this.dirty = !1);
        }
      }]);

      return $h;
    }(Rh);

    var qh = /*#__PURE__*/function (_Rh5) {
      _inherits(qh, _Rh5);

      var _super63 = _createSuper(qh);

      function qh() {
        _classCallCheck(this, qh);

        return _super63.apply(this, arguments);
      }

      _createClass(qh, [{
        key: "getDefault",
        value: function getDefault() {
          return !0;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.depthMask(t), this.current = t, this.dirty = !1);
        }
      }]);

      return qh;
    }(Rh);

    var Nh = /*#__PURE__*/function (_Rh6) {
      _inherits(Nh, _Rh6);

      var _super64 = _createSuper(Nh);

      function Nh() {
        _classCallCheck(this, Nh);

        return _super64.apply(this, arguments);
      }

      _createClass(Nh, [{
        key: "getDefault",
        value: function getDefault() {
          return 255;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.stencilMask(t), this.current = t, this.dirty = !1);
        }
      }]);

      return Nh;
    }(Rh);

    var jh = /*#__PURE__*/function (_Rh7) {
      _inherits(jh, _Rh7);

      var _super65 = _createSuper(jh);

      function jh() {
        _classCallCheck(this, jh);

        return _super65.apply(this, arguments);
      }

      _createClass(jh, [{
        key: "getDefault",
        value: function getDefault() {
          return {
            func: this.gl.ALWAYS,
            ref: 0,
            mask: 255
          };
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t.func !== e.func || t.ref !== e.ref || t.mask !== e.mask || this.dirty) && (this.gl.stencilFunc(t.func, t.ref, t.mask), this.current = t, this.dirty = !1);
        }
      }]);

      return jh;
    }(Rh);

    var Gh = /*#__PURE__*/function (_Rh8) {
      _inherits(Gh, _Rh8);

      var _super66 = _createSuper(Gh);

      function Gh() {
        _classCallCheck(this, Gh);

        return _super66.apply(this, arguments);
      }

      _createClass(Gh, [{
        key: "getDefault",
        value: function getDefault() {
          var t = this.gl;
          return [t.KEEP, t.KEEP, t.KEEP];
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || this.dirty) && (this.gl.stencilOp(t[0], t[1], t[2]), this.current = t, this.dirty = !1);
        }
      }]);

      return Gh;
    }(Rh);

    var Zh = /*#__PURE__*/function (_Rh9) {
      _inherits(Zh, _Rh9);

      var _super67 = _createSuper(Zh);

      function Zh() {
        _classCallCheck(this, Zh);

        return _super67.apply(this, arguments);
      }

      _createClass(Zh, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          t ? e.enable(e.STENCIL_TEST) : e.disable(e.STENCIL_TEST), this.current = t, this.dirty = !1;
        }
      }]);

      return Zh;
    }(Rh);

    var Xh = /*#__PURE__*/function (_Rh10) {
      _inherits(Xh, _Rh10);

      var _super68 = _createSuper(Xh);

      function Xh() {
        _classCallCheck(this, Xh);

        return _super68.apply(this, arguments);
      }

      _createClass(Xh, [{
        key: "getDefault",
        value: function getDefault() {
          return [0, 1];
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t[0] !== e[0] || t[1] !== e[1] || this.dirty) && (this.gl.depthRange(t[0], t[1]), this.current = t, this.dirty = !1);
        }
      }]);

      return Xh;
    }(Rh);

    var Kh = /*#__PURE__*/function (_Rh11) {
      _inherits(Kh, _Rh11);

      var _super69 = _createSuper(Kh);

      function Kh() {
        _classCallCheck(this, Kh);

        return _super69.apply(this, arguments);
      }

      _createClass(Kh, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          t ? e.enable(e.DEPTH_TEST) : e.disable(e.DEPTH_TEST), this.current = t, this.dirty = !1;
        }
      }]);

      return Kh;
    }(Rh);

    var Hh = /*#__PURE__*/function (_Rh12) {
      _inherits(Hh, _Rh12);

      var _super70 = _createSuper(Hh);

      function Hh() {
        _classCallCheck(this, Hh);

        return _super70.apply(this, arguments);
      }

      _createClass(Hh, [{
        key: "getDefault",
        value: function getDefault() {
          return this.gl.LESS;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.depthFunc(t), this.current = t, this.dirty = !1);
        }
      }]);

      return Hh;
    }(Rh);

    var Yh = /*#__PURE__*/function (_Rh13) {
      _inherits(Yh, _Rh13);

      var _super71 = _createSuper(Yh);

      function Yh() {
        _classCallCheck(this, Yh);

        return _super71.apply(this, arguments);
      }

      _createClass(Yh, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          t ? e.enable(e.BLEND) : e.disable(e.BLEND), this.current = t, this.dirty = !1;
        }
      }]);

      return Yh;
    }(Rh);

    var Wh = /*#__PURE__*/function (_Rh14) {
      _inherits(Wh, _Rh14);

      var _super72 = _createSuper(Wh);

      function Wh() {
        _classCallCheck(this, Wh);

        return _super72.apply(this, arguments);
      }

      _createClass(Wh, [{
        key: "getDefault",
        value: function getDefault() {
          var t = this.gl;
          return [t.ONE, t.ZERO];
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t[0] !== e[0] || t[1] !== e[1] || this.dirty) && (this.gl.blendFunc(t[0], t[1]), this.current = t, this.dirty = !1);
        }
      }]);

      return Wh;
    }(Rh);

    var Jh = /*#__PURE__*/function (_Rh15) {
      _inherits(Jh, _Rh15);

      var _super73 = _createSuper(Jh);

      function Jh() {
        _classCallCheck(this, Jh);

        return _super73.apply(this, arguments);
      }

      _createClass(Jh, [{
        key: "getDefault",
        value: function getDefault() {
          return le.transparent;
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t.r !== e.r || t.g !== e.g || t.b !== e.b || t.a !== e.a || this.dirty) && (this.gl.blendColor(t.r, t.g, t.b, t.a), this.current = t, this.dirty = !1);
        }
      }]);

      return Jh;
    }(Rh);

    var Qh = /*#__PURE__*/function (_Rh16) {
      _inherits(Qh, _Rh16);

      var _super74 = _createSuper(Qh);

      function Qh() {
        _classCallCheck(this, Qh);

        return _super74.apply(this, arguments);
      }

      _createClass(Qh, [{
        key: "getDefault",
        value: function getDefault() {
          return this.gl.FUNC_ADD;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.blendEquation(t), this.current = t, this.dirty = !1);
        }
      }]);

      return Qh;
    }(Rh);

    var tp = /*#__PURE__*/function (_Rh17) {
      _inherits(tp, _Rh17);

      var _super75 = _createSuper(tp);

      function tp() {
        _classCallCheck(this, tp);

        return _super75.apply(this, arguments);
      }

      _createClass(tp, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          t ? e.enable(e.CULL_FACE) : e.disable(e.CULL_FACE), this.current = t, this.dirty = !1;
        }
      }]);

      return tp;
    }(Rh);

    var ep = /*#__PURE__*/function (_Rh18) {
      _inherits(ep, _Rh18);

      var _super76 = _createSuper(ep);

      function ep() {
        _classCallCheck(this, ep);

        return _super76.apply(this, arguments);
      }

      _createClass(ep, [{
        key: "getDefault",
        value: function getDefault() {
          return this.gl.BACK;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.cullFace(t), this.current = t, this.dirty = !1);
        }
      }]);

      return ep;
    }(Rh);

    var rp = /*#__PURE__*/function (_Rh19) {
      _inherits(rp, _Rh19);

      var _super77 = _createSuper(rp);

      function rp() {
        _classCallCheck(this, rp);

        return _super77.apply(this, arguments);
      }

      _createClass(rp, [{
        key: "getDefault",
        value: function getDefault() {
          return this.gl.CCW;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.frontFace(t), this.current = t, this.dirty = !1);
        }
      }]);

      return rp;
    }(Rh);

    var ip = /*#__PURE__*/function (_Rh20) {
      _inherits(ip, _Rh20);

      var _super78 = _createSuper(ip);

      function ip() {
        _classCallCheck(this, ip);

        return _super78.apply(this, arguments);
      }

      _createClass(ip, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.useProgram(t), this.current = t, this.dirty = !1);
        }
      }]);

      return ip;
    }(Rh);

    var np = /*#__PURE__*/function (_Rh21) {
      _inherits(np, _Rh21);

      var _super79 = _createSuper(np);

      function np() {
        _classCallCheck(this, np);

        return _super79.apply(this, arguments);
      }

      _createClass(np, [{
        key: "getDefault",
        value: function getDefault() {
          return this.gl.TEXTURE0;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.activeTexture(t), this.current = t, this.dirty = !1);
        }
      }]);

      return np;
    }(Rh);

    var sp = /*#__PURE__*/function (_Rh22) {
      _inherits(sp, _Rh22);

      var _super80 = _createSuper(sp);

      function sp() {
        _classCallCheck(this, sp);

        return _super80.apply(this, arguments);
      }

      _createClass(sp, [{
        key: "getDefault",
        value: function getDefault() {
          var t = this.gl;
          return [0, 0, t.drawingBufferWidth, t.drawingBufferHeight];
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || t[3] !== e[3] || this.dirty) && (this.gl.viewport(t[0], t[1], t[2], t[3]), this.current = t, this.dirty = !1);
        }
      }]);

      return sp;
    }(Rh);

    var ap = /*#__PURE__*/function (_Rh23) {
      _inherits(ap, _Rh23);

      var _super81 = _createSuper(ap);

      function ap() {
        _classCallCheck(this, ap);

        return _super81.apply(this, arguments);
      }

      _createClass(ap, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.bindFramebuffer(e.FRAMEBUFFER, t), this.current = t, this.dirty = !1;
        }
      }]);

      return ap;
    }(Rh);

    var op = /*#__PURE__*/function (_Rh24) {
      _inherits(op, _Rh24);

      var _super82 = _createSuper(op);

      function op() {
        _classCallCheck(this, op);

        return _super82.apply(this, arguments);
      }

      _createClass(op, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.bindRenderbuffer(e.RENDERBUFFER, t), this.current = t, this.dirty = !1;
        }
      }]);

      return op;
    }(Rh);

    var lp = /*#__PURE__*/function (_Rh25) {
      _inherits(lp, _Rh25);

      var _super83 = _createSuper(lp);

      function lp() {
        _classCallCheck(this, lp);

        return _super83.apply(this, arguments);
      }

      _createClass(lp, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.bindTexture(e.TEXTURE_2D, t), this.current = t, this.dirty = !1;
        }
      }]);

      return lp;
    }(Rh);

    var up = /*#__PURE__*/function (_Rh26) {
      _inherits(up, _Rh26);

      var _super84 = _createSuper(up);

      function up() {
        _classCallCheck(this, up);

        return _super84.apply(this, arguments);
      }

      _createClass(up, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.bindBuffer(e.ARRAY_BUFFER, t), this.current = t, this.dirty = !1;
        }
      }]);

      return up;
    }(Rh);

    var cp = /*#__PURE__*/function (_Rh27) {
      _inherits(cp, _Rh27);

      var _super85 = _createSuper(cp);

      function cp() {
        _classCallCheck(this, cp);

        return _super85.apply(this, arguments);
      }

      _createClass(cp, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.gl;
          e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, t), this.current = t, this.dirty = !1;
        }
      }]);

      return cp;
    }(Rh);

    var hp = /*#__PURE__*/function (_Rh28) {
      _inherits(hp, _Rh28);

      var _super86 = _createSuper(hp);

      function hp(t) {
        var _this33;

        _classCallCheck(this, hp);

        _this33 = _super86.call(this, t), _this33.vao = t.extVertexArrayObject;
        return _this33;
      }

      _createClass(hp, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          this.vao && (t !== this.current || this.dirty) && (this.vao.bindVertexArrayOES(t), this.current = t, this.dirty = !1);
        }
      }]);

      return hp;
    }(Rh);

    var pp = /*#__PURE__*/function (_Rh29) {
      _inherits(pp, _Rh29);

      var _super87 = _createSuper(pp);

      function pp() {
        _classCallCheck(this, pp);

        return _super87.apply(this, arguments);
      }

      _createClass(pp, [{
        key: "getDefault",
        value: function getDefault() {
          return 4;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.pixelStorei(e.UNPACK_ALIGNMENT, t), this.current = t, this.dirty = !1;
        }
      }]);

      return pp;
    }(Rh);

    var dp = /*#__PURE__*/function (_Rh30) {
      _inherits(dp, _Rh30);

      var _super88 = _createSuper(dp);

      function dp() {
        _classCallCheck(this, dp);

        return _super88.apply(this, arguments);
      }

      _createClass(dp, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t), this.current = t, this.dirty = !1;
        }
      }]);

      return dp;
    }(Rh);

    var fp = /*#__PURE__*/function (_Rh31) {
      _inherits(fp, _Rh31);

      var _super89 = _createSuper(fp);

      function fp() {
        _classCallCheck(this, fp);

        return _super89.apply(this, arguments);
      }

      _createClass(fp, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, t), this.current = t, this.dirty = !1;
        }
      }]);

      return fp;
    }(Rh);

    var yp = /*#__PURE__*/function (_Rh32) {
      _inherits(yp, _Rh32);

      var _super90 = _createSuper(yp);

      function yp(t, e) {
        var _this34;

        _classCallCheck(this, yp);

        _this34 = _super90.call(this, t), _this34.context = t, _this34.parent = e;
        return _this34;
      }

      _createClass(yp, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }]);

      return yp;
    }(Rh);

    var mp = /*#__PURE__*/function (_yp) {
      _inherits(mp, _yp);

      var _super91 = _createSuper(mp);

      function mp() {
        _classCallCheck(this, mp);

        return _super91.apply(this, arguments);
      }

      _createClass(mp, [{
        key: "setDirty",
        value: function setDirty() {
          this.dirty = !0;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          this.context.bindFramebuffer.set(this.parent);
          var e = this.gl;
          e.framebufferTexture2D(e.FRAMEBUFFER, e.COLOR_ATTACHMENT0, e.TEXTURE_2D, t, 0), this.current = t, this.dirty = !1;
        }
      }]);

      return mp;
    }(yp);

    var gp = /*#__PURE__*/function (_yp2) {
      _inherits(gp, _yp2);

      var _super92 = _createSuper(gp);

      function gp() {
        _classCallCheck(this, gp);

        return _super92.apply(this, arguments);
      }

      _createClass(gp, [{
        key: "attachment",
        value: function attachment() {
          return this.gl.DEPTH_ATTACHMENT;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          this.context.bindFramebuffer.set(this.parent);
          var e = this.gl;
          e.framebufferRenderbuffer(e.FRAMEBUFFER, this.attachment(), e.RENDERBUFFER, t), this.current = t, this.dirty = !1;
        }
      }]);

      return gp;
    }(yp);

    var xp = /*#__PURE__*/function () {
      function xp(t, e, r, i) {
        _classCallCheck(this, xp);

        this.context = t, this.width = e, this.height = r;
        var n = this.framebuffer = t.gl.createFramebuffer();
        this.colorAttachment = new mp(t, n), i && (this.depthAttachment = new gp(t, n));
      }

      _createClass(xp, [{
        key: "destroy",
        value: function destroy() {
          var t = this.context.gl,
              e = this.colorAttachment.get();

          if (e && t.deleteTexture(e), this.depthAttachment) {
            var _e178 = this.depthAttachment.get();

            _e178 && t.deleteRenderbuffer(_e178);
          }

          t.deleteFramebuffer(this.framebuffer);
        }
      }]);

      return xp;
    }();

    var vp = function vp(t, e, r) {
      _classCallCheck(this, vp);

      this.func = t, this.mask = e, this.range = r;
    };

    vp.ReadOnly = !1, vp.ReadWrite = !0, vp.disabled = new vp(519, vp.ReadOnly, [0, 1]);

    var bp = function bp(t, e, r, i, n, s) {
      _classCallCheck(this, bp);

      this.test = t, this.ref = e, this.mask = r, this.fail = i, this.depthFail = n, this.pass = s;
    };

    bp.disabled = new bp({
      func: 519,
      mask: 0
    }, 0, 0, 7680, 7680, 7680);

    var wp = function wp(t, e, r) {
      _classCallCheck(this, wp);

      this.blendFunction = t, this.blendColor = e, this.mask = r;
    };

    wp.Replace = [1, 0], wp.disabled = new wp(wp.Replace, le.transparent, [!1, !1, !1, !1]), wp.unblended = new wp(wp.Replace, le.transparent, [!0, !0, !0, !0]), wp.alphaBlended = new wp([1, 771], le.transparent, [!0, !0, !0, !0]);

    var _p = function _p(t, e, r) {
      _classCallCheck(this, _p);

      this.enable = t, this.mode = e, this.frontFace = r;
    };

    _p.disabled = new _p(!1, 1029, 2305), _p.backCCW = new _p(!0, 1029, 2305), _p.backCW = new _p(!0, 1029, 2304), _p.frontCW = new _p(!0, 1028, 2304), _p.frontCCW = new _p(!0, 1028, 2305);

    var kp = /*#__PURE__*/function (_Vt2) {
      _inherits(kp, _Vt2);

      var _super93 = _createSuper(kp);

      function kp(t, e, r) {
        var _this35;

        _classCallCheck(this, kp);

        _this35 = _super93.call(this), _this35.id = t, _this35._onlySymbols = r, e.on("data", function (t) {
          "source" === t.dataType && "metadata" === t.sourceDataType && (_this35._sourceLoaded = !0), _this35._sourceLoaded && !_this35._paused && "source" === t.dataType && "content" === t.sourceDataType && (_this35.reload(), _this35.transform && _this35.update(_this35.transform));
        }), e.on("error", function () {
          _this35._sourceErrored = !0;
        }), _this35._source = e, _this35._tiles = {}, _this35._cache = new Ch(0, _this35._unloadTile.bind(_assertThisInitialized(_this35))), _this35._timers = {}, _this35._cacheTimers = {}, _this35._maxTileCacheSize = null, _this35._loadedParentTiles = {}, _this35._coveredTiles = {}, _this35._state = new _h();
        return _this35;
      }

      _createClass(kp, [{
        key: "onAdd",
        value: function onAdd(t) {
          this.map = t, this._maxTileCacheSize = t ? t._maxTileCacheSize : null;
        }
      }, {
        key: "loaded",
        value: function loaded() {
          if (this._sourceErrored) return !0;
          if (!this._sourceLoaded) return !1;
          if (!this._source.loaded()) return !1;

          for (var _t183 in this._tiles) {
            var _e179 = this._tiles[_t183];
            if ("loaded" !== _e179.state && "errored" !== _e179.state) return !1;
          }

          return !0;
        }
      }, {
        key: "getSource",
        value: function getSource() {
          return this._source;
        }
      }, {
        key: "pause",
        value: function pause() {
          this._paused = !0;
        }
      }, {
        key: "resume",
        value: function resume() {
          if (!this._paused) return;
          var t = this._shouldReloadOnResume;
          this._paused = !1, this._shouldReloadOnResume = !1, t && this.reload(), this.transform && this.update(this.transform);
        }
      }, {
        key: "_loadTile",
        value: function _loadTile(t, e) {
          return t.isSymbolTile = this._onlySymbols, this._source.loadTile(t, e);
        }
      }, {
        key: "_unloadTile",
        value: function _unloadTile(t) {
          if (this._source.unloadTile) return this._source.unloadTile(t, function () {});
        }
      }, {
        key: "_abortTile",
        value: function _abortTile(t) {
          if (this._source.abortTile) return this._source.abortTile(t, function () {});
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return this._source.serialize();
        }
      }, {
        key: "prepare",
        value: function prepare(t) {
          this._source.prepare && this._source.prepare(), this._state.coalesceChanges(this._tiles, this.map ? this.map.painter : null);

          for (var _e180 in this._tiles) {
            var _r172 = this._tiles[_e180];
            _r172.upload(t), _r172.prepare(this.map.style.imageManager);
          }
        }
      }, {
        key: "getIds",
        value: function getIds() {
          return g(this._tiles).map(function (t) {
            return t.tileID;
          }).sort(Ap).map(function (t) {
            return t.key;
          });
        }
      }, {
        key: "getRenderableIds",
        value: function getRenderableIds(t) {
          var _this36 = this;

          var e = [];

          for (var _r173 in this._tiles) {
            this._isIdRenderable(+_r173, t) && e.push(this._tiles[_r173]);
          }

          return t ? e.sort(function (t, e) {
            var r = t.tileID,
                n = e.tileID,
                s = new i(r.canonical.x, r.canonical.y)._rotate(_this36.transform.angle),
                a = new i(n.canonical.x, n.canonical.y)._rotate(_this36.transform.angle);

            return r.overscaledZ - n.overscaledZ || a.y - s.y || a.x - s.x;
          }).map(function (t) {
            return t.tileID.key;
          }) : e.map(function (t) {
            return t.tileID;
          }).sort(Ap).map(function (t) {
            return t.key;
          });
        }
      }, {
        key: "hasRenderableParent",
        value: function hasRenderableParent(t) {
          var e = this.findLoadedParent(t, 0);
          return !!e && this._isIdRenderable(e.tileID.key);
        }
      }, {
        key: "_isIdRenderable",
        value: function _isIdRenderable(t, e) {
          return this._tiles[t] && this._tiles[t].hasData() && !this._coveredTiles[t] && (e || !this._tiles[t].holdingForFade());
        }
      }, {
        key: "reload",
        value: function reload() {
          if (this._paused) this._shouldReloadOnResume = !0;else {
            this._cache.reset();

            for (var _t184 in this._tiles) {
              "errored" !== this._tiles[_t184].state && this._reloadTile(+_t184, "reloading");
            }
          }
        }
      }, {
        key: "_reloadTile",
        value: function _reloadTile(t, e) {
          var r = this._tiles[t];
          r && ("loading" !== r.state && (r.state = e), this._loadTile(r, this._tileLoaded.bind(this, r, t, e)));
        }
      }, {
        key: "_tileLoaded",
        value: function _tileLoaded(t, e, r, i) {
          if (i) return t.state = "errored", void (404 !== i.status ? this._source.fire(new Pt(i, {
            tile: t
          })) : this.update(this.transform));
          t.timeAdded = $.now(), "expired" === r && (t.refreshedUponExpiration = !0), this._setTileReloadTimer(e, t), "raster-dem" === this.getSource().type && t.dem && this._backfillDEM(t), this._state.initializeTileState(t, this.map ? this.map.painter : null), this._source.fire(new Ct("data", {
            dataType: "source",
            tile: t,
            coord: t.tileID,
            sourceCacheId: this.id
          }));
        }
      }, {
        key: "_backfillDEM",
        value: function _backfillDEM(t) {
          var e = this.getRenderableIds();

          for (var _i115 = 0; _i115 < e.length; _i115++) {
            var _n97 = e[_i115];

            if (t.neighboringTiles && t.neighboringTiles[_n97]) {
              var _e181 = this.getTileByID(_n97);

              r(t, _e181), r(_e181, t);
            }
          }

          function r(t, e) {
            if (!t.dem || t.dem.borderReady) return;
            t.needsHillshadePrepare = !0, t.needsDEMTextureUpload = !0;
            var r = e.tileID.canonical.x - t.tileID.canonical.x;
            var i = e.tileID.canonical.y - t.tileID.canonical.y,
                n = Math.pow(2, t.tileID.canonical.z),
                s = e.tileID.key;
            0 === r && 0 === i || Math.abs(i) > 1 || (Math.abs(r) > 1 && (1 === Math.abs(r + n) ? r += n : 1 === Math.abs(r - n) && (r -= n)), e.dem && t.dem && (t.dem.backfillBorder(e.dem, r, i), t.neighboringTiles && t.neighboringTiles[s] && (t.neighboringTiles[s].backfilled = !0)));
          }
        }
      }, {
        key: "getTile",
        value: function getTile(t) {
          return this.getTileByID(t.key);
        }
      }, {
        key: "getTileByID",
        value: function getTileByID(t) {
          return this._tiles[t];
        }
      }, {
        key: "_retainLoadedChildren",
        value: function _retainLoadedChildren(t, e, r, i) {
          for (var _n98 in this._tiles) {
            var _s80 = this._tiles[_n98];
            if (i[_n98] || !_s80.hasData() || _s80.tileID.overscaledZ <= e || _s80.tileID.overscaledZ > r) continue;
            var _a70 = _s80.tileID;

            for (; _s80 && _s80.tileID.overscaledZ > e + 1;) {
              var _t185 = _s80.tileID.scaledTo(_s80.tileID.overscaledZ - 1);

              _s80 = this._tiles[_t185.key], _s80 && _s80.hasData() && (_a70 = _t185);
            }

            var _o39 = _a70;

            for (; _o39.overscaledZ > e;) {
              if (_o39 = _o39.scaledTo(_o39.overscaledZ - 1), t[_o39.key]) {
                i[_a70.key] = _a70;
                break;
              }
            }
          }
        }
      }, {
        key: "findLoadedParent",
        value: function findLoadedParent(t, e) {
          if (t.key in this._loadedParentTiles) {
            var _r174 = this._loadedParentTiles[t.key];
            return _r174 && _r174.tileID.overscaledZ >= e ? _r174 : null;
          }

          for (var _r175 = t.overscaledZ - 1; _r175 >= e; _r175--) {
            var _e182 = t.scaledTo(_r175),
                _i116 = this._getLoadedTile(_e182);

            if (_i116) return _i116;
          }
        }
      }, {
        key: "_getLoadedTile",
        value: function _getLoadedTile(t) {
          var e = this._tiles[t.key];
          return e && e.hasData() ? e : this._cache.getByKey(this._source.reparseOverscaled ? t.wrapped().key : t.canonical.key);
        }
      }, {
        key: "updateCacheSize",
        value: function updateCacheSize(t, e) {
          e = e || this._source.tileSize;
          var r = Math.ceil(t.width / e) + 1,
              i = Math.ceil(t.height / e) + 1,
              n = Math.floor(r * i * 5),
              s = "number" == typeof this._maxTileCacheSize ? Math.min(this._maxTileCacheSize, n) : n;

          this._cache.setMaxSize(s);
        }
      }, {
        key: "handleWrapJump",
        value: function handleWrapJump(t) {
          var e = Math.round((t - (void 0 === this._prevLng ? t : this._prevLng)) / 360);

          if (this._prevLng = t, e) {
            var _t186 = {};

            for (var _r176 in this._tiles) {
              var _i117 = this._tiles[_r176];
              _i117.tileID = _i117.tileID.unwrapTo(_i117.tileID.wrap + e), _t186[_i117.tileID.key] = _i117;
            }

            this._tiles = _t186;

            for (var _t187 in this._timers) {
              clearTimeout(this._timers[_t187]), delete this._timers[_t187];
            }

            for (var _t188 in this._tiles) {
              this._setTileReloadTimer(+_t188, this._tiles[_t188]);
            }
          }
        }
      }, {
        key: "update",
        value: function update(t, e, r) {
          var _this37 = this;

          if (this.transform = t, !this._sourceLoaded || this._paused || this.transform.freezeTileCoverage) return;
          if (this.usedForTerrain && !r) return;
          var i;
          this.updateCacheSize(t, e), this.handleWrapJump(this.transform.center.lng), this._coveredTiles = {}, this.used || this.usedForTerrain ? this._source.tileID ? i = t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function (t) {
            return new mh(t.canonical.z, t.wrap, t.canonical.z, t.canonical.x, t.canonical.y);
          }) : (i = t.coveringTiles({
            tileSize: e || this._source.tileSize,
            minzoom: this._source.minzoom,
            maxzoom: this._source.maxzoom,
            roundZoom: this._source.roundZoom && !r,
            reparseOverscaled: this._source.reparseOverscaled,
            useElevationData: !!this.transform.elevation && !this.usedForTerrain
          }), this._source.hasTile && (i = i.filter(function (t) {
            return _this37._source.hasTile(t);
          }))) : i = [];

          var n = this._updateRetainedTiles(i);

          if (Sp(this._source.type) && 0 !== i.length) {
            var _t189 = {},
                _e183 = {},
                _r177 = Object.keys(n);

            for (var _i118 of _r177) {
              var _r178 = n[_i118],
                  _s82 = this._tiles[_i118];
              if (!_s82 || _s82.fadeEndTime && _s82.fadeEndTime <= $.now()) continue;

              var _a71 = this.findLoadedParent(_r178, Math.max(_r178.overscaledZ - kp.maxOverzooming, this._source.minzoom));

              _a71 && (this._addTile(_a71.tileID), _t189[_a71.tileID.key] = _a71.tileID), _e183[_i118] = _r178;
            }

            var _s81 = i[i.length - 1].overscaledZ;

            for (var _t190 in this._tiles) {
              var _r179 = this._tiles[_t190];
              if (n[_t190] || !_r179.hasData()) continue;
              var _i119 = _r179.tileID;

              for (; _i119.overscaledZ > _s81;) {
                _i119 = _i119.scaledTo(_i119.overscaledZ - 1);
                var _s83 = this._tiles[_i119.key];

                if (_s83 && _s83.hasData() && _e183[_i119.key]) {
                  n[_t190] = _r179.tileID;
                  break;
                }
              }
            }

            for (var _e184 in _t189) {
              n[_e184] || (this._coveredTiles[_e184] = !0, n[_e184] = _t189[_e184]);
            }
          }

          for (var _t191 in n) {
            this._tiles[_t191].clearFadeHold();
          }

          var s = function (t, e) {
            var r = [];

            for (var _i120 in t) {
              _i120 in e || r.push(_i120);
            }

            return r;
          }(this._tiles, n);

          for (var _t192 of s) {
            var _e185 = this._tiles[_t192];
            _e185.hasSymbolBuckets && !_e185.holdingForFade() ? _e185.setHoldDuration(this.map._fadeDuration) : _e185.hasSymbolBuckets && !_e185.symbolFadeFinished() || this._removeTile(+_t192);
          }

          this._updateLoadedParentTileCache(), this._onlySymbols && this._source.afterUpdate && this._source.afterUpdate();
        }
      }, {
        key: "releaseSymbolFadeTiles",
        value: function releaseSymbolFadeTiles() {
          for (var _t193 in this._tiles) {
            this._tiles[_t193].holdingForFade() && this._removeTile(+_t193);
          }
        }
      }, {
        key: "_updateRetainedTiles",
        value: function _updateRetainedTiles(t) {
          var e = {};
          if (0 === t.length) return e;
          var r = {},
              i = t[t.length - 1].overscaledZ,
              n = t[0].overscaledZ,
              s = Math.max(n - kp.maxOverzooming, this._source.minzoom),
              a = Math.max(n + kp.maxUnderzooming, this._source.minzoom),
              o = {};

          for (var _r180 of t) {
            var _t194 = this._addTile(_r180);

            e[_r180.key] = _r180, _t194.hasData() || i < this._source.maxzoom && (o[_r180.key] = _r180);
          }

          this._retainLoadedChildren(o, i, a, e);

          for (var _i121 of t) {
            var _t195 = this._tiles[_i121.key];
            if (_t195.hasData()) continue;

            if (_i121.canonical.z >= this._source.maxzoom) {
              var _t196 = _i121.children(this._source.maxzoom)[0],
                  _r181 = this.getTile(_t196);

              if (_r181 && _r181.hasData()) {
                e[_t196.key] = _t196;
                continue;
              }
            } else {
              var _t197 = _i121.children(this._source.maxzoom);

              if (e[_t197[0].key] && e[_t197[1].key] && e[_t197[2].key] && e[_t197[3].key]) continue;
            }

            var _n99 = _t195.wasRequested();

            for (var _a72 = _i121.overscaledZ - 1; _a72 >= s; --_a72) {
              var _s84 = _i121.scaledTo(_a72);

              if (r[_s84.key]) break;
              if (r[_s84.key] = !0, _t195 = this.getTile(_s84), !_t195 && _n99 && (_t195 = this._addTile(_s84)), _t195 && (e[_s84.key] = _s84, _n99 = _t195.wasRequested(), _t195.hasData())) break;
            }
          }

          return e;
        }
      }, {
        key: "_updateLoadedParentTileCache",
        value: function _updateLoadedParentTileCache() {
          this._loadedParentTiles = {};

          for (var _t198 in this._tiles) {
            var _e186 = [];

            var _r182 = void 0,
                _i122 = this._tiles[_t198].tileID;

            for (; _i122.overscaledZ > 0;) {
              if (_i122.key in this._loadedParentTiles) {
                _r182 = this._loadedParentTiles[_i122.key];
                break;
              }

              _e186.push(_i122.key);

              var _t199 = _i122.scaledTo(_i122.overscaledZ - 1);

              if (_r182 = this._getLoadedTile(_t199), _r182) break;
              _i122 = _t199;
            }

            for (var _t200 of _e186) {
              this._loadedParentTiles[_t200] = _r182;
            }
          }
        }
      }, {
        key: "_addTile",
        value: function _addTile(t) {
          var e = this._tiles[t.key];
          if (e) return e;
          e = this._cache.getAndRemove(t), e && (this._setTileReloadTimer(t.key, e), e.tileID = t, this._state.initializeTileState(e, this.map ? this.map.painter : null), this._cacheTimers[t.key] && (clearTimeout(this._cacheTimers[t.key]), delete this._cacheTimers[t.key], this._setTileReloadTimer(t.key, e)));
          var r = Boolean(e);
          return r || (e = new wh(t, this._source.tileSize * t.overscaleFactor(), this.transform.tileZoom), this._loadTile(e, this._tileLoaded.bind(this, e, t.key, e.state))), e ? (e.uses++, this._tiles[t.key] = e, r || this._source.fire(new Ct("dataloading", {
            tile: e,
            coord: e.tileID,
            dataType: "source"
          })), e) : null;
        }
      }, {
        key: "_setTileReloadTimer",
        value: function _setTileReloadTimer(t, e) {
          var _this38 = this;

          t in this._timers && (clearTimeout(this._timers[t]), delete this._timers[t]);
          var r = e.getExpiryTimeout();
          r && (this._timers[t] = setTimeout(function () {
            _this38._reloadTile(t, "expired"), delete _this38._timers[t];
          }, r));
        }
      }, {
        key: "_removeTile",
        value: function _removeTile(t) {
          var e = this._tiles[t];
          e && (e.uses--, delete this._tiles[t], this._timers[t] && (clearTimeout(this._timers[t]), delete this._timers[t]), e.uses > 0 || (e.hasData() && "reloading" !== e.state ? this._cache.add(e.tileID, e, e.getExpiryTimeout()) : (e.aborted = !0, this._abortTile(e), this._unloadTile(e))));
        }
      }, {
        key: "clearTiles",
        value: function clearTiles() {
          this._shouldReloadOnResume = !1, this._paused = !1;

          for (var _t201 in this._tiles) {
            this._removeTile(+_t201);
          }

          this._cache.reset();
        }
      }, {
        key: "tilesIn",
        value: function tilesIn(t, e, r) {
          var i = [],
              n = this.transform;
          if (!n) return i;

          for (var _s85 in this._tiles) {
            var _a73 = this._tiles[_s85];
            if (r && _a73.clearQueryDebugViz(), _a73.holdingForFade()) continue;

            var _o40 = t.containsTile(_a73, n, e);

            _o40 && i.push(_o40);
          }

          return i;
        }
      }, {
        key: "getVisibleCoordinates",
        value: function getVisibleCoordinates(t) {
          var _this39 = this;

          var e = this.getRenderableIds(t).map(function (t) {
            return _this39._tiles[t].tileID;
          });

          for (var _t202 of e) {
            _t202.posMatrix = this.transform.calculatePosMatrix(_t202.toUnwrapped());
          }

          return e;
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          if (this._source.hasTransition()) return !0;
          if (Sp(this._source.type)) for (var _t203 in this._tiles) {
            var _e187 = this._tiles[_t203];
            if (void 0 !== _e187.fadeEndTime && _e187.fadeEndTime >= $.now()) return !0;
          }
          return !1;
        }
      }, {
        key: "setFeatureState",
        value: function setFeatureState(t, e, r) {
          this._state.updateState(t = t || "_geojsonTileLayer", e, r);
        }
      }, {
        key: "removeFeatureState",
        value: function removeFeatureState(t, e, r) {
          this._state.removeFeatureState(t = t || "_geojsonTileLayer", e, r);
        }
      }, {
        key: "getFeatureState",
        value: function getFeatureState(t, e) {
          return this._state.getState(t = t || "_geojsonTileLayer", e);
        }
      }, {
        key: "setDependencies",
        value: function setDependencies(t, e, r) {
          var i = this._tiles[t];
          i && i.setDependencies(e, r);
        }
      }, {
        key: "reloadTilesForDependencies",
        value: function reloadTilesForDependencies(t, e) {
          for (var _r183 in this._tiles) {
            this._tiles[_r183].hasDependency(t, e) && this._reloadTile(+_r183, "reloading");
          }

          this._cache.filter(function (r) {
            return !r.hasDependency(t, e);
          });
        }
      }]);

      return kp;
    }(Vt);

    function Ap(t, e) {
      var r = Math.abs(2 * t.wrap) - +(t.wrap < 0),
          i = Math.abs(2 * e.wrap) - +(e.wrap < 0);
      return t.overscaledZ - e.overscaledZ || i - r || e.canonical.y - t.canonical.y || e.canonical.x - t.canonical.x;
    }

    function Sp(t) {
      return "raster" === t || "image" === t || "video" === t;
    }

    kp.maxOverzooming = 10, kp.maxUnderzooming = 3;

    var Ip = /*#__PURE__*/function () {
      function Ip(t, e, r) {
        _classCallCheck(this, Ip);

        this._demTile = t, this._dem = this._demTile.dem, this._scale = e, this._offset = r;
      }

      _createClass(Ip, [{
        key: "tileCoordToPixel",
        value: function tileCoordToPixel(t, e) {
          var r = e * this._scale + this._offset[1],
              n = Math.floor(t * this._scale + this._offset[0]),
              s = Math.floor(r);
          return new i(n, s);
        }
      }, {
        key: "getElevationAt",
        value: function getElevationAt(t, e, r, i) {
          var n = t * this._scale + this._offset[0],
              s = e * this._scale + this._offset[1],
              a = Math.floor(n),
              o = Math.floor(s),
              l = this._dem;
          return i = !!i, r ? Je(Je(l.get(a, o, i), l.get(a, o + 1, i), s - o), Je(l.get(a + 1, o, i), l.get(a + 1, o + 1, i), s - o), n - a) : l.get(a, o, i);
        }
      }, {
        key: "getElevationAtPixel",
        value: function getElevationAtPixel(t, e, r) {
          return this._dem.get(t, e, !!r);
        }
      }, {
        key: "getMeterToDEM",
        value: function getMeterToDEM(t) {
          return (1 << this._demTile.tileID.canonical.z) * uh(1, t) * this._dem.stride;
        }
      }], [{
        key: "create",
        value: function create(t, e, r) {
          var i = r || t.findDEMTileFor(e);
          if (!i || !i.dem) return;
          var n = i.dem,
              s = i.tileID,
              a = 1 << e.canonical.z - s.canonical.z;
          return new Ip(i, i.tileSize / 8192 / a, [(e.canonical.x / a - s.canonical.x) * n.dim, (e.canonical.y / a - s.canonical.y) * n.dim]);
        }
      }]);

      return Ip;
    }();

    var Tp = /*#__PURE__*/function () {
      function Tp(t, e) {
        _classCallCheck(this, Tp);

        this.tileID = t, this.x = t.canonical.x, this.y = t.canonical.y, this.z = t.canonical.z, this.grid = new Oi(8192, 16, 0), this.featureIndexArray = new Us(), this.promoteId = e;
      }

      _createClass(Tp, [{
        key: "insert",
        value: function insert(t, e, r, i, n) {
          var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;
          var a = this.featureIndexArray.length;
          this.featureIndexArray.emplaceBack(r, i, n, s);
          var o = this.grid;

          for (var _t204 = 0; _t204 < e.length; _t204++) {
            var _r184 = e[_t204],
                _i123 = [1 / 0, 1 / 0, -1 / 0, -1 / 0];

            for (var _t205 = 0; _t205 < _r184.length; _t205++) {
              var _e188 = _r184[_t205];
              _i123[0] = Math.min(_i123[0], _e188.x), _i123[1] = Math.min(_i123[1], _e188.y), _i123[2] = Math.max(_i123[2], _e188.x), _i123[3] = Math.max(_i123[3], _e188.y);
            }

            _i123[0] < 8192 && _i123[1] < 8192 && _i123[2] >= 0 && _i123[3] >= 0 && o.insert(a, _i123[0], _i123[1], _i123[2], _i123[3]);
          }
        }
      }, {
        key: "loadVTLayers",
        value: function loadVTLayers() {
          return this.vtLayers || (this.vtLayers = new Al.VectorTile(new ou(this.rawTileData)).layers, this.sourceLayerCoder = new xh(this.vtLayers ? Object.keys(this.vtLayers).sort() : ["_geojsonTileLayer"])), this.vtLayers;
        }
      }, {
        key: "query",
        value: function query(t, e, r, i) {
          var _this40 = this;

          this.loadVTLayers();
          var n = t.params || {},
              s = pi(n.filter),
              a = t.tileResult,
              o = t.transform,
              l = a.bufferedTilespaceBounds,
              u = this.grid.query(l.min.x, l.min.y, l.max.x, l.max.y, function (t, e, r, i) {
            return Da(a.bufferedTilespaceGeometry, t, e, r, i);
          });
          u.sort(Ep);
          var c = null;
          o.elevation && u.length > 0 && (c = Ip.create(o.elevation, this.tileID));
          var h = {};
          var p;

          var _loop5 = function (_o41) {
            var l = u[_o41];
            if (l === p) return "continue";
            p = l;

            var d = _this40.featureIndexArray.get(l);

            var f = null;

            _this40.loadMatchingFeature(h, d, s, n.layers, n.availableImages, e, r, i, function (e, r, i) {
              var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
              return f || (f = xa(e)), r.queryIntersectsFeature(a, e, i, f, _this40.z, t.transform, t.pixelPosMatrix, c, n);
            });
          };

          for (var _o41 = 0; _o41 < u.length; _o41++) {
            var _ret2 = _loop5(_o41);

            if (_ret2 === "continue") continue;
          }

          return h;
        }
      }, {
        key: "loadMatchingFeature",
        value: function loadMatchingFeature(t, e, r, i, n, s, a, o, l) {
          var {
            featureIndex: u,
            bucketIndex: c,
            sourceLayerIndex: h,
            layoutVertexArrayOffset: p
          } = e,
              d = this.bucketLayerIDs[c];
          if (i && !function (t, e) {
            for (var _r185 = 0; _r185 < t.length; _r185++) {
              if (e.indexOf(t[_r185]) >= 0) return !0;
            }

            return !1;
          }(i, d)) return;
          var f = this.sourceLayerCoder.decode(h),
              y = this.vtLayers[f].feature(u);

          if (r.needGeometry) {
            var _t206 = va(y, !0);

            if (!r.filter(new qn(this.tileID.overscaledZ), _t206, this.tileID.canonical)) return;
          } else if (!r.filter(new qn(this.tileID.overscaledZ), y)) return;

          var m = this.getId(y, f);

          for (var _e189 = 0; _e189 < d.length; _e189++) {
            var _r186 = d[_e189];
            if (i && i.indexOf(_r186) < 0) continue;
            var _c20 = s[_r186];
            if (!_c20) continue;
            var _h10 = {};
            void 0 !== m && o && (_h10 = o.getState(_c20.sourceLayer || "_geojsonTileLayer", m));

            var _f10 = x({}, a[_r186]);

            _f10.paint = zp(_f10.paint, _c20.paint, y, _h10, n), _f10.layout = zp(_f10.layout, _c20.layout, y, _h10, n);

            var _g10 = !l || l(y, _c20, _h10, p);

            if (!_g10) continue;

            var _v9 = new vh(y, this.z, this.x, this.y, m);

            _v9.layer = _f10;
            var _b8 = t[_r186];
            void 0 === _b8 && (_b8 = t[_r186] = []), _b8.push({
              featureIndex: u,
              feature: _v9,
              intersectionZ: _g10
            });
          }
        }
      }, {
        key: "lookupSymbolFeatures",
        value: function lookupSymbolFeatures(t, e, r, i, n, s, a, o) {
          var l = {};
          this.loadVTLayers();
          var u = pi(n);

          for (var _n100 of t) {
            this.loadMatchingFeature(l, {
              bucketIndex: r,
              sourceLayerIndex: i,
              featureIndex: _n100,
              layoutVertexArrayOffset: 0
            }, u, s, a, o, e);
          }

          return l;
        }
      }, {
        key: "hasLayer",
        value: function hasLayer(t) {
          for (var _e190 of this.bucketLayerIDs) {
            for (var _r187 of _e190) {
              if (t === _r187) return !0;
            }
          }

          return !1;
        }
      }, {
        key: "getId",
        value: function getId(t, e) {
          var r = t.id;
          return this.promoteId && (r = t.properties["string" == typeof this.promoteId ? this.promoteId : this.promoteId[e]], "boolean" == typeof r && (r = Number(r))), r;
        }
      }]);

      return Tp;
    }();

    function zp(t, e, r, i, n) {
      return S(t, function (t, s) {
        var a = e instanceof Yn ? e.get(s) : null;
        return a && a.evaluate ? a.evaluate(r, i, n) : a;
      });
    }

    function Ep(t, e) {
      return e - t;
    }

    Gi("FeatureIndex", Tp, {
      omit: ["rawTileData", "sourceLayerCoder"]
    });

    var Mp = function Mp(t) {
      _classCallCheck(this, Mp);

      var e = {},
          r = [];

      for (var _i124 in t) {
        var _n101 = t[_i124],
            _s86 = e[_i124] = {};

        for (var _t207 in _n101) {
          var _e191 = _n101[+_t207];
          if (!_e191 || 0 === _e191.bitmap.width || 0 === _e191.bitmap.height) continue;

          var _i125 = _e191.metrics.localGlyph ? 2 : 1,
              _a74 = {
            x: 0,
            y: 0,
            w: _e191.bitmap.width + 2 * _i125,
            h: _e191.bitmap.height + 2 * _i125
          };

          r.push(_a74), _s86[_t207] = {
            rect: _a74,
            metrics: _e191.metrics
          };
        }
      }

      var {
        w: i,
        h: n
      } = zu(r),
          s = new _o({
        width: i || 1,
        height: n || 1
      });

      for (var _r188 in t) {
        var _i126 = t[_r188];

        for (var _t208 in _i126) {
          var _n102 = _i126[+_t208];
          if (!_n102 || 0 === _n102.bitmap.width || 0 === _n102.bitmap.height) continue;

          var _a75 = e[_r188][_t208].rect,
              _o42 = _n102.metrics.localGlyph ? 2 : 1;

          _o.copy(_n102.bitmap, s, {
            x: 0,
            y: 0
          }, {
            x: _a75.x + _o42,
            y: _a75.y + _o42
          }, _n102.bitmap);
        }
      }

      this.image = s, this.positions = e;
    };

    Gi("GlyphAtlas", Mp);

    var Bp = /*#__PURE__*/function () {
      function Bp(t) {
        _classCallCheck(this, Bp);

        this.tileID = new mh(t.tileID.overscaledZ, t.tileID.wrap, t.tileID.canonical.z, t.tileID.canonical.x, t.tileID.canonical.y), this.tileZoom = t.tileZoom, this.uid = t.uid, this.zoom = t.zoom, this.pixelRatio = t.pixelRatio, this.tileSize = t.tileSize, this.source = t.source, this.overscaling = this.tileID.overscaleFactor(), this.showCollisionBoxes = t.showCollisionBoxes, this.collectResourceTiming = !!t.collectResourceTiming, this.returnDependencies = !!t.returnDependencies, this.promoteId = t.promoteId, this.enableTerrain = !!t.enableTerrain, this.isSymbolTile = t.isSymbolTile;
      }

      _createClass(Bp, [{
        key: "parse",
        value: function parse(t, e, r, i, n) {
          var _this41 = this;

          this.status = "parsing", this.data = t, this.collisionBoxArray = new Bs();
          var s = new xh(Object.keys(t.layers).sort()),
              a = new Tp(this.tileID, this.promoteId);
          a.bucketLayerIDs = [];
          var o = {},
              l = {
            featureIndex: a,
            iconDependencies: {},
            patternDependencies: {},
            glyphDependencies: {},
            availableImages: r
          },
              u = e.familiesBySource[this.source];

          for (var _e192 in u) {
            var _i127 = t.layers[_e192];
            if (!_i127) continue;

            var _n103 = !1,
                _c21 = !1;

            for (var _t209 of u[_e192]) {
              "symbol" === _t209[0].type ? _n103 = !0 : _c21 = !0;
            }

            if (!0 === this.isSymbolTile && !_n103) continue;
            if (!1 === this.isSymbolTile && !_c21) continue;
            1 === _i127.version && E("Vector tile source \"".concat(this.source, "\" layer \"").concat(_e192, "\" ") + "does not use vector tile spec v2 and therefore may have some rendering errors.");

            var _h11 = s.encode(_e192),
                _p14 = [];

            for (var _t210 = 0; _t210 < _i127.length; _t210++) {
              var _r189 = _i127.feature(_t210),
                  _n104 = a.getId(_r189, _e192);

              _p14.push({
                feature: _r189,
                id: _n104,
                index: _t210,
                sourceLayerIndex: _h11
              });
            }

            for (var _t211 of u[_e192]) {
              var _e193 = _t211[0];
              void 0 !== this.isSymbolTile && "symbol" === _e193.type !== this.isSymbolTile || _e193.minzoom && this.zoom < Math.floor(_e193.minzoom) || _e193.maxzoom && this.zoom >= _e193.maxzoom || "none" !== _e193.visibility && (Dp(_t211, this.zoom, r), (o[_e193.id] = _e193.createBucket({
                index: a.bucketLayerIDs.length,
                layers: _t211,
                zoom: this.zoom,
                pixelRatio: this.pixelRatio,
                overscaling: this.overscaling,
                collisionBoxArray: this.collisionBoxArray,
                sourceLayerIndex: _h11,
                sourceID: this.source,
                enableTerrain: this.enableTerrain
              })).populate(_p14, l, this.tileID.canonical), a.bucketLayerIDs.push(_t211.map(function (t) {
                return t.id;
              })));
            }
          }

          var c, h, p, d;
          var f = {
            type: "maybePrepare",
            isSymbolTile: this.isSymbolTile,
            zoom: this.zoom
          },
              y = S(l.glyphDependencies, function (t) {
            return Object.keys(t).map(Number);
          });
          Object.keys(y).length ? i.send("getGlyphs", {
            uid: this.uid,
            stacks: y
          }, function (t, e) {
            c || (c = t, h = e, v.call(_this41));
          }, void 0, void 0, f) : h = {};
          var m = Object.keys(l.iconDependencies);
          m.length ? i.send("getImages", {
            icons: m,
            source: this.source,
            tileID: this.tileID,
            type: "icons"
          }, function (t, e) {
            c || (c = t, p = e, v.call(_this41));
          }, void 0, void 0, f) : p = {};
          var x = Object.keys(l.patternDependencies);

          function v() {
            if (c) return n(c);

            if (h && p && d) {
              var _t212 = new Mp(h),
                  _e194 = new Mu(p, d);

              for (var _i128 in o) {
                var _n105 = o[_i128];
                _n105 instanceof Vc ? (Dp(_n105.layers, this.zoom, r), bc(_n105, h, _t212.positions, p, _e194.iconPositions, this.showCollisionBoxes, this.tileID.canonical, this.tileZoom)) : _n105.hasPattern && (_n105 instanceof ql || _n105 instanceof cl || _n105 instanceof El) && (Dp(_n105.layers, this.zoom, r), _n105.addFeatures(l, this.tileID.canonical, _e194.patternPositions));
              }

              this.status = "done", n(null, {
                buckets: g(o).filter(function (t) {
                  return !t.isEmpty();
                }),
                featureIndex: a,
                collisionBoxArray: this.collisionBoxArray,
                glyphAtlasImage: _t212.image,
                imageAtlas: _e194,
                glyphMap: this.returnDependencies ? h : null,
                iconMap: this.returnDependencies ? p : null,
                glyphPositions: this.returnDependencies ? _t212.positions : null
              });
            }
          }

          x.length ? i.send("getImages", {
            icons: x,
            source: this.source,
            tileID: this.tileID,
            type: "patterns"
          }, function (t, e) {
            c || (c = t, d = e, v.call(_this41));
          }, void 0, void 0, f) : d = {}, v.call(this);
        }
      }]);

      return Bp;
    }();

    function Dp(t, e, r) {
      var i = new qn(e);

      for (var _e195 of t) {
        _e195.recalculate(i, r);
      }
    }

    var Cp = /*#__PURE__*/function () {
      function Cp(t) {
        _classCallCheck(this, Cp);

        this.entries = {}, this.scheduler = t;
      }

      _createClass(Cp, [{
        key: "request",
        value: function request(t, e, r, i) {
          var _this42 = this;

          var n = this.entries[t] = this.entries[t] || {
            callbacks: []
          };

          if (n.result) {
            var [_t213, _r190] = n.result;
            return this.scheduler ? this.scheduler.add(function () {
              i(_t213, _r190);
            }, e) : i(_t213, _r190), function () {};
          }

          return n.callbacks.push(i), n.cancel || (n.cancel = r(function (r, i) {
            n.result = [r, i];

            var _loop6 = function (_t214) {
              _this42.scheduler ? _this42.scheduler.add(function () {
                _t214(r, i);
              }, e) : _t214(r, i);
            };

            for (var _t214 of n.callbacks) {
              _loop6(_t214);
            }

            setTimeout(function () {
              return delete _this42.entries[t];
            }, 3e3);
          })), function () {
            n.result || (n.callbacks = n.callbacks.filter(function (t) {
              return t !== i;
            }), n.callbacks.length || (n.cancel(), delete _this42.entries[t]));
          };
        }
      }]);

      return Cp;
    }();

    function Pp(t, e, r) {
      var i = JSON.stringify(t.request);
      return t.data && (this.deduped.entries[i] = {
        result: [null, t.data]
      }), this.deduped.request(i, {
        type: "parseTile",
        isSymbolTile: t.isSymbolTile,
        zoom: t.tileZoom
      }, function (e) {
        var i = kt(t.request, function (t, i, n, s) {
          t ? e(t) : i && e(null, {
            vectorTile: r ? void 0 : new Al.VectorTile(new ou(i)),
            rawData: i,
            cacheControl: n,
            expires: s
          });
        });
        return function () {
          i.cancel(), e();
        };
      }, e);
    }

    t.AUTH_ERR_MSG = "NO_ACCESS_TOKEN", t.Aabb = po, t.Actor = /*#__PURE__*/function () {
      function _class5(t, e, r) {
        _classCallCheck(this, _class5);

        this.target = t, this.parent = e, this.mapId = r, this.callbacks = {}, this.cancelCallbacks = {}, k(["receive"], this), this.target.addEventListener("message", this.receive, !1), this.globalScope = D() ? t : s, this.scheduler = new eh();
      }

      _createClass(_class5, [{
        key: "send",
        value: function send(t, e, r, i) {
          var _this43 = this;

          var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;
          var s = arguments.length > 5 ? arguments[5] : undefined;
          var a = Math.round(1e18 * Math.random()).toString(36).substring(0, 10);
          r && (r.metadata = s, this.callbacks[a] = r);
          var o = R(this.globalScope) ? void 0 : [];
          return this.target.postMessage({
            id: a,
            type: t,
            hasCallback: !!r,
            targetMapId: i,
            mustQueue: n,
            sourceMapId: this.mapId,
            data: Ki(e, o)
          }, o), {
            cancel: function () {
              r && delete _this43.callbacks[a], _this43.target.postMessage({
                id: a,
                type: "<cancel>",
                targetMapId: i,
                sourceMapId: _this43.mapId
              });
            }
          };
        }
      }, {
        key: "receive",
        value: function receive(t) {
          var _this44 = this;

          var e = t.data,
              r = e.id;
          if (r && (!e.targetMapId || this.mapId === e.targetMapId)) if ("<cancel>" === e.type) {
            var _t215 = this.cancelCallbacks[r];
            delete this.cancelCallbacks[r], _t215 && _t215.cancel();
          } else if (D() || e.mustQueue) {
            var _t216 = this.callbacks[r];
            this.cancelCallbacks[r] = this.scheduler.add(function () {
              return _this44.processTask(r, e);
            }, _t216 && _t216.metadata || {
              type: "message"
            });
          } else this.processTask(r, e);
        }
      }, {
        key: "processTask",
        value: function processTask(t, e) {
          var _this45 = this;

          if ("<response>" === e.type) {
            var _r191 = this.callbacks[t];
            delete this.callbacks[t], _r191 && (e.error ? _r191(Hi(e.error)) : _r191(null, Hi(e.data)));
          } else {
            var _r192 = R(this.globalScope) ? void 0 : [],
                _i129 = e.hasCallback ? function (e, i) {
              delete _this45.cancelCallbacks[t], _this45.target.postMessage({
                id: t,
                type: "<response>",
                sourceMapId: _this45.mapId,
                error: e ? Ki(e) : null,
                data: Ki(i, _r192)
              }, _r192);
            } : function (t) {},
                _n106 = Hi(e.data);

            if (this.parent[e.type]) this.parent[e.type](e.sourceMapId, _n106, _i129);else if (this.parent.getWorkerSource) {
              var _t217 = e.type.split(".");

              this.parent.getWorkerSource(e.sourceMapId, _t217[0], _n106.source)[_t217[1]](_n106, _i129);
            } else _i129(new Error("Could not find function ".concat(e.type)));
          }
        }
      }, {
        key: "remove",
        value: function remove() {
          this.scheduler.remove(), this.target.removeEventListener("message", this.receive, !1);
        }
      }]);

      return _class5;
    }(), t.CanonicalTileID = fh, t.Color = le, t.ColorMode = wp, t.Context = /*#__PURE__*/function () {
      function _class6(t) {
        _classCallCheck(this, _class6);

        this.gl = t, this.extVertexArrayObject = this.gl.getExtension("OES_vertex_array_object"), this.clearColor = new Lh(this), this.clearDepth = new Uh(this), this.clearStencil = new Oh(this), this.colorMask = new $h(this), this.depthMask = new qh(this), this.stencilMask = new Nh(this), this.stencilFunc = new jh(this), this.stencilOp = new Gh(this), this.stencilTest = new Zh(this), this.depthRange = new Xh(this), this.depthTest = new Kh(this), this.depthFunc = new Hh(this), this.blend = new Yh(this), this.blendFunc = new Wh(this), this.blendColor = new Jh(this), this.blendEquation = new Qh(this), this.cullFace = new tp(this), this.cullFaceSide = new ep(this), this.frontFace = new rp(this), this.program = new ip(this), this.activeTexture = new np(this), this.viewport = new sp(this), this.bindFramebuffer = new ap(this), this.bindRenderbuffer = new op(this), this.bindTexture = new lp(this), this.bindVertexBuffer = new up(this), this.bindElementBuffer = new cp(this), this.bindVertexArrayOES = this.extVertexArrayObject && new hp(this), this.pixelStoreUnpack = new pp(this), this.pixelStoreUnpackPremultiplyAlpha = new dp(this), this.pixelStoreUnpackFlipY = new fp(this), this.extTextureFilterAnisotropic = t.getExtension("EXT_texture_filter_anisotropic") || t.getExtension("MOZ_EXT_texture_filter_anisotropic") || t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"), this.extTextureFilterAnisotropic && (this.extTextureFilterAnisotropicMax = t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)), this.extTextureFilterAnisotropicForceOff = !1, this.extTextureHalfFloat = t.getExtension("OES_texture_half_float"), this.extTextureHalfFloat && (t.getExtension("OES_texture_half_float_linear"), this.extRenderToTextureHalfFloat = t.getExtension("EXT_color_buffer_half_float")), this.extTimerQuery = t.getExtension("EXT_disjoint_timer_query"), this.maxTextureSize = t.getParameter(t.MAX_TEXTURE_SIZE);
      }

      _createClass(_class6, [{
        key: "setDefault",
        value: function setDefault() {
          this.unbindVAO(), this.clearColor.setDefault(), this.clearDepth.setDefault(), this.clearStencil.setDefault(), this.colorMask.setDefault(), this.depthMask.setDefault(), this.stencilMask.setDefault(), this.stencilFunc.setDefault(), this.stencilOp.setDefault(), this.stencilTest.setDefault(), this.depthRange.setDefault(), this.depthTest.setDefault(), this.depthFunc.setDefault(), this.blend.setDefault(), this.blendFunc.setDefault(), this.blendColor.setDefault(), this.blendEquation.setDefault(), this.cullFace.setDefault(), this.cullFaceSide.setDefault(), this.frontFace.setDefault(), this.program.setDefault(), this.activeTexture.setDefault(), this.bindFramebuffer.setDefault(), this.pixelStoreUnpack.setDefault(), this.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.pixelStoreUnpackFlipY.setDefault();
        }
      }, {
        key: "setDirty",
        value: function setDirty() {
          this.clearColor.dirty = !0, this.clearDepth.dirty = !0, this.clearStencil.dirty = !0, this.colorMask.dirty = !0, this.depthMask.dirty = !0, this.stencilMask.dirty = !0, this.stencilFunc.dirty = !0, this.stencilOp.dirty = !0, this.stencilTest.dirty = !0, this.depthRange.dirty = !0, this.depthTest.dirty = !0, this.depthFunc.dirty = !0, this.blend.dirty = !0, this.blendFunc.dirty = !0, this.blendColor.dirty = !0, this.blendEquation.dirty = !0, this.cullFace.dirty = !0, this.cullFaceSide.dirty = !0, this.frontFace.dirty = !0, this.program.dirty = !0, this.activeTexture.dirty = !0, this.viewport.dirty = !0, this.bindFramebuffer.dirty = !0, this.bindRenderbuffer.dirty = !0, this.bindTexture.dirty = !0, this.bindVertexBuffer.dirty = !0, this.bindElementBuffer.dirty = !0, this.extVertexArrayObject && (this.bindVertexArrayOES.dirty = !0), this.pixelStoreUnpack.dirty = !0, this.pixelStoreUnpackPremultiplyAlpha.dirty = !0, this.pixelStoreUnpackFlipY.dirty = !0;
        }
      }, {
        key: "createIndexBuffer",
        value: function createIndexBuffer(t, e) {
          return new Ph(this, t, e);
        }
      }, {
        key: "createVertexBuffer",
        value: function createVertexBuffer(t, e, r) {
          return new Fh(this, t, e, r);
        }
      }, {
        key: "createRenderbuffer",
        value: function createRenderbuffer(t, e, r) {
          var i = this.gl,
              n = i.createRenderbuffer();
          return this.bindRenderbuffer.set(n), i.renderbufferStorage(i.RENDERBUFFER, t, e, r), this.bindRenderbuffer.set(null), n;
        }
      }, {
        key: "createFramebuffer",
        value: function createFramebuffer(t, e, r) {
          return new xp(this, t, e, r);
        }
      }, {
        key: "clear",
        value: function clear(_ref66) {
          var {
            color: t,
            depth: e,
            stencil: r
          } = _ref66;
          var i = this.gl;
          var n = 0;
          t && (n |= i.COLOR_BUFFER_BIT, this.clearColor.set(t), this.colorMask.set([!0, !0, !0, !0])), void 0 !== e && (n |= i.DEPTH_BUFFER_BIT, this.depthRange.set([0, 1]), this.clearDepth.set(e), this.depthMask.set(!0)), void 0 !== r && (n |= i.STENCIL_BUFFER_BIT, this.clearStencil.set(r), this.stencilMask.set(255)), i.clear(n);
        }
      }, {
        key: "setCullFace",
        value: function setCullFace(t) {
          !1 === t.enable ? this.cullFace.set(!1) : (this.cullFace.set(!0), this.cullFaceSide.set(t.mode), this.frontFace.set(t.frontFace));
        }
      }, {
        key: "setDepthMode",
        value: function setDepthMode(t) {
          t.func !== this.gl.ALWAYS || t.mask ? (this.depthTest.set(!0), this.depthFunc.set(t.func), this.depthMask.set(t.mask), this.depthRange.set(t.range)) : this.depthTest.set(!1);
        }
      }, {
        key: "setStencilMode",
        value: function setStencilMode(t) {
          t.test.func !== this.gl.ALWAYS || t.mask ? (this.stencilTest.set(!0), this.stencilMask.set(t.mask), this.stencilOp.set([t.fail, t.depthFail, t.pass]), this.stencilFunc.set({
            func: t.test.func,
            ref: t.ref,
            mask: t.test.mask
          })) : this.stencilTest.set(!1);
        }
      }, {
        key: "setColorMode",
        value: function setColorMode(t) {
          a(t.blendFunction, wp.Replace) ? this.blend.set(!1) : (this.blend.set(!0), this.blendFunc.set(t.blendFunction), this.blendColor.set(t.blendColor)), this.colorMask.set(t.mask);
        }
      }, {
        key: "unbindVAO",
        value: function unbindVAO() {
          this.extVertexArrayObject && this.bindVertexArrayOES.set(null);
        }
      }]);

      return _class6;
    }(), t.CullFaceMode = _p, t.DEMData = Dh, t.DataConstantProperty = Wn, t.DedupedRequest = Cp, t.DepthMode = vp, t.DepthStencilAttachment = /*#__PURE__*/function (_gp) {
      _inherits(_class7, _gp);

      var _super94 = _createSuper(_class7);

      function _class7() {
        _classCallCheck(this, _class7);

        return _super94.apply(this, arguments);
      }

      _createClass(_class7, [{
        key: "attachment",
        value: function attachment() {
          return this.gl.DEPTH_STENCIL_ATTACHMENT;
        }
      }]);

      return _class7;
    }(gp), t.EXTENT = 8192, t.Elevation = /*#__PURE__*/function () {
      function _class8() {
        _classCallCheck(this, _class8);
      }

      _createClass(_class8, [{
        key: "getAtPoint",
        value: function getAtPoint(t) {
          var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

          var r = this._source();

          if (!r) return e;
          if (t.y < 0 || t.y > 1) return e;
          var i = r.getSource().maxzoom,
              n = 1 << i,
              s = Math.floor(t.x),
              a = t.x - s,
              o = new mh(i, s, i, Math.floor(a * n), Math.floor(t.y * n)),
              l = this.findDEMTileFor(o);
          if (!l || !l.dem) return e;
          var u = l.dem,
              c = 1 << l.tileID.canonical.z,
              h = (a * c - l.tileID.canonical.x) * u.dim,
              p = (t.y * c - l.tileID.canonical.y) * u.dim,
              d = Math.floor(h),
              f = Math.floor(p);
          return this.exaggeration() * Je(Je(u.get(d, f), u.get(d, f + 1), p - f), Je(u.get(d + 1, f), u.get(d + 1, f + 1), p - f), h - d);
        }
      }, {
        key: "getAtTileOffset",
        value: function getAtTileOffset(t, e, r) {
          var i = 1 << t.canonical.z;
          return this.getAtPoint(new ph(t.wrap + (t.canonical.x + e / 8192) / i, (t.canonical.y + r / 8192) / i));
        }
      }, {
        key: "getForTilePoints",
        value: function getForTilePoints(t, e, r, i) {
          var _this46 = this;

          var n = Ip.create(this, t, i);
          return !!n && (e.forEach(function (t) {
            t[2] = _this46.exaggeration() * n.getElevationAt(t[0], t[1], r);
          }), !0);
        }
      }, {
        key: "getMinMaxForTile",
        value: function getMinMaxForTile(t) {
          var e = this.findDEMTileFor(t);
          if (!e || !e.dem) return null;
          var r = e.dem.tree,
              i = e.tileID,
              n = 1 << t.canonical.z - i.canonical.z;
          var s = t.canonical.x / n - i.canonical.x,
              a = t.canonical.y / n - i.canonical.y,
              o = 0;

          for (var _e196 = 0; _e196 < t.canonical.z - i.canonical.z && !r.leaves[o]; _e196++) {
            s *= 2, a *= 2;

            var _t218 = 2 * Math.floor(a) + Math.floor(s);

            o = r.childOffsets[o] + _t218, s %= 1, a %= 1;
          }

          return {
            min: this.exaggeration() * r.minimums[o],
            max: this.exaggeration() * r.maximums[o]
          };
        }
      }, {
        key: "raycast",
        value: function raycast(t, e, r) {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "pointCoordinate",
        value: function pointCoordinate(t) {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "_source",
        value: function _source() {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "exaggeration",
        value: function exaggeration() {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "findDEMTileFor",
        value: function findDEMTileFor(t) {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "visibleDemTiles",
        get: function () {
          throw new Error("Getter must be implemented in subclass.");
        }
      }]);

      return _class8;
    }(), t.ErrorEvent = Pt, t.EvaluationParameters = qn, t.Event = Ct, t.Evented = Vt, t.Frustum = ho, t.GlyphManager = oc, t.ImagePosition = Eu, t.LngLat = nh, t.LngLatBounds = ih, t.LocalGlyphMode = ac, t.MAX_SAFE_INTEGER = o, t.MercatorCoordinate = ph, t.ONE_EM = 24, t.OverscaledTileID = mh, t.Point = i, t.Point$1 = i, t.Properties = rs, t.RGBAImage = ko, t.Ray = /*#__PURE__*/function () {
      function _class9(t, e) {
        _classCallCheck(this, _class9);

        this.pos = t, this.dir = e;
      }

      _createClass(_class9, [{
        key: "intersectsPlane",
        value: function intersectsPlane(t, e, r) {
          var i = to(e, this.dir);
          if (Math.abs(i) < 1e-6) return !1;
          var n = to(so(Ga(), t, this.pos), e) / i;
          return function (t, e) {
            t[0] = e[0], t[1] = e[1], t[2] = e[2];
          }(r, Ja(Ga(), this.pos, this.dir, n)), !0;
        }
      }]);

      return _class9;
    }(), t.RequestManager = /*#__PURE__*/function () {
      function _class10(t, e) {
        _classCallCheck(this, _class10);

        this._transformRequestFn = t, this._customAccessToken = e, this._createSkuToken();
      }

      _createClass(_class10, [{
        key: "_createSkuToken",
        value: function _createSkuToken() {
          var t = function () {
            var t = "";

            for (var _e197 = 0; _e197 < 10; _e197++) {
              t += "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62 * Math.random())];
            }

            return {
              token: ["1", Y, t].join(""),
              tokenExpiresAt: Date.now() + 432e5
            };
          }();

          this._skuToken = t.token, this._skuTokenExpiresAt = t.tokenExpiresAt;
        }
      }, {
        key: "_isSkuTokenExpired",
        value: function _isSkuTokenExpired() {
          return Date.now() > this._skuTokenExpiresAt;
        }
      }, {
        key: "transformRequest",
        value: function transformRequest(t, e) {
          return this._transformRequestFn && this._transformRequestFn(t, e) || {
            url: t
          };
        }
      }, {
        key: "normalizeStyleURL",
        value: function normalizeStyleURL(t, e) {
          if (!W(t)) return t;
          var r = tt(t);
          return r.path = "/styles/v1".concat(r.path), this._makeAPIURL(r, this._customAccessToken || e);
        }
      }, {
        key: "normalizeGlyphsURL",
        value: function normalizeGlyphsURL(t, e) {
          if (!W(t)) return t;
          var r = tt(t);
          return r.path = "/fonts/v1".concat(r.path), this._makeAPIURL(r, this._customAccessToken || e);
        }
      }, {
        key: "normalizeSourceURL",
        value: function normalizeSourceURL(t, e) {
          if (!W(t)) return t;
          var r = tt(t);
          return r.path = "/v4/".concat(r.authority, ".json"), r.params.push("secure"), this._makeAPIURL(r, this._customAccessToken || e);
        }
      }, {
        key: "normalizeSpriteURL",
        value: function normalizeSpriteURL(t, e, r, i) {
          var n = tt(t);
          return W(t) ? (n.path = "/styles/v1".concat(n.path, "/sprite").concat(e).concat(r), this._makeAPIURL(n, this._customAccessToken || i)) : (n.path += "".concat(e).concat(r), et(n));
        }
      }, {
        key: "normalizeTileURL",
        value: function normalizeTileURL(t, e, r) {
          if (this._isSkuTokenExpired() && this._createSkuToken(), t && !W(t)) return t;
          var i = tt(t);
          i.path = i.path.replace(/(\.(png|jpg)\d*)(?=$)/, "".concat(e || r && "raster" !== i.authority && 512 === r ? "@2x" : "").concat(j.supported ? ".webp" : "$1")), "raster" === i.authority ? i.path = "/".concat(N.RASTER_URL_PREFIX).concat(i.path) : (i.path = i.path.replace(/^.+\/v4\//, "/"), i.path = "/".concat(N.TILE_URL_VERSION).concat(i.path));

          var n = this._customAccessToken || function (t) {
            for (var _e198 of t) {
              var _t219 = _e198.match(/^access_token=(.*)$/);

              if (_t219) return _t219[1];
            }

            return null;
          }(i.params) || N.ACCESS_TOKEN;

          return N.REQUIRE_ACCESS_TOKEN && n && this._skuToken && i.params.push("sku=".concat(this._skuToken)), this._makeAPIURL(i, n);
        }
      }, {
        key: "canonicalizeTileURL",
        value: function canonicalizeTileURL(t, e) {
          var r = tt(t);
          if (!r.path.match(/^(\/v4\/|\/raster\/v1\/)/) || !r.path.match(/\.[\w]+$/)) return t;
          var i = "mapbox://";
          r.path.match(/^\/raster\/v1\//) ? i += "raster/".concat(r.path.replace("/".concat(N.RASTER_URL_PREFIX, "/"), "")) : i += "tiles/".concat(r.path.replace("/".concat(N.TILE_URL_VERSION, "/"), ""));
          var n = r.params;
          return e && (n = n.filter(function (t) {
            return !t.match(/^access_token=/);
          })), n.length && (i += "?".concat(n.join("&"))), i;
        }
      }, {
        key: "canonicalizeTileset",
        value: function canonicalizeTileset(t, e) {
          var r = !!e && W(e),
              i = [];

          for (var _e199 of t.tiles || []) {
            J(_e199) ? i.push(this.canonicalizeTileURL(_e199, r)) : i.push(_e199);
          }

          return i;
        }
      }, {
        key: "_makeAPIURL",
        value: function _makeAPIURL(t, e) {
          var r = "See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",
              i = tt(N.API_URL);

          if (t.protocol = i.protocol, t.authority = i.authority, "http" === t.protocol) {
            var _e200 = t.params.indexOf("secure");

            _e200 >= 0 && t.params.splice(_e200, 1);
          }

          if ("/" !== i.path && (t.path = "".concat(i.path).concat(t.path)), !N.REQUIRE_ACCESS_TOKEN) return et(t);
          if (!(e = e || N.ACCESS_TOKEN)) throw new Error("An API access token is required to use Mapbox GL. ".concat(r));
          if ("s" === e[0]) throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ".concat(r));
          return t.params = t.params.filter(function (t) {
            return -1 === t.indexOf("access_token");
          }), t.params.push("access_token=".concat(e)), et(t);
        }
      }]);

      return _class10;
    }(), t.RequestPerformance = th, t.ResourceType = vt, t.SegmentVector = ya, t.SourceCache = kp, t.StencilMode = bp, t.StructArrayLayout1ui2 = zs, t.StructArrayLayout2f1f2i16 = vs, t.StructArrayLayout2i4 = us, t.StructArrayLayout3f12 = ys, t.StructArrayLayout3ui6 = ws, t.StructArrayLayout4i8 = cs, t.Texture = Wc, t.Tile = wh, t.Transitionable = Gn, t.Uniform1f = Ws, t.Uniform1i = /*#__PURE__*/function (_Ys4) {
      _inherits(_class11, _Ys4);

      var _super95 = _createSuper(_class11);

      function _class11(t, e) {
        var _this47;

        _classCallCheck(this, _class11);

        _this47 = _super95.call(this, t, e), _this47.current = 0;
        return _this47;
      }

      _createClass(_class11, [{
        key: "set",
        value: function set(t) {
          this.current !== t && (this.current = t, this.gl.uniform1i(this.location, t));
        }
      }]);

      return _class11;
    }(Ys), t.Uniform2f = /*#__PURE__*/function (_Ys5) {
      _inherits(_class12, _Ys5);

      var _super96 = _createSuper(_class12);

      function _class12(t, e) {
        var _this48;

        _classCallCheck(this, _class12);

        _this48 = _super96.call(this, t, e), _this48.current = [0, 0];
        return _this48;
      }

      _createClass(_class12, [{
        key: "set",
        value: function set(t) {
          t[0] === this.current[0] && t[1] === this.current[1] || (this.current = t, this.gl.uniform2f(this.location, t[0], t[1]));
        }
      }]);

      return _class12;
    }(Ys), t.Uniform3f = /*#__PURE__*/function (_Ys6) {
      _inherits(_class13, _Ys6);

      var _super97 = _createSuper(_class13);

      function _class13(t, e) {
        var _this49;

        _classCallCheck(this, _class13);

        _this49 = _super97.call(this, t, e), _this49.current = [0, 0, 0];
        return _this49;
      }

      _createClass(_class13, [{
        key: "set",
        value: function set(t) {
          t[0] === this.current[0] && t[1] === this.current[1] && t[2] === this.current[2] || (this.current = t, this.gl.uniform3f(this.location, t[0], t[1], t[2]));
        }
      }]);

      return _class13;
    }(Ys), t.Uniform4f = Js, t.UniformColor = Qs, t.UniformMatrix3f = /*#__PURE__*/function (_Ys7) {
      _inherits(_class14, _Ys7);

      var _super98 = _createSuper(_class14);

      function _class14(t, e) {
        var _this50;

        _classCallCheck(this, _class14);

        _this50 = _super98.call(this, t, e), _this50.current = ea;
        return _this50;
      }

      _createClass(_class14, [{
        key: "set",
        value: function set(t) {
          for (var _e201 = 0; _e201 < 9; _e201++) {
            if (t[_e201] !== this.current[_e201]) {
              this.current = t, this.gl.uniformMatrix3fv(this.location, !1, t);
              break;
            }
          }
        }
      }]);

      return _class14;
    }(Ys), t.UniformMatrix4f = /*#__PURE__*/function (_Ys8) {
      _inherits(_class15, _Ys8);

      var _super99 = _createSuper(_class15);

      function _class15(t, e) {
        var _this51;

        _classCallCheck(this, _class15);

        _this51 = _super99.call(this, t, e), _this51.current = ta;
        return _this51;
      }

      _createClass(_class15, [{
        key: "set",
        value: function set(t) {
          if (t[12] !== this.current[12] || t[0] !== this.current[0]) return this.current = t, void this.gl.uniformMatrix4fv(this.location, !1, t);

          for (var _e202 = 1; _e202 < 16; _e202++) {
            if (t[_e202] !== this.current[_e202]) {
              this.current = t, this.gl.uniformMatrix4fv(this.location, !1, t);
              break;
            }
          }
        }
      }]);

      return _class15;
    }(Ys), t.UnwrappedTileID = yh, t.ValidationError = Rt, t.VectorTileWorkerSource = /*#__PURE__*/function (_Vt3) {
      _inherits(_class16, _Vt3);

      var _super100 = _createSuper(_class16);

      function _class16(t, e, r, i, n) {
        var _this52;

        _classCallCheck(this, _class16);

        _this52 = _super100.call(this), _this52.actor = t, _this52.layerIndex = e, _this52.availableImages = r, _this52.loadVectorData = n || Pp, _this52.loading = {}, _this52.loaded = {}, _this52.deduped = new Cp(t.scheduler), _this52.isSpriteLoaded = i, _this52.scheduler = t.scheduler;
        return _this52;
      }

      _createClass(_class16, [{
        key: "loadTile",
        value: function loadTile(t, e) {
          var _this53 = this;

          var r = t.uid,
              i = !!(t && t.request && t.request.collectResourceTiming) && new th(t.request),
              n = this.loading[r] = new Bp(t);
          n.abort = this.loadVectorData(t, function (s, a) {
            var o = !_this53.loading[r];
            if (delete _this53.loading[r], o || s || !a) return n.status = "done", o || (_this53.loaded[r] = n), e(s);
            var l = a.rawData,
                u = {};
            a.expires && (u.expires = a.expires), a.cacheControl && (u.cacheControl = a.cacheControl);
            var c = {};

            if (i) {
              var _t220 = i.finish();

              _t220 && (c.resourceTiming = JSON.parse(JSON.stringify(_t220)));
            }

            n.vectorTile = a.vectorTile || new Al.VectorTile(new ou(l));

            var h = function () {
              n.parse(n.vectorTile, _this53.layerIndex, _this53.availableImages, _this53.actor, function (t, r) {
                if (t || !r) return e(t);
                e(null, x({
                  rawTileData: l.slice(0)
                }, r, u, c));
              });
            };

            _this53.isSpriteLoaded ? h() : _this53.once("isSpriteLoaded", function () {
              _this53.scheduler ? _this53.scheduler.add(h, {
                type: "parseTile",
                isSymbolTile: t.isSymbolTile,
                zoom: t.tileZoom
              }) : h();
            }), _this53.loaded = _this53.loaded || {}, _this53.loaded[r] = n;
          });
        }
      }, {
        key: "reloadTile",
        value: function reloadTile(t, e) {
          var _this54 = this;

          var r = this.loaded,
              i = t.uid,
              n = this;

          if (r && r[i]) {
            var _s87 = r[i];
            _s87.showCollisionBoxes = t.showCollisionBoxes, _s87.enableTerrain = !!t.enableTerrain;

            var _a76 = function (t, r) {
              var i = _s87.reloadCallback;
              i && (delete _s87.reloadCallback, _s87.parse(_s87.vectorTile, n.layerIndex, _this54.availableImages, n.actor, i)), e(t, r);
            };

            "parsing" === _s87.status ? _s87.reloadCallback = _a76 : "done" === _s87.status && (_s87.vectorTile ? _s87.parse(_s87.vectorTile, this.layerIndex, this.availableImages, this.actor, _a76) : _a76());
          }
        }
      }, {
        key: "abortTile",
        value: function abortTile(t, e) {
          var r = t.uid,
              i = this.loading[r];
          i && (i.abort && i.abort(), delete this.loading[r]), e();
        }
      }, {
        key: "removeTile",
        value: function removeTile(t, e) {
          var r = this.loaded,
              i = t.uid;
          r && r[i] && delete r[i], e();
        }
      }]);

      return _class16;
    }(Vt), t.WritingMode = Bu, t.ZoomHistory = Yi, t.add = Ha, t.addDynamicAttributes = Bc, t.altitudeFromMercatorZ = hh, t.asyncAll = m, t.bezier = p, t.bindAll = k, t.browser = $, t.bufferConvexPolygon = function (t, e) {
      var r = [];

      for (var _i130 = 0; _i130 < t.length; _i130++) {
        var _n107 = y(_i130 - 1, -1, t.length - 1),
            _s88 = y(_i130 + 1, -1, t.length - 1),
            _a77 = t[_i130],
            _o43 = t[_s88],
            _l31 = t[_n107].sub(_a77).unit(),
            _u29 = _o43.sub(_a77).unit(),
            _c22 = _u29.angleWithSep(_l31.x, _l31.y),
            _h12 = _l31.add(_u29).unit().mult(-1 * e / Math.sin(_c22 / 2));

        r.push(_a77.add(_h12));
      }

      return r;
    }, t.cacheEntryPossiblyAdded = function (t) {
      gt++, gt > dt && (t.getActor().send("enforceCacheSizeLimit", pt), gt = 0);
    }, t.clamp = f, t.clearTileCache = function (t) {
      var e = s.caches.delete("mapbox-tiles");
      t && e.catch(t).then(function () {
        return t();
      });
    }, t.clipLine = Qu, t.clone = function (t) {
      var e = new Oa(16);
      return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[4] = t[4], e[5] = t[5], e[6] = t[6], e[7] = t[7], e[8] = t[8], e[9] = t[9], e[10] = t[10], e[11] = t[11], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15], e;
    }, t.clone$1 = T, t.collisionCircleLayout = Jl, t.config = N, t.conjugate = function (t, e) {
      return t[0] = -e[0], t[1] = -e[1], t[2] = -e[2], t[3] = e[3], t;
    }, t.create = function () {
      var t = new Oa(16);
      return Oa != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0), t[0] = 1, t[5] = 1, t[10] = 1, t[15] = 1, t;
    }, t.create$1 = $a, t.create$2 = function () {
      var t = new Oa(4);
      return Oa != Float32Array && (t[1] = 0, t[2] = 0), t[0] = 1, t[3] = 1, t;
    }, t.createExpression = Qr, t.createLayout = os, t.createStyleLayer = function (t) {
      return "custom" === t.type ? new qc(t) : new Gc[t.type](t);
    }, t.cross = eo, t.deepEqual = a, t.degToRad = c, t.div = function (t, e, r) {
      return t[0] = e[0] / r[0], t[1] = e[1] / r[1], t[2] = e[2] / r[2], t;
    }, t.dot = to, t.ease = d, t.easeCubicInOut = h, t.emitValidationErrors = Ui, t.endsWith = A, t.enforceCacheSizeLimit = function (t) {
      ft(), ct && ct.then(function (e) {
        e.keys().then(function (r) {
          for (var _i131 = 0; _i131 < r.length - t; _i131++) {
            e.delete(r[_i131]);
          }
        });
      });
    }, t.evaluateSizeForFeature = tu, t.evaluateSizeForZoom = eu, t.evaluateVariableOffset = vc, t.evented = Ln, t.exactEquals = function (t, e) {
      return t[0] === e[0] && t[1] === e[1] && t[2] === e[2] && t[3] === e[3];
    }, t.exactEquals$1 = function (t, e) {
      return t[0] === e[0] && t[1] === e[1] && t[2] === e[2];
    }, t.extend = x, t.featureFilter = pi, t.filterObject = I, t.fromMat4 = function (t, e) {
      return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[4], t[4] = e[5], t[5] = e[6], t[6] = e[8], t[7] = e[9], t[8] = e[10], t;
    }, t.fromQuat = function (t, e) {
      var r = e[0],
          i = e[1],
          n = e[2],
          s = e[3],
          a = r + r,
          o = i + i,
          l = n + n,
          u = r * a,
          c = i * a,
          h = i * o,
          p = n * a,
          d = n * o,
          f = n * l,
          y = s * a,
          m = s * o,
          g = s * l;
      return t[0] = 1 - h - f, t[1] = c + g, t[2] = p - m, t[3] = 0, t[4] = c - g, t[5] = 1 - u - f, t[6] = d + y, t[7] = 0, t[8] = p + m, t[9] = d - y, t[10] = 1 - u - h, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;
    }, t.fromRotation = function (t, e) {
      var r = Math.sin(e),
          i = Math.cos(e);
      return t[0] = i, t[1] = r, t[2] = 0, t[3] = -r, t[4] = i, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1, t;
    }, t.getAnchorAlignment = qu, t.getAnchorJustification = wc, t.getBounds = function (t) {
      var e = 1 / 0,
          r = 1 / 0,
          n = -1 / 0,
          s = -1 / 0;

      for (var _i132 of t) {
        e = Math.min(e, _i132.x), r = Math.min(r, _i132.y), n = Math.max(n, _i132.x), s = Math.max(s, _i132.y);
      }

      return {
        min: new i(e, r),
        max: new i(n, s)
      };
    }, t.getImage = Mt, t.getJSON = function (t, e) {
      return _t(x(t, {
        type: "json"
      }), e);
    }, t.getMapSessionAPI = ut, t.getRTLTextPluginStatus = Un, t.getReferrer = wt, t.getVideo = function (t, e) {
      var r = s.document.createElement("video");
      r.muted = !0, r.onloadstart = function () {
        e(null, r);
      };

      for (var _e203 = 0; _e203 < t.length; _e203++) {
        var _i133 = s.document.createElement("source");

        It(t[_e203]) || (r.crossOrigin = "Anonymous"), _i133.src = t[_e203], r.appendChild(_i133);
      }

      return {
        cancel: function () {}
      };
    }, t.identity = qa, t.identity$1 = uo, t.invert = function (t, e) {
      var r = e[0],
          i = e[1],
          n = e[2],
          s = e[3],
          a = e[4],
          o = e[5],
          l = e[6],
          u = e[7],
          c = e[8],
          h = e[9],
          p = e[10],
          d = e[11],
          f = e[12],
          y = e[13],
          m = e[14],
          g = e[15],
          x = r * o - i * a,
          v = r * l - n * a,
          b = r * u - s * a,
          w = i * l - n * o,
          _ = i * u - s * o,
          k = n * u - s * l,
          A = c * y - h * f,
          S = c * m - p * f,
          I = c * g - d * f,
          T = h * m - p * y,
          z = h * g - d * y,
          E = p * g - d * m,
          M = x * E - v * z + b * T + w * I - _ * S + k * A;

      return M ? (t[0] = (o * E - l * z + u * T) * (M = 1 / M), t[1] = (n * z - i * E - s * T) * M, t[2] = (y * k - m * _ + g * w) * M, t[3] = (p * _ - h * k - d * w) * M, t[4] = (l * I - a * E - u * S) * M, t[5] = (r * E - n * I + s * S) * M, t[6] = (m * b - f * k - g * v) * M, t[7] = (c * k - p * b + d * v) * M, t[8] = (a * z - o * I + u * A) * M, t[9] = (i * I - r * z - s * A) * M, t[10] = (f * _ - y * b + g * x) * M, t[11] = (h * b - c * _ - d * x) * M, t[12] = (o * S - a * T - l * A) * M, t[13] = (r * T - i * S + n * A) * M, t[14] = (y * v - f * w - m * x) * M, t[15] = (c * w - h * v + p * x) * M, t) : null;
    }, t.isMapboxURL = W, t.latFromMercatorY = ch, t.len = ao, t.length = Xa, t.length$1 = function (t) {
      return Math.hypot(t[0], t[1], t[2], t[3]);
    }, t.loadVectorTile = Pp, t.makeRequest = _t, t.mercatorXfromLng = oh, t.mercatorYfromLat = lh, t.mercatorZfromAltitude = uh, t.mul = ja, t.mul$1 = function (t, e, r) {
      return t[0] = e[0] * r[0], t[1] = e[1] * r[1], t[2] = e[2] * r[2], t;
    }, t.multiply = Na, t.mvt = Al, t.nextPowerOfTwo = function (t) {
      return t <= 1 ? 1 : Math.pow(2, Math.ceil(Math.log(t) / Math.LN2));
    }, t.normalize = Qa, t.normalize$1 = function (t, e) {
      var r = e[0],
          i = e[1],
          n = e[2],
          s = e[3],
          a = r * r + i * i + n * n + s * s;
      return a > 0 && (a = 1 / Math.sqrt(a)), t[0] = r * a, t[1] = i * a, t[2] = n * a, t[3] = s * a, t;
    }, t.number = Je, t.offscreenCanvasSupported = xt, t.ortho = function (t, e, r, i, n, s, a) {
      var o = 1 / (e - r),
          l = 1 / (i - n),
          u = 1 / (s - a);
      return t[0] = -2 * o, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = -2 * l, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 2 * u, t[11] = 0, t[12] = (e + r) * o, t[13] = (n + i) * l, t[14] = (a + s) * u, t[15] = 1, t;
    }, t.pbf = ou, t.perspective = function (t, e, r, i, n) {
      var s,
          a = 1 / Math.tan(e / 2);
      return t[0] = a / r, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = a, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = -1, t[12] = 0, t[13] = 0, t[15] = 0, null != n && n !== 1 / 0 ? (t[10] = (n + i) * (s = 1 / (i - n)), t[14] = 2 * n * i * s) : (t[10] = -1, t[14] = -2 * i), t;
    }, t.pick = function (t, e) {
      var r = {};

      for (var _i134 = 0; _i134 < e.length; _i134++) {
        var _n108 = e[_i134];
        _n108 in t && (r[_n108] = t[_n108]);
      }

      return r;
    }, t.plugin = $n, t.polygonIntersectsBox = Da, t.polygonIntersectsPolygon = _a, t.polygonizeBounds = function (t, e) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !0;
      var s = new i(r, r),
          a = t.sub(s),
          o = e.add(s),
          l = [a, new i(o.x, a.y), o, new i(a.x, o.y)];
      return n && l.push(a), l;
    }, t.posAttributes = bh, t.postMapLoadEvent = ot, t.postTurnstileEvent = st, t.potpack = zu, t.prevPowerOfTwo = function (t) {
      return t <= 1 ? 1 : Math.pow(2, Math.floor(Math.log(t) / Math.LN2));
    }, t.radToDeg = function (t) {
      return t * u;
    }, t.refProperties = ["type", "source", "source-layer", "minzoom", "maxzoom", "filter", "layout"], t.registerForPluginStateChange = function (t) {
      return t({
        pluginStatus: Pn,
        pluginURL: Vn
      }), Ln.on("pluginStateChange", t), t;
    }, t.renderColorRamp = So, t.rotate = function (t, e, r) {
      var i = e[0],
          n = e[1],
          s = e[2],
          a = e[3],
          o = Math.sin(r),
          l = Math.cos(r);
      return t[0] = i * l + s * o, t[1] = n * l + a * o, t[2] = i * -o + s * l, t[3] = n * -o + a * l, t;
    }, t.rotateX = function (t, e, r) {
      var i = Math.sin(r),
          n = Math.cos(r),
          s = e[4],
          a = e[5],
          o = e[6],
          l = e[7],
          u = e[8],
          c = e[9],
          h = e[10],
          p = e[11];
      return e !== t && (t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[4] = s * n + u * i, t[5] = a * n + c * i, t[6] = o * n + h * i, t[7] = l * n + p * i, t[8] = u * n - s * i, t[9] = c * n - a * i, t[10] = h * n - o * i, t[11] = p * n - l * i, t;
    }, t.rotateX$1 = co, t.rotateY = function (t, e, r) {
      var i = Math.sin(r),
          n = Math.cos(r),
          s = e[0],
          a = e[1],
          o = e[2],
          l = e[3],
          u = e[8],
          c = e[9],
          h = e[10],
          p = e[11];
      return e !== t && (t[4] = e[4], t[5] = e[5], t[6] = e[6], t[7] = e[7], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[0] = s * n - u * i, t[1] = a * n - c * i, t[2] = o * n - h * i, t[3] = l * n - p * i, t[8] = s * i + u * n, t[9] = a * i + c * n, t[10] = o * i + h * n, t[11] = l * i + p * n, t;
    }, t.rotateZ = function (t, e, r) {
      var i = Math.sin(r),
          n = Math.cos(r),
          s = e[0],
          a = e[1],
          o = e[2],
          l = e[3],
          u = e[4],
          c = e[5],
          h = e[6],
          p = e[7];
      return e !== t && (t[8] = e[8], t[9] = e[9], t[10] = e[10], t[11] = e[11], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[0] = s * n + u * i, t[1] = a * n + c * i, t[2] = o * n + h * i, t[3] = l * n + p * i, t[4] = u * n - s * i, t[5] = c * n - a * i, t[6] = h * n - o * i, t[7] = p * n - l * i, t;
    }, t.rotateZ$1 = function (t, e, r) {
      r *= .5;
      var i = e[0],
          n = e[1],
          s = e[2],
          a = e[3],
          o = Math.sin(r),
          l = Math.cos(r);
      return t[0] = i * l + n * o, t[1] = n * l - i * o, t[2] = s * l + a * o, t[3] = a * l - s * o, t;
    }, t.scale = function (t, e, r) {
      var i = r[0],
          n = r[1],
          s = r[2];
      return t[0] = e[0] * i, t[1] = e[1] * i, t[2] = e[2] * i, t[3] = e[3] * i, t[4] = e[4] * n, t[5] = e[5] * n, t[6] = e[6] * n, t[7] = e[7] * n, t[8] = e[8] * s, t[9] = e[9] * s, t[10] = e[10] * s, t[11] = e[11] * s, t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15], t;
    }, t.scale$1 = function (t, e, r) {
      return t[0] = e[0] * r, t[1] = e[1] * r, t[2] = e[2] * r, t[3] = e[3] * r, t;
    }, t.scale$2 = Wa, t.scaleAndAdd = Ja, t.setCacheLimits = function (t, e) {
      pt = t, dt = e;
    }, t.setRTLTextPlugin = function (t, e) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;
      if ("deferred" === Pn || "loading" === Pn || "loaded" === Pn) throw new Error("setRTLTextPlugin cannot be called multiple times.");
      Vn = $.resolveURL(t), Pn = "deferred", Cn = e, Rn(), r || On();
    }, t.styleSpec = Ft, t.sub = so, t.subtract = Ya, t.symbolSize = ru, t.transformMat3 = function (t, e, r) {
      var i = e[0],
          n = e[1],
          s = e[2];
      return t[0] = i * r[0] + n * r[3] + s * r[6], t[1] = i * r[1] + n * r[4] + s * r[7], t[2] = i * r[2] + n * r[5] + s * r[8], t;
    }, t.transformMat4 = oo, t.transformQuat = io, t.translate = function (t, e, r) {
      var i,
          n,
          s,
          a,
          o,
          l,
          u,
          c,
          h,
          p,
          d,
          f,
          y = r[0],
          m = r[1],
          g = r[2];
      return e === t ? (t[12] = e[0] * y + e[4] * m + e[8] * g + e[12], t[13] = e[1] * y + e[5] * m + e[9] * g + e[13], t[14] = e[2] * y + e[6] * m + e[10] * g + e[14], t[15] = e[3] * y + e[7] * m + e[11] * g + e[15]) : (n = e[1], s = e[2], a = e[3], o = e[4], l = e[5], u = e[6], c = e[7], h = e[8], p = e[9], d = e[10], f = e[11], t[0] = i = e[0], t[1] = n, t[2] = s, t[3] = a, t[4] = o, t[5] = l, t[6] = u, t[7] = c, t[8] = h, t[9] = p, t[10] = d, t[11] = f, t[12] = i * y + o * m + h * g + e[12], t[13] = n * y + l * m + p * g + e[13], t[14] = s * y + u * m + d * g + e[14], t[15] = a * y + c * m + f * g + e[15]), t;
    }, t.triggerPluginCompletionEvent = Fn, t.uniqueId = b, t.validateCustomStyleLayer = function (t) {
      var e = [],
          r = t.id;
      return void 0 === r && e.push({
        message: "layers.".concat(r, ": missing required property \"id\"")
      }), void 0 === t.render && e.push({
        message: "layers.".concat(r, ": missing required method \"render\"")
      }), t.renderingMode && "2d" !== t.renderingMode && "3d" !== t.renderingMode && e.push({
        message: "layers.".concat(r, ": property \"renderingMode\" must be either \"2d\" or \"3d\"")
      }), e;
    }, t.validateLight = Fi, t.validateStyle = Vi, t.values = g, t.vectorTile = Al, t.version = "2.1.1", t.warnOnce = E, t.webpSupported = j, t.window = s, t.wrap = y;
  });
  define(["./shared"], function (e) {
    "use strict";

    function t(e) {
      var r = _typeof(e);

      if ("number" === r || "boolean" === r || "string" === r || null == e) return JSON.stringify(e);

      if (Array.isArray(e)) {
        var _r193 = "[";

        for (var _n109 of e) {
          _r193 += "".concat(t(_n109), ",");
        }

        return "".concat(_r193, "]");
      }

      var n = Object.keys(e).sort();
      var o = "{";

      for (var _r194 = 0; _r194 < n.length; _r194++) {
        o += "".concat(JSON.stringify(n[_r194]), ":").concat(t(e[n[_r194]]), ",");
      }

      return "".concat(o, "}");
    }

    function r(r) {
      var n = "";

      for (var _o44 of e.refProperties) {
        n += "/".concat(t(r[_o44]));
      }

      return n;
    }

    var n = /*#__PURE__*/function () {
      function n(e) {
        _classCallCheck(this, n);

        this.keyCache = {}, e && this.replace(e);
      }

      _createClass(n, [{
        key: "replace",
        value: function replace(e) {
          this._layerConfigs = {}, this._layers = {}, this.update(e, []);
        }
      }, {
        key: "update",
        value: function update(t, _n110) {
          var _this55 = this;

          for (var _r195 of t) {
            this._layerConfigs[_r195.id] = _r195;

            var _t221 = this._layers[_r195.id] = e.createStyleLayer(_r195);

            _t221._featureFilter = e.featureFilter(_t221.filter), this.keyCache[_r195.id] && delete this.keyCache[_r195.id];
          }

          for (var _e204 of _n110) {
            delete this.keyCache[_e204], delete this._layerConfigs[_e204], delete this._layers[_e204];
          }

          this.familiesBySource = {};

          var o = function (e, t) {
            var n = {};

            for (var _o45 = 0; _o45 < e.length; _o45++) {
              var _i135 = t && t[e[_o45].id] || r(e[_o45]);

              t && (t[e[_o45].id] = _i135);
              var _s89 = n[_i135];
              _s89 || (_s89 = n[_i135] = []), _s89.push(e[_o45]);
            }

            var o = [];

            for (var _e205 in n) {
              o.push(n[_e205]);
            }

            return o;
          }(e.values(this._layerConfigs), this.keyCache);

          for (var _e206 of o) {
            var _t222 = _e206.map(function (e) {
              return _this55._layers[e.id];
            }),
                _r196 = _t222[0];

            if ("none" === _r196.visibility) continue;

            var _n112 = _r196.source || "";

            var _o46 = this.familiesBySource[_n112];
            _o46 || (_o46 = this.familiesBySource[_n112] = {});

            var _i136 = _r196.sourceLayer || "_geojsonTileLayer";

            var _s90 = _o46[_i136];
            _s90 || (_s90 = _o46[_i136] = []), _s90.push(_t222);
          }
        }
      }]);

      return n;
    }();

    var {
      ImageBitmap: o
    } = e.window;

    var i = /*#__PURE__*/function () {
      function i() {
        _classCallCheck(this, i);
      }

      _createClass(i, [{
        key: "loadTile",
        value: function loadTile(t, r) {
          var {
            uid: n,
            encoding: _i137,
            rawImageData: s,
            padding: a,
            buildQuadTree: l
          } = t,
              u = o && s instanceof o ? this.getImageData(s, a) : s;
          r(null, new e.DEMData(n, u, _i137, a < 1, l));
        }
      }, {
        key: "getImageData",
        value: function getImageData(t, r) {
          this.offscreenCanvas && this.offscreenCanvasContext || (this.offscreenCanvas = new OffscreenCanvas(t.width, t.height), this.offscreenCanvasContext = this.offscreenCanvas.getContext("2d")), this.offscreenCanvas.width = t.width, this.offscreenCanvas.height = t.height, this.offscreenCanvasContext.drawImage(t, 0, 0, t.width, t.height);
          var n = this.offscreenCanvasContext.getImageData(-r, -r, t.width + 2 * r, t.height + 2 * r);
          return this.offscreenCanvasContext.clearRect(0, 0, this.offscreenCanvas.width, this.offscreenCanvas.height), new e.RGBAImage({
            width: n.width,
            height: n.height
          }, n.data);
        }
      }]);

      return i;
    }();

    function s(e, t) {
      if (0 !== e.length) {
        a(e[0], t);

        for (var r = 1; r < e.length; r++) {
          a(e[r], !t);
        }
      }
    }

    function a(e, t) {
      for (var r = 0, n = 0, o = e.length, i = o - 1; n < o; i = n++) {
        r += (e[n][0] - e[i][0]) * (e[i][1] + e[n][1]);
      }

      r >= 0 != !!t && e.reverse();
    }

    var l = e.vectorTile.VectorTileFeature.prototype.toGeoJSON;

    var u = /*#__PURE__*/function () {
      function u(t) {
        _classCallCheck(this, u);

        this._feature = t, this.extent = e.EXTENT, this.type = t.type, this.properties = t.tags, "id" in t && !isNaN(t.id) && (this.id = parseInt(t.id, 10));
      }

      _createClass(u, [{
        key: "loadGeometry",
        value: function loadGeometry() {
          if (1 === this._feature.type) {
            var _t223 = [];

            for (var _r197 of this._feature.geometry) {
              _t223.push([new e.Point$1(_r197[0], _r197[1])]);
            }

            return _t223;
          }

          {
            var _t224 = [];

            for (var _r198 of this._feature.geometry) {
              var _n113 = [];

              for (var _t225 of _r198) {
                _n113.push(new e.Point$1(_t225[0], _t225[1]));
              }

              _t224.push(_n113);
            }

            return _t224;
          }
        }
      }, {
        key: "toGeoJSON",
        value: function toGeoJSON(e, t, r) {
          return l.call(this, e, t, r);
        }
      }]);

      return u;
    }();

    var h = /*#__PURE__*/function () {
      function h(t) {
        _classCallCheck(this, h);

        this.layers = {
          _geojsonTileLayer: this
        }, this.name = "_geojsonTileLayer", this.extent = e.EXTENT, this.length = t.length, this._features = t;
      }

      _createClass(h, [{
        key: "feature",
        value: function feature(e) {
          return new u(this._features[e]);
        }
      }]);

      return h;
    }();

    var c = e.vectorTile.VectorTileFeature,
        f = p;

    function p(e, t) {
      this.options = t || {}, this.features = e, this.length = e.length;
    }

    function d(e, t) {
      this.id = "number" == typeof e.id ? e.id : void 0, this.type = e.type, this.rawGeometry = 1 === e.type ? [e.geometry] : e.geometry, this.properties = e.tags, this.extent = t || 4096;
    }

    p.prototype.feature = function (e) {
      return new d(this.features[e], this.options.extent);
    }, d.prototype.loadGeometry = function () {
      var t = this.rawGeometry;
      this.geometry = [];

      for (var r = 0; r < t.length; r++) {
        for (var n = t[r], o = [], i = 0; i < n.length; i++) {
          o.push(new e.Point$1(n[i][0], n[i][1]));
        }

        this.geometry.push(o);
      }

      return this.geometry;
    }, d.prototype.bbox = function () {
      this.geometry || this.loadGeometry();

      for (var e = this.geometry, t = 1 / 0, r = -1 / 0, n = 1 / 0, o = -1 / 0, i = 0; i < e.length; i++) {
        for (var s = e[i], a = 0; a < s.length; a++) {
          var l = s[a];
          t = Math.min(t, l.x), r = Math.max(r, l.x), n = Math.min(n, l.y), o = Math.max(o, l.y);
        }
      }

      return [t, n, r, o];
    }, d.prototype.toGeoJSON = c.prototype.toGeoJSON;
    var g = y,
        m = f;

    function y(t) {
      var r = new e.pbf();
      return function (e, t) {
        for (var r in e.layers) {
          t.writeMessage(3, v, e.layers[r]);
        }
      }(t, r), r.finish();
    }

    function v(e, t) {
      var r;
      t.writeVarintField(15, e.version || 1), t.writeStringField(1, e.name || ""), t.writeVarintField(5, e.extent || 4096);
      var n = {
        keys: [],
        values: [],
        keycache: {},
        valuecache: {}
      };

      for (r = 0; r < e.length; r++) {
        n.feature = e.feature(r), t.writeMessage(2, x, n);
      }

      var o = n.keys;

      for (r = 0; r < o.length; r++) {
        t.writeStringField(3, o[r]);
      }

      var i = n.values;

      for (r = 0; r < i.length; r++) {
        t.writeMessage(4, P, i[r]);
      }
    }

    function x(e, t) {
      var r = e.feature;
      void 0 !== r.id && t.writeVarintField(1, r.id), t.writeMessage(2, w, e), t.writeVarintField(3, r.type), t.writeMessage(4, _, r);
    }

    function w(e, t) {
      var r = e.feature,
          n = e.keys,
          o = e.values,
          i = e.keycache,
          s = e.valuecache;

      for (var a in r.properties) {
        var l = i[a];
        void 0 === l && (n.push(a), i[a] = l = n.length - 1), t.writeVarint(l);

        var u = r.properties[a],
            h = _typeof(u);

        "string" !== h && "boolean" !== h && "number" !== h && (u = JSON.stringify(u));
        var c = h + ":" + u,
            f = s[c];
        void 0 === f && (o.push(u), s[c] = f = o.length - 1), t.writeVarint(f);
      }
    }

    function S(e, t) {
      return (t << 3) + (7 & e);
    }

    function M(e) {
      return e << 1 ^ e >> 31;
    }

    function _(e, t) {
      for (var r = e.loadGeometry(), n = e.type, o = 0, i = 0, s = r.length, a = 0; a < s; a++) {
        var l = r[a],
            u = 1;
        1 === n && (u = l.length), t.writeVarint(S(1, u));

        for (var h = 3 === n ? l.length - 1 : l.length, c = 0; c < h; c++) {
          1 === c && 1 !== n && t.writeVarint(S(2, h - 1));
          var f = l[c].x - o,
              p = l[c].y - i;
          t.writeVarint(M(f)), t.writeVarint(M(p)), o += f, i += p;
        }

        3 === n && t.writeVarint(S(7, 1));
      }
    }

    function P(e, t) {
      var r = _typeof(e);

      "string" === r ? t.writeStringField(1, e) : "boolean" === r ? t.writeBooleanField(7, e) : "number" === r && (e % 1 != 0 ? t.writeDoubleField(3, e) : e < 0 ? t.writeSVarintField(6, e) : t.writeVarintField(5, e));
    }

    function b(e, t, r, n) {
      k(e, r, n), k(t, 2 * r, 2 * n), k(t, 2 * r + 1, 2 * n + 1);
    }

    function k(e, t, r) {
      var n = e[t];
      e[t] = e[r], e[r] = n;
    }

    function T(e, t, r, n) {
      var o = e - r,
          i = t - n;
      return o * o + i * i;
    }

    g.fromVectorTileJs = y, g.fromGeojsonVt = function (e, t) {
      t = t || {};
      var r = {};

      for (var n in e) {
        r[n] = new f(e[n].features, t), r[n].name = n, r[n].version = t.version, r[n].extent = t.extent;
      }

      return y({
        layers: r
      });
    }, g.GeoJSONWrapper = m;

    var I = function (e) {
      return e[0];
    },
        C = function (e) {
      return e[1];
    };

    var L = /*#__PURE__*/function () {
      function L(e) {
        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : I;
        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : C;
        var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 64;
        var o = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : Float64Array;

        _classCallCheck(this, L);

        this.nodeSize = n, this.points = e;
        var i = e.length < 65536 ? Uint16Array : Uint32Array,
            s = this.ids = new i(e.length),
            a = this.coords = new o(2 * e.length);

        for (var _n114 = 0; _n114 < e.length; _n114++) {
          s[_n114] = _n114, a[2 * _n114] = t(e[_n114]), a[2 * _n114 + 1] = r(e[_n114]);
        }

        !function e(t, r, n, o, i, s) {
          if (i - o <= n) return;
          var a = o + i >> 1;
          !function e(t, r, n, o, i, s) {
            for (; i > o;) {
              if (i - o > 600) {
                var _a79 = i - o + 1,
                    _l33 = n - o + 1,
                    _u31 = Math.log(_a79),
                    _h13 = .5 * Math.exp(2 * _u31 / 3),
                    _c23 = .5 * Math.sqrt(_u31 * _h13 * (_a79 - _h13) / _a79) * (_l33 - _a79 / 2 < 0 ? -1 : 1);

                e(t, r, n, Math.max(o, Math.floor(n - _l33 * _h13 / _a79 + _c23)), Math.min(i, Math.floor(n + (_a79 - _l33) * _h13 / _a79 + _c23)), s);
              }

              var _a78 = r[2 * n + s];
              var _l32 = o,
                  _u30 = i;

              for (b(t, r, o, n), r[2 * i + s] > _a78 && b(t, r, o, i); _l32 < _u30;) {
                for (b(t, r, _l32, _u30), _l32++, _u30--; r[2 * _l32 + s] < _a78;) {
                  _l32++;
                }

                for (; r[2 * _u30 + s] > _a78;) {
                  _u30--;
                }
              }

              r[2 * o + s] === _a78 ? b(t, r, o, _u30) : (_u30++, b(t, r, _u30, i)), _u30 <= n && (o = _u30 + 1), n <= _u30 && (i = _u30 - 1);
            }
          }(t, r, a, o, i, s % 2), e(t, r, n, o, a - 1, s + 1), e(t, r, n, a + 1, i, s + 1);
        }(s, a, n, 0, s.length - 1, 0);
      }

      _createClass(L, [{
        key: "range",
        value: function range(e, t, r, n) {
          return function (e, t, r, n, o, i, s) {
            var a = [0, e.length - 1, 0],
                l = [];
            var u, h;

            for (; a.length;) {
              var _c24 = a.pop(),
                  _f11 = a.pop(),
                  _p15 = a.pop();

              if (_f11 - _p15 <= s) {
                for (var _s91 = _p15; _s91 <= _f11; _s91++) {
                  u = t[2 * _s91], h = t[2 * _s91 + 1], u >= r && u <= o && h >= n && h <= i && l.push(e[_s91]);
                }

                continue;
              }

              var _d10 = Math.floor((_p15 + _f11) / 2);

              u = t[2 * _d10], h = t[2 * _d10 + 1], u >= r && u <= o && h >= n && h <= i && l.push(e[_d10]);

              var _g11 = (_c24 + 1) % 2;

              (0 === _c24 ? r <= u : n <= h) && (a.push(_p15), a.push(_d10 - 1), a.push(_g11)), (0 === _c24 ? o >= u : i >= h) && (a.push(_d10 + 1), a.push(_f11), a.push(_g11));
            }

            return l;
          }(this.ids, this.coords, e, t, r, n, this.nodeSize);
        }
      }, {
        key: "within",
        value: function within(e, t, r) {
          return function (e, t, r, n, o, i) {
            var s = [0, e.length - 1, 0],
                a = [],
                l = o * o;

            for (; s.length;) {
              var _u32 = s.pop(),
                  _h14 = s.pop(),
                  _c25 = s.pop();

              if (_h14 - _c25 <= i) {
                for (var _o47 = _c25; _o47 <= _h14; _o47++) {
                  T(t[2 * _o47], t[2 * _o47 + 1], r, n) <= l && a.push(e[_o47]);
                }

                continue;
              }

              var _f12 = Math.floor((_c25 + _h14) / 2),
                  _p16 = t[2 * _f12],
                  _d11 = t[2 * _f12 + 1];

              T(_p16, _d11, r, n) <= l && a.push(e[_f12]);

              var _g12 = (_u32 + 1) % 2;

              (0 === _u32 ? r - o <= _p16 : n - o <= _d11) && (s.push(_c25), s.push(_f12 - 1), s.push(_g12)), (0 === _u32 ? r + o >= _p16 : n + o >= _d11) && (s.push(_f12 + 1), s.push(_h14), s.push(_g12));
            }

            return a;
          }(this.ids, this.coords, e, t, r, this.nodeSize);
        }
      }]);

      return L;
    }();

    var O = {
      minZoom: 0,
      maxZoom: 16,
      minPoints: 2,
      radius: 40,
      extent: 512,
      nodeSize: 64,
      log: !1,
      generateId: !1,
      reduce: null,
      map: function (e) {
        return e;
      }
    },
        z = Math.fround || (E = new Float32Array(1), function (e) {
      return E[0] = +e, E[0];
    });
    var E;

    var F = /*#__PURE__*/function () {
      function F(e) {
        _classCallCheck(this, F);

        this.options = X(Object.create(O), e), this.trees = new Array(this.options.maxZoom + 1);
      }

      _createClass(F, [{
        key: "load",
        value: function load(e) {
          var {
            log: t,
            minZoom: r,
            maxZoom: n,
            nodeSize: o
          } = this.options;
          t && console.time("total time");
          var i = "prepare ".concat(e.length, " points");
          t && console.time(i), this.points = e;
          var s = [];

          for (var _t226 = 0; _t226 < e.length; _t226++) {
            e[_t226].geometry && s.push(Z(e[_t226], _t226));
          }

          this.trees[n + 1] = new L(s, V, $, o, Float32Array), t && console.timeEnd(i);

          for (var _e207 = n; _e207 >= r; _e207--) {
            var _r199 = +Date.now();

            s = this._cluster(s, _e207), this.trees[_e207] = new L(s, V, $, o, Float32Array), t && console.log("z%d: %d clusters in %dms", _e207, s.length, +Date.now() - _r199);
          }

          return t && console.timeEnd("total time"), this;
        }
      }, {
        key: "getClusters",
        value: function getClusters(e, t) {
          var r = ((e[0] + 180) % 360 + 360) % 360 - 180;
          var n = Math.max(-90, Math.min(90, e[1]));
          var o = 180 === e[2] ? 180 : ((e[2] + 180) % 360 + 360) % 360 - 180;
          var i = Math.max(-90, Math.min(90, e[3]));
          if (e[2] - e[0] >= 360) r = -180, o = 180;else if (r > o) {
            var _e208 = this.getClusters([r, n, 180, i], t),
                _s92 = this.getClusters([-180, n, o, i], t);

            return _e208.concat(_s92);
          }

          var s = this.trees[this._limitZoom(t)],
              a = s.range(G(r), Y(i), G(o), Y(n)),
              l = [];

          for (var _e209 of a) {
            var _t227 = s.points[_e209];
            l.push(_t227.numPoints ? J(_t227) : this.points[_t227.index]);
          }

          return l;
        }
      }, {
        key: "getChildren",
        value: function getChildren(e) {
          var t = this._getOriginId(e),
              r = this._getOriginZoom(e),
              n = "No cluster with the specified id.",
              o = this.trees[r];

          if (!o) throw new Error(n);
          var i = o.points[t];
          if (!i) throw new Error(n);
          var s = this.options.radius / (this.options.extent * Math.pow(2, r - 1)),
              a = o.within(i.x, i.y, s),
              l = [];

          for (var _t228 of a) {
            var _r200 = o.points[_t228];
            _r200.parentId === e && l.push(_r200.numPoints ? J(_r200) : this.points[_r200.index]);
          }

          if (0 === l.length) throw new Error(n);
          return l;
        }
      }, {
        key: "getLeaves",
        value: function getLeaves(e, t, r) {
          var n = [];
          return this._appendLeaves(n, e, t = t || 10, r = r || 0, 0), n;
        }
      }, {
        key: "getTile",
        value: function getTile(e, t, r) {
          var n = this.trees[this._limitZoom(e)],
              o = Math.pow(2, e),
              {
            extent: i,
            radius: s
          } = this.options,
              a = s / i,
              l = (r - a) / o,
              u = (r + 1 + a) / o,
              h = {
            features: []
          };

          return this._addTileFeatures(n.range((t - a) / o, l, (t + 1 + a) / o, u), n.points, t, r, o, h), 0 === t && this._addTileFeatures(n.range(1 - a / o, l, 1, u), n.points, o, r, o, h), t === o - 1 && this._addTileFeatures(n.range(0, l, a / o, u), n.points, -1, r, o, h), h.features.length ? h : null;
        }
      }, {
        key: "getClusterExpansionZoom",
        value: function getClusterExpansionZoom(e) {
          var t = this._getOriginZoom(e) - 1;

          for (; t <= this.options.maxZoom;) {
            var _r201 = this.getChildren(e);

            if (t++, 1 !== _r201.length) break;
            e = _r201[0].properties.cluster_id;
          }

          return t;
        }
      }, {
        key: "_appendLeaves",
        value: function _appendLeaves(e, t, r, n, o) {
          var i = this.getChildren(t);

          for (var _t229 of i) {
            var _i138 = _t229.properties;
            if (_i138 && _i138.cluster ? o + _i138.point_count <= n ? o += _i138.point_count : o = this._appendLeaves(e, _i138.cluster_id, r, n, o) : o < n ? o++ : e.push(_t229), e.length === r) break;
          }

          return o;
        }
      }, {
        key: "_addTileFeatures",
        value: function _addTileFeatures(e, t, r, n, o, i) {
          for (var _s93 of e) {
            var _e210 = t[_s93],
                _a80 = _e210.numPoints,
                _l34 = {
              type: 1,
              geometry: [[Math.round(this.options.extent * (_e210.x * o - r)), Math.round(this.options.extent * (_e210.y * o - n))]],
              tags: _a80 ? D(_e210) : this.points[_e210.index].properties
            };

            var _u33 = void 0;

            _a80 ? _u33 = _e210.id : this.options.generateId ? _u33 = _e210.index : this.points[_e210.index].id && (_u33 = this.points[_e210.index].id), void 0 !== _u33 && (_l34.id = _u33), i.features.push(_l34);
          }
        }
      }, {
        key: "_limitZoom",
        value: function _limitZoom(e) {
          return Math.max(this.options.minZoom, Math.min(+e, this.options.maxZoom + 1));
        }
      }, {
        key: "_cluster",
        value: function _cluster(e, t) {
          var r = [],
              {
            radius: n,
            extent: o,
            reduce: i,
            minPoints: s
          } = this.options,
              a = n / (o * Math.pow(2, t));

          for (var _n115 = 0; _n115 < e.length; _n115++) {
            var _o48 = e[_n115];
            if (_o48.zoom <= t) continue;
            _o48.zoom = t;

            var _l35 = this.trees[t + 1],
                _u34 = _l35.within(_o48.x, _o48.y, a),
                _h15 = _o48.numPoints || 1;

            var _c26 = _h15;

            for (var _e211 of _u34) {
              var _r202 = _l35.points[_e211];
              _r202.zoom > t && (_c26 += _r202.numPoints || 1);
            }

            if (_c26 >= s) {
              var _e212 = _o48.x * _h15,
                  _s94 = _o48.y * _h15,
                  _a81 = i && _h15 > 1 ? this._map(_o48, !0) : null;

              var _f13 = (_n115 << 5) + (t + 1) + this.points.length;

              for (var _r203 of _u34) {
                var _n116 = _l35.points[_r203];
                if (_n116.zoom <= t) continue;
                _n116.zoom = t;

                var _u35 = _n116.numPoints || 1;

                _e212 += _n116.x * _u35, _s94 += _n116.y * _u35, _n116.parentId = _f13, i && (_a81 || (_a81 = this._map(_o48, !0)), i(_a81, this._map(_n116)));
              }

              _o48.parentId = _f13, r.push(N(_e212 / _c26, _s94 / _c26, _f13, _c26, _a81));
            } else if (r.push(_o48), _c26 > 1) for (var _e213 of _u34) {
              var _n117 = _l35.points[_e213];
              _n117.zoom <= t || (_n117.zoom = t, r.push(_n117));
            }
          }

          return r;
        }
      }, {
        key: "_getOriginId",
        value: function _getOriginId(e) {
          return e - this.points.length >> 5;
        }
      }, {
        key: "_getOriginZoom",
        value: function _getOriginZoom(e) {
          return (e - this.points.length) % 32;
        }
      }, {
        key: "_map",
        value: function _map(e, t) {
          if (e.numPoints) return t ? X({}, e.properties) : e.properties;
          var r = this.points[e.index].properties,
              n = this.options.map(r);
          return t && n === r ? X({}, n) : n;
        }
      }]);

      return F;
    }();

    function N(e, t, r, n, o) {
      return {
        x: z(e),
        y: z(t),
        zoom: 1 / 0,
        id: r,
        parentId: -1,
        numPoints: n,
        properties: o
      };
    }

    function Z(e, t) {
      var [r, n] = e.geometry.coordinates;
      return {
        x: z(G(r)),
        y: z(Y(n)),
        zoom: 1 / 0,
        index: t,
        parentId: -1
      };
    }

    function J(e) {
      return {
        type: "Feature",
        id: e.id,
        properties: D(e),
        geometry: {
          type: "Point",
          coordinates: [(t = e.x, 360 * (t - .5)), W(e.y)]
        }
      };
      var t;
    }

    function D(e) {
      var t = e.numPoints,
          r = t >= 1e4 ? "".concat(Math.round(t / 1e3), "k") : t >= 1e3 ? "".concat(Math.round(t / 100) / 10, "k") : t;
      return X(X({}, e.properties), {
        cluster: !0,
        cluster_id: e.id,
        point_count: t,
        point_count_abbreviated: r
      });
    }

    function G(e) {
      return e / 360 + .5;
    }

    function Y(e) {
      var t = Math.sin(e * Math.PI / 180),
          r = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;
      return r < 0 ? 0 : r > 1 ? 1 : r;
    }

    function W(e) {
      var t = (180 - 360 * e) * Math.PI / 180;
      return 360 * Math.atan(Math.exp(t)) / Math.PI - 90;
    }

    function X(e, t) {
      for (var _r204 in t) {
        e[_r204] = t[_r204];
      }

      return e;
    }

    function V(e) {
      return e.x;
    }

    function $(e) {
      return e.y;
    }

    function j(e, t, r, n, o, i) {
      var s = o - r,
          a = i - n;

      if (0 !== s || 0 !== a) {
        var l = ((e - r) * s + (t - n) * a) / (s * s + a * a);
        l > 1 ? (r = o, n = i) : l > 0 && (r += s * l, n += a * l);
      }

      return (s = e - r) * s + (a = t - n) * a;
    }

    function A(e, t, r, n) {
      var o = {
        id: void 0 === e ? null : e,
        type: t,
        geometry: r,
        tags: n,
        minX: 1 / 0,
        minY: 1 / 0,
        maxX: -1 / 0,
        maxY: -1 / 0
      };
      return function (e) {
        var t = e.geometry,
            r = e.type;
        if ("Point" === r || "MultiPoint" === r || "LineString" === r) R(e, t);else if ("Polygon" === r || "MultiLineString" === r) for (var n = 0; n < t.length; n++) {
          R(e, t[n]);
        } else if ("MultiPolygon" === r) for (n = 0; n < t.length; n++) {
          for (var o = 0; o < t[n].length; o++) {
            R(e, t[n][o]);
          }
        }
      }(o), o;
    }

    function R(e, t) {
      for (var r = 0; r < t.length; r += 3) {
        e.minX = Math.min(e.minX, t[r]), e.minY = Math.min(e.minY, t[r + 1]), e.maxX = Math.max(e.maxX, t[r]), e.maxY = Math.max(e.maxY, t[r + 1]);
      }
    }

    function B(e, t, r, n) {
      if (t.geometry) {
        var o = t.geometry.coordinates,
            i = t.geometry.type,
            s = Math.pow(r.tolerance / ((1 << r.maxZoom) * r.extent), 2),
            a = [],
            l = t.id;
        if (r.promoteId ? l = t.properties[r.promoteId] : r.generateId && (l = n || 0), "Point" === i) q(o, a);else if ("MultiPoint" === i) for (var u = 0; u < o.length; u++) {
          q(o[u], a);
        } else if ("LineString" === i) U(o, a, s, !1);else if ("MultiLineString" === i) {
          if (r.lineMetrics) {
            for (u = 0; u < o.length; u++) {
              U(o[u], a = [], s, !1), e.push(A(l, "LineString", a, t.properties));
            }

            return;
          }

          Q(o, a, s, !1);
        } else if ("Polygon" === i) Q(o, a, s, !0);else {
          if ("MultiPolygon" !== i) {
            if ("GeometryCollection" === i) {
              for (u = 0; u < t.geometry.geometries.length; u++) {
                B(e, {
                  id: l,
                  geometry: t.geometry.geometries[u],
                  properties: t.properties
                }, r, n);
              }

              return;
            }

            throw new Error("Input data is not a valid GeoJSON object.");
          }

          for (u = 0; u < o.length; u++) {
            var h = [];
            Q(o[u], h, s, !0), a.push(h);
          }
        }
        e.push(A(l, i, a, t.properties));
      }
    }

    function q(e, t) {
      t.push(H(e[0])), t.push(K(e[1])), t.push(0);
    }

    function U(e, t, r, n) {
      for (var o, i, s = 0, a = 0; a < e.length; a++) {
        var l = H(e[a][0]),
            u = K(e[a][1]);
        t.push(l), t.push(u), t.push(0), a > 0 && (s += n ? (o * u - l * i) / 2 : Math.sqrt(Math.pow(l - o, 2) + Math.pow(u - i, 2))), o = l, i = u;
      }

      var h = t.length - 3;
      t[2] = 1, function e(t, r, n, o) {
        for (var i, s = o, a = n - r >> 1, l = n - r, u = t[r], h = t[r + 1], c = t[n], f = t[n + 1], p = r + 3; p < n; p += 3) {
          var d = j(t[p], t[p + 1], u, h, c, f);
          if (d > s) i = p, s = d;else if (d === s) {
            var g = Math.abs(p - a);
            g < l && (i = p, l = g);
          }
        }

        s > o && (i - r > 3 && e(t, r, i, o), t[i + 2] = s, n - i > 3 && e(t, i, n, o));
      }(t, 0, h, r), t[h + 2] = 1, t.size = Math.abs(s), t.start = 0, t.end = t.size;
    }

    function Q(e, t, r, n) {
      for (var o = 0; o < e.length; o++) {
        var i = [];
        U(e[o], i, r, n), t.push(i);
      }
    }

    function H(e) {
      return e / 360 + .5;
    }

    function K(e) {
      var t = Math.sin(e * Math.PI / 180),
          r = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;
      return r < 0 ? 0 : r > 1 ? 1 : r;
    }

    function ee(e, t, r, n, o, i, s, a) {
      if (n /= t, i >= (r /= t) && s < n) return e;
      if (s < r || i >= n) return null;

      for (var l = [], u = 0; u < e.length; u++) {
        var h = e[u],
            c = h.geometry,
            f = h.type,
            p = 0 === o ? h.minX : h.minY,
            d = 0 === o ? h.maxX : h.maxY;
        if (p >= r && d < n) l.push(h);else if (!(d < r || p >= n)) {
          var g = [];
          if ("Point" === f || "MultiPoint" === f) te(c, g, r, n, o);else if ("LineString" === f) re(c, g, r, n, o, !1, a.lineMetrics);else if ("MultiLineString" === f) oe(c, g, r, n, o, !1);else if ("Polygon" === f) oe(c, g, r, n, o, !0);else if ("MultiPolygon" === f) for (var m = 0; m < c.length; m++) {
            var y = [];
            oe(c[m], y, r, n, o, !0), y.length && g.push(y);
          }

          if (g.length) {
            if (a.lineMetrics && "LineString" === f) {
              for (m = 0; m < g.length; m++) {
                l.push(A(h.id, f, g[m], h.tags));
              }

              continue;
            }

            "LineString" !== f && "MultiLineString" !== f || (1 === g.length ? (f = "LineString", g = g[0]) : f = "MultiLineString"), "Point" !== f && "MultiPoint" !== f || (f = 3 === g.length ? "Point" : "MultiPoint"), l.push(A(h.id, f, g, h.tags));
          }
        }
      }

      return l.length ? l : null;
    }

    function te(e, t, r, n, o) {
      for (var i = 0; i < e.length; i += 3) {
        var s = e[i + o];
        s >= r && s <= n && (t.push(e[i]), t.push(e[i + 1]), t.push(e[i + 2]));
      }
    }

    function re(e, t, r, n, o, i, s) {
      for (var a, l, u = ne(e), h = 0 === o ? se : ae, c = e.start, f = 0; f < e.length - 3; f += 3) {
        var p = e[f],
            d = e[f + 1],
            g = e[f + 2],
            m = e[f + 3],
            y = e[f + 4],
            v = 0 === o ? p : d,
            x = 0 === o ? m : y,
            w = !1;
        s && (a = Math.sqrt(Math.pow(p - m, 2) + Math.pow(d - y, 2))), v < r ? x > r && (l = h(u, p, d, m, y, r), s && (u.start = c + a * l)) : v > n ? x < n && (l = h(u, p, d, m, y, n), s && (u.start = c + a * l)) : ie(u, p, d, g), x < r && v >= r && (l = h(u, p, d, m, y, r), w = !0), x > n && v <= n && (l = h(u, p, d, m, y, n), w = !0), !i && w && (s && (u.end = c + a * l), t.push(u), u = ne(e)), s && (c += a);
      }

      var S = e.length - 3;
      p = e[S], d = e[S + 1], g = e[S + 2], (v = 0 === o ? p : d) >= r && v <= n && ie(u, p, d, g), S = u.length - 3, i && S >= 3 && (u[S] !== u[0] || u[S + 1] !== u[1]) && ie(u, u[0], u[1], u[2]), u.length && t.push(u);
    }

    function ne(e) {
      var t = [];
      return t.size = e.size, t.start = e.start, t.end = e.end, t;
    }

    function oe(e, t, r, n, o, i) {
      for (var s = 0; s < e.length; s++) {
        re(e[s], t, r, n, o, i, !1);
      }
    }

    function ie(e, t, r, n) {
      e.push(t), e.push(r), e.push(n);
    }

    function se(e, t, r, n, o, i) {
      var s = (i - t) / (n - t);
      return e.push(i), e.push(r + (o - r) * s), e.push(1), s;
    }

    function ae(e, t, r, n, o, i) {
      var s = (i - r) / (o - r);
      return e.push(t + (n - t) * s), e.push(i), e.push(1), s;
    }

    function le(e, t) {
      for (var r = [], n = 0; n < e.length; n++) {
        var o,
            i = e[n],
            s = i.type;
        if ("Point" === s || "MultiPoint" === s || "LineString" === s) o = ue(i.geometry, t);else if ("MultiLineString" === s || "Polygon" === s) {
          o = [];

          for (var a = 0; a < i.geometry.length; a++) {
            o.push(ue(i.geometry[a], t));
          }
        } else if ("MultiPolygon" === s) for (o = [], a = 0; a < i.geometry.length; a++) {
          for (var l = [], u = 0; u < i.geometry[a].length; u++) {
            l.push(ue(i.geometry[a][u], t));
          }

          o.push(l);
        }
        r.push(A(i.id, s, o, i.tags));
      }

      return r;
    }

    function ue(e, t) {
      var r = [];
      r.size = e.size, void 0 !== e.start && (r.start = e.start, r.end = e.end);

      for (var n = 0; n < e.length; n += 3) {
        r.push(e[n] + t, e[n + 1], e[n + 2]);
      }

      return r;
    }

    function he(e, t) {
      if (e.transformed) return e;
      var r,
          n,
          o,
          i = 1 << e.z,
          s = e.x,
          a = e.y;

      for (r = 0; r < e.features.length; r++) {
        var l = e.features[r],
            u = l.geometry,
            h = l.type;
        if (l.geometry = [], 1 === h) for (n = 0; n < u.length; n += 2) {
          l.geometry.push(ce(u[n], u[n + 1], t, i, s, a));
        } else for (n = 0; n < u.length; n++) {
          var c = [];

          for (o = 0; o < u[n].length; o += 2) {
            c.push(ce(u[n][o], u[n][o + 1], t, i, s, a));
          }

          l.geometry.push(c);
        }
      }

      return e.transformed = !0, e;
    }

    function ce(e, t, r, n, o, i) {
      return [Math.round(r * (e * n - o)), Math.round(r * (t * n - i))];
    }

    function fe(e, t, r, n, o) {
      for (var i = t === o.maxZoom ? 0 : o.tolerance / ((1 << t) * o.extent), s = {
        features: [],
        numPoints: 0,
        numSimplified: 0,
        numFeatures: 0,
        source: null,
        x: r,
        y: n,
        z: t,
        transformed: !1,
        minX: 2,
        minY: 1,
        maxX: -1,
        maxY: 0
      }, a = 0; a < e.length; a++) {
        s.numFeatures++, pe(s, e[a], i, o);
        var l = e[a].minX,
            u = e[a].minY,
            h = e[a].maxX,
            c = e[a].maxY;
        l < s.minX && (s.minX = l), u < s.minY && (s.minY = u), h > s.maxX && (s.maxX = h), c > s.maxY && (s.maxY = c);
      }

      return s;
    }

    function pe(e, t, r, n) {
      var o = t.geometry,
          i = t.type,
          s = [];
      if ("Point" === i || "MultiPoint" === i) for (var a = 0; a < o.length; a += 3) {
        s.push(o[a]), s.push(o[a + 1]), e.numPoints++, e.numSimplified++;
      } else if ("LineString" === i) de(s, o, e, r, !1, !1);else if ("MultiLineString" === i || "Polygon" === i) for (a = 0; a < o.length; a++) {
        de(s, o[a], e, r, "Polygon" === i, 0 === a);
      } else if ("MultiPolygon" === i) for (var l = 0; l < o.length; l++) {
        var u = o[l];

        for (a = 0; a < u.length; a++) {
          de(s, u[a], e, r, !0, 0 === a);
        }
      }

      if (s.length) {
        var h = t.tags || null;

        if ("LineString" === i && n.lineMetrics) {
          for (var c in h = {}, t.tags) {
            h[c] = t.tags[c];
          }

          h.mapbox_clip_start = o.start / o.size, h.mapbox_clip_end = o.end / o.size;
        }

        var f = {
          geometry: s,
          type: "Polygon" === i || "MultiPolygon" === i ? 3 : "LineString" === i || "MultiLineString" === i ? 2 : 1,
          tags: h
        };
        null !== t.id && (f.id = t.id), e.features.push(f);
      }
    }

    function de(e, t, r, n, o, i) {
      var s = n * n;
      if (n > 0 && t.size < (o ? s : n)) r.numPoints += t.length / 3;else {
        for (var a = [], l = 0; l < t.length; l += 3) {
          (0 === n || t[l + 2] > s) && (r.numSimplified++, a.push(t[l]), a.push(t[l + 1])), r.numPoints++;
        }

        o && function (e, t) {
          for (var r = 0, n = 0, o = e.length, i = o - 2; n < o; i = n, n += 2) {
            r += (e[n] - e[i]) * (e[n + 1] + e[i + 1]);
          }

          if (r > 0 === t) for (n = 0, o = e.length; n < o / 2; n += 2) {
            var s = e[n],
                a = e[n + 1];
            e[n] = e[o - 2 - n], e[n + 1] = e[o - 1 - n], e[o - 2 - n] = s, e[o - 1 - n] = a;
          }
        }(a, i), e.push(a);
      }
    }

    function ge(e, t) {
      var r = (t = this.options = function (e, t) {
        for (var r in t) {
          e[r] = t[r];
        }

        return e;
      }(Object.create(this.options), t)).debug;

      if (r && console.time("preprocess data"), t.maxZoom < 0 || t.maxZoom > 24) throw new Error("maxZoom should be in the 0-24 range");
      if (t.promoteId && t.generateId) throw new Error("promoteId and generateId cannot be used together.");

      var n = function (e, t) {
        var r = [];
        if ("FeatureCollection" === e.type) for (var n = 0; n < e.features.length; n++) {
          B(r, e.features[n], t, n);
        } else B(r, "Feature" === e.type ? e : {
          geometry: e
        }, t);
        return r;
      }(e, t);

      this.tiles = {}, this.tileCoords = [], r && (console.timeEnd("preprocess data"), console.log("index: maxZoom: %d, maxPoints: %d", t.indexMaxZoom, t.indexMaxPoints), console.time("generate tiles"), this.stats = {}, this.total = 0), (n = function (e, t) {
        var r = t.buffer / t.extent,
            n = e,
            o = ee(e, 1, -1 - r, r, 0, -1, 2, t),
            i = ee(e, 1, 1 - r, 2 + r, 0, -1, 2, t);
        return (o || i) && (n = ee(e, 1, -r, 1 + r, 0, -1, 2, t) || [], o && (n = le(o, 1).concat(n)), i && (n = n.concat(le(i, -1)))), n;
      }(n, t)).length && this.splitTile(n, 0, 0, 0), r && (n.length && console.log("features: %d, points: %d", this.tiles[0].numFeatures, this.tiles[0].numPoints), console.timeEnd("generate tiles"), console.log("tiles generated:", this.total, JSON.stringify(this.stats)));
    }

    function me(e, t, r) {
      return 32 * ((1 << e) * r + t) + e;
    }

    function ye(e, t) {
      var r = e.tileID.canonical;
      if (!this._geoJSONIndex) return t(null, null);

      var n = this._geoJSONIndex.getTile(r.z, r.x, r.y);

      if (!n) return t(null, null);
      var o = new h(n.features);
      var i = g(o);
      0 === i.byteOffset && i.byteLength === i.buffer.byteLength || (i = new Uint8Array(i)), t(null, {
        vectorTile: o,
        rawData: i.buffer
      });
    }

    ge.prototype.options = {
      maxZoom: 14,
      indexMaxZoom: 5,
      indexMaxPoints: 1e5,
      tolerance: 3,
      extent: 4096,
      buffer: 64,
      lineMetrics: !1,
      promoteId: null,
      generateId: !1,
      debug: 0
    }, ge.prototype.splitTile = function (e, t, r, n, o, i, s) {
      for (var a = [e, t, r, n], l = this.options, u = l.debug; a.length;) {
        n = a.pop(), r = a.pop(), t = a.pop(), e = a.pop();
        var h = 1 << t,
            c = me(t, r, n),
            f = this.tiles[c];

        if (!f && (u > 1 && console.time("creation"), f = this.tiles[c] = fe(e, t, r, n, l), this.tileCoords.push({
          z: t,
          x: r,
          y: n
        }), u)) {
          u > 1 && (console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)", t, r, n, f.numFeatures, f.numPoints, f.numSimplified), console.timeEnd("creation"));
          var p = "z" + t;
          this.stats[p] = (this.stats[p] || 0) + 1, this.total++;
        }

        if (f.source = e, o) {
          if (t === l.maxZoom || t === o) continue;
          var d = 1 << o - t;
          if (r !== Math.floor(i / d) || n !== Math.floor(s / d)) continue;
        } else if (t === l.indexMaxZoom || f.numPoints <= l.indexMaxPoints) continue;

        if (f.source = null, 0 !== e.length) {
          u > 1 && console.time("clipping");

          var g,
              m,
              y,
              v,
              x,
              w,
              S = .5 * l.buffer / l.extent,
              M = .5 - S,
              _ = .5 + S,
              P = 1 + S;

          g = m = y = v = null, x = ee(e, h, r - S, r + _, 0, f.minX, f.maxX, l), w = ee(e, h, r + M, r + P, 0, f.minX, f.maxX, l), e = null, x && (g = ee(x, h, n - S, n + _, 1, f.minY, f.maxY, l), m = ee(x, h, n + M, n + P, 1, f.minY, f.maxY, l), x = null), w && (y = ee(w, h, n - S, n + _, 1, f.minY, f.maxY, l), v = ee(w, h, n + M, n + P, 1, f.minY, f.maxY, l), w = null), u > 1 && console.timeEnd("clipping"), a.push(g || [], t + 1, 2 * r, 2 * n), a.push(m || [], t + 1, 2 * r, 2 * n + 1), a.push(y || [], t + 1, 2 * r + 1, 2 * n), a.push(v || [], t + 1, 2 * r + 1, 2 * n + 1);
        }
      }
    }, ge.prototype.getTile = function (e, t, r) {
      var n = this.options,
          o = n.extent,
          i = n.debug;
      if (e < 0 || e > 24) return null;
      var s = 1 << e,
          a = me(e, t = (t % s + s) % s, r);
      if (this.tiles[a]) return he(this.tiles[a], o);
      i > 1 && console.log("drilling down to z%d-%d-%d", e, t, r);

      for (var l, u = e, h = t, c = r; !l && u > 0;) {
        u--, h = Math.floor(h / 2), c = Math.floor(c / 2), l = this.tiles[me(u, h, c)];
      }

      return l && l.source ? (i > 1 && console.log("found parent tile z%d-%d-%d", u, h, c), i > 1 && console.time("drilling down"), this.splitTile(l.source, u, h, c, e, t, r), i > 1 && console.timeEnd("drilling down"), this.tiles[a] ? he(this.tiles[a], o) : null) : null;
    };

    var ve = /*#__PURE__*/function (_e$VectorTileWorkerSo) {
      _inherits(ve, _e$VectorTileWorkerSo);

      var _super101 = _createSuper(ve);

      function ve(e, t, r, n, o) {
        var _this56;

        _classCallCheck(this, ve);

        _this56 = _super101.call(this, e, t, r, n, ye), o && (_this56.loadGeoJSON = o);
        return _this56;
      }

      _createClass(ve, [{
        key: "loadData",
        value: function loadData(e, t) {
          this._pendingCallback && this._pendingCallback(null, {
            abandoned: !0
          }), this._pendingCallback = t, this._pendingLoadDataParams = e, this._state && "Idle" !== this._state ? this._state = "NeedsLoadData" : (this._state = "Coalescing", this._loadData());
        }
      }, {
        key: "_loadData",
        value: function _loadData() {
          var _this57 = this;

          if (!this._pendingCallback || !this._pendingLoadDataParams) return;
          var t = this._pendingCallback,
              r = this._pendingLoadDataParams;
          delete this._pendingCallback, delete this._pendingLoadDataParams;
          var n = !!(r && r.request && r.request.collectResourceTiming) && new e.RequestPerformance(r.request);
          this.loadGeoJSON(r, function (o, i) {
            if (o || !i) return t(o);
            if ("object" != _typeof(i)) return t(new Error("Input data given to '".concat(r.source, "' is not a valid GeoJSON object.")));
            {
              !function e(t, r) {
                var n,
                    o = t && t.type;
                if ("FeatureCollection" === o) for (n = 0; n < t.features.length; n++) {
                  e(t.features[n], r);
                } else if ("GeometryCollection" === o) for (n = 0; n < t.geometries.length; n++) {
                  e(t.geometries[n], r);
                } else if ("Feature" === o) e(t.geometry, r);else if ("Polygon" === o) s(t.coordinates, r);else if ("MultiPolygon" === o) for (n = 0; n < t.coordinates.length; n++) {
                  s(t.coordinates[n], r);
                }
                return t;
              }(i, !0);

              try {
                if (r.filter) {
                  var _t230 = e.createExpression(r.filter, {
                    type: "boolean",
                    "property-type": "data-driven",
                    overridable: !1,
                    transition: !1
                  });

                  if ("error" === _t230.result) throw new Error(_t230.value.map(function (e) {
                    return "".concat(e.key, ": ").concat(e.message);
                  }).join(", "));

                  var _n118 = i.features.filter(function (e) {
                    return _t230.value.evaluate({
                      zoom: 0
                    }, e);
                  });

                  i = {
                    type: "FeatureCollection",
                    features: _n118
                  };
                }

                _this57._geoJSONIndex = r.cluster ? new F(function (_ref67) {
                  var {
                    superclusterOptions: t,
                    clusterProperties: r
                  } = _ref67;
                  if (!r || !t) return t;
                  var n = {},
                      o = {},
                      i = {
                    accumulated: null,
                    zoom: 0
                  },
                      s = {
                    properties: null
                  },
                      a = Object.keys(r);

                  for (var _t231 of a) {
                    var [_i139, _s95] = r[_t231],
                        _a83 = e.createExpression(_s95),
                        _l36 = e.createExpression("string" == typeof _i139 ? [_i139, ["accumulated"], ["get", _t231]] : _i139);

                    n[_t231] = _a83.value, o[_t231] = _l36.value;
                  }

                  return t.map = function (e) {
                    s.properties = e;
                    var t = {};

                    for (var _e214 of a) {
                      t[_e214] = n[_e214].evaluate(i, s);
                    }

                    return t;
                  }, t.reduce = function (e, t) {
                    s.properties = t;

                    for (var _t232 of a) {
                      i.accumulated = e[_t232], e[_t232] = o[_t232].evaluate(i, s);
                    }
                  }, t;
                }(r)).load(i.features) : function (e, t) {
                  return new ge(e, t);
                }(i, r.geojsonVtOptions);
              } catch (o) {
                return t(o);
              }

              _this57.loaded = {};
              var _a82 = {};

              if (n) {
                var _e215 = n.finish();

                _e215 && (_a82.resourceTiming = {}, _a82.resourceTiming[r.source] = JSON.parse(JSON.stringify(_e215)));
              }

              t(null, _a82);
            }
          });
        }
      }, {
        key: "coalesce",
        value: function coalesce() {
          "Coalescing" === this._state ? this._state = "Idle" : "NeedsLoadData" === this._state && (this._state = "Coalescing", this._loadData());
        }
      }, {
        key: "reloadTile",
        value: function reloadTile(e, t) {
          var r = this.loaded;
          return r && r[e.uid] ? _get(_getPrototypeOf(ve.prototype), "reloadTile", this).call(this, e, t) : this.loadTile(e, t);
        }
      }, {
        key: "loadGeoJSON",
        value: function loadGeoJSON(t, r) {
          if (t.request) e.getJSON(t.request, r);else {
            if ("string" != typeof t.data) return r(new Error("Input data given to '".concat(t.source, "' is not a valid GeoJSON object.")));

            try {
              return r(null, JSON.parse(t.data));
            } catch (e) {
              return r(new Error("Input data given to '".concat(t.source, "' is not a valid GeoJSON object.")));
            }
          }
        }
      }, {
        key: "removeSource",
        value: function removeSource(e, t) {
          this._pendingCallback && this._pendingCallback(null, {
            abandoned: !0
          }), t();
        }
      }, {
        key: "getClusterExpansionZoom",
        value: function getClusterExpansionZoom(e, t) {
          try {
            t(null, this._geoJSONIndex.getClusterExpansionZoom(e.clusterId));
          } catch (e) {
            t(e);
          }
        }
      }, {
        key: "getClusterChildren",
        value: function getClusterChildren(e, t) {
          try {
            t(null, this._geoJSONIndex.getChildren(e.clusterId));
          } catch (e) {
            t(e);
          }
        }
      }, {
        key: "getClusterLeaves",
        value: function getClusterLeaves(e, t) {
          try {
            t(null, this._geoJSONIndex.getLeaves(e.clusterId, e.limit, e.offset));
          } catch (e) {
            t(e);
          }
        }
      }]);

      return ve;
    }(e.VectorTileWorkerSource);

    var xe = /*#__PURE__*/function () {
      function xe(t) {
        var _this58 = this;

        _classCallCheck(this, xe);

        this.self = t, this.actor = new e.Actor(t, this), this.layerIndexes = {}, this.availableImages = {}, this.isSpriteLoaded = !1, this.workerSourceTypes = {
          vector: e.VectorTileWorkerSource,
          geojson: ve
        }, this.workerSources = {}, this.demWorkerSources = {}, this.self.registerWorkerSource = function (e, t) {
          if (_this58.workerSourceTypes[e]) throw new Error("Worker source with name \"".concat(e, "\" already registered."));
          _this58.workerSourceTypes[e] = t;
        }, this.self.registerRTLTextPlugin = function (t) {
          if (e.plugin.isParsed()) throw new Error("RTL text plugin already registered.");
          e.plugin.applyArabicShaping = t.applyArabicShaping, e.plugin.processBidirectionalText = t.processBidirectionalText, e.plugin.processStyledBidirectionalText = t.processStyledBidirectionalText;
        };
      }

      _createClass(xe, [{
        key: "checkIfReady",
        value: function checkIfReady(e, t, r) {
          r();
        }
      }, {
        key: "setReferrer",
        value: function setReferrer(e, t) {
          this.referrer = t;
        }
      }, {
        key: "spriteLoaded",
        value: function spriteLoaded(t, r) {
          this.isSpriteLoaded = r;

          for (var _n119 in this.workerSources[t]) {
            var _o49 = this.workerSources[t][_n119];

            for (var _t233 in _o49) {
              _o49[_t233] instanceof e.VectorTileWorkerSource && (_o49[_t233].isSpriteLoaded = r, _o49[_t233].fire(new e.Event("isSpriteLoaded")));
            }
          }
        }
      }, {
        key: "setImages",
        value: function setImages(e, t, r) {
          this.availableImages[e] = t;

          for (var _r205 in this.workerSources[e]) {
            var _n120 = this.workerSources[e][_r205];

            for (var _e216 in _n120) {
              _n120[_e216].availableImages = t;
            }
          }

          r();
        }
      }, {
        key: "enableTerrain",
        value: function enableTerrain(e, t, r) {
          this.terrain = t, r();
        }
      }, {
        key: "setLayers",
        value: function setLayers(e, t, r) {
          this.getLayerIndex(e).replace(t), r();
        }
      }, {
        key: "updateLayers",
        value: function updateLayers(e, t, r) {
          this.getLayerIndex(e).update(t.layers, t.removedIds), r();
        }
      }, {
        key: "loadTile",
        value: function loadTile(t, r, n) {
          var o = this.enableTerrain ? e.extend({
            enableTerrain: this.terrain
          }, r) : r;
          this.getWorkerSource(t, r.type, r.source).loadTile(o, n);
        }
      }, {
        key: "loadDEMTile",
        value: function loadDEMTile(t, r, n) {
          var o = this.enableTerrain ? e.extend({
            buildQuadTree: this.terrain
          }, r) : r;
          this.getDEMWorkerSource(t, r.source).loadTile(o, n);
        }
      }, {
        key: "reloadTile",
        value: function reloadTile(t, r, n) {
          var o = this.enableTerrain ? e.extend({
            enableTerrain: this.terrain
          }, r) : r;
          this.getWorkerSource(t, r.type, r.source).reloadTile(o, n);
        }
      }, {
        key: "abortTile",
        value: function abortTile(e, t, r) {
          this.getWorkerSource(e, t.type, t.source).abortTile(t, r);
        }
      }, {
        key: "removeTile",
        value: function removeTile(e, t, r) {
          this.getWorkerSource(e, t.type, t.source).removeTile(t, r);
        }
      }, {
        key: "removeSource",
        value: function removeSource(e, t, r) {
          if (!this.workerSources[e] || !this.workerSources[e][t.type] || !this.workerSources[e][t.type][t.source]) return;
          var n = this.workerSources[e][t.type][t.source];
          delete this.workerSources[e][t.type][t.source], void 0 !== n.removeSource ? n.removeSource(t, r) : r();
        }
      }, {
        key: "loadWorkerSource",
        value: function loadWorkerSource(e, t, r) {
          try {
            this.self.importScripts(t.url), r();
          } catch (e) {
            r(e.toString());
          }
        }
      }, {
        key: "syncRTLPluginState",
        value: function syncRTLPluginState(t, r, n) {
          try {
            e.plugin.setState(r);

            var _t234 = e.plugin.getPluginURL();

            if (e.plugin.isLoaded() && !e.plugin.isParsed() && null != _t234) {
              this.self.importScripts(_t234);

              var _r206 = e.plugin.isParsed();

              n(_r206 ? void 0 : new Error("RTL Text Plugin failed to import scripts from ".concat(_t234)), _r206);
            }
          } catch (e) {
            n(e.toString());
          }
        }
      }, {
        key: "getAvailableImages",
        value: function getAvailableImages(e) {
          var t = this.availableImages[e];
          return t || (t = []), t;
        }
      }, {
        key: "getLayerIndex",
        value: function getLayerIndex(e) {
          var t = this.layerIndexes[e];
          return t || (t = this.layerIndexes[e] = new n()), t;
        }
      }, {
        key: "getWorkerSource",
        value: function getWorkerSource(e, t, r) {
          var _this59 = this;

          return this.workerSources[e] || (this.workerSources[e] = {}), this.workerSources[e][t] || (this.workerSources[e][t] = {}), this.workerSources[e][t][r] || (this.workerSources[e][t][r] = new this.workerSourceTypes[t]({
            send: function (t, r, n, o, i, s) {
              _this59.actor.send(t, r, n, e, o, s);
            },
            scheduler: this.actor.scheduler
          }, this.getLayerIndex(e), this.getAvailableImages(e), this.isSpriteLoaded)), this.workerSources[e][t][r];
        }
      }, {
        key: "getDEMWorkerSource",
        value: function getDEMWorkerSource(e, t) {
          return this.demWorkerSources[e] || (this.demWorkerSources[e] = {}), this.demWorkerSources[e][t] || (this.demWorkerSources[e][t] = new i()), this.demWorkerSources[e][t];
        }
      }, {
        key: "enforceCacheSizeLimit",
        value: function enforceCacheSizeLimit(t, r) {
          e.enforceCacheSizeLimit(r);
        }
      }, {
        key: "getWorkerPerformanceMetrics",
        value: function getWorkerPerformanceMetrics(e, t, r) {
          r(void 0, void 0);
        }
      }]);

      return xe;
    }();

    return "undefined" != typeof WorkerGlobalScope && "undefined" != typeof self && self instanceof WorkerGlobalScope && (self.worker = new xe(self)), xe;
  });
  define(["./shared"], function (e) {
    "use strict";

    var t = i;

    function i(e) {
      return !function (e) {
        return "undefined" == typeof window || "undefined" == typeof document ? "not a browser" : Array.prototype && Array.prototype.every && Array.prototype.filter && Array.prototype.forEach && Array.prototype.indexOf && Array.prototype.lastIndexOf && Array.prototype.map && Array.prototype.some && Array.prototype.reduce && Array.prototype.reduceRight && Array.isArray ? Function.prototype && Function.prototype.bind ? Object.keys && Object.create && Object.getPrototypeOf && Object.getOwnPropertyNames && Object.isSealed && Object.isFrozen && Object.isExtensible && Object.getOwnPropertyDescriptor && Object.defineProperty && Object.defineProperties && Object.seal && Object.freeze && Object.preventExtensions ? "JSON" in window && "parse" in JSON && "stringify" in JSON ? function () {
          if (!("Worker" in window && "Blob" in window && "URL" in window)) return !1;
          var e,
              t,
              i = new Blob([""], {
            type: "text/javascript"
          }),
              o = URL.createObjectURL(i);

          try {
            t = new Worker(o), e = !0;
          } catch (t) {
            e = !1;
          }

          return t && t.terminate(), URL.revokeObjectURL(o), e;
        }() ? "Uint8ClampedArray" in window ? ArrayBuffer.isView ? function () {
          var e = document.createElement("canvas");
          e.width = e.height = 1;
          var t = e.getContext("2d");
          if (!t) return !1;
          var i = t.getImageData(0, 0, 1, 1);
          return i && i.width === e.width;
        }() ? (void 0 === o[t = e && e.failIfMajorPerformanceCaveat] && (o[t] = function (e) {
          var t,
              o = function (e) {
            var t = document.createElement("canvas"),
                o = Object.create(i.webGLContextAttributes);
            return o.failIfMajorPerformanceCaveat = e, t.getContext("webgl", o) || t.getContext("experimental-webgl", o);
          }(e);

          if (!o) return !1;

          try {
            t = o.createShader(o.VERTEX_SHADER);
          } catch (e) {
            return !1;
          }

          return !(!t || o.isContextLost()) && (o.shaderSource(t, "void main() {}"), o.compileShader(t), !0 === o.getShaderParameter(t, o.COMPILE_STATUS));
        }(t)), o[t] ? document.documentMode ? "insufficient ECMAScript 6 support" : void 0 : "insufficient WebGL support") : "insufficient Canvas/getImageData support" : "insufficient ArrayBuffer support" : "insufficient Uint8ClampedArray support" : "insufficient worker support" : "insufficient JSON support" : "insufficient Object support" : "insufficient Function support" : "insufficent Array support";
        var t;
      }(e);
    }

    var o = {};
    i.webGLContextAttributes = {
      antialias: !1,
      alpha: !0,
      stencil: !0,
      depth: !0
    };
    var a = {
      create: function (t, i, o) {
        var a = e.window.document.createElement(t);
        return void 0 !== i && (a.className = i), o && o.appendChild(a), a;
      },
      createNS: function (t, i) {
        return e.window.document.createElementNS(t, i);
      }
    },
        r = e.window.document && e.window.document.documentElement.style,
        n = r && void 0 !== r.userSelect ? "userSelect" : "WebkitUserSelect";
    var s;
    a.disableDrag = function () {
      r && n && (s = r[n], r[n] = "none");
    }, a.enableDrag = function () {
      r && n && (r[n] = s);
    }, a.setTransform = function (e, t) {
      e.style.transform = t;
    };
    var l = !1;

    try {
      var _t235 = Object.defineProperty({}, "passive", {
        get: function () {
          l = !0;
        }
      });

      e.window.addEventListener("test", _t235, _t235), e.window.removeEventListener("test", _t235, _t235);
    } catch (e) {
      l = !1;
    }

    a.addEventListener = function (e, t, i) {
      var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
      e.addEventListener(t, i, "passive" in o && l ? o : o.capture);
    }, a.removeEventListener = function (e, t, i) {
      var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
      e.removeEventListener(t, i, "passive" in o && l ? o : o.capture);
    };

    var c = function (t) {
      t.preventDefault(), t.stopPropagation(), e.window.removeEventListener("click", c, !0);
    };

    function h(e) {
      var {
        userImage: t
      } = e;
      return !!(t && t.render && t.render()) && (e.data.replace(new Uint8Array(t.data.buffer)), !0);
    }

    a.suppressClick = function () {
      e.window.addEventListener("click", c, !0), e.window.setTimeout(function () {
        e.window.removeEventListener("click", c, !0);
      }, 0);
    }, a.mousePos = function (t, i) {
      var o = t.getBoundingClientRect();
      return new e.Point(i.clientX - o.left - t.clientLeft, i.clientY - o.top - t.clientTop);
    }, a.touchPos = function (t, i) {
      var o = t.getBoundingClientRect(),
          a = [];

      for (var _r207 = 0; _r207 < i.length; _r207++) {
        a.push(new e.Point(i[_r207].clientX - o.left - t.clientLeft, i[_r207].clientY - o.top - t.clientTop));
      }

      return a;
    }, a.mouseButton = function (t) {
      return void 0 !== e.window.InstallTrigger && 2 === t.button && t.ctrlKey && e.window.navigator.platform.toUpperCase().indexOf("MAC") >= 0 ? 0 : t.button;
    }, a.remove = function (e) {
      e.parentNode && e.parentNode.removeChild(e);
    };

    var u = /*#__PURE__*/function (_e$Evented) {
      _inherits(u, _e$Evented);

      var _super102 = _createSuper(u);

      function u() {
        var _this60;

        _classCallCheck(this, u);

        _this60 = _super102.call(this), _this60.images = {}, _this60.updatedImages = {}, _this60.callbackDispatchedThisFrame = {}, _this60.loaded = !1, _this60.requestors = [], _this60.patterns = {}, _this60.atlasImage = new e.RGBAImage({
          width: 1,
          height: 1
        }), _this60.dirty = !0;
        return _this60;
      }

      _createClass(u, [{
        key: "isLoaded",
        value: function isLoaded() {
          return this.loaded;
        }
      }, {
        key: "setLoaded",
        value: function setLoaded(e) {
          if (this.loaded !== e && (this.loaded = e, e)) {
            for (var {
              ids: _e217,
              callback: _t236
            } of this.requestors) {
              this._notify(_e217, _t236);
            }

            this.requestors = [];
          }
        }
      }, {
        key: "getImage",
        value: function getImage(e) {
          return this.images[e];
        }
      }, {
        key: "addImage",
        value: function addImage(e, t) {
          this._validate(e, t) && (this.images[e] = t);
        }
      }, {
        key: "_validate",
        value: function _validate(t, i) {
          var o = !0;
          return this._validateStretch(i.stretchX, i.data && i.data.width) || (this.fire(new e.ErrorEvent(new Error("Image \"".concat(t, "\" has invalid \"stretchX\" value")))), o = !1), this._validateStretch(i.stretchY, i.data && i.data.height) || (this.fire(new e.ErrorEvent(new Error("Image \"".concat(t, "\" has invalid \"stretchY\" value")))), o = !1), this._validateContent(i.content, i) || (this.fire(new e.ErrorEvent(new Error("Image \"".concat(t, "\" has invalid \"content\" value")))), o = !1), o;
        }
      }, {
        key: "_validateStretch",
        value: function _validateStretch(e, t) {
          if (!e) return !0;
          var i = 0;

          for (var _o50 of e) {
            if (_o50[0] < i || _o50[1] < _o50[0] || t < _o50[1]) return !1;
            i = _o50[1];
          }

          return !0;
        }
      }, {
        key: "_validateContent",
        value: function _validateContent(e, t) {
          return !(e && (4 !== e.length || e[0] < 0 || t.data.width < e[0] || e[1] < 0 || t.data.height < e[1] || e[2] < 0 || t.data.width < e[2] || e[3] < 0 || t.data.height < e[3] || e[2] < e[0] || e[3] < e[1]));
        }
      }, {
        key: "updateImage",
        value: function updateImage(e, t) {
          t.version = this.images[e].version + 1, this.images[e] = t, this.updatedImages[e] = !0;
        }
      }, {
        key: "removeImage",
        value: function removeImage(e) {
          var t = this.images[e];
          delete this.images[e], delete this.patterns[e], t.userImage && t.userImage.onRemove && t.userImage.onRemove();
        }
      }, {
        key: "listImages",
        value: function listImages() {
          return Object.keys(this.images);
        }
      }, {
        key: "getImages",
        value: function getImages(e, t) {
          var i = !0;
          if (!this.isLoaded()) for (var _t237 of e) {
            this.images[_t237] || (i = !1);
          }
          this.isLoaded() || i ? this._notify(e, t) : this.requestors.push({
            ids: e,
            callback: t
          });
        }
      }, {
        key: "_notify",
        value: function _notify(t, i) {
          var o = {};

          for (var _i140 of t) {
            this.images[_i140] || this.fire(new e.Event("styleimagemissing", {
              id: _i140
            }));
            var _t238 = this.images[_i140];
            _t238 ? o[_i140] = {
              data: _t238.data.clone(),
              pixelRatio: _t238.pixelRatio,
              sdf: _t238.sdf,
              version: _t238.version,
              stretchX: _t238.stretchX,
              stretchY: _t238.stretchY,
              content: _t238.content,
              hasRenderCallback: Boolean(_t238.userImage && _t238.userImage.render)
            } : e.warnOnce("Image \"".concat(_i140, "\" could not be loaded. Please make sure you have added the image with map.addImage() or a \"sprite\" property in your style. You can provide missing images by listening for the \"styleimagemissing\" map event."));
          }

          i(null, o);
        }
      }, {
        key: "getPixelSize",
        value: function getPixelSize() {
          var {
            width: e,
            height: t
          } = this.atlasImage;
          return {
            width: e,
            height: t
          };
        }
      }, {
        key: "getPattern",
        value: function getPattern(t) {
          var i = this.patterns[t],
              o = this.getImage(t);
          if (!o) return null;
          if (i && i.position.version === o.version) return i.position;
          if (i) i.position.version = o.version;else {
            var _i141 = {
              w: o.data.width + 2,
              h: o.data.height + 2,
              x: 0,
              y: 0
            },
                _a84 = new e.ImagePosition(_i141, o);

            this.patterns[t] = {
              bin: _i141,
              position: _a84
            };
          }
          return this._updatePatternAtlas(), this.patterns[t].position;
        }
      }, {
        key: "bind",
        value: function bind(t) {
          var i = t.gl;
          this.atlasTexture ? this.dirty && (this.atlasTexture.update(this.atlasImage), this.dirty = !1) : this.atlasTexture = new e.Texture(t, this.atlasImage, i.RGBA), this.atlasTexture.bind(i.LINEAR, i.CLAMP_TO_EDGE);
        }
      }, {
        key: "_updatePatternAtlas",
        value: function _updatePatternAtlas() {
          var t = [];

          for (var _e218 in this.patterns) {
            t.push(this.patterns[_e218].bin);
          }

          var {
            w: i,
            h: o
          } = e.potpack(t),
              a = this.atlasImage;
          a.resize({
            width: i || 1,
            height: o || 1
          });

          for (var _t239 in this.patterns) {
            var {
              bin: _i142
            } = this.patterns[_t239],
                _o51 = _i142.x + 1,
                _r208 = _i142.y + 1,
                _n121 = this.images[_t239].data,
                _s96 = _n121.width,
                _l37 = _n121.height;

            e.RGBAImage.copy(_n121, a, {
              x: 0,
              y: 0
            }, {
              x: _o51,
              y: _r208
            }, {
              width: _s96,
              height: _l37
            }), e.RGBAImage.copy(_n121, a, {
              x: 0,
              y: _l37 - 1
            }, {
              x: _o51,
              y: _r208 - 1
            }, {
              width: _s96,
              height: 1
            }), e.RGBAImage.copy(_n121, a, {
              x: 0,
              y: 0
            }, {
              x: _o51,
              y: _r208 + _l37
            }, {
              width: _s96,
              height: 1
            }), e.RGBAImage.copy(_n121, a, {
              x: _s96 - 1,
              y: 0
            }, {
              x: _o51 - 1,
              y: _r208
            }, {
              width: 1,
              height: _l37
            }), e.RGBAImage.copy(_n121, a, {
              x: 0,
              y: 0
            }, {
              x: _o51 + _s96,
              y: _r208
            }, {
              width: 1,
              height: _l37
            });
          }

          this.dirty = !0;
        }
      }, {
        key: "beginFrame",
        value: function beginFrame() {
          this.callbackDispatchedThisFrame = {};
        }
      }, {
        key: "dispatchRenderCallbacks",
        value: function dispatchRenderCallbacks(e) {
          for (var _t240 of e) {
            if (this.callbackDispatchedThisFrame[_t240]) continue;
            this.callbackDispatchedThisFrame[_t240] = !0;
            var _e219 = this.images[_t240];
            h(_e219) && this.updateImage(_t240, _e219);
          }
        }
      }]);

      return u;
    }(e.Evented);

    var d = new e.Properties({
      anchor: new e.DataConstantProperty(e.styleSpec.light.anchor),
      position: new ( /*#__PURE__*/function () {
        function _class17() {
          _classCallCheck(this, _class17);

          this.specification = e.styleSpec.light.position;
        }

        _createClass(_class17, [{
          key: "possiblyEvaluate",
          value: function possiblyEvaluate(t, i) {
            return function (_ref68) {
              var [t, i, o] = _ref68;
              var a = e.degToRad(i + 90),
                  r = e.degToRad(o);
              return {
                x: t * Math.cos(a) * Math.sin(r),
                y: t * Math.sin(a) * Math.sin(r),
                z: t * Math.cos(r),
                azimuthal: i,
                polar: o
              };
            }(t.expression.evaluate(i));
          }
        }, {
          key: "interpolate",
          value: function interpolate(t, i, o) {
            return {
              x: e.number(t.x, i.x, o),
              y: e.number(t.y, i.y, o),
              z: e.number(t.z, i.z, o),
              azimuthal: e.number(t.azimuthal, i.azimuthal, o),
              polar: e.number(t.polar, i.polar, o)
            };
          }
        }]);

        return _class17;
      }())(),
      color: new e.DataConstantProperty(e.styleSpec.light.color),
      intensity: new e.DataConstantProperty(e.styleSpec.light.intensity)
    });

    var _ = /*#__PURE__*/function (_e$Evented2) {
      _inherits(_, _e$Evented2);

      var _super103 = _createSuper(_);

      function _(t) {
        var _this61;

        _classCallCheck(this, _);

        _this61 = _super103.call(this), _this61._transitionable = new e.Transitionable(d), _this61.setLight(t), _this61._transitioning = _this61._transitionable.untransitioned();
        return _this61;
      }

      _createClass(_, [{
        key: "getLight",
        value: function getLight() {
          return this._transitionable.serialize();
        }
      }, {
        key: "setLight",
        value: function setLight(t) {
          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          if (!this._validate(e.validateLight, t, i)) for (var _i143 in t) {
            var _o52 = t[_i143];
            e.endsWith(_i143, "-transition") ? this._transitionable.setTransition(_i143.slice(0, -"-transition".length), _o52) : this._transitionable.setValue(_i143, _o52);
          }
        }
      }, {
        key: "updateTransitions",
        value: function updateTransitions(e) {
          this._transitioning = this._transitionable.transitioned(e, this._transitioning);
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return this._transitioning.hasTransition();
        }
      }, {
        key: "recalculate",
        value: function recalculate(e) {
          this.properties = this._transitioning.possiblyEvaluate(e);
        }
      }, {
        key: "_validate",
        value: function _validate(t, i, o) {
          return (!o || !1 !== o.validate) && e.emitValidationErrors(this, t.call(e.validateStyle, e.extend({
            value: i,
            style: {
              glyphs: !0,
              sprite: !0
            },
            styleSpec: e.styleSpec
          })));
        }
      }]);

      return _;
    }(e.Evented);

    var m = new e.Properties({
      source: new e.DataConstantProperty(e.styleSpec.terrain.source),
      exaggeration: new e.DataConstantProperty(e.styleSpec.terrain.exaggeration)
    });

    var p = /*#__PURE__*/function (_e$Evented3) {
      _inherits(p, _e$Evented3);

      var _super104 = _createSuper(p);

      function p(t) {
        var _this62;

        _classCallCheck(this, p);

        _this62 = _super104.call(this), _this62._transitionable = new e.Transitionable(m), _this62.set(t), _this62._transitioning = _this62._transitionable.untransitioned();
        return _this62;
      }

      _createClass(p, [{
        key: "get",
        value: function get() {
          return this._transitionable.serialize();
        }
      }, {
        key: "set",
        value: function set(t) {
          for (var _i144 in t) {
            var _o53 = t[_i144];
            e.endsWith(_i144, "-transition") ? this._transitionable.setTransition(_i144.slice(0, -"-transition".length), _o53) : this._transitionable.setValue(_i144, _o53);
          }
        }
      }, {
        key: "updateTransitions",
        value: function updateTransitions(e) {
          this._transitioning = this._transitionable.transitioned(e, this._transitioning);
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return this._transitioning.hasTransition();
        }
      }, {
        key: "recalculate",
        value: function recalculate(e) {
          this.properties = this._transitioning.possiblyEvaluate(e);
        }
      }]);

      return p;
    }(e.Evented);

    var f = /*#__PURE__*/function () {
      function f(e, t) {
        _classCallCheck(this, f);

        this.width = e, this.height = t, this.nextRow = 0, this.data = new Uint8Array(this.width * this.height), this.dashEntry = {};
      }

      _createClass(f, [{
        key: "getDash",
        value: function getDash(e, t) {
          var i = e.join(",") + String(t);
          return this.dashEntry[i] || (this.dashEntry[i] = this.addDash(e, t)), this.dashEntry[i];
        }
      }, {
        key: "getDashRanges",
        value: function getDashRanges(e, t, i) {
          var o = [];
          var a = e.length % 2 == 1 ? -e[e.length - 1] * i : 0,
              r = e[0] * i,
              n = !0;
          o.push({
            left: a,
            right: r,
            isDash: n,
            zeroLength: 0 === e[0]
          });
          var s = e[0];

          for (var _t241 = 1; _t241 < e.length; _t241++) {
            n = !n;
            var _l38 = e[_t241];
            a = s * i, s += _l38, r = s * i, o.push({
              left: a,
              right: r,
              isDash: n,
              zeroLength: 0 === _l38
            });
          }

          return o;
        }
      }, {
        key: "addRoundDash",
        value: function addRoundDash(e, t, i) {
          var o = t / 2;

          for (var _t242 = -i; _t242 <= i; _t242++) {
            var _a85 = this.width * (this.nextRow + i + _t242);

            var _r209 = 0,
                _n122 = e[_r209];

            for (var _s97 = 0; _s97 < this.width; _s97++) {
              _s97 / _n122.right > 1 && (_n122 = e[++_r209]);

              var _l39 = Math.abs(_s97 - _n122.left),
                  _c27 = Math.abs(_s97 - _n122.right),
                  _h16 = Math.min(_l39, _c27);

              var _u36 = void 0;

              var _d12 = _t242 / i * (o + 1);

              if (_n122.isDash) {
                var _e220 = o - Math.abs(_d12);

                _u36 = Math.sqrt(_h16 * _h16 + _e220 * _e220);
              } else _u36 = o - Math.sqrt(_h16 * _h16 + _d12 * _d12);

              this.data[_a85 + _s97] = Math.max(0, Math.min(255, _u36 + 128));
            }
          }
        }
      }, {
        key: "addRegularDash",
        value: function addRegularDash(e) {
          for (var _t243 = e.length - 1; _t243 >= 0; --_t243) {
            var _i145 = e[_t243],
                _o54 = e[_t243 + 1];
            _i145.zeroLength ? e.splice(_t243, 1) : _o54 && _o54.isDash === _i145.isDash && (_o54.left = _i145.left, e.splice(_t243, 1));
          }

          var t = e[0],
              i = e[e.length - 1];
          t.isDash === i.isDash && (t.left = i.left - this.width, i.right = t.right + this.width);
          var o = this.width * this.nextRow;
          var a = 0,
              r = e[a];

          for (var _t244 = 0; _t244 < this.width; _t244++) {
            _t244 / r.right > 1 && (r = e[++a]);

            var _i146 = Math.abs(_t244 - r.left),
                _n123 = Math.abs(_t244 - r.right),
                _s98 = Math.min(_i146, _n123);

            this.data[o + _t244] = Math.max(0, Math.min(255, (r.isDash ? _s98 : -_s98) + 128));
          }
        }
      }, {
        key: "addDash",
        value: function addDash(t, i) {
          var o = i ? 7 : 0,
              a = 2 * o + 1;
          if (this.nextRow + a > this.height) return e.warnOnce("LineAtlas out of space"), null;
          0 === t.length && t.push(1);
          var r = 0;

          for (var _i147 = 0; _i147 < t.length; _i147++) {
            t[_i147] < 0 && (e.warnOnce("Negative value is found in line dasharray, replacing values with 0"), t[_i147] = 0), r += t[_i147];
          }

          if (0 !== r) {
            var _e221 = this.width / r,
                _a86 = this.getDashRanges(t, this.width, _e221);

            i ? this.addRoundDash(_a86, _e221, o) : this.addRegularDash(_a86);
          }

          var n = {
            y: (this.nextRow + o + .5) / this.height,
            height: 2 * o / this.height,
            width: r
          };
          return this.nextRow += a, this.dirty = !0, n;
        }
      }, {
        key: "bind",
        value: function bind(e) {
          var t = e.gl;
          this.texture ? (t.bindTexture(t.TEXTURE_2D, this.texture), this.dirty && (this.dirty = !1, t.texSubImage2D(t.TEXTURE_2D, 0, 0, 0, this.width, this.height, t.ALPHA, t.UNSIGNED_BYTE, this.data))) : (this.texture = t.createTexture(), t.bindTexture(t.TEXTURE_2D, this.texture), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, t.REPEAT), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, t.REPEAT), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, t.LINEAR), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, t.LINEAR), t.texImage2D(t.TEXTURE_2D, 0, t.ALPHA, this.width, this.height, 0, t.ALPHA, t.UNSIGNED_BYTE, this.data));
        }
      }]);

      return f;
    }();

    var g = /*#__PURE__*/function () {
      function g(t, i) {
        var _this63 = this;

        _classCallCheck(this, g);

        this.workerPool = t, this.actors = [], this.currentActor = 0, this.id = e.uniqueId();
        var o = this.workerPool.acquire(this.id);

        for (var _e222 = 0; _e222 < o.length; _e222++) {
          var _t245 = new g.Actor(o[_e222], i, this.id);

          _t245.name = "Worker ".concat(_e222), this.actors.push(_t245);
        }

        this.ready = !1, this.broadcast("checkIfReady", null, function () {
          _this63.ready = !0;
        });
      }

      _createClass(g, [{
        key: "broadcast",
        value: function broadcast(t, i, o) {
          e.asyncAll(this.actors, function (e, o) {
            e.send(t, i, o);
          }, o = o || function () {});
        }
      }, {
        key: "getActor",
        value: function getActor() {
          return this.currentActor = (this.currentActor + 1) % this.actors.length, this.actors[this.currentActor];
        }
      }, {
        key: "remove",
        value: function remove() {
          this.actors.forEach(function (e) {
            e.remove();
          }), this.actors = [], this.workerPool.release(this.id);
        }
      }]);

      return g;
    }();

    function v(t, i, o) {
      return i * (e.EXTENT / (t.tileSize * Math.pow(2, o - t.tileID.overscaledZ)));
    }

    g.Actor = e.Actor;

    var x = /*#__PURE__*/function () {
      function x(e, t, i, o) {
        _classCallCheck(this, x);

        this.screenBounds = e, this.cameraPoint = t, this._screenRaycastCache = {}, this._cameraRaycastCache = {}, this.isAboveHorizon = i, this.screenGeometry = this.bufferedScreenGeometry(0), this.screenGeometryMercator = this.screenGeometry.map(function (e) {
          return o.pointCoordinate3D(e);
        }), this.cameraGeometry = this.bufferedCameraGeometry(0);
      }

      _createClass(x, [{
        key: "isPointQuery",
        value: function isPointQuery() {
          return 1 === this.screenBounds.length;
        }
      }, {
        key: "bufferedScreenGeometry",
        value: function bufferedScreenGeometry(t) {
          return e.polygonizeBounds(this.screenBounds[0], 1 === this.screenBounds.length ? this.screenBounds[0] : this.screenBounds[1], t);
        }
      }, {
        key: "bufferedCameraGeometry",
        value: function bufferedCameraGeometry(t) {
          var i = this.screenBounds[0],
              o = 1 === this.screenBounds.length ? this.screenBounds[0].add(new e.Point(1, 1)) : this.screenBounds[1],
              a = e.polygonizeBounds(i, o, 0, !1);
          return this.cameraPoint.y > o.y && (this.cameraPoint.x > i.x && this.cameraPoint.x < o.x ? a.splice(3, 0, this.cameraPoint) : this.cameraPoint.x >= o.x ? a[2] = this.cameraPoint : this.cameraPoint.x <= i.x && (a[3] = this.cameraPoint)), e.bufferConvexPolygon(a, t);
        }
      }, {
        key: "containsTile",
        value: function containsTile(t, i, o) {
          var a = t.queryPadding + 1,
              r = o ? this._bufferedCameraMercator(a, i).map(function (e) {
            return t.tileID.getTilePoint(e);
          }) : this._bufferedScreenMercator(a, i).map(function (e) {
            return t.tileID.getTilePoint(e);
          }),
              n = this.screenGeometryMercator.map(function (e) {
            return t.tileID.getTileVec3(e);
          }),
              s = n.map(function (t) {
            return new e.Point(t[0], t[1]);
          }),
              l = i.getFreeCameraOptions().position || new e.MercatorCoordinate(0, 0, 0),
              c = t.tileID.getTileVec3(l),
              h = n.map(function (t) {
            var i = e.sub(t, t, c);
            return e.normalize(i, i), new e.Ray(c, i);
          }),
              u = v(t, 1, i.zoom);
          if (e.polygonIntersectsBox(r, 0, 0, e.EXTENT, e.EXTENT)) return {
            queryGeometry: this,
            tilespaceGeometry: s,
            tilespaceRays: h,
            bufferedTilespaceGeometry: r,
            bufferedTilespaceBounds: (d = e.getBounds(r), d.min.x = e.clamp(d.min.x, 0, e.EXTENT), d.min.y = e.clamp(d.min.y, 0, e.EXTENT), d.max.x = e.clamp(d.max.x, 0, e.EXTENT), d.max.y = e.clamp(d.max.y, 0, e.EXTENT), d),
            tile: t,
            tileID: t.tileID,
            pixelToTileUnitsFactor: u
          };
          var d;
        }
      }, {
        key: "_bufferedScreenMercator",
        value: function _bufferedScreenMercator(e, t) {
          var i = y(e);
          if (this._screenRaycastCache[i]) return this._screenRaycastCache[i];
          {
            var _o55 = this.bufferedScreenGeometry(e).map(function (e) {
              return t.pointCoordinate3D(e);
            });

            return this._screenRaycastCache[i] = _o55, _o55;
          }
        }
      }, {
        key: "_bufferedCameraMercator",
        value: function _bufferedCameraMercator(e, t) {
          var i = y(e);
          if (this._cameraRaycastCache[i]) return this._cameraRaycastCache[i];
          {
            var _o56 = this.bufferedCameraGeometry(e).map(function (e) {
              return t.pointCoordinate3D(e);
            });

            return this._cameraRaycastCache[i] = _o56, _o56;
          }
        }
      }], [{
        key: "createFromScreenPoints",
        value: function createFromScreenPoints(t, i) {
          var o, a;

          if (t instanceof e.Point || "number" == typeof t[0]) {
            var _r210 = e.Point.convert(t);

            o = [e.Point.convert(t)], a = i.isPointAboveHorizon(_r210);
          } else {
            var _r211 = e.Point.convert(t[0]),
                _n124 = e.Point.convert(t[1]);

            o = [_r211, _n124], a = e.polygonizeBounds(_r211, _n124).every(function (e) {
              return i.isPointAboveHorizon(e);
            });
          }

          return new x(o, i.getCameraPoint(), a, i);
        }
      }]);

      return x;
    }();

    function y(e) {
      return 100 * e | 0;
    }

    function b(t, i, o) {
      var a = function (a, r) {
        if (a) return o(a);

        if (r) {
          var _a87 = e.pick(e.extend(r, t), ["tiles", "minzoom", "maxzoom", "attribution", "mapbox_logo", "bounds", "scheme", "tileSize", "encoding"]);

          r.vector_layers && (_a87.vectorLayers = r.vector_layers, _a87.vectorLayerIds = _a87.vectorLayers.map(function (e) {
            return e.id;
          })), _a87.tiles = i.canonicalizeTileset(_a87, t.url), o(null, _a87);
        }
      };

      return t.url ? e.getJSON(i.transformRequest(i.normalizeSourceURL(t.url), e.ResourceType.Source), a) : e.browser.frame(function () {
        return a(null, t);
      });
    }

    var w = /*#__PURE__*/function () {
      function w(t, i, o) {
        _classCallCheck(this, w);

        this.bounds = e.LngLatBounds.convert(this.validateBounds(t)), this.minzoom = i || 0, this.maxzoom = o || 24;
      }

      _createClass(w, [{
        key: "validateBounds",
        value: function validateBounds(e) {
          return Array.isArray(e) && 4 === e.length ? [Math.max(-180, e[0]), Math.max(-90, e[1]), Math.min(180, e[2]), Math.min(90, e[3])] : [-180, -90, 180, 90];
        }
      }, {
        key: "contains",
        value: function contains(t) {
          var i = Math.pow(2, t.z),
              o = Math.floor(e.mercatorXfromLng(this.bounds.getWest()) * i),
              a = Math.floor(e.mercatorYfromLat(this.bounds.getNorth()) * i),
              r = Math.ceil(e.mercatorXfromLng(this.bounds.getEast()) * i),
              n = Math.ceil(e.mercatorYfromLat(this.bounds.getSouth()) * i);
          return t.x >= o && t.x < r && t.y >= a && t.y < n;
        }
      }]);

      return w;
    }();

    var T = /*#__PURE__*/function (_e$Evented4) {
      _inherits(T, _e$Evented4);

      var _super105 = _createSuper(T);

      function T(t, i, o, a) {
        var _this64;

        _classCallCheck(this, T);

        _this64 = _super105.call(this), _this64.id = t, _this64.dispatcher = o, _this64.setEventedParent(a), _this64.type = "raster", _this64.minzoom = 0, _this64.maxzoom = 22, _this64.roundZoom = !0, _this64.scheme = "xyz", _this64.tileSize = 512, _this64._loaded = !1, _this64._options = e.extend({
          type: "raster"
        }, i), e.extend(_assertThisInitialized(_this64), e.pick(i, ["url", "scheme", "tileSize"]));
        return _this64;
      }

      _createClass(T, [{
        key: "load",
        value: function load() {
          var _this65 = this;

          this._loaded = !1, this.fire(new e.Event("dataloading", {
            dataType: "source"
          })), this._tileJSONRequest = b(this._options, this.map._requestManager, function (t, i) {
            _this65._tileJSONRequest = null, _this65._loaded = !0, t ? _this65.fire(new e.ErrorEvent(t)) : i && (e.extend(_this65, i), i.bounds && (_this65.tileBounds = new w(i.bounds, _this65.minzoom, _this65.maxzoom)), e.postTurnstileEvent(i.tiles), _this65.fire(new e.Event("data", {
              dataType: "source",
              sourceDataType: "metadata"
            })), _this65.fire(new e.Event("data", {
              dataType: "source",
              sourceDataType: "content"
            })));
          });
        }
      }, {
        key: "loaded",
        value: function loaded() {
          return this._loaded;
        }
      }, {
        key: "onAdd",
        value: function onAdd(e) {
          this.map = e, this.load();
        }
      }, {
        key: "onRemove",
        value: function onRemove() {
          this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return e.extend({}, this._options);
        }
      }, {
        key: "hasTile",
        value: function hasTile(e) {
          return !this.tileBounds || this.tileBounds.contains(e.canonical);
        }
      }, {
        key: "loadTile",
        value: function loadTile(t, i) {
          var _this66 = this;

          var o = e.browser.devicePixelRatio >= 2,
              a = this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles, this.scheme), o, this.tileSize);

          t.request = e.getImage(this.map._requestManager.transformRequest(a, e.ResourceType.Tile), function (o, a) {
            if (delete t.request, t.aborted) t.state = "unloaded", i(null);else if (o) t.state = "errored", i(o);else if (a) {
              _this66.map._refreshExpiredTiles && t.setExpiryData(a), delete a.cacheControl, delete a.expires;
              var _o57 = _this66.map.painter.context,
                  _r212 = _o57.gl;
              t.texture = _this66.map.painter.getTileTexture(a.width), t.texture ? t.texture.update(a, {
                useMipmap: !0
              }) : (t.texture = new e.Texture(_o57, a, _r212.RGBA, {
                useMipmap: !0
              }), t.texture.bind(_r212.LINEAR, _r212.CLAMP_TO_EDGE, _r212.LINEAR_MIPMAP_NEAREST), _o57.extTextureFilterAnisotropic && _r212.texParameterf(_r212.TEXTURE_2D, _o57.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, _o57.extTextureFilterAnisotropicMax)), t.state = "loaded", e.cacheEntryPossiblyAdded(_this66.dispatcher), i(null);
            }
          });
        }
      }, {
        key: "abortTile",
        value: function abortTile(e, t) {
          e.request && (e.request.cancel(), delete e.request), t();
        }
      }, {
        key: "unloadTile",
        value: function unloadTile(e, t) {
          e.texture && this.map.painter.saveTileTexture(e.texture), t();
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return !1;
        }
      }]);

      return T;
    }(e.Evented);

    var E = e.createLayout([{
      name: "a_pos",
      type: "Int16",
      components: 2
    }, {
      name: "a_texture_pos",
      type: "Int16",
      components: 2
    }]);

    var C = /*#__PURE__*/function (_e$Evented5) {
      _inherits(C, _e$Evented5);

      var _super106 = _createSuper(C);

      function C(e, t, i, o) {
        var _this67;

        _classCallCheck(this, C);

        _this67 = _super106.call(this), _this67.id = e, _this67.dispatcher = i, _this67.coordinates = t.coordinates, _this67.type = "image", _this67.minzoom = 0, _this67.maxzoom = 22, _this67.tileSize = 512, _this67.tiles = {}, _this67._loaded = !1, _this67.setEventedParent(o), _this67.options = t;
        return _this67;
      }

      _createClass(C, [{
        key: "load",
        value: function load(t, i) {
          var _this68 = this;

          this._loaded = !1, this.fire(new e.Event("dataloading", {
            dataType: "source"
          })), this.url = this.options.url, e.getImage(this.map._requestManager.transformRequest(this.url, e.ResourceType.Image), function (o, a) {
            _this68._loaded = !0, o ? _this68.fire(new e.ErrorEvent(o)) : a && (_this68.image = a, t && (_this68.coordinates = t), i && i(), _this68._finishLoading());
          });
        }
      }, {
        key: "loaded",
        value: function loaded() {
          return this._loaded;
        }
      }, {
        key: "updateImage",
        value: function updateImage(e) {
          var _this69 = this;

          return this.image && e.url ? (this.options.url = e.url, this.load(e.coordinates, function () {
            _this69.texture = null;
          }), this) : this;
        }
      }, {
        key: "_finishLoading",
        value: function _finishLoading() {
          this.map && (this.setCoordinates(this.coordinates), this.fire(new e.Event("data", {
            dataType: "source",
            sourceDataType: "metadata"
          })));
        }
      }, {
        key: "onAdd",
        value: function onAdd(e) {
          this.map = e, this.load();
        }
      }, {
        key: "setCoordinates",
        value: function setCoordinates(t) {
          var _this70 = this;

          this.coordinates = t;
          var i = t.map(e.MercatorCoordinate.fromLngLat);
          this.tileID = function (t) {
            var i = 1 / 0,
                o = 1 / 0,
                a = -1 / 0,
                r = -1 / 0;

            for (var _e223 of t) {
              i = Math.min(i, _e223.x), o = Math.min(o, _e223.y), a = Math.max(a, _e223.x), r = Math.max(r, _e223.y);
            }

            var n = Math.max(a - i, r - o),
                s = Math.max(0, Math.floor(-Math.log(n) / Math.LN2)),
                l = Math.pow(2, s);
            return new e.CanonicalTileID(s, Math.floor((i + a) / 2 * l), Math.floor((o + r) / 2 * l));
          }(i), this.minzoom = this.maxzoom = this.tileID.z;
          var o = i.map(function (e) {
            return _this70.tileID.getTilePoint(e)._round();
          });
          return this._boundsArray = new e.StructArrayLayout4i8(), this._boundsArray.emplaceBack(o[0].x, o[0].y, 0, 0), this._boundsArray.emplaceBack(o[1].x, o[1].y, e.EXTENT, 0), this._boundsArray.emplaceBack(o[3].x, o[3].y, 0, e.EXTENT), this._boundsArray.emplaceBack(o[2].x, o[2].y, e.EXTENT, e.EXTENT), this.boundsBuffer && (this.boundsBuffer.destroy(), delete this.boundsBuffer), this.fire(new e.Event("data", {
            dataType: "source",
            sourceDataType: "content"
          })), this;
        }
      }, {
        key: "prepare",
        value: function prepare() {
          if (0 === Object.keys(this.tiles).length || !this.image) return;
          var t = this.map.painter.context,
              i = t.gl;
          this.boundsBuffer || (this.boundsBuffer = t.createVertexBuffer(this._boundsArray, E.members)), this.boundsSegments || (this.boundsSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture || (this.texture = new e.Texture(t, this.image, i.RGBA), this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE));

          for (var _e224 in this.tiles) {
            var _t246 = this.tiles[_e224];
            "loaded" !== _t246.state && (_t246.state = "loaded", _t246.texture = this.texture);
          }
        }
      }, {
        key: "loadTile",
        value: function loadTile(e, t) {
          this.tileID && this.tileID.equals(e.tileID.canonical) ? (this.tiles[String(e.tileID.wrap)] = e, e.buckets = {}, t(null)) : (e.state = "errored", t(null));
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return {
            type: "image",
            url: this.options.url,
            coordinates: this.coordinates
          };
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return !1;
        }
      }]);

      return C;
    }(e.Evented);

    var S = {
      vector: /*#__PURE__*/function (_e$Evented6) {
        _inherits(vector, _e$Evented6);

        var _super107 = _createSuper(vector);

        function vector(t, i, o, a) {
          var _this71;

          _classCallCheck(this, vector);

          if (_this71 = _super107.call(this), _this71.id = t, _this71.dispatcher = o, _this71.type = "vector", _this71.minzoom = 0, _this71.maxzoom = 22, _this71.scheme = "xyz", _this71.tileSize = 512, _this71.reparseOverscaled = !0, _this71.isTileClipped = !0, _this71._loaded = !1, e.extend(_assertThisInitialized(_this71), e.pick(i, ["url", "scheme", "tileSize", "promoteId"])), _this71._options = e.extend({
            type: "vector"
          }, i), _this71._collectResourceTiming = i.collectResourceTiming, 512 !== _this71.tileSize) throw new Error("vector tile sources must have a tileSize of 512");
          _this71.setEventedParent(a), _this71._tileWorkers = {}, _this71._deduped = new e.DedupedRequest();
          return _possibleConstructorReturn(_this71);
        }

        _createClass(vector, [{
          key: "load",
          value: function load() {
            var _this72 = this;

            this._loaded = !1, this.fire(new e.Event("dataloading", {
              dataType: "source"
            })), this._tileJSONRequest = b(this._options, this.map._requestManager, function (t, i) {
              _this72._tileJSONRequest = null, _this72._loaded = !0, t ? _this72.fire(new e.ErrorEvent(t)) : i && (e.extend(_this72, i), i.bounds && (_this72.tileBounds = new w(i.bounds, _this72.minzoom, _this72.maxzoom)), e.postTurnstileEvent(i.tiles, _this72.map._requestManager._customAccessToken), _this72.fire(new e.Event("data", {
                dataType: "source",
                sourceDataType: "metadata"
              })), _this72.fire(new e.Event("data", {
                dataType: "source",
                sourceDataType: "content"
              })));
            });
          }
        }, {
          key: "loaded",
          value: function loaded() {
            return this._loaded;
          }
        }, {
          key: "hasTile",
          value: function hasTile(e) {
            return !this.tileBounds || this.tileBounds.contains(e.canonical);
          }
        }, {
          key: "onAdd",
          value: function onAdd(e) {
            this.map = e, this.load();
          }
        }, {
          key: "setSourceProperty",
          value: function setSourceProperty(e) {
            this._tileJSONRequest && this._tileJSONRequest.cancel(), e();

            var t = this.map.style._getSourceCaches(this.id);

            for (var _e225 of t) {
              _e225.clearTiles();
            }

            this.load();
          }
        }, {
          key: "setTiles",
          value: function setTiles(e) {
            var _this73 = this;

            return this.setSourceProperty(function () {
              _this73._options.tiles = e;
            }), this;
          }
        }, {
          key: "setUrl",
          value: function setUrl(e) {
            var _this74 = this;

            return this.setSourceProperty(function () {
              _this74.url = e, _this74._options.url = e;
            }), this;
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);
          }
        }, {
          key: "serialize",
          value: function serialize() {
            return e.extend({}, this._options);
          }
        }, {
          key: "loadTile",
          value: function loadTile(t, i) {
            var _this75 = this;

            var o = this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles, this.scheme)),
                a = {
              request: this.map._requestManager.transformRequest(o, e.ResourceType.Tile),
              data: void 0,
              uid: t.uid,
              tileID: t.tileID,
              tileZoom: t.tileZoom,
              zoom: t.tileID.overscaledZ,
              tileSize: this.tileSize * t.tileID.overscaleFactor(),
              type: this.type,
              source: this.id,
              pixelRatio: e.browser.devicePixelRatio,
              showCollisionBoxes: this.map.showCollisionBoxes,
              promoteId: this.promoteId,
              isSymbolTile: t.isSymbolTile
            };

            if (a.request.collectResourceTiming = this._collectResourceTiming, t.actor && "expired" !== t.state) "loading" === t.state ? t.reloadCallback = i : t.request = t.actor.send("reloadTile", a, r.bind(this));else if (t.actor = this._tileWorkers[o] = this._tileWorkers[o] || this.dispatcher.getActor(), this.dispatcher.ready) t.request = t.actor.send("loadTile", a, r.bind(this));else {
              var _i148 = e.loadVectorTile.call({
                deduped: this._deduped
              }, a, function (e, i) {
                e || !i ? r.call(_this75, e) : (a.data = {
                  cacheControl: i.cacheControl,
                  expires: i.expires,
                  rawData: i.rawData.slice(0)
                }, t.actor && t.actor.send("loadTile", a, r.bind(_this75)));
              }, !0);

              t.request = {
                cancel: _i148
              };
            }

            function r(o, a) {
              return delete t.request, t.aborted ? i(null) : o && 404 !== o.status ? i(o) : (a && a.resourceTiming && (t.resourceTiming = a.resourceTiming), this.map._refreshExpiredTiles && a && t.setExpiryData(a), t.loadVectorData(a, this.map.painter), e.cacheEntryPossiblyAdded(this.dispatcher), i(null), void (t.reloadCallback && (this.loadTile(t, t.reloadCallback), t.reloadCallback = null)));
            }
          }
        }, {
          key: "abortTile",
          value: function abortTile(e) {
            e.request && (e.request.cancel(), delete e.request), e.actor && e.actor.send("abortTile", {
              uid: e.uid,
              type: this.type,
              source: this.id
            }, void 0);
          }
        }, {
          key: "unloadTile",
          value: function unloadTile(e) {
            e.unloadVectorData(), e.actor && e.actor.send("removeTile", {
              uid: e.uid,
              type: this.type,
              source: this.id
            }, void 0);
          }
        }, {
          key: "hasTransition",
          value: function hasTransition() {
            return !1;
          }
        }, {
          key: "afterUpdate",
          value: function afterUpdate() {
            this._tileWorkers = {};
          }
        }]);

        return vector;
      }(e.Evented),
      raster: T,
      "raster-dem": /*#__PURE__*/function (_T3) {
        _inherits(rasterDem, _T3);

        var _super108 = _createSuper(rasterDem);

        function rasterDem(t, i, o, a) {
          var _this76;

          _classCallCheck(this, rasterDem);

          _this76 = _super108.call(this, t, i, o, a), _this76.type = "raster-dem", _this76.maxzoom = 22, _this76._options = e.extend({
            type: "raster-dem"
          }, i), _this76.encoding = i.encoding || "mapbox";
          return _this76;
        }

        _createClass(rasterDem, [{
          key: "serialize",
          value: function serialize() {
            return {
              type: "raster-dem",
              url: this.url,
              tileSize: this.tileSize,
              tiles: this.tiles,
              bounds: this.bounds,
              encoding: this.encoding
            };
          }
        }, {
          key: "loadTile",
          value: function loadTile(t, i) {
            var o = this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles, this.scheme), !1, this.tileSize);

            function a(e, o) {
              e && (t.state = "errored", i(e)), o && (t.dem = o, t.dem.onDeserialize(), t.needsHillshadePrepare = !0, t.needsDEMTextureUpload = !0, t.state = "loaded", i(null));
            }

            t.request = e.getImage(this.map._requestManager.transformRequest(o, e.ResourceType.Tile), function (o, r) {
              if (delete t.request, t.aborted) t.state = "unloaded", i(null);else if (o) t.state = "errored", i(o);else if (r) {
                this.map._refreshExpiredTiles && t.setExpiryData(r), delete r.cacheControl, delete r.expires;

                var _i149 = e.window.ImageBitmap && r instanceof e.window.ImageBitmap && e.offscreenCanvasSupported(),
                    _o58 = 1 - (r.width - e.prevPowerOfTwo(r.width)) / 2;

                _o58 < 1 || t.neighboringTiles || (t.neighboringTiles = this._getNeighboringTiles(t.tileID));

                var _n125 = _i149 ? r : e.browser.getImageData(r, _o58),
                    _s99 = {
                  uid: t.uid,
                  coord: t.tileID,
                  source: this.id,
                  rawImageData: _n125,
                  encoding: this.encoding,
                  padding: _o58
                };

                t.actor && "expired" !== t.state || (t.actor = this.dispatcher.getActor(), t.actor.send("loadDEMTile", _s99, a.bind(this)));
              }
            }.bind(this));
          }
        }, {
          key: "_getNeighboringTiles",
          value: function _getNeighboringTiles(t) {
            var i = t.canonical,
                o = Math.pow(2, i.z),
                a = (i.x - 1 + o) % o,
                r = 0 === i.x ? t.wrap - 1 : t.wrap,
                n = (i.x + 1 + o) % o,
                s = i.x + 1 === o ? t.wrap + 1 : t.wrap,
                l = {};
            return l[new e.OverscaledTileID(t.overscaledZ, r, i.z, a, i.y).key] = {
              backfilled: !1
            }, l[new e.OverscaledTileID(t.overscaledZ, s, i.z, n, i.y).key] = {
              backfilled: !1
            }, i.y > 0 && (l[new e.OverscaledTileID(t.overscaledZ, r, i.z, a, i.y - 1).key] = {
              backfilled: !1
            }, l[new e.OverscaledTileID(t.overscaledZ, t.wrap, i.z, i.x, i.y - 1).key] = {
              backfilled: !1
            }, l[new e.OverscaledTileID(t.overscaledZ, s, i.z, n, i.y - 1).key] = {
              backfilled: !1
            }), i.y + 1 < o && (l[new e.OverscaledTileID(t.overscaledZ, r, i.z, a, i.y + 1).key] = {
              backfilled: !1
            }, l[new e.OverscaledTileID(t.overscaledZ, t.wrap, i.z, i.x, i.y + 1).key] = {
              backfilled: !1
            }, l[new e.OverscaledTileID(t.overscaledZ, s, i.z, n, i.y + 1).key] = {
              backfilled: !1
            }), l;
          }
        }, {
          key: "unloadTile",
          value: function unloadTile(e) {
            e.demTexture && this.map.painter.saveTileTexture(e.demTexture), e.fbo && (e.fbo.destroy(), delete e.fbo), e.dem && delete e.dem, delete e.neighboringTiles, e.state = "unloaded";
          }
        }]);

        return rasterDem;
      }(T),
      geojson: /*#__PURE__*/function (_e$Evented7) {
        _inherits(geojson, _e$Evented7);

        var _super109 = _createSuper(geojson);

        function geojson(t, i, o, a) {
          var _this77;

          _classCallCheck(this, geojson);

          _this77 = _super109.call(this), _this77.id = t, _this77.type = "geojson", _this77.minzoom = 0, _this77.maxzoom = 18, _this77.tileSize = 512, _this77.isTileClipped = !0, _this77.reparseOverscaled = !0, _this77._removed = !1, _this77._loaded = !1, _this77.actor = o.getActor(), _this77.setEventedParent(a), _this77._data = i.data, _this77._options = e.extend({}, i), _this77._collectResourceTiming = i.collectResourceTiming, _this77._resourceTiming = [], void 0 !== i.maxzoom && (_this77.maxzoom = i.maxzoom), i.type && (_this77.type = i.type), i.attribution && (_this77.attribution = i.attribution), _this77.promoteId = i.promoteId;
          var r = e.EXTENT / _this77.tileSize;
          _this77.workerOptions = e.extend({
            source: _this77.id,
            cluster: i.cluster || !1,
            geojsonVtOptions: {
              buffer: (void 0 !== i.buffer ? i.buffer : 128) * r,
              tolerance: (void 0 !== i.tolerance ? i.tolerance : .375) * r,
              extent: e.EXTENT,
              maxZoom: _this77.maxzoom,
              lineMetrics: i.lineMetrics || !1,
              generateId: i.generateId || !1
            },
            superclusterOptions: {
              maxZoom: void 0 !== i.clusterMaxZoom ? i.clusterMaxZoom : _this77.maxzoom - 1,
              minPoints: Math.max(2, i.clusterMinPoints || 2),
              extent: e.EXTENT,
              radius: (i.clusterRadius || 50) * r,
              log: !1,
              generateId: i.generateId || !1
            },
            clusterProperties: i.clusterProperties,
            filter: i.filter
          }, i.workerOptions);
          return _this77;
        }

        _createClass(geojson, [{
          key: "load",
          value: function load() {
            var _this78 = this;

            this.fire(new e.Event("dataloading", {
              dataType: "source"
            })), this._updateWorkerData(function (t) {
              if (t) return void _this78.fire(new e.ErrorEvent(t));
              var i = {
                dataType: "source",
                sourceDataType: "metadata"
              };
              _this78._collectResourceTiming && _this78._resourceTiming && _this78._resourceTiming.length > 0 && (i.resourceTiming = _this78._resourceTiming, _this78._resourceTiming = []), _this78.fire(new e.Event("data", i));
            });
          }
        }, {
          key: "onAdd",
          value: function onAdd(e) {
            this.map = e, this.load();
          }
        }, {
          key: "setData",
          value: function setData(t) {
            var _this79 = this;

            return this._data = t, this.fire(new e.Event("dataloading", {
              dataType: "source"
            })), this._updateWorkerData(function (t) {
              if (t) return void _this79.fire(new e.ErrorEvent(t));
              var i = {
                dataType: "source",
                sourceDataType: "content"
              };
              _this79._collectResourceTiming && _this79._resourceTiming && _this79._resourceTiming.length > 0 && (i.resourceTiming = _this79._resourceTiming, _this79._resourceTiming = []), _this79.fire(new e.Event("data", i));
            }), this;
          }
        }, {
          key: "getClusterExpansionZoom",
          value: function getClusterExpansionZoom(e, t) {
            return this.actor.send("geojson.getClusterExpansionZoom", {
              clusterId: e,
              source: this.id
            }, t), this;
          }
        }, {
          key: "getClusterChildren",
          value: function getClusterChildren(e, t) {
            return this.actor.send("geojson.getClusterChildren", {
              clusterId: e,
              source: this.id
            }, t), this;
          }
        }, {
          key: "getClusterLeaves",
          value: function getClusterLeaves(e, t, i, o) {
            return this.actor.send("geojson.getClusterLeaves", {
              source: this.id,
              clusterId: e,
              limit: t,
              offset: i
            }, o), this;
          }
        }, {
          key: "_updateWorkerData",
          value: function _updateWorkerData(t) {
            var _this80 = this;

            this._loaded = !1;
            var i = e.extend({}, this.workerOptions),
                o = this._data;
            "string" == typeof o ? (i.request = this.map._requestManager.transformRequest(e.browser.resolveURL(o), e.ResourceType.Source), i.request.collectResourceTiming = this._collectResourceTiming) : i.data = JSON.stringify(o), this.actor.send("".concat(this.type, ".loadData"), i, function (e, o) {
              _this80._removed || o && o.abandoned || (_this80._loaded = !0, o && o.resourceTiming && o.resourceTiming[_this80.id] && (_this80._resourceTiming = o.resourceTiming[_this80.id].slice(0)), _this80.actor.send("".concat(_this80.type, ".coalesce"), {
                source: i.source
              }, null), t(e));
            });
          }
        }, {
          key: "loaded",
          value: function loaded() {
            return this._loaded;
          }
        }, {
          key: "loadTile",
          value: function loadTile(t, i) {
            var _this81 = this;

            var o = t.actor ? "reloadTile" : "loadTile";
            t.actor = this.actor, t.request = this.actor.send(o, {
              type: this.type,
              uid: t.uid,
              tileID: t.tileID,
              tileZoom: t.tileZoom,
              zoom: t.tileID.overscaledZ,
              maxZoom: this.maxzoom,
              tileSize: this.tileSize,
              source: this.id,
              pixelRatio: e.browser.devicePixelRatio,
              showCollisionBoxes: this.map.showCollisionBoxes,
              promoteId: this.promoteId
            }, function (e, a) {
              return delete t.request, t.unloadVectorData(), t.aborted ? i(null) : e ? i(e) : (t.loadVectorData(a, _this81.map.painter, "reloadTile" === o), i(null));
            });
          }
        }, {
          key: "abortTile",
          value: function abortTile(e) {
            e.request && (e.request.cancel(), delete e.request), e.aborted = !0;
          }
        }, {
          key: "unloadTile",
          value: function unloadTile(e) {
            e.unloadVectorData(), this.actor.send("removeTile", {
              uid: e.uid,
              type: this.type,
              source: this.id
            });
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            this._removed = !0, this.actor.send("removeSource", {
              type: this.type,
              source: this.id
            });
          }
        }, {
          key: "serialize",
          value: function serialize() {
            return e.extend({}, this._options, {
              type: this.type,
              data: this._data
            });
          }
        }, {
          key: "hasTransition",
          value: function hasTransition() {
            return !1;
          }
        }]);

        return geojson;
      }(e.Evented),
      video: /*#__PURE__*/function (_C) {
        _inherits(video, _C);

        var _super110 = _createSuper(video);

        function video(e, t, i, o) {
          var _this82;

          _classCallCheck(this, video);

          _this82 = _super110.call(this, e, t, i, o), _this82.roundZoom = !0, _this82.type = "video", _this82.options = t;
          return _this82;
        }

        _createClass(video, [{
          key: "load",
          value: function load() {
            var _this83 = this;

            this._loaded = !1;
            var t = this.options;
            this.urls = [];

            for (var _i150 of t.urls) {
              this.urls.push(this.map._requestManager.transformRequest(_i150, e.ResourceType.Source).url);
            }

            e.getVideo(this.urls, function (t, i) {
              _this83._loaded = !0, t ? _this83.fire(new e.ErrorEvent(t)) : i && (_this83.video = i, _this83.video.loop = !0, _this83.video.addEventListener("playing", function () {
                _this83.map.triggerRepaint();
              }), _this83.map && _this83.video.play(), _this83._finishLoading());
            });
          }
        }, {
          key: "pause",
          value: function pause() {
            this.video && this.video.pause();
          }
        }, {
          key: "play",
          value: function play() {
            this.video && this.video.play();
          }
        }, {
          key: "seek",
          value: function seek(t) {
            if (this.video) {
              var _i151 = this.video.seekable;
              t < _i151.start(0) || t > _i151.end(0) ? this.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(this.id), null, "Playback for this video can be set only between the ".concat(_i151.start(0), " and ").concat(_i151.end(0), "-second mark.")))) : this.video.currentTime = t;
            }
          }
        }, {
          key: "getVideo",
          value: function getVideo() {
            return this.video;
          }
        }, {
          key: "onAdd",
          value: function onAdd(e) {
            this.map || (this.map = e, this.load(), this.video && (this.video.play(), this.setCoordinates(this.coordinates)));
          }
        }, {
          key: "prepare",
          value: function prepare() {
            if (0 === Object.keys(this.tiles).length || this.video.readyState < 2) return;
            var t = this.map.painter.context,
                i = t.gl;
            this.boundsBuffer || (this.boundsBuffer = t.createVertexBuffer(this._boundsArray, E.members)), this.boundsSegments || (this.boundsSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? this.video.paused || (this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE), i.texSubImage2D(i.TEXTURE_2D, 0, 0, 0, i.RGBA, i.UNSIGNED_BYTE, this.video)) : (this.texture = new e.Texture(t, this.video, i.RGBA), this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE));

            for (var _e226 in this.tiles) {
              var _t247 = this.tiles[_e226];
              "loaded" !== _t247.state && (_t247.state = "loaded", _t247.texture = this.texture);
            }
          }
        }, {
          key: "serialize",
          value: function serialize() {
            return {
              type: "video",
              urls: this.urls,
              coordinates: this.coordinates
            };
          }
        }, {
          key: "hasTransition",
          value: function hasTransition() {
            return this.video && !this.video.paused;
          }
        }]);

        return video;
      }(C),
      image: C,
      canvas: /*#__PURE__*/function (_C2) {
        _inherits(canvas, _C2);

        var _super111 = _createSuper(canvas);

        function canvas(t, i, o, a) {
          var _this84;

          _classCallCheck(this, canvas);

          _this84 = _super111.call(this, t, i, o, a), i.coordinates ? Array.isArray(i.coordinates) && 4 === i.coordinates.length && !i.coordinates.some(function (e) {
            return !Array.isArray(e) || 2 !== e.length || e.some(function (e) {
              return "number" != typeof e;
            });
          }) || _this84.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t), null, '"coordinates" property must be an array of 4 longitude/latitude array pairs'))) : _this84.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t), null, 'missing required property "coordinates"'))), i.animate && "boolean" != typeof i.animate && _this84.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t), null, 'optional "animate" property must be a boolean value'))), i.canvas ? "string" == typeof i.canvas || i.canvas instanceof e.window.HTMLCanvasElement || _this84.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t), null, '"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))) : _this84.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t), null, 'missing required property "canvas"'))), _this84.options = i, _this84.animate = void 0 === i.animate || i.animate;
          return _this84;
        }

        _createClass(canvas, [{
          key: "load",
          value: function load() {
            this._loaded = !0, this.canvas || (this.canvas = this.options.canvas instanceof e.window.HTMLCanvasElement ? this.options.canvas : e.window.document.getElementById(this.options.canvas)), this.width = this.canvas.width, this.height = this.canvas.height, this._hasInvalidDimensions() ? this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))) : (this.play = function () {
              this._playing = !0, this.map.triggerRepaint();
            }, this.pause = function () {
              this._playing && (this.prepare(), this._playing = !1);
            }, this._finishLoading());
          }
        }, {
          key: "getCanvas",
          value: function getCanvas() {
            return this.canvas;
          }
        }, {
          key: "onAdd",
          value: function onAdd(e) {
            this.map = e, this.load(), this.canvas && this.animate && this.play();
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            this.pause();
          }
        }, {
          key: "prepare",
          value: function prepare() {
            var t = !1;
            if (this.canvas.width !== this.width && (this.width = this.canvas.width, t = !0), this.canvas.height !== this.height && (this.height = this.canvas.height, t = !0), this._hasInvalidDimensions()) return;
            if (0 === Object.keys(this.tiles).length) return;
            var i = this.map.painter.context,
                o = i.gl;
            this.boundsBuffer || (this.boundsBuffer = i.createVertexBuffer(this._boundsArray, E.members)), this.boundsSegments || (this.boundsSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? (t || this._playing) && this.texture.update(this.canvas, {
              premultiply: !0
            }) : this.texture = new e.Texture(i, this.canvas, o.RGBA, {
              premultiply: !0
            });

            for (var _e227 in this.tiles) {
              var _t248 = this.tiles[_e227];
              "loaded" !== _t248.state && (_t248.state = "loaded", _t248.texture = this.texture);
            }
          }
        }, {
          key: "serialize",
          value: function serialize() {
            return {
              type: "canvas",
              coordinates: this.coordinates
            };
          }
        }, {
          key: "hasTransition",
          value: function hasTransition() {
            return this._playing;
          }
        }, {
          key: "_hasInvalidDimensions",
          value: function _hasInvalidDimensions() {
            for (var _e228 of [this.canvas.width, this.canvas.height]) {
              if (isNaN(_e228) || _e228 <= 0) return !0;
            }

            return !1;
          }
        }]);

        return canvas;
      }(C)
    },
        I = function (t, i, o, a) {
      var r = new S[i.type](t, i, o, a);
      if (r.id !== t) throw new Error("Expected Source id to be ".concat(t, " instead of ").concat(r.id));
      return e.bindAll(["load", "abort", "unload", "serialize", "prepare"], r), r;
    };

    function P(t, i) {
      var o = e.identity([]);
      return e.scale(o, o, [.5 * t.width, .5 * -t.height, 1]), e.translate(o, o, [1, -1, 0]), e.multiply(o, o, t.calculatePosMatrix(i.toUnwrapped()));
    }

    function M(e, t, i, o, a, r, n) {
      var s = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : !1;
      var l = e.tilesIn(o, n, s);
      l.sort(A);
      var c = [];

      for (var _o59 of l) {
        c.push({
          wrappedTileID: _o59.tile.tileID.wrapped().key,
          queryResults: _o59.tile.queryRenderedFeatures(t, i, e._state, _o59, a, r, P(e.transform, _o59.tile.tileID), s)
        });
      }

      var h = function (e) {
        var t = {},
            i = {};

        for (var _o60 of e) {
          var _e229 = _o60.queryResults,
              _a88 = _o60.wrappedTileID,
              _r213 = i[_a88] = i[_a88] || {};

          for (var _i152 in _e229) {
            var _o61 = _e229[_i152],
                _a89 = _r213[_i152] = _r213[_i152] || {},
                _n126 = t[_i152] = t[_i152] || [];

            for (var _e230 of _o61) {
              _a89[_e230.featureIndex] || (_a89[_e230.featureIndex] = !0, _n126.push(_e230));
            }
          }
        }

        return t;
      }(c);

      for (var _t249 in h) {
        h[_t249].forEach(function (t) {
          var i = t.feature,
              o = e.getFeatureState(i.layer["source-layer"], i.id);
          i.source = i.layer.source, i.layer["source-layer"] && (i.sourceLayer = i.layer["source-layer"]), i.state = o;
        });
      }

      return h;
    }

    function z(e, t) {
      var i = e.getRenderableIds().map(function (t) {
        return e.getTileByID(t);
      }),
          o = [],
          a = {};

      for (var _e231 = 0; _e231 < i.length; _e231++) {
        var _r214 = i[_e231],
            _n127 = _r214.tileID.canonical.key;
        a[_n127] || (a[_n127] = !0, _r214.querySourceFeatures(o, t));
      }

      return o;
    }

    function A(e, t) {
      var i = e.tileID,
          o = t.tileID;
      return i.overscaledZ - o.overscaledZ || i.canonical.y - o.canonical.y || i.wrap - o.wrap || i.canonical.x - o.canonical.x;
    }

    function D() {
      return null != fa.workerClass ? new fa.workerClass() : new e.window.Worker(fa.workerUrl);
    }

    var L = "mapboxgl_preloaded_worker_pool";

    var R = /*#__PURE__*/function () {
      function R() {
        _classCallCheck(this, R);

        this.active = {};
      }

      _createClass(R, [{
        key: "acquire",
        value: function acquire(e) {
          if (!this.workers) for (this.workers = []; this.workers.length < R.workerCount;) {
            this.workers.push(new D());
          }
          return this.active[e] = !0, this.workers.slice();
        }
      }, {
        key: "release",
        value: function release(e) {
          delete this.active[e], 0 === this.numActive() && (this.workers.forEach(function (e) {
            e.terminate();
          }), this.workers = null);
        }
      }, {
        key: "isPreloaded",
        value: function isPreloaded() {
          return !!this.active[L];
        }
      }, {
        key: "numActive",
        value: function numActive() {
          return Object.keys(this.active).length;
        }
      }]);

      return R;
    }();

    var k;

    function B() {
      return k || (k = new R()), k;
    }

    function F(t, i) {
      var o = {};

      for (var _e232 in t) {
        "ref" !== _e232 && (o[_e232] = t[_e232]);
      }

      return e.refProperties.forEach(function (e) {
        e in i && (o[e] = i[e]);
      }), o;
    }

    function O(e) {
      e = e.slice();
      var t = Object.create(null);

      for (var _i153 = 0; _i153 < e.length; _i153++) {
        t[e[_i153].id] = e[_i153];
      }

      for (var _i154 = 0; _i154 < e.length; _i154++) {
        "ref" in e[_i154] && (e[_i154] = F(e[_i154], t[e[_i154].ref]));
      }

      return e;
    }

    R.workerCount = 2;
    var U = {
      setStyle: "setStyle",
      addLayer: "addLayer",
      removeLayer: "removeLayer",
      setPaintProperty: "setPaintProperty",
      setLayoutProperty: "setLayoutProperty",
      setFilter: "setFilter",
      addSource: "addSource",
      removeSource: "removeSource",
      setGeoJSONSourceData: "setGeoJSONSourceData",
      setLayerZoomRange: "setLayerZoomRange",
      setLayerProperty: "setLayerProperty",
      setCenter: "setCenter",
      setZoom: "setZoom",
      setBearing: "setBearing",
      setPitch: "setPitch",
      setSprite: "setSprite",
      setGlyphs: "setGlyphs",
      setTransition: "setTransition",
      setLight: "setLight",
      setTerrain: "setTerrain"
    };

    function N(e, t, i) {
      i.push({
        command: U.addSource,
        args: [e, t[e]]
      });
    }

    function Z(e, t, i) {
      t.push({
        command: U.removeSource,
        args: [e]
      }), i[e] = !0;
    }

    function G(e, t, i, o) {
      Z(e, i, o), N(e, t, i);
    }

    function V(t, i, o) {
      var a;

      for (a in t[o]) {
        if (t[o].hasOwnProperty(a) && "data" !== a && !e.deepEqual(t[o][a], i[o][a])) return !1;
      }

      for (a in i[o]) {
        if (i[o].hasOwnProperty(a) && "data" !== a && !e.deepEqual(t[o][a], i[o][a])) return !1;
      }

      return !0;
    }

    function q(t, i, o, a, r, n) {
      var s;

      for (s in i = i || {}, t = t || {}) {
        t.hasOwnProperty(s) && (e.deepEqual(t[s], i[s]) || o.push({
          command: n,
          args: [a, s, i[s], r]
        }));
      }

      for (s in i) {
        i.hasOwnProperty(s) && !t.hasOwnProperty(s) && (e.deepEqual(t[s], i[s]) || o.push({
          command: n,
          args: [a, s, i[s], r]
        }));
      }
    }

    function j(e) {
      return e.id;
    }

    function $(e, t) {
      return e[t.id] = t, e;
    }

    var X = /*#__PURE__*/function () {
      function X(e, t) {
        _classCallCheck(this, X);

        this.reset(e, t);
      }

      _createClass(X, [{
        key: "reset",
        value: function reset(e, t) {
          this.points = e || [], this._distances = [0];

          for (var _e233 = 1; _e233 < this.points.length; _e233++) {
            this._distances[_e233] = this._distances[_e233 - 1] + this.points[_e233].dist(this.points[_e233 - 1]);
          }

          this.length = this._distances[this._distances.length - 1], this.padding = Math.min(t || 0, .5 * this.length), this.paddedLength = this.length - 2 * this.padding;
        }
      }, {
        key: "lerp",
        value: function lerp(t) {
          if (1 === this.points.length) return this.points[0];
          t = e.clamp(t, 0, 1);
          var i = 1,
              o = this._distances[i];
          var a = t * this.paddedLength + this.padding;

          for (; o < a && i < this._distances.length;) {
            o = this._distances[++i];
          }

          var r = i - 1,
              n = this._distances[r],
              s = o - n,
              l = s > 0 ? (a - n) / s : 0;
          return this.points[r].mult(1 - l).add(this.points[i].mult(l));
        }
      }]);

      return X;
    }();

    var W = /*#__PURE__*/function () {
      function W(e, t, i) {
        _classCallCheck(this, W);

        var o = this.boxCells = [],
            a = this.circleCells = [];
        this.xCellCount = Math.ceil(e / i), this.yCellCount = Math.ceil(t / i);

        for (var _e234 = 0; _e234 < this.xCellCount * this.yCellCount; _e234++) {
          o.push([]), a.push([]);
        }

        this.circleKeys = [], this.boxKeys = [], this.bboxes = [], this.circles = [], this.width = e, this.height = t, this.xScale = this.xCellCount / e, this.yScale = this.yCellCount / t, this.boxUid = 0, this.circleUid = 0;
      }

      _createClass(W, [{
        key: "keysLength",
        value: function keysLength() {
          return this.boxKeys.length + this.circleKeys.length;
        }
      }, {
        key: "insert",
        value: function insert(e, t, i, o, a) {
          this._forEachCell(t, i, o, a, this._insertBoxCell, this.boxUid++), this.boxKeys.push(e), this.bboxes.push(t), this.bboxes.push(i), this.bboxes.push(o), this.bboxes.push(a);
        }
      }, {
        key: "insertCircle",
        value: function insertCircle(e, t, i, o) {
          this._forEachCell(t - o, i - o, t + o, i + o, this._insertCircleCell, this.circleUid++), this.circleKeys.push(e), this.circles.push(t), this.circles.push(i), this.circles.push(o);
        }
      }, {
        key: "_insertBoxCell",
        value: function _insertBoxCell(e, t, i, o, a, r) {
          this.boxCells[a].push(r);
        }
      }, {
        key: "_insertCircleCell",
        value: function _insertCircleCell(e, t, i, o, a, r) {
          this.circleCells[a].push(r);
        }
      }, {
        key: "_query",
        value: function _query(e, t, i, o, a, r) {
          if (i < 0 || e > this.width || o < 0 || t > this.height) return !a && [];
          var n = [];

          if (e <= 0 && t <= 0 && this.width <= i && this.height <= o) {
            if (a) return !0;

            for (var _e235 = 0; _e235 < this.boxKeys.length; _e235++) {
              n.push({
                key: this.boxKeys[_e235],
                x1: this.bboxes[4 * _e235],
                y1: this.bboxes[4 * _e235 + 1],
                x2: this.bboxes[4 * _e235 + 2],
                y2: this.bboxes[4 * _e235 + 3]
              });
            }

            for (var _e236 = 0; _e236 < this.circleKeys.length; _e236++) {
              var _t250 = this.circles[3 * _e236],
                  _i155 = this.circles[3 * _e236 + 1],
                  _o62 = this.circles[3 * _e236 + 2];
              n.push({
                key: this.circleKeys[_e236],
                x1: _t250 - _o62,
                y1: _i155 - _o62,
                x2: _t250 + _o62,
                y2: _i155 + _o62
              });
            }

            return r ? n.filter(r) : n;
          }

          return this._forEachCell(e, t, i, o, this._queryCell, n, {
            hitTest: a,
            seenUids: {
              box: {},
              circle: {}
            }
          }, r), a ? n.length > 0 : n;
        }
      }, {
        key: "_queryCircle",
        value: function _queryCircle(e, t, i, o, a) {
          var r = e - i,
              n = e + i,
              s = t - i,
              l = t + i;
          if (n < 0 || r > this.width || l < 0 || s > this.height) return !o && [];
          var c = [];
          return this._forEachCell(r, s, n, l, this._queryCellCircle, c, {
            hitTest: o,
            circle: {
              x: e,
              y: t,
              radius: i
            },
            seenUids: {
              box: {},
              circle: {}
            }
          }, a), o ? c.length > 0 : c;
        }
      }, {
        key: "query",
        value: function query(e, t, i, o, a) {
          return this._query(e, t, i, o, !1, a);
        }
      }, {
        key: "hitTest",
        value: function hitTest(e, t, i, o, a) {
          return this._query(e, t, i, o, !0, a);
        }
      }, {
        key: "hitTestCircle",
        value: function hitTestCircle(e, t, i, o) {
          return this._queryCircle(e, t, i, !0, o);
        }
      }, {
        key: "_queryCell",
        value: function _queryCell(e, t, i, o, a, r, n, s) {
          var l = n.seenUids,
              c = this.boxCells[a];

          if (null !== c) {
            var _a90 = this.bboxes;

            for (var _h17 of c) {
              if (!l.box[_h17]) {
                l.box[_h17] = !0;

                var _c28 = 4 * _h17;

                if (e <= _a90[_c28 + 2] && t <= _a90[_c28 + 3] && i >= _a90[_c28 + 0] && o >= _a90[_c28 + 1] && (!s || s(this.boxKeys[_h17]))) {
                  if (n.hitTest) return r.push(!0), !0;
                  r.push({
                    key: this.boxKeys[_h17],
                    x1: _a90[_c28],
                    y1: _a90[_c28 + 1],
                    x2: _a90[_c28 + 2],
                    y2: _a90[_c28 + 3]
                  });
                }
              }
            }
          }

          var h = this.circleCells[a];

          if (null !== h) {
            var _a91 = this.circles;

            for (var _c29 of h) {
              if (!l.circle[_c29]) {
                l.circle[_c29] = !0;

                var _h18 = 3 * _c29;

                if (this._circleAndRectCollide(_a91[_h18], _a91[_h18 + 1], _a91[_h18 + 2], e, t, i, o) && (!s || s(this.circleKeys[_c29]))) {
                  if (n.hitTest) return r.push(!0), !0;
                  {
                    var _e237 = _a91[_h18],
                        _t251 = _a91[_h18 + 1],
                        _i156 = _a91[_h18 + 2];
                    r.push({
                      key: this.circleKeys[_c29],
                      x1: _e237 - _i156,
                      y1: _t251 - _i156,
                      x2: _e237 + _i156,
                      y2: _t251 + _i156
                    });
                  }
                }
              }
            }
          }
        }
      }, {
        key: "_queryCellCircle",
        value: function _queryCellCircle(e, t, i, o, a, r, n, s) {
          var l = n.circle,
              c = n.seenUids,
              h = this.boxCells[a];

          if (null !== h) {
            var _e238 = this.bboxes;

            for (var _t252 of h) {
              if (!c.box[_t252]) {
                c.box[_t252] = !0;

                var _i157 = 4 * _t252;

                if (this._circleAndRectCollide(l.x, l.y, l.radius, _e238[_i157 + 0], _e238[_i157 + 1], _e238[_i157 + 2], _e238[_i157 + 3]) && (!s || s(this.boxKeys[_t252]))) return r.push(!0), !0;
              }
            }
          }

          var u = this.circleCells[a];

          if (null !== u) {
            var _e239 = this.circles;

            for (var _t253 of u) {
              if (!c.circle[_t253]) {
                c.circle[_t253] = !0;

                var _i158 = 3 * _t253;

                if (this._circlesCollide(_e239[_i158], _e239[_i158 + 1], _e239[_i158 + 2], l.x, l.y, l.radius) && (!s || s(this.circleKeys[_t253]))) return r.push(!0), !0;
              }
            }
          }
        }
      }, {
        key: "_forEachCell",
        value: function _forEachCell(e, t, i, o, a, r, n, s) {
          var l = this._convertToXCellCoord(e),
              c = this._convertToYCellCoord(t),
              h = this._convertToXCellCoord(i),
              u = this._convertToYCellCoord(o);

          for (var _d13 = l; _d13 <= h; _d13++) {
            for (var _l40 = c; _l40 <= u; _l40++) {
              if (a.call(this, e, t, i, o, this.xCellCount * _l40 + _d13, r, n, s)) return;
            }
          }
        }
      }, {
        key: "_convertToXCellCoord",
        value: function _convertToXCellCoord(e) {
          return Math.max(0, Math.min(this.xCellCount - 1, Math.floor(e * this.xScale)));
        }
      }, {
        key: "_convertToYCellCoord",
        value: function _convertToYCellCoord(e) {
          return Math.max(0, Math.min(this.yCellCount - 1, Math.floor(e * this.yScale)));
        }
      }, {
        key: "_circlesCollide",
        value: function _circlesCollide(e, t, i, o, a, r) {
          var n = o - e,
              s = a - t,
              l = i + r;
          return l * l > n * n + s * s;
        }
      }, {
        key: "_circleAndRectCollide",
        value: function _circleAndRectCollide(e, t, i, o, a, r, n) {
          var s = (r - o) / 2,
              l = Math.abs(e - (o + s));
          if (l > s + i) return !1;
          var c = (n - a) / 2,
              h = Math.abs(t - (a + c));
          if (h > c + i) return !1;
          if (l <= s || h <= c) return !0;
          var u = l - s,
              d = h - c;
          return u * u + d * d <= i * i;
        }
      }]);

      return W;
    }();

    function H(t, i, o, a, r) {
      var n = e.create();
      return i ? (e.scale(n, n, [1 / r, 1 / r, 1]), o || e.rotateZ(n, n, a.angle)) : e.multiply(n, a.labelPlaneMatrix, t), n;
    }

    function K(t, i, o, a, r) {
      if (i) {
        var _i159 = e.clone(t);

        return e.scale(_i159, _i159, [r, r, 1]), o || e.rotateZ(_i159, _i159, -a.angle), _i159;
      }

      return a.glCoordMatrix;
    }

    function Y(t, i) {
      var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var a = [t.x, t.y, o, 1];
      o ? e.transformMat4(a, a, i) : le(a, a, i);
      var r = a[3];
      return {
        point: new e.Point(a[0] / r, a[1] / r),
        signedDistanceFromCamera: r
      };
    }

    function J(e, t) {
      return Math.min(.5 + e / t * .5, 1.5);
    }

    function Q(e, t) {
      var i = e[0] / e[3],
          o = e[1] / e[3];
      return i >= -t[0] && i <= t[0] && o >= -t[1] && o <= t[1];
    }

    function ee(t, i, o, a, r, n, s, l, c) {
      var h = a ? t.textSizeData : t.iconSizeData,
          u = e.evaluateSizeForZoom(h, o.transform.zoom),
          d = [256 / o.width * 2 + 1, 256 / o.height * 2 + 1],
          _ = a ? t.text.dynamicLayoutVertexArray : t.icon.dynamicLayoutVertexArray;

      _.clear();

      var m = t.lineVertexArray,
          p = a ? t.text.placedSymbolArray : t.icon.placedSymbolArray,
          f = o.transform.width / o.transform.height;
      var g = !1;

      for (var _a92 = 0; _a92 < p.length; _a92++) {
        var _v10 = p.get(_a92);

        if (_v10.hidden || _v10.writingMode === e.WritingMode.vertical && !g) {
          se(_v10.numGlyphs, _);
          continue;
        }

        g = !1;

        var _x9 = c ? c({
          x: _v10.anchorX,
          y: _v10.anchorY
        }) : 0,
            _y10 = [_v10.anchorX, _v10.anchorY, _x9, 1];

        if (e.transformMat4(_y10, _y10, i), !Q(_y10, d)) {
          se(_v10.numGlyphs, _);
          continue;
        }

        var _b9 = J(o.transform.cameraToCenterDistance, _y10[3]),
            _w8 = e.evaluateSizeForFeature(h, u, _v10),
            _T4 = s ? _w8 / _b9 : _w8 * _b9,
            _E2 = new e.Point(_v10.anchorX, _v10.anchorY),
            _C3 = Y(_E2, r, _x9);

        if (_C3.signedDistanceFromCamera <= 0) {
          se(_v10.numGlyphs, _);
          continue;
        }

        var _S5 = _C3.point;
        var _I3 = {};

        var _P = s ? null : c,
            _M = oe(_v10, _T4, !1, l, i, r, n, t.glyphOffsetArray, m, _, _S5, _E2, _I3, f, _P);

        g = _M.useVertical, _P && _M.needsFlipping && (_I3 = {}), (_M.notEnoughRoom || g || _M.needsFlipping && oe(_v10, _T4, !0, l, i, r, n, t.glyphOffsetArray, m, _, _S5, _E2, _I3, f, _P).notEnoughRoom) && se(_v10.numGlyphs, _);
      }

      a ? t.text.dynamicLayoutVertexBuffer.updateData(_) : t.icon.dynamicLayoutVertexBuffer.updateData(_);
    }

    function te(e, t, i, o, a, r, n, s, l, c, h, u, d) {
      var _ = s.glyphStartIndex + s.numGlyphs,
          m = s.lineStartIndex,
          p = s.lineStartIndex + s.lineLength,
          f = t.getoffsetX(s.glyphStartIndex),
          g = t.getoffsetX(_ - 1),
          v = re(e * f, i, o, a, r, n, s.segment, m, p, l, c, h, u, d, !0);

      if (!v) return null;
      var x = re(e * g, i, o, a, r, n, s.segment, m, p, l, c, h, u, d, !0);
      return x ? {
        first: v,
        last: x
      } : null;
    }

    function ie(t, i, o, a) {
      return t === e.WritingMode.horizontal && Math.abs(o.y - i.y) > Math.abs(o.x - i.x) * a ? {
        useVertical: !0
      } : (t === e.WritingMode.vertical ? i.y < o.y : i.x > o.x) ? {
        needsFlipping: !0
      } : null;
    }

    function oe(t, i, o, a, r, n, s, l, c, h, u, d, _, m, p) {
      var f = i / 24,
          g = t.lineOffsetX * f,
          v = t.lineOffsetY * f;
      var x;

      if (t.numGlyphs > 1) {
        var _e240 = t.glyphStartIndex + t.numGlyphs,
            _i160 = t.lineStartIndex,
            _r215 = t.lineStartIndex + t.lineLength,
            _h19 = te(f, l, g, v, o, u, d, t, c, n, _, p);

        if (!_h19) return {
          notEnoughRoom: !0
        };
        var _y11 = Y(_h19.first.point, s).point,
            _b10 = Y(_h19.last.point, s).point;

        if (a && !o) {
          var _e241 = ie(t.writingMode, _y11, _b10, m);

          if (_e241) return _e241;
        }

        x = [_h19.first];

        for (var _a93 = t.glyphStartIndex + 1; _a93 < _e240 - 1; _a93++) {
          x.push(re(f * l.getoffsetX(_a93), g, v, o, u, d, t.segment, _i160, _r215, c, n, _, p));
        }

        x.push(_h19.last);
      } else {
        if (a && !o) {
          var _i162 = Y(d, r).point,
              _o63 = t.lineStartIndex + t.segment + 1,
              _a94 = new e.Point(c.getx(_o63), c.gety(_o63)),
              _n128 = Y(_a94, r),
              _s100 = _n128.signedDistanceFromCamera > 0 ? _n128.point : ae(d, _a94, _i162, 1, r),
              _l41 = ie(t.writingMode, _i162, _s100, m);

          if (_l41) return _l41;
        }

        var _i161 = re(f * l.getoffsetX(t.glyphStartIndex), g, v, o, u, d, t.segment, t.lineStartIndex, t.lineStartIndex + t.lineLength, c, n, _, p);

        if (!_i161) return {
          notEnoughRoom: !0
        };
        x = [_i161];
      }

      for (var _t254 of x) {
        e.addDynamicAttributes(h, _t254.point, _t254.angle);
      }

      return {};
    }

    function ae(e, t, i, o, a, r) {
      var n = e.add(e.sub(t)._unit()),
          s = Y(n, a, r ? r(n) : 0).point,
          l = i.sub(s);
      return i.add(l._mult(o / l.mag()));
    }

    function re(t, i, o, a, r, n, s, l, c, h, u, d, _, m, p) {
      var f = a ? t - i : t + i;
      var g = f > 0 ? 1 : -1,
          v = 0;
      a && (g *= -1, v = Math.PI), g < 0 && (v += Math.PI);
      var x = g > 0 ? l + s : l + s + 1,
          y = r,
          b = r,
          w = 0,
          T = 0;
      var E = Math.abs(f),
          C = [],
          S = [];
      var I = n;

      var P = function () {
        var t = x - g;
        return 0 === w ? n : new e.Point(h.getx(t), h.gety(t));
      },
          M = function () {
        return ae(P(), I, b, E - w + 1, u, _);
      };

      for (; w + T <= E;) {
        if (x += g, x < l || x >= c) return null;

        if (b = y, C.push(y), m && S.push(I || P()), y = d[x], void 0 === y) {
          I = new e.Point(h.getx(x), h.gety(x));

          var _t255 = Y(I, u, _ ? _(I) : 0);

          y = _t255.signedDistanceFromCamera > 0 ? d[x] = _t255.point : M();
        } else I = null;

        w += T, T = b.dist(y);
      }

      p && _ && (I = I || new e.Point(h.getx(x), h.gety(x)), d[x] = y = void 0 === d[x] ? y : M(), T = b.dist(y));

      var z = (E - w) / T,
          A = y.sub(b),
          D = A.mult(z)._add(b);

      o && D._add(A._unit()._perp()._mult(o * g));
      var L = v + Math.atan2(y.y - b.y, y.x - b.x);
      return C.push(D), m && (I = I || new e.Point(h.getx(x), h.gety(x)), S.push(function (t, i, o) {
        var a = 1 - o;
        return new e.Point(t.x * a + i.x * o, t.y * a + i.y * o);
      }(S.length > 0 ? S[S.length - 1] : I, I, z))), {
        point: D,
        angle: L,
        path: C,
        tilePath: S
      };
    }

    var ne = new Float32Array([-1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0]);

    function se(e, t) {
      for (var _i163 = 0; _i163 < e; _i163++) {
        var _e242 = t.length;
        t.resize(_e242 + 4), t.float32.set(ne, 3 * _e242);
      }
    }

    function le(e, t, i) {
      var o = t[0],
          a = t[1];
      return e[0] = i[0] * o + i[4] * a + i[12], e[1] = i[1] * o + i[5] * a + i[13], e[3] = i[3] * o + i[7] * a + i[15], e;
    }

    var ce = /*#__PURE__*/function () {
      function ce(e) {
        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new W(e.width + 200, e.height + 200, 25);
        var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new W(e.width + 200, e.height + 200, 25);

        _classCallCheck(this, ce);

        this.transform = e, this.grid = t, this.ignoredGrid = i, this.pitchfactor = Math.cos(e._pitch) * e.cameraToCenterDistance, this.screenRightBoundary = e.width + 100, this.screenBottomBoundary = e.height + 100, this.gridRightBoundary = e.width + 200, this.gridBottomBoundary = e.height + 200;
      }

      _createClass(ce, [{
        key: "placeCollisionBox",
        value: function placeCollisionBox(e, t, i, o, a, r, n) {
          var s = this.projectAndGetPerspectiveRatio(r, t.anchorPointX, t.anchorPointY, t.elevation),
              l = a * s.perspectiveRatio,
              c = (t.x1 * e + i.x - t.padding) * l + s.point.x,
              h = (t.y1 * e + i.y - t.padding) * l + s.point.y,
              u = (t.x2 * e + i.x + t.padding) * l + s.point.x,
              d = (t.y2 * e + i.y + t.padding) * l + s.point.y,
              _ = s.perspectiveRatio <= .55 || s.aboveHorizon;

          return !this.isInsideGrid(c, h, u, d) || !o && this.grid.hitTest(c, h, u, d, n) || _ ? {
            box: [],
            offscreen: !1
          } : {
            box: [c, h, u, d],
            offscreen: this.isOffscreen(c, h, u, d)
          };
        }
      }, {
        key: "placeCollisionCircles",
        value: function placeCollisionCircles(t, i, o, a, r, n, s, l, c, h, u, d, _, m) {
          var p = [],
              f = this.transform.elevation,
              g = f ? function (e) {
            return f.getAtTileOffset(m, e.x, e.y);
          } : function (e) {
            return 0;
          },
              v = new e.Point(i.anchorX, i.anchorY),
              x = g(v),
              y = this.projectAndGetPerspectiveRatio(n, v.x, v.y, x),
              {
            perspectiveRatio: b
          } = y,
              w = (h ? r / b : r * b) / e.ONE_EM,
              T = Y(v, s, x).point,
              E = y.signedDistanceFromCamera > 0 ? te(w, a, i.lineOffsetX * w, i.lineOffsetY * w, !1, T, v, i, o, s, {}, f && !h ? g : null, h && !!f) : null;
          var C = !1,
              S = !1,
              I = !0;

          if (E && !y.aboveHorizon) {
            var _i164 = .5 * d * b + _,
                _o64 = new e.Point(-100, -100),
                _a95 = new e.Point(this.screenRightBoundary, this.screenBottomBoundary),
                _r216 = new X(),
                _n129 = E.first,
                _s101 = E.last;

            var _h20 = [];

            for (var _e243 = _n129.path.length - 1; _e243 >= 1; _e243--) {
              _h20.push(_n129.path[_e243]);
            }

            for (var _e244 = 1; _e244 < _s101.path.length; _e244++) {
              _h20.push(_s101.path[_e244]);
            }

            var _m12 = 2.5 * _i164;

            if (l) {
              var _e245 = _h20.map(f ? function (e, t) {
                var i = g(t < _n129.path.length - 1 ? _n129.tilePath[_n129.path.length - 1 - t] : _s101.tilePath[t - _n129.path.length + 2]);
                return Y(e, l, i);
              } : function (e) {
                return Y(e, l);
              });

              _h20 = _e245.some(function (e) {
                return e.signedDistanceFromCamera <= 0;
              }) ? [] : _e245.map(function (e) {
                return e.point;
              });
            }

            var _v11 = [];

            if (_h20.length > 0) {
              var _t256 = _h20[0].clone(),
                  _i165 = _h20[0].clone();

              for (var _e246 = 1; _e246 < _h20.length; _e246++) {
                _t256.x = Math.min(_t256.x, _h20[_e246].x), _t256.y = Math.min(_t256.y, _h20[_e246].y), _i165.x = Math.max(_i165.x, _h20[_e246].x), _i165.y = Math.max(_i165.y, _h20[_e246].y);
              }

              _v11 = _t256.x >= _o64.x && _i165.x <= _a95.x && _t256.y >= _o64.y && _i165.y <= _a95.y ? [_h20] : _i165.x < _o64.x || _t256.x > _a95.x || _i165.y < _o64.y || _t256.y > _a95.y ? [] : e.clipLine([_h20], _o64.x, _o64.y, _a95.x, _a95.y);
            }

            for (var _e247 of _v11) {
              _r216.reset(_e247, .25 * _i164);

              var _o65 = 0;
              _o65 = _r216.length <= .5 * _i164 ? 1 : Math.ceil(_r216.paddedLength / _m12) + 1;

              for (var _e248 = 0; _e248 < _o65; _e248++) {
                var _a96 = _e248 / Math.max(_o65 - 1, 1),
                    _n130 = _r216.lerp(_a96),
                    _s102 = _n130.x + 100,
                    _l42 = _n130.y + 100;

                p.push(_s102, _l42, _i164, 0);

                var _h21 = _s102 - _i164,
                    _d14 = _l42 - _i164,
                    _10 = _s102 + _i164,
                    _m13 = _l42 + _i164;

                if (I = I && this.isOffscreen(_h21, _d14, _10, _m13), S = S || this.isInsideGrid(_h21, _d14, _10, _m13), !t && this.grid.hitTestCircle(_s102, _l42, _i164, u) && (C = !0, !c)) return {
                  circles: [],
                  offscreen: !1,
                  collisionDetected: C
                };
              }
            }
          }

          return {
            circles: !c && C || !S ? [] : p,
            offscreen: I,
            collisionDetected: C
          };
        }
      }, {
        key: "queryRenderedSymbols",
        value: function queryRenderedSymbols(t) {
          if (0 === t.length || 0 === this.grid.keysLength() && 0 === this.ignoredGrid.keysLength()) return {};
          var i = [];
          var o = 1 / 0,
              a = 1 / 0,
              r = -1 / 0,
              n = -1 / 0;

          for (var _s103 of t) {
            var _t257 = new e.Point(_s103.x + 100, _s103.y + 100);

            o = Math.min(o, _t257.x), a = Math.min(a, _t257.y), r = Math.max(r, _t257.x), n = Math.max(n, _t257.y), i.push(_t257);
          }

          var s = this.grid.query(o, a, r, n).concat(this.ignoredGrid.query(o, a, r, n)),
              l = {},
              c = {};

          for (var _t258 of s) {
            var _o66 = _t258.key;
            if (void 0 === l[_o66.bucketInstanceId] && (l[_o66.bucketInstanceId] = {}), l[_o66.bucketInstanceId][_o66.featureIndex]) continue;
            var _a97 = [new e.Point(_t258.x1, _t258.y1), new e.Point(_t258.x2, _t258.y1), new e.Point(_t258.x2, _t258.y2), new e.Point(_t258.x1, _t258.y2)];
            e.polygonIntersectsPolygon(i, _a97) && (l[_o66.bucketInstanceId][_o66.featureIndex] = !0, void 0 === c[_o66.bucketInstanceId] && (c[_o66.bucketInstanceId] = []), c[_o66.bucketInstanceId].push(_o66.featureIndex));
          }

          return c;
        }
      }, {
        key: "insertCollisionBox",
        value: function insertCollisionBox(e, t, i, o, a) {
          (t ? this.ignoredGrid : this.grid).insert({
            bucketInstanceId: i,
            featureIndex: o,
            collisionGroupID: a
          }, e[0], e[1], e[2], e[3]);
        }
      }, {
        key: "insertCollisionCircles",
        value: function insertCollisionCircles(e, t, i, o, a) {
          var r = t ? this.ignoredGrid : this.grid,
              n = {
            bucketInstanceId: i,
            featureIndex: o,
            collisionGroupID: a
          };

          for (var _t259 = 0; _t259 < e.length; _t259 += 4) {
            r.insertCircle(n, e[_t259], e[_t259 + 1], e[_t259 + 2]);
          }
        }
      }, {
        key: "projectAndGetPerspectiveRatio",
        value: function projectAndGetPerspectiveRatio(t, i, o, a) {
          var r = [i, o, a || 0, 1];
          var n = !1;
          return a || this.transform.pitch > 0 ? (e.transformMat4(r, r, t), n = r[2] > r[3]) : le(r, r, t), {
            point: new e.Point((r[0] / r[3] + 1) / 2 * this.transform.width + 100, (-r[1] / r[3] + 1) / 2 * this.transform.height + 100),
            perspectiveRatio: Math.min(.5 + this.transform.cameraToCenterDistance / r[3] * .5, 1.5),
            signedDistanceFromCamera: r[3],
            aboveHorizon: n
          };
        }
      }, {
        key: "isOffscreen",
        value: function isOffscreen(e, t, i, o) {
          return i < 100 || e >= this.screenRightBoundary || o < 100 || t > this.screenBottomBoundary;
        }
      }, {
        key: "isInsideGrid",
        value: function isInsideGrid(e, t, i, o) {
          return i >= 0 && e < this.gridRightBoundary && o >= 0 && t < this.gridBottomBoundary;
        }
      }, {
        key: "getViewportMatrix",
        value: function getViewportMatrix() {
          var t = e.identity([]);
          return e.translate(t, t, [-100, -100, 0]), t;
        }
      }]);

      return ce;
    }();

    var he = /*#__PURE__*/function () {
      function he(e, t, i, o) {
        _classCallCheck(this, he);

        this.opacity = e ? Math.max(0, Math.min(1, e.opacity + (e.placed ? t : -t))) : o && i ? 1 : 0, this.placed = i;
      }

      _createClass(he, [{
        key: "isHidden",
        value: function isHidden() {
          return 0 === this.opacity && !this.placed;
        }
      }]);

      return he;
    }();

    var ue = /*#__PURE__*/function () {
      function ue(e, t, i, o, a) {
        _classCallCheck(this, ue);

        this.text = new he(e ? e.text : null, t, i, a), this.icon = new he(e ? e.icon : null, t, o, a);
      }

      _createClass(ue, [{
        key: "isHidden",
        value: function isHidden() {
          return this.text.isHidden() && this.icon.isHidden();
        }
      }]);

      return ue;
    }();

    var de = function de(e, t, i) {
      _classCallCheck(this, de);

      this.text = e, this.icon = t, this.skipFade = i;
    };

    var _e = function _e() {
      _classCallCheck(this, _e);

      this.invProjMatrix = e.create(), this.viewportMatrix = e.create(), this.circles = [];
    };

    var me = function me(e, t, i, o, a) {
      _classCallCheck(this, me);

      this.bucketInstanceId = e, this.featureIndex = t, this.sourceLayerIndex = i, this.bucketIndex = o, this.tileID = a;
    };

    var pe = /*#__PURE__*/function () {
      function pe(e) {
        _classCallCheck(this, pe);

        this.crossSourceCollisions = e, this.maxGroupID = 0, this.collisionGroups = {};
      }

      _createClass(pe, [{
        key: "get",
        value: function get(e) {
          if (this.crossSourceCollisions) return {
            ID: 0,
            predicate: null
          };

          if (!this.collisionGroups[e]) {
            var _t260 = ++this.maxGroupID;

            this.collisionGroups[e] = {
              ID: _t260,
              predicate: function (e) {
                return e.collisionGroupID === _t260;
              }
            };
          }

          return this.collisionGroups[e];
        }
      }]);

      return pe;
    }();

    function fe(t, i, o, a, r) {
      var {
        horizontalAlign: n,
        verticalAlign: s
      } = e.getAnchorAlignment(t),
          l = -(n - .5) * i,
          c = -(s - .5) * o,
          h = e.evaluateVariableOffset(t, a);
      return new e.Point(l + h[0] * r, c + h[1] * r);
    }

    function ge(t, i, o, a, r) {
      var n = new e.Point(t, i);
      return o && n._rotate(a ? r : -r), n;
    }

    var ve = /*#__PURE__*/function () {
      function ve(e, t, i, o) {
        _classCallCheck(this, ve);

        this.transform = e.clone(), this.collisionIndex = new ce(this.transform), this.placements = {}, this.opacities = {}, this.variableOffsets = {}, this.stale = !1, this.commitTime = 0, this.fadeDuration = t, this.retainedQueryData = {}, this.collisionGroups = new pe(i), this.collisionCircleArrays = {}, this.prevPlacement = o, o && (o.prevPlacement = void 0), this.placedOrientations = {};
      }

      _createClass(ve, [{
        key: "getBucketParts",
        value: function getBucketParts(t, i, o, a) {
          var r = o.getBucket(i),
              n = o.latestFeatureIndex;
          if (!r || !n || i.id !== r.layerIds[0]) return;

          var s = o.collisionBoxArray,
              l = r.layers[0].layout,
              c = Math.pow(2, this.transform.zoom - o.tileID.overscaledZ),
              h = o.tileSize / e.EXTENT,
              u = this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),
              d = "map" === l.get("text-pitch-alignment"),
              _ = "map" === l.get("text-rotation-alignment"),
              m = v(o, 1, this.transform.zoom),
              p = H(u, d, _, this.transform, m);

          var f = null;

          if (d) {
            var _t261 = K(u, d, _, this.transform, m);

            f = e.multiply([], this.transform.labelPlaneMatrix, _t261);
          }

          this.retainedQueryData[r.bucketInstanceId] = new me(r.bucketInstanceId, n, r.sourceLayerIndex, r.index, o.tileID);
          var g = {
            bucket: r,
            layout: l,
            posMatrix: u,
            textLabelPlaneMatrix: p,
            labelToScreenMatrix: f,
            scale: c,
            textPixelRatio: h,
            holdingForFade: o.holdingForFade(),
            collisionBoxArray: s,
            partiallyEvaluatedTextSize: e.evaluateSizeForZoom(r.textSizeData, this.transform.zoom),
            partiallyEvaluatedIconSize: e.evaluateSizeForZoom(r.iconSizeData, this.transform.zoom),
            collisionGroup: this.collisionGroups.get(r.sourceID)
          };
          if (a) for (var _e249 of r.sortKeyRanges) {
            var {
              sortKey: _i166,
              symbolInstanceStart: _o67,
              symbolInstanceEnd: _a98
            } = _e249;
            t.push({
              sortKey: _i166,
              symbolInstanceStart: _o67,
              symbolInstanceEnd: _a98,
              parameters: g
            });
          } else t.push({
            symbolInstanceStart: 0,
            symbolInstanceEnd: r.symbolInstances.length,
            parameters: g
          });
        }
      }, {
        key: "attemptAnchorPlacement",
        value: function attemptAnchorPlacement(e, t, i, o, a, r, n, s, l, c, h, u, d, _, m, p, f, g) {
          var v = [u.textOffset0, u.textOffset1],
              x = _.getSymbolInstanceTextSize(f, u, this.transform.zoom, d),
              y = fe(e, i, o, v, a),
              b = this.collisionIndex.placeCollisionBox(x, t, ge(y.x, y.y, r, n, this.transform.angle), h, s, l, c.predicate);

          if ((!p || 0 !== this.collisionIndex.placeCollisionBox(_.getSymbolInstanceIconSize(g, this.transform.zoom, d), p, ge(y.x, y.y, r, n, this.transform.angle), h, s, l, c.predicate).box.length) && b.box.length > 0) {
            var _t262;

            return this.prevPlacement && this.prevPlacement.variableOffsets[u.crossTileID] && this.prevPlacement.placements[u.crossTileID] && this.prevPlacement.placements[u.crossTileID].text && (_t262 = this.prevPlacement.variableOffsets[u.crossTileID].anchor), this.variableOffsets[u.crossTileID] = {
              textOffset: v,
              width: i,
              height: o,
              anchor: e,
              textBoxScale: a,
              prevAnchor: _t262
            }, this.markUsedJustification(_, e, u, m), _.allowVerticalPlacement && (this.markUsedOrientation(_, m, u), this.placedOrientations[u.crossTileID] = m), {
              shift: y,
              placedGlyphBoxes: b
            };
          }
        }
      }, {
        key: "placeLayerBucketPart",
        value: function placeLayerBucketPart(t, i, o) {
          var _this85 = this;

          var {
            bucket: a,
            layout: r,
            posMatrix: n,
            textLabelPlaneMatrix: s,
            labelToScreenMatrix: l,
            textPixelRatio: c,
            holdingForFade: h,
            collisionBoxArray: u,
            partiallyEvaluatedTextSize: d,
            partiallyEvaluatedIconSize: _,
            collisionGroup: m
          } = t.parameters,
              p = r.get("text-optional"),
              f = r.get("icon-optional"),
              g = r.get("text-allow-overlap"),
              v = r.get("icon-allow-overlap"),
              x = "map" === r.get("text-rotation-alignment"),
              y = "map" === r.get("text-pitch-alignment"),
              b = "none" !== r.get("icon-text-fit"),
              w = "viewport-y" === r.get("symbol-z-order"),
              T = g && (v || !a.hasIconData() || f),
              E = v && (g || !a.hasTextData() || p);
          !a.collisionArrays && u && a.deserializeCollisionBoxes(u), o && a.updateCollisionDebugBuffers(this.transform.zoom, u);

          var C = function (t, u, w) {
            if (i[t.crossTileID]) return;
            if (h) return void (_this85.placements[t.crossTileID] = new de(!1, !1, !1));
            var C = !1,
                S = !1,
                I = !0,
                P = null,
                M = {
              box: null,
              offscreen: null
            },
                z = {
              box: null,
              offscreen: null
            },
                A = null,
                D = null,
                L = null,
                R = 0,
                k = 0,
                B = 0;
            w.textFeatureIndex ? R = w.textFeatureIndex : t.useRuntimeCollisionCircles && (R = t.featureIndex), w.verticalTextFeatureIndex && (k = w.verticalTextFeatureIndex);

            var F = function (e) {
              (_this85.transform.elevation || e.elevation) && (e.elevation = _this85.transform.elevation ? _this85.transform.elevation.getAtTileOffset(_this85.retainedQueryData[a.bucketInstanceId].tileID, e.anchorPointX, e.anchorPointY) : 0);
            },
                O = w.textBox;

            if (O) {
              F(O);

              var _i167 = function (i) {
                var o = e.WritingMode.horizontal;

                if (a.allowVerticalPlacement && !i && _this85.prevPlacement) {
                  var _e250 = _this85.prevPlacement.placedOrientations[t.crossTileID];
                  _e250 && (_this85.placedOrientations[t.crossTileID] = _e250, o = _e250, _this85.markUsedOrientation(a, o, t));
                }

                return o;
              },
                  _o68 = function (i, o) {
                if (a.allowVerticalPlacement && t.numVerticalGlyphVertices > 0 && w.verticalTextBox) {
                  for (var _t263 of a.writingModes) {
                    if (_t263 === e.WritingMode.vertical ? (M = o(), z = M) : M = i(), M && M.box && M.box.length) break;
                  }
                } else M = i();
              };

              if (r.get("text-variable-anchor")) {
                var _s104 = r.get("text-variable-anchor");

                if (_this85.prevPlacement && _this85.prevPlacement.variableOffsets[t.crossTileID]) {
                  var _e251 = _this85.prevPlacement.variableOffsets[t.crossTileID];
                  _s104.indexOf(_e251.anchor) > 0 && (_s104 = _s104.filter(function (t) {
                    return t !== _e251.anchor;
                  }), _s104.unshift(_e251.anchor));
                }

                var _l43 = function (e, i, o) {
                  var r = t.textBoxScale,
                      l = (e.x2 - e.x1) * r + 2 * e.padding,
                      h = (e.y2 - e.y1) * r + 2 * e.padding,
                      p = b && !v ? i : null;
                  p && F(p);
                  var f = {
                    box: [],
                    offscreen: !1
                  };
                  var w = g ? 2 * _s104.length : _s104.length;

                  for (var _i168 = 0; _i168 < w; ++_i168) {
                    var _g13 = _this85.attemptAnchorPlacement(_s104[_i168 % _s104.length], e, l, h, r, x, y, c, n, m, _i168 >= _s104.length, t, u, a, o, p, d, _);

                    if (_g13 && (f = _g13.placedGlyphBoxes, f && f.box && f.box.length)) {
                      C = !0, P = _g13.shift;
                      break;
                    }
                  }

                  return f;
                };

                _o68(function () {
                  return _l43(O, w.iconBox, e.WritingMode.horizontal);
                }, function () {
                  var i = w.verticalTextBox;
                  return i && F(i), a.allowVerticalPlacement && !(M && M.box && M.box.length) && t.numVerticalGlyphVertices > 0 && i ? _l43(i, w.verticalIconBox, e.WritingMode.vertical) : {
                    box: null,
                    offscreen: null
                  };
                }), M && (C = M.box, I = M.offscreen);

                var _h22 = _i167(M && M.box);

                if (!C && _this85.prevPlacement) {
                  var _e252 = _this85.prevPlacement.variableOffsets[t.crossTileID];
                  _e252 && (_this85.variableOffsets[t.crossTileID] = _e252, _this85.markUsedJustification(a, _e252.anchor, t, _h22));
                }
              } else {
                var _r217 = function (i, o) {
                  var r = a.getSymbolInstanceTextSize(d, t, _this85.transform.zoom, u),
                      s = _this85.collisionIndex.placeCollisionBox(r, i, new e.Point(0, 0), g, c, n, m.predicate);

                  return s && s.box && s.box.length && (_this85.markUsedOrientation(a, o, t), _this85.placedOrientations[t.crossTileID] = o), s;
                };

                _o68(function () {
                  return _r217(O, e.WritingMode.horizontal);
                }, function () {
                  var i = w.verticalTextBox;
                  return a.allowVerticalPlacement && t.numVerticalGlyphVertices > 0 && i ? (F(i), _r217(i, e.WritingMode.vertical)) : {
                    box: null,
                    offscreen: null
                  };
                }), _i167(M && M.box && M.box.length);
              }
            }

            if (A = M, C = A && A.box && A.box.length > 0, I = A && A.offscreen, t.useRuntimeCollisionCircles) {
              var _i169 = a.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),
                  _c30 = e.evaluateSizeForFeature(a.textSizeData, d, _i169),
                  _h23 = r.get("text-padding");

              D = _this85.collisionIndex.placeCollisionCircles(g, _i169, a.lineVertexArray, a.glyphOffsetArray, _c30, n, s, l, o, y, m.predicate, t.collisionCircleDiameter, _h23, _this85.retainedQueryData[a.bucketInstanceId].tileID), C = g || D.circles.length > 0 && !D.collisionDetected, I = I && D.offscreen;
            }

            if (w.iconFeatureIndex && (B = w.iconFeatureIndex), w.iconBox) {
              var _t264 = function (t) {
                F(t);
                var i = b && P ? ge(P.x, P.y, x, y, _this85.transform.angle) : new e.Point(0, 0),
                    o = a.getSymbolInstanceIconSize(_, _this85.transform.zoom, u);
                return _this85.collisionIndex.placeCollisionBox(o, t, i, v, c, n, m.predicate);
              };

              z && z.box && z.box.length && w.verticalIconBox ? (L = _t264(w.verticalIconBox), S = L.box.length > 0) : (L = _t264(w.iconBox), S = L.box.length > 0), I = I && L.offscreen;
            }

            var U = p || 0 === t.numHorizontalGlyphVertices && 0 === t.numVerticalGlyphVertices,
                N = f || 0 === t.numIconVertices;

            if (U || N ? N ? U || (S = S && C) : C = S && C : S = C = S && C, C && A && A.box && _this85.collisionIndex.insertCollisionBox(A.box, r.get("text-ignore-placement"), a.bucketInstanceId, z && z.box && k ? k : R, m.ID), S && L && _this85.collisionIndex.insertCollisionBox(L.box, r.get("icon-ignore-placement"), a.bucketInstanceId, B, m.ID), D && (C && _this85.collisionIndex.insertCollisionCircles(D.circles, r.get("text-ignore-placement"), a.bucketInstanceId, R, m.ID), o)) {
              var _e253 = a.bucketInstanceId;
              var _t265 = _this85.collisionCircleArrays[_e253];
              void 0 === _t265 && (_t265 = _this85.collisionCircleArrays[_e253] = new _e());

              for (var _e254 = 0; _e254 < D.circles.length; _e254 += 4) {
                _t265.circles.push(D.circles[_e254 + 0]), _t265.circles.push(D.circles[_e254 + 1]), _t265.circles.push(D.circles[_e254 + 2]), _t265.circles.push(D.collisionDetected ? 1 : 0);
              }
            }

            _this85.placements[t.crossTileID] = new de(C || T, S || E, I || a.justReloaded), i[t.crossTileID] = !0;
          };

          if (w) {
            var _e255 = a.getSortedSymbolIndexes(this.transform.angle);

            for (var _t266 = _e255.length - 1; _t266 >= 0; --_t266) {
              var _i170 = _e255[_t266];
              C(a.symbolInstances.get(_i170), _i170, a.collisionArrays[_i170]);
            }
          } else for (var _e256 = t.symbolInstanceStart; _e256 < t.symbolInstanceEnd; _e256++) {
            C(a.symbolInstances.get(_e256), _e256, a.collisionArrays[_e256]);
          }

          if (o && a.bucketInstanceId in this.collisionCircleArrays) {
            var _t267 = this.collisionCircleArrays[a.bucketInstanceId];
            e.invert(_t267.invProjMatrix, n), _t267.viewportMatrix = this.collisionIndex.getViewportMatrix();
          }

          a.justReloaded = !1;
        }
      }, {
        key: "markUsedJustification",
        value: function markUsedJustification(t, i, o, a) {
          var r;
          r = a === e.WritingMode.vertical ? o.verticalPlacedTextSymbolIndex : {
            left: o.leftJustifiedTextSymbolIndex,
            center: o.centerJustifiedTextSymbolIndex,
            right: o.rightJustifiedTextSymbolIndex
          }[e.getAnchorJustification(i)];
          var n = [o.leftJustifiedTextSymbolIndex, o.centerJustifiedTextSymbolIndex, o.rightJustifiedTextSymbolIndex, o.verticalPlacedTextSymbolIndex];

          for (var _e257 of n) {
            _e257 >= 0 && (t.text.placedSymbolArray.get(_e257).crossTileID = r >= 0 && _e257 !== r ? 0 : o.crossTileID);
          }
        }
      }, {
        key: "markUsedOrientation",
        value: function markUsedOrientation(t, i, o) {
          var a = i === e.WritingMode.horizontal || i === e.WritingMode.horizontalOnly ? i : 0,
              r = i === e.WritingMode.vertical ? i : 0,
              n = [o.leftJustifiedTextSymbolIndex, o.centerJustifiedTextSymbolIndex, o.rightJustifiedTextSymbolIndex];

          for (var _e258 of n) {
            t.text.placedSymbolArray.get(_e258).placedOrientation = a;
          }

          o.verticalPlacedTextSymbolIndex && (t.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation = r);
        }
      }, {
        key: "commit",
        value: function commit(e) {
          this.commitTime = e, this.zoomAtLastRecencyCheck = this.transform.zoom;
          var t = this.prevPlacement;
          var i = !1;
          this.prevZoomAdjustment = t ? t.zoomAdjustment(this.transform.zoom) : 0;
          var o = t ? t.symbolFadeChange(e) : 1,
              a = t ? t.opacities : {},
              r = t ? t.variableOffsets : {},
              n = t ? t.placedOrientations : {};

          for (var _e259 in this.placements) {
            var _t268 = this.placements[_e259],
                _r218 = a[_e259];
            _r218 ? (this.opacities[_e259] = new ue(_r218, o, _t268.text, _t268.icon), i = i || _t268.text !== _r218.text.placed || _t268.icon !== _r218.icon.placed) : (this.opacities[_e259] = new ue(null, o, _t268.text, _t268.icon, _t268.skipFade), i = i || _t268.text || _t268.icon);
          }

          for (var _e260 in a) {
            var _t269 = a[_e260];

            if (!this.opacities[_e260]) {
              var _a99 = new ue(_t269, o, !1, !1);

              _a99.isHidden() || (this.opacities[_e260] = _a99, i = i || _t269.text.placed || _t269.icon.placed);
            }
          }

          for (var _e261 in r) {
            this.variableOffsets[_e261] || !this.opacities[_e261] || this.opacities[_e261].isHidden() || (this.variableOffsets[_e261] = r[_e261]);
          }

          for (var _e262 in n) {
            this.placedOrientations[_e262] || !this.opacities[_e262] || this.opacities[_e262].isHidden() || (this.placedOrientations[_e262] = n[_e262]);
          }

          i ? this.lastPlacementChangeTime = e : "number" != typeof this.lastPlacementChangeTime && (this.lastPlacementChangeTime = t ? t.lastPlacementChangeTime : e);
        }
      }, {
        key: "updateLayerOpacities",
        value: function updateLayerOpacities(e, t) {
          var i = {};

          for (var _o69 of t) {
            var _t270 = _o69.getBucket(e);

            _t270 && _o69.latestFeatureIndex && e.id === _t270.layerIds[0] && this.updateBucketOpacities(_t270, i, _o69.collisionBoxArray);
          }
        }
      }, {
        key: "updateBucketOpacities",
        value: function updateBucketOpacities(t, i, o) {
          var _this86 = this;

          t.hasTextData() && t.text.opacityVertexArray.clear(), t.hasIconData() && t.icon.opacityVertexArray.clear(), t.hasIconCollisionBoxData() && t.iconCollisionBox.collisionVertexArray.clear(), t.hasTextCollisionBoxData() && t.textCollisionBox.collisionVertexArray.clear();
          var a = t.layers[0].layout,
              r = new ue(null, 0, !1, !1, !0),
              n = a.get("text-allow-overlap"),
              s = a.get("icon-allow-overlap"),
              l = a.get("text-variable-anchor"),
              c = "map" === a.get("text-rotation-alignment"),
              h = "map" === a.get("text-pitch-alignment"),
              u = "none" !== a.get("icon-text-fit"),
              d = new ue(null, 0, n && (s || !t.hasIconData() || a.get("icon-optional")), s && (n || !t.hasTextData() || a.get("text-optional")), !0);
          !t.collisionArrays && o && (t.hasIconCollisionBoxData() || t.hasTextCollisionBoxData()) && t.deserializeCollisionBoxes(o);

          var _ = function (e, t, i) {
            for (var _o70 = 0; _o70 < t / 4; _o70++) {
              e.opacityVertexArray.emplaceBack(i);
            }
          };

          var _loop7 = function (_o71) {
            var a = t.symbolInstances.get(_o71),
                {
              numHorizontalGlyphVertices: n,
              numVerticalGlyphVertices: s,
              crossTileID: m
            } = a;
            var p = _this86.opacities[m];
            i[m] ? p = r : p || (p = d, _this86.opacities[m] = p), i[m] = !0;
            var f = a.numIconVertices > 0,
                g = _this86.placedOrientations[a.crossTileID],
                v = g === e.WritingMode.vertical,
                x = g === e.WritingMode.horizontal || g === e.WritingMode.horizontalOnly;

            if (n > 0 || s > 0) {
              var _e264 = Ie(p.text);

              _(t.text, n, v ? Pe : _e264), _(t.text, s, x ? Pe : _e264);

              var _i171 = p.text.isHidden();

              [a.rightJustifiedTextSymbolIndex, a.centerJustifiedTextSymbolIndex, a.leftJustifiedTextSymbolIndex].forEach(function (e) {
                e >= 0 && (t.text.placedSymbolArray.get(e).hidden = _i171 || v ? 1 : 0);
              }), a.verticalPlacedTextSymbolIndex >= 0 && (t.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).hidden = _i171 || x ? 1 : 0);
              var _o72 = _this86.variableOffsets[a.crossTileID];
              _o72 && _this86.markUsedJustification(t, _o72.anchor, a, g);
              var _r219 = _this86.placedOrientations[a.crossTileID];
              _r219 && (_this86.markUsedJustification(t, "left", a, _r219), _this86.markUsedOrientation(t, _r219, a));
            }

            if (f) {
              var _e265 = Ie(p.icon),
                  _i172 = !(u && a.verticalPlacedIconSymbolIndex && v);

              a.placedIconSymbolIndex >= 0 && (_(t.icon, a.numIconVertices, _i172 ? _e265 : Pe), t.icon.placedSymbolArray.get(a.placedIconSymbolIndex).hidden = p.icon.isHidden()), a.verticalPlacedIconSymbolIndex >= 0 && (_(t.icon, a.numVerticalIconVertices, _i172 ? Pe : _e265), t.icon.placedSymbolArray.get(a.verticalPlacedIconSymbolIndex).hidden = p.icon.isHidden());
            }

            if (t.hasIconCollisionBoxData() || t.hasTextCollisionBoxData()) {
              var _i173 = t.collisionArrays[_o71];

              if (_i173) {
                var _o73 = new e.Point(0, 0);

                if (_i173.textBox || _i173.verticalTextBox) {
                  var _e266 = !0;

                  if (l) {
                    var _t271 = _this86.variableOffsets[m];
                    _t271 ? (_o73 = fe(_t271.anchor, _t271.width, _t271.height, _t271.textOffset, _t271.textBoxScale), c && _o73._rotate(h ? _this86.transform.angle : -_this86.transform.angle)) : _e266 = !1;
                  }

                  _i173.textBox && xe(t.textCollisionBox.collisionVertexArray, p.text.placed, !_e266 || v, _o73.x, _o73.y), _i173.verticalTextBox && xe(t.textCollisionBox.collisionVertexArray, p.text.placed, !_e266 || x, _o73.x, _o73.y);
                }

                var _a100 = Boolean(!x && _i173.verticalIconBox);

                _i173.iconBox && xe(t.iconCollisionBox.collisionVertexArray, p.icon.placed, _a100, u ? _o73.x : 0, u ? _o73.y : 0), _i173.verticalIconBox && xe(t.iconCollisionBox.collisionVertexArray, p.icon.placed, !_a100, u ? _o73.x : 0, u ? _o73.y : 0);
              }
            }
          };

          for (var _o71 = 0; _o71 < t.symbolInstances.length; _o71++) {
            _loop7(_o71);
          }

          if (t.sortFeatures(this.transform.angle), this.retainedQueryData[t.bucketInstanceId] && (this.retainedQueryData[t.bucketInstanceId].featureSortOrder = t.featureSortOrder), t.hasTextData() && t.text.opacityVertexBuffer && t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray), t.hasIconData() && t.icon.opacityVertexBuffer && t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray), t.hasIconCollisionBoxData() && t.iconCollisionBox.collisionVertexBuffer && t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray), t.hasTextCollisionBoxData() && t.textCollisionBox.collisionVertexBuffer && t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray), t.bucketInstanceId in this.collisionCircleArrays) {
            var _e263 = this.collisionCircleArrays[t.bucketInstanceId];
            t.placementInvProjMatrix = _e263.invProjMatrix, t.placementViewportMatrix = _e263.viewportMatrix, t.collisionCircleArray = _e263.circles, delete this.collisionCircleArrays[t.bucketInstanceId];
          }
        }
      }, {
        key: "symbolFadeChange",
        value: function symbolFadeChange(e) {
          return 0 === this.fadeDuration ? 1 : (e - this.commitTime) / this.fadeDuration + this.prevZoomAdjustment;
        }
      }, {
        key: "zoomAdjustment",
        value: function zoomAdjustment(e) {
          return Math.max(0, (this.transform.zoom - e) / 1.5);
        }
      }, {
        key: "hasTransitions",
        value: function hasTransitions(e) {
          return this.stale || e - this.lastPlacementChangeTime < this.fadeDuration;
        }
      }, {
        key: "stillRecent",
        value: function stillRecent(e, t) {
          var i = this.zoomAtLastRecencyCheck === t ? 1 - this.zoomAdjustment(t) : 1;
          return this.zoomAtLastRecencyCheck = t, this.commitTime + this.fadeDuration * i > e;
        }
      }, {
        key: "setStale",
        value: function setStale() {
          this.stale = !0;
        }
      }]);

      return ve;
    }();

    function xe(e, t, i, o, a) {
      e.emplaceBack(t ? 1 : 0, i ? 1 : 0, o || 0, a || 0), e.emplaceBack(t ? 1 : 0, i ? 1 : 0, o || 0, a || 0), e.emplaceBack(t ? 1 : 0, i ? 1 : 0, o || 0, a || 0), e.emplaceBack(t ? 1 : 0, i ? 1 : 0, o || 0, a || 0);
    }

    var ye = Math.pow(2, 25),
        be = Math.pow(2, 24),
        we = Math.pow(2, 17),
        Te = Math.pow(2, 16),
        Ee = Math.pow(2, 9),
        Ce = Math.pow(2, 8),
        Se = Math.pow(2, 1);

    function Ie(e) {
      if (0 === e.opacity && !e.placed) return 0;
      if (1 === e.opacity && e.placed) return 4294967295;
      var t = e.placed ? 1 : 0,
          i = Math.floor(127 * e.opacity);
      return i * ye + t * be + i * we + t * Te + i * Ee + t * Ce + i * Se + t;
    }

    var Pe = 0;

    var Me = /*#__PURE__*/function () {
      function Me(e) {
        _classCallCheck(this, Me);

        this._sortAcrossTiles = "viewport-y" !== e.layout.get("symbol-z-order") && void 0 !== e.layout.get("symbol-sort-key").constantOr(1), this._currentTileIndex = 0, this._currentPartIndex = 0, this._seenCrossTileIDs = {}, this._bucketParts = [];
      }

      _createClass(Me, [{
        key: "continuePlacement",
        value: function continuePlacement(e, t, i, o, a) {
          var r = this._bucketParts;

          for (; this._currentTileIndex < e.length;) {
            if (t.getBucketParts(r, o, e[this._currentTileIndex], this._sortAcrossTiles), this._currentTileIndex++, a()) return !0;
          }

          for (this._sortAcrossTiles && (this._sortAcrossTiles = !1, r.sort(function (e, t) {
            return e.sortKey - t.sortKey;
          })); this._currentPartIndex < r.length;) {
            if (t.placeLayerBucketPart(r[this._currentPartIndex], this._seenCrossTileIDs, i), this._currentPartIndex++, a()) return !0;
          }

          return !1;
        }
      }]);

      return Me;
    }();

    var ze = /*#__PURE__*/function () {
      function ze(e, t, i, o, a, r, n) {
        _classCallCheck(this, ze);

        this.placement = new ve(e, a, r, n), this._currentPlacementIndex = t.length - 1, this._forceFullPlacement = i, this._showCollisionBoxes = o, this._done = !1;
      }

      _createClass(ze, [{
        key: "isDone",
        value: function isDone() {
          return this._done;
        }
      }, {
        key: "continuePlacement",
        value: function continuePlacement(t, i, o) {
          var _this87 = this;

          var a = e.browser.now(),
              r = function () {
            var t = e.browser.now() - a;
            return !_this87._forceFullPlacement && t > 2;
          };

          for (; this._currentPlacementIndex >= 0;) {
            var _e267 = i[t[this._currentPlacementIndex]],
                _a101 = this.placement.collisionIndex.transform.zoom;

            if ("symbol" === _e267.type && (!_e267.minzoom || _e267.minzoom <= _a101) && (!_e267.maxzoom || _e267.maxzoom > _a101)) {
              if (this._inProgressLayer || (this._inProgressLayer = new Me(_e267)), this._inProgressLayer.continuePlacement(o[_e267.source], this.placement, this._showCollisionBoxes, _e267, r)) return;
              delete this._inProgressLayer;
            }

            this._currentPlacementIndex--;
          }

          this._done = !0;
        }
      }, {
        key: "commit",
        value: function commit(e) {
          return this.placement.commit(e), this.placement;
        }
      }]);

      return ze;
    }();

    var Ae = 512 / e.EXTENT / 2;

    var De = /*#__PURE__*/function () {
      function De(e, t, i) {
        _classCallCheck(this, De);

        this.tileID = e, this.indexedSymbolInstances = {}, this.bucketInstanceId = i;

        for (var _i174 = 0; _i174 < t.length; _i174++) {
          var _o74 = t.get(_i174),
              _a102 = _o74.key;

          this.indexedSymbolInstances[_a102] || (this.indexedSymbolInstances[_a102] = []), this.indexedSymbolInstances[_a102].push({
            crossTileID: _o74.crossTileID,
            coord: this.getScaledCoordinates(_o74, e)
          });
        }
      }

      _createClass(De, [{
        key: "getScaledCoordinates",
        value: function getScaledCoordinates(t, i) {
          var o = Ae / Math.pow(2, i.canonical.z - this.tileID.canonical.z);
          return {
            x: Math.floor((i.canonical.x * e.EXTENT + t.anchorX) * o),
            y: Math.floor((i.canonical.y * e.EXTENT + t.anchorY) * o)
          };
        }
      }, {
        key: "findMatches",
        value: function findMatches(e, t, i) {
          var o = this.tileID.canonical.z < t.canonical.z ? 1 : Math.pow(2, this.tileID.canonical.z - t.canonical.z);

          for (var _a103 = 0; _a103 < e.length; _a103++) {
            var _r220 = e.get(_a103);

            if (_r220.crossTileID) continue;
            var _n131 = this.indexedSymbolInstances[_r220.key];
            if (!_n131) continue;

            var _s105 = this.getScaledCoordinates(_r220, t);

            for (var _e268 of _n131) {
              if (Math.abs(_e268.coord.x - _s105.x) <= o && Math.abs(_e268.coord.y - _s105.y) <= o && !i[_e268.crossTileID]) {
                i[_e268.crossTileID] = !0, _r220.crossTileID = _e268.crossTileID;
                break;
              }
            }
          }
        }
      }]);

      return De;
    }();

    var Le = /*#__PURE__*/function () {
      function Le() {
        _classCallCheck(this, Le);

        this.maxCrossTileID = 0;
      }

      _createClass(Le, [{
        key: "generate",
        value: function generate() {
          return ++this.maxCrossTileID;
        }
      }]);

      return Le;
    }();

    var Re = /*#__PURE__*/function () {
      function Re() {
        _classCallCheck(this, Re);

        this.indexes = {}, this.usedCrossTileIDs = {}, this.lng = 0;
      }

      _createClass(Re, [{
        key: "handleWrapJump",
        value: function handleWrapJump(e) {
          var t = Math.round((e - this.lng) / 360);
          if (0 !== t) for (var _e269 in this.indexes) {
            var _i175 = this.indexes[_e269],
                _o75 = {};

            for (var _e270 in _i175) {
              var _a104 = _i175[_e270];
              _a104.tileID = _a104.tileID.unwrapTo(_a104.tileID.wrap + t), _o75[_a104.tileID.key] = _a104;
            }

            this.indexes[_e269] = _o75;
          }
          this.lng = e;
        }
      }, {
        key: "addBucket",
        value: function addBucket(e, t, i) {
          if (this.indexes[e.overscaledZ] && this.indexes[e.overscaledZ][e.key]) {
            if (this.indexes[e.overscaledZ][e.key].bucketInstanceId === t.bucketInstanceId) return !1;
            this.removeBucketCrossTileIDs(e.overscaledZ, this.indexes[e.overscaledZ][e.key]);
          }

          for (var _e271 = 0; _e271 < t.symbolInstances.length; _e271++) {
            t.symbolInstances.get(_e271).crossTileID = 0;
          }

          this.usedCrossTileIDs[e.overscaledZ] || (this.usedCrossTileIDs[e.overscaledZ] = {});
          var o = this.usedCrossTileIDs[e.overscaledZ];

          for (var _i176 in this.indexes) {
            var _a105 = this.indexes[_i176];
            if (Number(_i176) > e.overscaledZ) for (var _i177 in _a105) {
              var _r221 = _a105[_i177];
              _r221.tileID.isChildOf(e) && _r221.findMatches(t.symbolInstances, e, o);
            } else {
              var _r222 = _a105[e.scaledTo(Number(_i176)).key];

              _r222 && _r222.findMatches(t.symbolInstances, e, o);
            }
          }

          for (var _e272 = 0; _e272 < t.symbolInstances.length; _e272++) {
            var _a106 = t.symbolInstances.get(_e272);

            _a106.crossTileID || (_a106.crossTileID = i.generate(), o[_a106.crossTileID] = !0);
          }

          return void 0 === this.indexes[e.overscaledZ] && (this.indexes[e.overscaledZ] = {}), this.indexes[e.overscaledZ][e.key] = new De(e, t.symbolInstances, t.bucketInstanceId), !0;
        }
      }, {
        key: "removeBucketCrossTileIDs",
        value: function removeBucketCrossTileIDs(e, t) {
          for (var _i178 in t.indexedSymbolInstances) {
            for (var _o76 of t.indexedSymbolInstances[_i178]) {
              delete this.usedCrossTileIDs[e][_o76.crossTileID];
            }
          }
        }
      }, {
        key: "removeStaleBuckets",
        value: function removeStaleBuckets(e) {
          var t = !1;

          for (var _i179 in this.indexes) {
            var _o77 = this.indexes[_i179];

            for (var _a107 in _o77) {
              e[_o77[_a107].bucketInstanceId] || (this.removeBucketCrossTileIDs(_i179, _o77[_a107]), delete _o77[_a107], t = !0);
            }
          }

          return t;
        }
      }]);

      return Re;
    }();

    var ke = /*#__PURE__*/function () {
      function ke() {
        _classCallCheck(this, ke);

        this.layerIndexes = {}, this.crossTileIDs = new Le(), this.maxBucketInstanceId = 0, this.bucketsInCurrentPlacement = {};
      }

      _createClass(ke, [{
        key: "addLayer",
        value: function addLayer(e, t, i) {
          var o = this.layerIndexes[e.id];
          void 0 === o && (o = this.layerIndexes[e.id] = new Re());
          var a = !1;
          var r = {};
          o.handleWrapJump(i);

          for (var _i180 of t) {
            var _t272 = _i180.getBucket(e);

            _t272 && e.id === _t272.layerIds[0] && (_t272.bucketInstanceId || (_t272.bucketInstanceId = ++this.maxBucketInstanceId), o.addBucket(_i180.tileID, _t272, this.crossTileIDs) && (a = !0), r[_t272.bucketInstanceId] = !0);
          }

          return o.removeStaleBuckets(r) && (a = !0), a;
        }
      }, {
        key: "pruneUnusedLayers",
        value: function pruneUnusedLayers(e) {
          var t = {};
          e.forEach(function (e) {
            t[e] = !0;
          });

          for (var _e273 in this.layerIndexes) {
            t[_e273] || delete this.layerIndexes[_e273];
          }
        }
      }]);

      return ke;
    }();

    var Be = function (t, i) {
      return e.emitValidationErrors(t, i && i.filter(function (e) {
        return "source.canvas" !== e.identifier;
      }));
    },
        Fe = e.pick(U, ["addLayer", "removeLayer", "setPaintProperty", "setLayoutProperty", "setFilter", "addSource", "removeSource", "setLayerZoomRange", "setLight", "setTransition", "setGeoJSONSourceData", "setTerrain"]),
        Oe = e.pick(U, ["setCenter", "setZoom", "setBearing", "setPitch"]),
        Ue = function () {
      var t = {},
          i = e.styleSpec.$version;

      for (var _o78 in e.styleSpec.$root) {
        var _a108 = e.styleSpec.$root[_o78];

        if (_a108.required) {
          var _e274 = null;
          _e274 = "version" === _o78 ? i : "array" === _a108.type ? [] : {}, null != _e274 && (t[_o78] = _e274);
        }
      }

      return t;
    }(),
        Ne = {
      fill: !0,
      line: !0,
      background: !0,
      hillshade: !0,
      raster: !0
    };

    var Ze = /*#__PURE__*/function (_e$Evented8) {
      _inherits(Ze, _e$Evented8);

      var _super112 = _createSuper(Ze);

      function Ze(t) {
        var _this88;

        var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        _classCallCheck(this, Ze);

        _this88 = _super112.call(this), _this88.map = t, _this88.dispatcher = new g(B(), _assertThisInitialized(_this88)), _this88.imageManager = new u(), _this88.imageManager.setEventedParent(_assertThisInitialized(_this88)), _this88.glyphManager = new e.GlyphManager(t._requestManager, i.localFontFamily ? e.LocalGlyphMode.all : i.localIdeographFontFamily ? e.LocalGlyphMode.ideographs : e.LocalGlyphMode.none, i.localFontFamily || i.localIdeographFontFamily), _this88.lineAtlas = new f(256, 512), _this88.crossTileSymbolIndex = new ke(), _this88._layers = {}, _this88._num3DLayers = 0, _this88._numSymbolLayers = 0, _this88._numCircleLayers = 0, _this88._serializedLayers = {}, _this88._sourceCaches = {}, _this88._otherSourceCaches = {}, _this88._symbolSourceCaches = {}, _this88.zoomHistory = new e.ZoomHistory(), _this88._loaded = !1, _this88._availableImages = [], _this88._order = [], _this88._drapedFirstOrder = [], _this88._resetUpdates(), _this88.dispatcher.broadcast("setReferrer", e.getReferrer());

        var o = _assertThisInitialized(_this88);

        _this88._rtlTextPluginCallback = Ze.registerForPluginStateChange(function (t) {
          o.dispatcher.broadcast("syncRTLPluginState", {
            pluginStatus: t.pluginStatus,
            pluginURL: t.pluginURL
          }, function (t, i) {
            if (e.triggerPluginCompletionEvent(t), i && i.every(function (e) {
              return e;
            })) for (var _e275 in o._sourceCaches) {
              var _t273 = o._sourceCaches[_e275],
                  _i181 = _t273.getSource().type;

              "vector" !== _i181 && "geojson" !== _i181 || _t273.reload();
            }
          });
        }), _this88.on("data", function (e) {
          if ("source" !== e.dataType || "metadata" !== e.sourceDataType) return;

          var t = _this88.getSource(e.sourceId);

          if (t && t.vectorLayerIds) for (var _e276 in _this88._layers) {
            var _i182 = _this88._layers[_e276];
            _i182.source === t.id && _this88._validateLayer(_i182);
          }
        });
        return _this88;
      }

      _createClass(Ze, [{
        key: "loadURL",
        value: function loadURL(t) {
          var _this89 = this;

          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          this.fire(new e.Event("dataloading", {
            dataType: "style"
          }));
          var o = "boolean" == typeof i.validate ? i.validate : !e.isMapboxURL(t);
          t = this.map._requestManager.normalizeStyleURL(t, i.accessToken);

          var a = this.map._requestManager.transformRequest(t, e.ResourceType.Style);

          this._request = e.getJSON(a, function (t, i) {
            _this89._request = null, t ? _this89.fire(new e.ErrorEvent(t)) : i && _this89._load(i, o);
          });
        }
      }, {
        key: "loadJSON",
        value: function loadJSON(t) {
          var _this90 = this;

          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          this.fire(new e.Event("dataloading", {
            dataType: "style"
          })), this._request = e.browser.frame(function () {
            _this90._request = null, _this90._load(t, !1 !== i.validate);
          });
        }
      }, {
        key: "loadEmpty",
        value: function loadEmpty() {
          this.fire(new e.Event("dataloading", {
            dataType: "style"
          })), this._load(Ue, !1);
        }
      }, {
        key: "_updateLayerCount",
        value: function _updateLayerCount(e, t) {
          var i = t ? 1 : -1;
          e.is3D() && (this._num3DLayers += i), "circle" === e.type && (this._numCircleLayers += i), "symbol" === e.type && (this._numSymbolLayers += i);
        }
      }, {
        key: "_load",
        value: function _load(t, i) {
          if (i && Be(this, e.validateStyle(t))) return;
          this._loaded = !0, this.stylesheet = t;

          for (var _e277 in t.sources) {
            this.addSource(_e277, t.sources[_e277], {
              validate: !1
            });
          }

          this._changed = !1, t.sprite ? this._loadSprite(t.sprite) : (this.imageManager.setLoaded(!0), this.dispatcher.broadcast("spriteLoaded", !0)), this.glyphManager.setURL(t.glyphs);
          var o = O(this.stylesheet.layers);
          this._order = o.map(function (e) {
            return e.id;
          }), this._layers = {}, this._serializedLayers = {};

          for (var _t274 of o) {
            _t274 = e.createStyleLayer(_t274), _t274.setEventedParent(this, {
              layer: {
                id: _t274.id
              }
            }), this._layers[_t274.id] = _t274, this._serializedLayers[_t274.id] = _t274.serialize(), this._updateLayerCount(_t274, !0);
          }

          this.dispatcher.broadcast("setLayers", this._serializeLayers(this._order)), this.light = new _(this.stylesheet.light), this.stylesheet.terrain && this._createTerrain(this.stylesheet.terrain), this._updateDrapeFirstLayers(), this.fire(new e.Event("data", {
            dataType: "style"
          })), this.fire(new e.Event("style.load"));
        }
      }, {
        key: "_loadSprite",
        value: function _loadSprite(t) {
          var _this91 = this;

          this._spriteRequest = function (t, i, o) {
            var a, r, n;
            var s = e.browser.devicePixelRatio > 1 ? "@2x" : "";
            var l = e.getJSON(i.transformRequest(i.normalizeSpriteURL(t, s, ".json"), e.ResourceType.SpriteJSON), function (e, t) {
              l = null, n || (n = e, a = t, h());
            }),
                c = e.getImage(i.transformRequest(i.normalizeSpriteURL(t, s, ".png"), e.ResourceType.SpriteImage), function (e, t) {
              c = null, n || (n = e, r = t, h());
            });

            function h() {
              if (n) o(n);else if (a && r) {
                var _t275 = e.browser.getImageData(r),
                    _i183 = {};

                for (var _o79 in a) {
                  var {
                    width: _r223,
                    height: _n132,
                    x: _s106,
                    y: _l44,
                    sdf: _c31,
                    pixelRatio: _h24,
                    stretchX: _u37,
                    stretchY: _d15,
                    content: _11
                  } = a[_o79],
                      _m14 = new e.RGBAImage({
                    width: _r223,
                    height: _n132
                  });

                  e.RGBAImage.copy(_t275, _m14, {
                    x: _s106,
                    y: _l44
                  }, {
                    x: 0,
                    y: 0
                  }, {
                    width: _r223,
                    height: _n132
                  }), _i183[_o79] = {
                    data: _m14,
                    pixelRatio: _h24,
                    sdf: _c31,
                    stretchX: _u37,
                    stretchY: _d15,
                    content: _11
                  };
                }

                o(null, _i183);
              }
            }

            return {
              cancel: function () {
                l && (l.cancel(), l = null), c && (c.cancel(), c = null);
              }
            };
          }(t, this.map._requestManager, function (t, i) {
            if (_this91._spriteRequest = null, t) _this91.fire(new e.ErrorEvent(t));else if (i) for (var _e278 in i) {
              _this91.imageManager.addImage(_e278, i[_e278]);
            }
            _this91.imageManager.setLoaded(!0), _this91._availableImages = _this91.imageManager.listImages(), _this91.dispatcher.broadcast("setImages", _this91._availableImages), _this91.dispatcher.broadcast("spriteLoaded", !0), _this91.fire(new e.Event("data", {
              dataType: "style"
            }));
          });
        }
      }, {
        key: "_validateLayer",
        value: function _validateLayer(t) {
          var i = this.getSource(t.source);
          if (!i) return;
          var o = t.sourceLayer;
          o && ("geojson" === i.type || i.vectorLayerIds && -1 === i.vectorLayerIds.indexOf(o)) && this.fire(new e.ErrorEvent(new Error("Source layer \"".concat(o, "\" ") + "does not exist on source \"".concat(i.id, "\" ") + "as specified by style layer \"".concat(t.id, "\""))));
        }
      }, {
        key: "loaded",
        value: function loaded() {
          if (!this._loaded) return !1;
          if (Object.keys(this._updatedSources).length) return !1;

          for (var _e279 in this._sourceCaches) {
            if (!this._sourceCaches[_e279].loaded()) return !1;
          }

          return !!this.imageManager.isLoaded();
        }
      }, {
        key: "_serializeLayers",
        value: function _serializeLayers(e) {
          var t = [];

          for (var _i184 of e) {
            var _e280 = this._layers[_i184];
            "custom" !== _e280.type && t.push(_e280.serialize());
          }

          return t;
        }
      }, {
        key: "hasTransitions",
        value: function hasTransitions() {
          if (this.light && this.light.hasTransition()) return !0;

          for (var _e281 in this._sourceCaches) {
            if (this._sourceCaches[_e281].hasTransition()) return !0;
          }

          for (var _e282 in this._layers) {
            if (this._layers[_e282].hasTransition()) return !0;
          }

          return !1;
        }
      }, {
        key: "order",
        get: function () {
          return this.map._optimizeForTerrain && this.terrain ? this._drapedFirstOrder : this._order;
        }
      }, {
        key: "isLayerDraped",
        value: function isLayerDraped(e) {
          return !!this.terrain && Ne[e.type];
        }
      }, {
        key: "_checkLoaded",
        value: function _checkLoaded() {
          if (!this._loaded) throw new Error("Style is not done loading");
        }
      }, {
        key: "update",
        value: function update(t) {
          if (!this._loaded) return;
          var i = this._changed;

          if (this._changed) {
            var _e283 = Object.keys(this._updatedLayers),
                _i185 = Object.keys(this._removedLayers);

            (_e283.length || _i185.length) && this._updateWorkerLayers(_e283, _i185);

            for (var _e284 in this._updatedSources) {
              var _t276 = this._updatedSources[_e284];
              "reload" === _t276 ? this._reloadSource(_e284) : "clear" === _t276 && this._clearSource(_e284);
            }

            this._updateTilesForChangedImages();

            for (var _e285 in this._updatedPaintProps) {
              this._layers[_e285].updateTransitions(t);
            }

            this.light.updateTransitions(t), this._resetUpdates();
          }

          var o = {};

          for (var _e286 in this._sourceCaches) {
            var _t277 = this._sourceCaches[_e286];
            o[_e286] = _t277.used, _t277.used = !1;
          }

          for (var _e287 of this._order) {
            var _i186 = this._layers[_e287];

            if (_i186.recalculate(t, this._availableImages), !_i186.isHidden(t.zoom)) {
              var _e288 = this._getLayerSourceCache(_i186);

              _e288 && (_e288.used = !0);
            }

            var _o80 = this.map.painter;

            if (_o80) {
              var _e289 = _i186.getProgramIds();

              if (!_e289) continue;

              var _a109 = _i186.getProgramConfiguration(t.zoom);

              for (var _t278 of _e289) {
                _o80.useProgram(_t278, _a109);
              }
            }
          }

          for (var _t279 in o) {
            var _i187 = this._sourceCaches[_t279];
            o[_t279] !== _i187.used && _i187.getSource().fire(new e.Event("data", {
              sourceDataType: "visibility",
              dataType: "source",
              sourceId: _i187.getSource().id
            }));
          }

          this.light.recalculate(t), this.terrain && this.terrain.recalculate(t), this.z = t.zoom, i && this.fire(new e.Event("data", {
            dataType: "style"
          }));
        }
      }, {
        key: "_updateTilesForChangedImages",
        value: function _updateTilesForChangedImages() {
          var e = Object.keys(this._changedImages);

          if (e.length) {
            for (var _t280 in this._sourceCaches) {
              this._sourceCaches[_t280].reloadTilesForDependencies(["icons", "patterns"], e);
            }

            this._changedImages = {};
          }
        }
      }, {
        key: "_updateWorkerLayers",
        value: function _updateWorkerLayers(e, t) {
          this.dispatcher.broadcast("updateLayers", {
            layers: this._serializeLayers(e),
            removedIds: t
          });
        }
      }, {
        key: "_resetUpdates",
        value: function _resetUpdates() {
          this._changed = !1, this._updatedLayers = {}, this._removedLayers = {}, this._updatedSources = {}, this._updatedPaintProps = {}, this._changedImages = {};
        }
      }, {
        key: "setState",
        value: function setState(t) {
          var _this92 = this;

          if (this._checkLoaded(), Be(this, e.validateStyle(t))) return !1;
          (t = e.clone$1(t)).layers = O(t.layers);

          var i = function (t, i) {
            if (!t) return [{
              command: U.setStyle,
              args: [i]
            }];
            var o = [];

            try {
              if (!e.deepEqual(t.version, i.version)) return [{
                command: U.setStyle,
                args: [i]
              }];
              e.deepEqual(t.center, i.center) || o.push({
                command: U.setCenter,
                args: [i.center]
              }), e.deepEqual(t.zoom, i.zoom) || o.push({
                command: U.setZoom,
                args: [i.zoom]
              }), e.deepEqual(t.bearing, i.bearing) || o.push({
                command: U.setBearing,
                args: [i.bearing]
              }), e.deepEqual(t.pitch, i.pitch) || o.push({
                command: U.setPitch,
                args: [i.pitch]
              }), e.deepEqual(t.sprite, i.sprite) || o.push({
                command: U.setSprite,
                args: [i.sprite]
              }), e.deepEqual(t.glyphs, i.glyphs) || o.push({
                command: U.setGlyphs,
                args: [i.glyphs]
              }), e.deepEqual(t.transition, i.transition) || o.push({
                command: U.setTransition,
                args: [i.transition]
              }), e.deepEqual(t.light, i.light) || o.push({
                command: U.setLight,
                args: [i.light]
              });
              var _a110 = {},
                  _r224 = [];
              !function (t, i, o, a) {
                var r;

                for (r in i = i || {}, t = t || {}) {
                  t.hasOwnProperty(r) && (i.hasOwnProperty(r) || Z(r, o, a));
                }

                for (r in i) {
                  i.hasOwnProperty(r) && (t.hasOwnProperty(r) ? e.deepEqual(t[r], i[r]) || ("geojson" === t[r].type && "geojson" === i[r].type && V(t, i, r) ? o.push({
                    command: U.setGeoJSONSourceData,
                    args: [r, i[r].data]
                  }) : G(r, i, o, a)) : N(r, i, o));
                }
              }(t.sources, i.sources, _r224, _a110);
              var _n133 = [];
              t.layers && t.layers.forEach(function (e) {
                _a110[e.source] ? o.push({
                  command: U.removeLayer,
                  args: [e.id]
                }) : _n133.push(e);
              });
              var _s107 = t.terrain;
              _s107 && _a110[_s107.source] && (o.push({
                command: U.setTerrain,
                args: [void 0]
              }), _s107 = void 0), o = o.concat(_r224), e.deepEqual(_s107, i.terrain) || o.push({
                command: U.setTerrain,
                args: [i.terrain]
              }), function (t, i, o) {
                i = i || [];
                var a = (t = t || []).map(j),
                    r = i.map(j),
                    n = t.reduce($, {}),
                    s = i.reduce($, {}),
                    l = a.slice(),
                    c = Object.create(null);

                var h, u, d, _, m, p, f;

                for (h = 0, u = 0; h < a.length; h++) {
                  d = a[h], s.hasOwnProperty(d) ? u++ : (o.push({
                    command: U.removeLayer,
                    args: [d]
                  }), l.splice(l.indexOf(d, u), 1));
                }

                for (h = 0, u = 0; h < r.length; h++) {
                  d = r[r.length - 1 - h], l[l.length - 1 - h] !== d && (n.hasOwnProperty(d) ? (o.push({
                    command: U.removeLayer,
                    args: [d]
                  }), l.splice(l.lastIndexOf(d, l.length - u), 1)) : u++, p = l[l.length - h], o.push({
                    command: U.addLayer,
                    args: [s[d], p]
                  }), l.splice(l.length - h, 0, d), c[d] = !0);
                }

                for (h = 0; h < r.length; h++) {
                  if (d = r[h], _ = n[d], m = s[d], !c[d] && !e.deepEqual(_, m)) if (e.deepEqual(_.source, m.source) && e.deepEqual(_["source-layer"], m["source-layer"]) && e.deepEqual(_.type, m.type)) {
                    for (f in q(_.layout, m.layout, o, d, null, U.setLayoutProperty), q(_.paint, m.paint, o, d, null, U.setPaintProperty), e.deepEqual(_.filter, m.filter) || o.push({
                      command: U.setFilter,
                      args: [d, m.filter]
                    }), e.deepEqual(_.minzoom, m.minzoom) && e.deepEqual(_.maxzoom, m.maxzoom) || o.push({
                      command: U.setLayerZoomRange,
                      args: [d, m.minzoom, m.maxzoom]
                    }), _) {
                      _.hasOwnProperty(f) && "layout" !== f && "paint" !== f && "filter" !== f && "metadata" !== f && "minzoom" !== f && "maxzoom" !== f && (0 === f.indexOf("paint.") ? q(_[f], m[f], o, d, f.slice(6), U.setPaintProperty) : e.deepEqual(_[f], m[f]) || o.push({
                        command: U.setLayerProperty,
                        args: [d, f, m[f]]
                      }));
                    }

                    for (f in m) {
                      m.hasOwnProperty(f) && !_.hasOwnProperty(f) && "layout" !== f && "paint" !== f && "filter" !== f && "metadata" !== f && "minzoom" !== f && "maxzoom" !== f && (0 === f.indexOf("paint.") ? q(_[f], m[f], o, d, f.slice(6), U.setPaintProperty) : e.deepEqual(_[f], m[f]) || o.push({
                        command: U.setLayerProperty,
                        args: [d, f, m[f]]
                      }));
                    }
                  } else o.push({
                    command: U.removeLayer,
                    args: [d]
                  }), p = l[l.lastIndexOf(d) + 1], o.push({
                    command: U.addLayer,
                    args: [m, p]
                  });
                }
              }(_n133, i.layers, o);
            } catch (e) {
              console.warn("Unable to compute style diff:", e), o = [{
                command: U.setStyle,
                args: [i]
              }];
            }

            return o;
          }(this.serialize(), t).filter(function (e) {
            return !(e.command in Oe);
          });

          if (0 === i.length) return !1;
          var o = i.filter(function (e) {
            return !(e.command in Fe);
          });
          if (o.length > 0) throw new Error("Unimplemented: ".concat(o.map(function (e) {
            return e.command;
          }).join(", "), "."));
          return i.forEach(function (e) {
            "setTransition" !== e.command && _this92[e.command].apply(_this92, e.args);
          }), this.stylesheet = t, !0;
        }
      }, {
        key: "addImage",
        value: function addImage(t, i) {
          if (this.getImage(t)) return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));
          this.imageManager.addImage(t, i), this._afterImageUpdated(t);
        }
      }, {
        key: "updateImage",
        value: function updateImage(e, t) {
          this.imageManager.updateImage(e, t);
        }
      }, {
        key: "getImage",
        value: function getImage(e) {
          return this.imageManager.getImage(e);
        }
      }, {
        key: "removeImage",
        value: function removeImage(t) {
          if (!this.getImage(t)) return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));
          this.imageManager.removeImage(t), this._afterImageUpdated(t);
        }
      }, {
        key: "_afterImageUpdated",
        value: function _afterImageUpdated(t) {
          this._availableImages = this.imageManager.listImages(), this._changedImages[t] = !0, this._changed = !0, this.dispatcher.broadcast("setImages", this._availableImages), this.fire(new e.Event("data", {
            dataType: "style"
          }));
        }
      }, {
        key: "listImages",
        value: function listImages() {
          return this._checkLoaded(), this.imageManager.listImages();
        }
      }, {
        key: "addSource",
        value: function addSource(t, i) {
          var _this93 = this;

          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
          if (this._checkLoaded(), void 0 !== this.getSource(t)) throw new Error("There is already a source with this ID");
          if (!i.type) throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(i).join(", "), "."));
          if (["vector", "raster", "geojson", "video", "image"].indexOf(i.type) >= 0 && this._validate(e.validateStyle.source, "sources.".concat(t), i, null, o)) return;
          this.map && this.map._collectResourceTiming && (i.collectResourceTiming = !0);
          var a = I(t, i, this.dispatcher, this);
          a.setEventedParent(this, function () {
            return {
              isSourceLoaded: _this93.loaded(),
              source: a.serialize(),
              sourceId: t
            };
          });

          var r = function (i) {
            var o = (i ? "symbol:" : "other:") + t,
                r = _this93._sourceCaches[o] = new e.SourceCache(o, a, i);
            (i ? _this93._symbolSourceCaches : _this93._otherSourceCaches)[t] = r, r.style = _this93, r.onAdd(_this93.map);
          };

          r(!1), "vector" !== i.type && "geojson" !== i.type || r(!0), a.onAdd && a.onAdd(this.map), this._changed = !0;
        }
      }, {
        key: "removeSource",
        value: function removeSource(t) {
          this._checkLoaded();

          var i = this.getSource(t);
          if (void 0 === i) throw new Error("There is no source with this ID");

          for (var _i188 in this._layers) {
            if (this._layers[_i188].source === t) return this.fire(new e.ErrorEvent(new Error("Source \"".concat(t, "\" cannot be removed while layer \"").concat(_i188, "\" is using it."))));
          }

          if (this.terrain && this.terrain.get().source === t) return this.fire(new e.ErrorEvent(new Error("Source \"".concat(t, "\" cannot be removed while terrain is using it."))));

          var o = this._getSourceCaches(t);

          for (var _t281 of o) {
            delete this._sourceCaches[_t281.id], delete this._updatedSources[_t281.id], _t281.fire(new e.Event("data", {
              sourceDataType: "metadata",
              dataType: "source",
              sourceId: _t281.getSource().id
            })), _t281.setEventedParent(null), _t281.clearTiles();
          }

          delete this._otherSourceCaches[t], delete this._symbolSourceCaches[t], i.setEventedParent(null), i.onRemove && i.onRemove(this.map), this._changed = !0;
        }
      }, {
        key: "setGeoJSONSourceData",
        value: function setGeoJSONSourceData(e, t) {
          this._checkLoaded(), this.getSource(e).setData(t), this._changed = !0;
        }
      }, {
        key: "getSource",
        value: function getSource(e) {
          var t = this._getSourceCache(e);

          return t && t.getSource();
        }
      }, {
        key: "addLayer",
        value: function addLayer(t, i) {
          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

          this._checkLoaded();

          var a = t.id;
          if (this.getLayer(a)) return void this.fire(new e.ErrorEvent(new Error("Layer with id \"".concat(a, "\" already exists on this map"))));
          var r;

          if ("custom" === t.type) {
            if (Be(this, e.validateCustomStyleLayer(t))) return;
            r = e.createStyleLayer(t);
          } else {
            if ("object" == _typeof(t.source) && (this.addSource(a, t.source), t = e.clone$1(t), t = e.extend(t, {
              source: a
            })), this._validate(e.validateStyle.layer, "layers.".concat(a), t, {
              arrayIndex: -1
            }, o)) return;
            r = e.createStyleLayer(t), this._validateLayer(r), r.setEventedParent(this, {
              layer: {
                id: a
              }
            }), this._serializedLayers[r.id] = r.serialize(), this._updateLayerCount(r, !0);
          }

          var n = i ? this._order.indexOf(i) : this._order.length;
          if (i && -1 === n) return void this.fire(new e.ErrorEvent(new Error("Layer with id \"".concat(i, "\" does not exist on this map."))));
          this._order.splice(n, 0, a), this._layerOrderChanged = !0, this._layers[a] = r;

          var s = this._getLayerSourceCache(r);

          if (this._removedLayers[a] && r.source && s && "custom" !== r.type) {
            var _e290 = this._removedLayers[a];
            delete this._removedLayers[a], _e290.type !== r.type ? this._updatedSources[r.source] = "clear" : (this._updatedSources[r.source] = "reload", s.pause());
          }

          this._updateLayer(r), r.onAdd && r.onAdd(this.map), this._updateDrapeFirstLayers();
        }
      }, {
        key: "moveLayer",
        value: function moveLayer(t, i) {
          if (this._checkLoaded(), this._changed = !0, !this._layers[t]) return void this.fire(new e.ErrorEvent(new Error("The layer '".concat(t, "' does not exist in the map's style and cannot be moved."))));
          if (t === i) return;

          var o = this._order.indexOf(t);

          this._order.splice(o, 1);

          var a = i ? this._order.indexOf(i) : this._order.length;
          i && -1 === a ? this.fire(new e.ErrorEvent(new Error("Layer with id \"".concat(i, "\" does not exist on this map.")))) : (this._order.splice(a, 0, t), this._layerOrderChanged = !0, this._updateDrapeFirstLayers());
        }
      }, {
        key: "removeLayer",
        value: function removeLayer(t) {
          this._checkLoaded();

          var i = this._layers[t];
          if (!i) return void this.fire(new e.ErrorEvent(new Error("The layer '".concat(t, "' does not exist in the map's style and cannot be removed."))));
          i.setEventedParent(null), this._updateLayerCount(i, !1);

          var o = this._order.indexOf(t);

          this._order.splice(o, 1), this._layerOrderChanged = !0, this._changed = !0, this._removedLayers[t] = i, delete this._layers[t], delete this._serializedLayers[t], delete this._updatedLayers[t], delete this._updatedPaintProps[t], i.onRemove && i.onRemove(this.map), this._updateDrapeFirstLayers();
        }
      }, {
        key: "getLayer",
        value: function getLayer(e) {
          return this._layers[e];
        }
      }, {
        key: "hasLayer",
        value: function hasLayer(e) {
          return e in this._layers;
        }
      }, {
        key: "hasLayerType",
        value: function hasLayerType(e) {
          for (var _t282 in this._layers) {
            if (this._layers[_t282].type === e) return !0;
          }

          return !1;
        }
      }, {
        key: "setLayerZoomRange",
        value: function setLayerZoomRange(t, i, o) {
          this._checkLoaded();

          var a = this.getLayer(t);
          a ? a.minzoom === i && a.maxzoom === o || (null != i && (a.minzoom = i), null != o && (a.maxzoom = o), this._updateLayer(a)) : this.fire(new e.ErrorEvent(new Error("The layer '".concat(t, "' does not exist in the map's style and cannot have zoom extent."))));
        }
      }, {
        key: "setFilter",
        value: function setFilter(t, i) {
          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

          this._checkLoaded();

          var a = this.getLayer(t);

          if (a) {
            if (!e.deepEqual(a.filter, i)) return null == i ? (a.filter = void 0, void this._updateLayer(a)) : void (this._validate(e.validateStyle.filter, "layers.".concat(a.id, ".filter"), i, null, o) || (a.filter = e.clone$1(i), this._updateLayer(a)));
          } else this.fire(new e.ErrorEvent(new Error("The layer '".concat(t, "' does not exist in the map's style and cannot be filtered."))));
        }
      }, {
        key: "getFilter",
        value: function getFilter(t) {
          return e.clone$1(this.getLayer(t).filter);
        }
      }, {
        key: "setLayoutProperty",
        value: function setLayoutProperty(t, i, o) {
          var a = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};

          this._checkLoaded();

          var r = this.getLayer(t);
          r ? e.deepEqual(r.getLayoutProperty(i), o) || (r.setLayoutProperty(i, o, a), this._updateLayer(r)) : this.fire(new e.ErrorEvent(new Error("The layer '".concat(t, "' does not exist in the map's style and cannot be styled."))));
        }
      }, {
        key: "getLayoutProperty",
        value: function getLayoutProperty(t, i) {
          var o = this.getLayer(t);
          if (o) return o.getLayoutProperty(i);
          this.fire(new e.ErrorEvent(new Error("The layer '".concat(t, "' does not exist in the map's style."))));
        }
      }, {
        key: "setPaintProperty",
        value: function setPaintProperty(t, i, o) {
          var a = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};

          this._checkLoaded();

          var r = this.getLayer(t);
          r ? e.deepEqual(r.getPaintProperty(i), o) || (r.setPaintProperty(i, o, a) && this._updateLayer(r), this._changed = !0, this._updatedPaintProps[t] = !0) : this.fire(new e.ErrorEvent(new Error("The layer '".concat(t, "' does not exist in the map's style and cannot be styled."))));
        }
      }, {
        key: "getPaintProperty",
        value: function getPaintProperty(e, t) {
          return this.getLayer(e).getPaintProperty(t);
        }
      }, {
        key: "setFeatureState",
        value: function setFeatureState(t, i) {
          this._checkLoaded();

          var o = t.source,
              a = t.sourceLayer,
              r = this.getSource(o);
          if (void 0 === r) return void this.fire(new e.ErrorEvent(new Error("The source '".concat(o, "' does not exist in the map's style."))));
          var n = r.type;
          if ("geojson" === n && a) return void this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));
          if ("vector" === n && !a) return void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
          void 0 === t.id && this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided.")));

          var s = this._getSourceCaches(o);

          for (var _e291 of s) {
            _e291.setFeatureState(a, t.id, i);
          }
        }
      }, {
        key: "removeFeatureState",
        value: function removeFeatureState(t, i) {
          this._checkLoaded();

          var o = t.source,
              a = this.getSource(o);
          if (void 0 === a) return void this.fire(new e.ErrorEvent(new Error("The source '".concat(o, "' does not exist in the map's style."))));
          var r = a.type,
              n = "vector" === r ? t.sourceLayer : void 0;
          if ("vector" === r && !n) return void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
          if (i && "string" != typeof t.id && "number" != typeof t.id) return void this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));

          var s = this._getSourceCaches(o);

          for (var _e292 of s) {
            _e292.removeFeatureState(n, t.id, i);
          }
        }
      }, {
        key: "getFeatureState",
        value: function getFeatureState(t) {
          this._checkLoaded();

          var i = t.source,
              o = t.sourceLayer,
              a = this.getSource(i);

          if (void 0 !== a) {
            if ("vector" !== a.type || o) return void 0 === t.id && this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))), this._getSourceCaches(i)[0].getFeatureState(o, t.id);
            this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
          } else this.fire(new e.ErrorEvent(new Error("The source '".concat(i, "' does not exist in the map's style."))));
        }
      }, {
        key: "getTransition",
        value: function getTransition() {
          return e.extend({
            duration: 300,
            delay: 0
          }, this.stylesheet && this.stylesheet.transition);
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {};

          for (var _e293 in this._sourceCaches) {
            var _i189 = this._sourceCaches[_e293].getSource();

            t[_i189.id] || (t[_i189.id] = _i189.serialize());
          }

          return e.filterObject({
            version: this.stylesheet.version,
            name: this.stylesheet.name,
            metadata: this.stylesheet.metadata,
            light: this.stylesheet.light,
            terrain: this.stylesheet.terrain,
            center: this.stylesheet.center,
            zoom: this.stylesheet.zoom,
            bearing: this.stylesheet.bearing,
            pitch: this.stylesheet.pitch,
            sprite: this.stylesheet.sprite,
            glyphs: this.stylesheet.glyphs,
            transition: this.stylesheet.transition,
            sources: t,
            layers: this._serializeLayers(this._order)
          }, function (e) {
            return void 0 !== e;
          });
        }
      }, {
        key: "_updateLayer",
        value: function _updateLayer(e) {
          this._updatedLayers[e.id] = !0;

          var t = this._getLayerSourceCache(e);

          e.source && !this._updatedSources[e.source] && t && "raster" !== t.getSource().type && (this._updatedSources[e.source] = "reload", t.pause()), this._changed = !0;
        }
      }, {
        key: "_flattenAndSortRenderedFeatures",
        value: function _flattenAndSortRenderedFeatures(e) {
          var _this94 = this;

          var t = function (e) {
            return "fill-extrusion" === _this94._layers[e].type;
          },
              i = {},
              o = [];

          for (var _a111 = this._order.length - 1; _a111 >= 0; _a111--) {
            var _r225 = this._order[_a111];

            if (t(_r225)) {
              i[_r225] = _a111;

              for (var _t283 of e) {
                var _e294 = _t283[_r225];
                if (_e294) for (var _t284 of _e294) {
                  o.push(_t284);
                }
              }
            }
          }

          o.sort(function (e, t) {
            return t.intersectionZ - e.intersectionZ;
          });
          var a = [];

          for (var _r226 = this._order.length - 1; _r226 >= 0; _r226--) {
            var _n134 = this._order[_r226];
            if (t(_n134)) for (var _e295 = o.length - 1; _e295 >= 0; _e295--) {
              var _t285 = o[_e295].feature;
              if (i[_t285.layer.id] < _r226) break;
              a.push(_t285), o.pop();
            } else for (var _t286 of e) {
              var _e296 = _t286[_n134];
              if (_e296) for (var _t287 of _e296) {
                a.push(_t287.feature);
              }
            }
          }

          return a;
        }
      }, {
        key: "queryRenderedFeatures",
        value: function queryRenderedFeatures(t, i, o) {
          var _this95 = this;

          i && i.filter && this._validate(e.validateStyle.filter, "queryRenderedFeatures.filter", i.filter, null, i);
          var a = {};

          if (i && i.layers) {
            if (!Array.isArray(i.layers)) return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))), [];

            for (var _t288 of i.layers) {
              var _i190 = this._layers[_t288];
              if (!_i190) return this.fire(new e.ErrorEvent(new Error("The layer '".concat(_t288, "' does not exist in the map's style and cannot be queried for features.")))), [];
              a[_i190.source] = !0;
            }
          }

          var r = [];
          i.availableImages = this._availableImages;
          var n = i && i.layers ? i.layers.some(function (e) {
            var t = _this95.getLayer(e);

            return t && t.is3D();
          }) : this.has3DLayers(),
              s = x.createFromScreenPoints(t, o);

          for (var _e297 in this._sourceCaches) {
            var _t289 = this._sourceCaches[_e297].getSource().id;

            i.layers && !a[_t289] || r.push(M(this._sourceCaches[_e297], this._layers, this._serializedLayers, s, i, o, n, !!this.map._showQueryGeometry));
          }

          return this.placement && r.push(function (e, t, i, o, a, r, n) {
            var s = {},
                l = r.queryRenderedSymbols(o),
                c = [];

            for (var _e298 of Object.keys(l).map(Number)) {
              c.push(n[_e298]);
            }

            c.sort(A);

            var _loop8 = function (_i191) {
              var o = _i191.featureIndex.lookupSymbolFeatures(l[_i191.bucketInstanceId], t, _i191.bucketIndex, _i191.sourceLayerIndex, a.filter, a.layers, a.availableImages, e);

              for (var _e299 in o) {
                var _t291 = s[_e299] = s[_e299] || [],
                    _a112 = o[_e299];

                _a112.sort(function (e, t) {
                  var o = _i191.featureSortOrder;

                  if (o) {
                    var _i192 = o.indexOf(e.featureIndex);

                    return o.indexOf(t.featureIndex) - _i192;
                  }

                  return t.featureIndex - e.featureIndex;
                });

                for (var _e300 of _a112) {
                  _t291.push(_e300);
                }
              }
            };

            for (var _i191 of c) {
              _loop8(_i191);
            }

            var _loop9 = function (_t290) {
              s[_t290].forEach(function (o) {
                var a = o.feature,
                    r = i(e[_t290]).getFeatureState(a.layer["source-layer"], a.id);
                a.source = a.layer.source, a.layer["source-layer"] && (a.sourceLayer = a.layer["source-layer"]), a.state = r;
              });
            };

            for (var _t290 in s) {
              _loop9(_t290);
            }

            return s;
          }(this._layers, this._serializedLayers, this._getLayerSourceCache.bind(this), s.screenGeometry, i, this.placement.collisionIndex, this.placement.retainedQueryData)), this._flattenAndSortRenderedFeatures(r);
        }
      }, {
        key: "querySourceFeatures",
        value: function querySourceFeatures(t, i) {
          i && i.filter && this._validate(e.validateStyle.filter, "querySourceFeatures.filter", i.filter, null, i);

          var o = this._getSourceCaches(t);

          var a = [];

          for (var _e301 of o) {
            a = a.concat(z(_e301, i));
          }

          return a;
        }
      }, {
        key: "addSourceType",
        value: function addSourceType(e, t, i) {
          return Ze.getSourceType(e) ? i(new Error("A source type called \"".concat(e, "\" already exists."))) : (Ze.setSourceType(e, t), t.workerSourceURL ? void this.dispatcher.broadcast("loadWorkerSource", {
            name: e,
            url: t.workerSourceURL
          }, i) : i(null, null));
        }
      }, {
        key: "getLight",
        value: function getLight() {
          return this.light.getLight();
        }
      }, {
        key: "setLight",
        value: function setLight(t) {
          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

          this._checkLoaded();

          var o = this.light.getLight();
          var a = !1;

          for (var _i193 in t) {
            if (!e.deepEqual(t[_i193], o[_i193])) {
              a = !0;
              break;
            }
          }

          if (!a) return;
          var r = {
            now: e.browser.now(),
            transition: e.extend({
              duration: 300,
              delay: 0
            }, this.stylesheet.transition)
          };
          this.light.setLight(t, i), this.light.updateTransitions(r);
        }
      }, {
        key: "setTerrain",
        value: function setTerrain(t) {
          if (this._checkLoaded(), !t) return delete this.terrain, delete this.stylesheet.terrain, this.dispatcher.broadcast("enableTerrain", !1), void this._force3DLayerUpdate();

          if ("object" == _typeof(t.source)) {
            var _i194 = "terrain-dem-src";
            this.addSource(_i194, t.source), t = e.clone$1(t), t = e.extend(t, {
              source: _i194
            });
          }

          if (!this._validate(e.validateStyle.terrain, "terrain", t)) {
            if (this.terrain) {
              var _i195 = this.terrain,
                  _o81 = _i195.get();

              for (var _a113 in t) {
                if (!e.deepEqual(t[_a113], _o81[_a113])) {
                  _i195.set(t), this.stylesheet.terrain = t;
                  var _o82 = {
                    now: e.browser.now(),
                    transition: e.extend({
                      duration: 0
                    }, this.stylesheet.transition)
                  };

                  _i195.updateTransitions(_o82);

                  break;
                }
              }
            } else this._createTerrain(t);

            this._updateDrapeFirstLayers();
          }
        }
      }, {
        key: "_updateDrapeFirstLayers",
        value: function _updateDrapeFirstLayers() {
          var _this96 = this,
              _this$_drapedFirstOrd,
              _this$_drapedFirstOrd2;

          if (!this.map._optimizeForTerrain || !this.terrain) return;

          var e = this._order.filter(function (e) {
            return _this96.isLayerDraped(_this96._layers[e]);
          }),
              t = this._order.filter(function (e) {
            return !_this96.isLayerDraped(_this96._layers[e]);
          });

          this._drapedFirstOrder = [], (_this$_drapedFirstOrd = this._drapedFirstOrder).push.apply(_this$_drapedFirstOrd, _toConsumableArray(e)), (_this$_drapedFirstOrd2 = this._drapedFirstOrder).push.apply(_this$_drapedFirstOrd2, _toConsumableArray(t));
        }
      }, {
        key: "_createTerrain",
        value: function _createTerrain(t) {
          var i = this.terrain = new p(t);
          this.stylesheet.terrain = t, this.dispatcher.broadcast("enableTerrain", !0), this._force3DLayerUpdate();
          var o = {
            now: e.browser.now(),
            transition: e.extend({
              duration: 0
            }, this.stylesheet.transition)
          };
          i.updateTransitions(o);
        }
      }, {
        key: "_force3DLayerUpdate",
        value: function _force3DLayerUpdate() {
          for (var _e302 in this._layers) {
            var _t292 = this._layers[_e302];
            "fill-extrusion" === _t292.type && this._updateLayer(_t292);
          }
        }
      }, {
        key: "_validate",
        value: function _validate(t, i, o, a) {
          var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
          return (!r || !1 !== r.validate) && Be(this, t.call(e.validateStyle, e.extend({
            key: i,
            style: this.serialize(),
            value: o,
            styleSpec: e.styleSpec
          }, a)));
        }
      }, {
        key: "_remove",
        value: function _remove() {
          this._request && (this._request.cancel(), this._request = null), this._spriteRequest && (this._spriteRequest.cancel(), this._spriteRequest = null), e.evented.off("pluginStateChange", this._rtlTextPluginCallback);

          for (var _e303 in this._layers) {
            this._layers[_e303].setEventedParent(null);
          }

          for (var _e304 in this._sourceCaches) {
            this._sourceCaches[_e304].clearTiles(), this._sourceCaches[_e304].setEventedParent(null);
          }

          this.imageManager.setEventedParent(null), this.setEventedParent(null), this.dispatcher.remove();
        }
      }, {
        key: "_clearSource",
        value: function _clearSource(e) {
          var t = this._getSourceCaches(e);

          for (var _e305 of t) {
            _e305.clearTiles();
          }
        }
      }, {
        key: "_reloadSource",
        value: function _reloadSource(e) {
          var t = this._getSourceCaches(e);

          for (var _e306 of t) {
            _e306.resume(), _e306.reload();
          }
        }
      }, {
        key: "_updateSources",
        value: function _updateSources(e) {
          for (var _t293 in this._sourceCaches) {
            this._sourceCaches[_t293].update(e);
          }
        }
      }, {
        key: "_generateCollisionBoxes",
        value: function _generateCollisionBoxes() {
          for (var _e307 in this._sourceCaches) {
            var _t294 = this._sourceCaches[_e307];
            _t294.resume(), _t294.reload();
          }
        }
      }, {
        key: "_updatePlacement",
        value: function _updatePlacement(t, i, o, a) {
          var _this97 = this;

          var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;
          var n = !1,
              s = !1;
          var l = {};

          for (var _e308 of this._order) {
            var _i196 = this._layers[_e308];
            if ("symbol" !== _i196.type) continue;

            if (!l[_i196.source]) {
              var _ret3 = function () {
                var e = _this97._getLayerSourceCache(_i196);

                if (!e) return "continue";
                l[_i196.source] = e.getRenderableIds(!0).map(function (t) {
                  return e.getTileByID(t);
                }).sort(function (e, t) {
                  return t.tileID.overscaledZ - e.tileID.overscaledZ || (e.tileID.isLessThan(t.tileID) ? -1 : 1);
                });
              }();

              if (_ret3 === "continue") continue;
            }

            var _o83 = this.crossTileSymbolIndex.addLayer(_i196, l[_i196.source], t.center.lng);

            n = n || _o83;
          }

          if (this.crossTileSymbolIndex.pruneUnusedLayers(this._order), r = r || this._layerOrderChanged || 0 === o, this._layerOrderChanged && this.fire(new e.Event("neworder")), (r || !this.pauseablePlacement || this.pauseablePlacement.isDone() && !this.placement.stillRecent(e.browser.now(), t.zoom)) && (this.pauseablePlacement = new ze(t, this._order, r, i, o, a, this.placement), this._layerOrderChanged = !1), this.pauseablePlacement.isDone() ? this.placement.setStale() : (this.pauseablePlacement.continuePlacement(this._order, this._layers, l), this.pauseablePlacement.isDone() && (this.placement = this.pauseablePlacement.commit(e.browser.now()), s = !0), n && this.pauseablePlacement.placement.setStale()), s || n) for (var _e309 of this._order) {
            var _t295 = this._layers[_e309];
            "symbol" === _t295.type && this.placement.updateLayerOpacities(_t295, l[_t295.source]);
          }
          return !this.pauseablePlacement.isDone() || this.placement.hasTransitions(e.browser.now());
        }
      }, {
        key: "_releaseSymbolFadeTiles",
        value: function _releaseSymbolFadeTiles() {
          for (var _e310 in this._sourceCaches) {
            this._sourceCaches[_e310].releaseSymbolFadeTiles();
          }
        }
      }, {
        key: "getImages",
        value: function getImages(e, t, i) {
          this.imageManager.getImages(t.icons, i), this._updateTilesForChangedImages();

          var o = function (e) {
            e && e.setDependencies(t.tileID.key, t.type, t.icons);
          };

          o(this._otherSourceCaches[t.source]), o(this._symbolSourceCaches[t.source]);
        }
      }, {
        key: "getGlyphs",
        value: function getGlyphs(e, t, i) {
          this.glyphManager.getGlyphs(t.stacks, i);
        }
      }, {
        key: "getResource",
        value: function getResource(t, i, o) {
          return e.makeRequest(i, o);
        }
      }, {
        key: "_getSourceCache",
        value: function _getSourceCache(e) {
          return this._otherSourceCaches[e];
        }
      }, {
        key: "_getLayerSourceCache",
        value: function _getLayerSourceCache(e) {
          return "symbol" === e.type ? this._symbolSourceCaches[e.source] : this._otherSourceCaches[e.source];
        }
      }, {
        key: "_getSourceCaches",
        value: function _getSourceCaches(e) {
          var t = [];
          return this._otherSourceCaches[e] && t.push(this._otherSourceCaches[e]), this._symbolSourceCaches[e] && t.push(this._symbolSourceCaches[e]), t;
        }
      }, {
        key: "has3DLayers",
        value: function has3DLayers() {
          return this._num3DLayers > 0;
        }
      }, {
        key: "hasSymbolLayers",
        value: function hasSymbolLayers() {
          return this._numSymbolLayers > 0;
        }
      }, {
        key: "hasCircleLayers",
        value: function hasCircleLayers() {
          return this._numCircleLayers > 0;
        }
      }]);

      return Ze;
    }(e.Evented);

    Ze.getSourceType = function (e) {
      return S[e];
    }, Ze.setSourceType = function (e, t) {
      S[e] = t;
    }, Ze.registerForPluginStateChange = e.registerForPluginStateChange;
    var Ge = "attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";
    var Ve = {};
    Ve = bt("", "\n#define ELEVATION_SCALE 7.3\n#ifdef TERRAIN\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);}float prevElevation(vec2 apos) {float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*word/ELEVATION_SCALE;}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif", !0);

    var qe = bt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nconst float PI=3.141592653589793;", "#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const float PI=3.141592653589793;const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),
        je = bt("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),
        $e = bt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),
        Xe = bt("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),
        We = bt("void main() {gl_FragColor=vec4(1.0);}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),
        He = bt("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}"),
        Ke = bt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),
        Ye = bt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}", "attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=u_matrix*vec4(a_pos,elevation(a_pos),1.0);gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),
        Je = bt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}", "attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),
        Qe = bt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}", "attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),
        et = bt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),
        tt = bt("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),
        it = bt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),
        ot = bt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),
        at = bt("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);gl_Position=mix(u_matrix*vec4(pos_nx.xy,h,1),AWAY,hidden);\n#else\ngl_Position=u_matrix*vec4(pos_nx.xy,t > 0.0 ? height : base,1);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),
        rt = bt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);gl_Position=mix(u_matrix*vec4(pos_nx.xy,h,1),AWAY,hidden);\n#else\ngl_Position=u_matrix*vec4(pos_nx.xy,z,1);\n#endif\nvec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),
        nt = bt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),
        st = bt("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),
        lt = bt("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);}"),
        ct = bt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);}"),
        ht = bt("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),
        ut = bt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),
        dt = bt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),
        _t = bt("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}"),
        mt = bt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),
        pt = bt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),
        ft = bt("uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;const float skirtOffset=24575.0;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);}"),
        gt = bt("#ifdef GL_ES\nprecision highp float;\n#endif\nvec4 pack_depth(float ndc_z) {float depth=ndc_z*0.5+0.5;const vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}", "uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),
        vt = bt("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(vec3(p.xyx)*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract(vec3((p3.x+p3.y)*p3.z,(p3.x+p3.z)*p3.y,(p3.y+p3.z)*p3.x));}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;color.rgb+=rnd/255.0;return color;}float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", Ge),
        xt = bt("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform lowp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(vec3(p.xyx)*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract(vec3((p3.x+p3.y)*p3.z,(p3.x+p3.z)*p3.y,(p3.y+p3.z)*p3.x));}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;color.rgb+=rnd/255.0;return color;}void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5))*u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", Ge),
        yt = bt("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}", "attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}");

    function bt(e, t, i) {
      var o = /#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,
          a = t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),
          r = e.match(/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g),
          n = t.match(/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g);
      var s = n ? n.concat(r) : r;
      i || (s = Ve.staticUniforms.concat(s));
      var l = {};
      return {
        fragmentSource: e = e.replace(o, function (e, t, i, o, a) {
          return l[a] = !0, "define" === t ? "\n#ifndef HAS_UNIFORM_u_".concat(a, "\nvarying ").concat(i, " ").concat(o, " ").concat(a, ";\n#else\nuniform ").concat(i, " ").concat(o, " u_").concat(a, ";\n#endif\n") : "\n#ifdef HAS_UNIFORM_u_".concat(a, "\n    ").concat(i, " ").concat(o, " ").concat(a, " = u_").concat(a, ";\n#endif\n");
        }),
        vertexSource: t = t.replace(o, function (e, t, i, o, a) {
          var r = "float" === o ? "vec2" : "vec4",
              n = a.match(/color/) ? "color" : r;
          return l[a] ? "define" === t ? "\n#ifndef HAS_UNIFORM_u_".concat(a, "\nuniform lowp float u_").concat(a, "_t;\nattribute ").concat(i, " ").concat(r, " a_").concat(a, ";\nvarying ").concat(i, " ").concat(o, " ").concat(a, ";\n#else\nuniform ").concat(i, " ").concat(o, " u_").concat(a, ";\n#endif\n") : "vec4" === n ? "\n#ifndef HAS_UNIFORM_u_".concat(a, "\n    ").concat(a, " = a_").concat(a, ";\n#else\n    ").concat(i, " ").concat(o, " ").concat(a, " = u_").concat(a, ";\n#endif\n") : "\n#ifndef HAS_UNIFORM_u_".concat(a, "\n    ").concat(a, " = unpack_mix_").concat(n, "(a_").concat(a, ", u_").concat(a, "_t);\n#else\n    ").concat(i, " ").concat(o, " ").concat(a, " = u_").concat(a, ";\n#endif\n") : "define" === t ? "\n#ifndef HAS_UNIFORM_u_".concat(a, "\nuniform lowp float u_").concat(a, "_t;\nattribute ").concat(i, " ").concat(r, " a_").concat(a, ";\n#else\nuniform ").concat(i, " ").concat(o, " u_").concat(a, ";\n#endif\n") : "vec4" === n ? "\n#ifndef HAS_UNIFORM_u_".concat(a, "\n    ").concat(i, " ").concat(o, " ").concat(a, " = a_").concat(a, ";\n#else\n    ").concat(i, " ").concat(o, " ").concat(a, " = u_").concat(a, ";\n#endif\n") : "\n#ifndef HAS_UNIFORM_u_".concat(a, "\n    ").concat(i, " ").concat(o, " ").concat(a, " = unpack_mix_").concat(n, "(a_").concat(a, ", u_").concat(a, "_t);\n#else\n    ").concat(i, " ").concat(o, " ").concat(a, " = u_").concat(a, ";\n#endif\n");
        }),
        staticAttributes: a,
        staticUniforms: s
      };
    }

    var wt = Object.freeze({
      __proto__: null,

      get preludeTerrain() {
        return Ve;
      },

      prelude: qe,
      background: je,
      backgroundPattern: $e,
      circle: Xe,
      clippingMask: We,
      heatmap: He,
      heatmapTexture: Ke,
      collisionBox: Ye,
      collisionCircle: Je,
      debug: Qe,
      fill: et,
      fillOutline: tt,
      fillOutlinePattern: it,
      fillPattern: ot,
      fillExtrusion: at,
      fillExtrusionPattern: rt,
      hillshadePrepare: nt,
      hillshade: st,
      line: lt,
      lineGradient: ct,
      linePattern: ht,
      lineSDF: ut,
      raster: dt,
      symbolIcon: _t,
      symbolSDF: mt,
      symbolTextAndIcon: pt,
      terrainRaster: ft,
      terrainDepth: gt,
      skybox: vt,
      skyboxGradient: xt,
      skyboxCapture: yt
    });

    var Tt = /*#__PURE__*/function () {
      function Tt() {
        _classCallCheck(this, Tt);

        this.boundProgram = null, this.boundLayoutVertexBuffer = null, this.boundPaintVertexBuffers = [], this.boundIndexBuffer = null, this.boundVertexOffset = null, this.boundDynamicVertexBuffer = null, this.vao = null;
      }

      _createClass(Tt, [{
        key: "bind",
        value: function bind(e, t, i, o, a, r, n, s) {
          this.context = e;
          var l = this.boundPaintVertexBuffers.length !== o.length;

          for (var _e311 = 0; !l && _e311 < o.length; _e311++) {
            this.boundPaintVertexBuffers[_e311] !== o[_e311] && (l = !0);
          }

          e.extVertexArrayObject && this.vao && this.boundProgram === t && this.boundLayoutVertexBuffer === i && !l && this.boundIndexBuffer === a && this.boundVertexOffset === r && this.boundDynamicVertexBuffer === n && this.boundDynamicVertexBuffer2 === s ? (e.bindVertexArrayOES.set(this.vao), n && n.bind(), a && a.dynamicDraw && a.bind(), s && s.bind()) : this.freshBind(t, i, o, a, r, n, s);
        }
      }, {
        key: "freshBind",
        value: function freshBind(e, t, i, o, a, r, n) {
          var s;
          var l = e.numAttributes,
              c = this.context,
              h = c.gl;
          if (c.extVertexArrayObject) this.vao && this.destroy(), this.vao = c.extVertexArrayObject.createVertexArrayOES(), c.bindVertexArrayOES.set(this.vao), s = 0, this.boundProgram = e, this.boundLayoutVertexBuffer = t, this.boundPaintVertexBuffers = i, this.boundIndexBuffer = o, this.boundVertexOffset = a, this.boundDynamicVertexBuffer = r, this.boundDynamicVertexBuffer2 = n;else {
            s = c.currentNumAttributes || 0;

            for (var _e312 = l; _e312 < s; _e312++) {
              h.disableVertexAttribArray(_e312);
            }
          }
          t.enableAttributes(h, e);

          for (var _t296 of i) {
            _t296.enableAttributes(h, e);
          }

          r && r.enableAttributes(h, e), n && n.enableAttributes(h, e), t.bind(), t.setVertexAttribPointers(h, e, a);

          for (var _t297 of i) {
            _t297.bind(), _t297.setVertexAttribPointers(h, e, a);
          }

          r && (r.bind(), r.setVertexAttribPointers(h, e, a)), o && o.bind(), n && (n.bind(), n.setVertexAttribPointers(h, e, a)), c.currentNumAttributes = l;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.vao && (this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao), this.vao = null);
        }
      }]);

      return Tt;
    }();

    function Et(t, i) {
      var o = Math.pow(2, i.canonical.z),
          a = i.canonical.y;
      return [new e.MercatorCoordinate(0, a / o).toLngLat().lat, new e.MercatorCoordinate(0, (a + 1) / o).toLngLat().lat];
    }

    function Ct(t, i, o, a, r, n, s) {
      var l = t.context,
          c = l.gl,
          h = o.fbo;
      if (!h) return;
      t.prepareDrawTile(i);
      var u = t.useProgram("hillshade");
      l.activeTexture.set(c.TEXTURE0), c.bindTexture(c.TEXTURE_2D, h.colorAttachment.get());

      var d = function (e, t, i, o) {
        var a = i.paint.get("hillshade-shadow-color"),
            r = i.paint.get("hillshade-highlight-color"),
            n = i.paint.get("hillshade-accent-color");
        var s = i.paint.get("hillshade-illumination-direction") * (Math.PI / 180);
        "viewport" === i.paint.get("hillshade-illumination-anchor") && (s -= e.transform.angle);
        var l = !e.options.moving;
        return {
          u_matrix: o || e.transform.calculatePosMatrix(t.tileID.toUnwrapped(), l),
          u_image: 0,
          u_latrange: Et(0, t.tileID),
          u_light: [i.paint.get("hillshade-exaggeration"), s],
          u_shadow: a,
          u_highlight: r,
          u_accent: n
        };
      }(t, o, a, t.terrain ? i.posMatrix : null);

      u.draw(l, c.TRIANGLES, r, n, s, e.CullFaceMode.disabled, d, a.id, t.rasterBoundsBuffer, t.quadTriangleIndexBuffer, t.rasterBoundsSegments);
    }

    function St(t, i, o) {
      if (!i.needsDEMTextureUpload) return;
      var a = t.context,
          r = a.gl;
      a.pixelStoreUnpackPremultiplyAlpha.set(!1), i.demTexture = i.demTexture || t.getTileTexture(o.stride);
      var n = o.getPixels();
      i.demTexture ? i.demTexture.update(n, {
        premultiply: !1
      }) : i.demTexture = new e.Texture(a, n, r.RGBA, {
        premultiply: !1
      }), i.needsDEMTextureUpload = !1;
    }

    function It(t, i, o, a, r, n) {
      var s = t.context,
          l = s.gl;
      if (!i.dem) return;
      var c = i.dem;
      if (s.activeTexture.set(l.TEXTURE1), St(t, i, c), !i.demTexture) return;
      i.demTexture.bind(l.NEAREST, l.CLAMP_TO_EDGE);
      var h = c.dim;
      s.activeTexture.set(l.TEXTURE0);
      var u = i.fbo;

      if (!u) {
        var _t298 = new e.Texture(s, {
          width: h,
          height: h,
          data: null
        }, l.RGBA);

        _t298.bind(l.LINEAR, l.CLAMP_TO_EDGE), u = i.fbo = s.createFramebuffer(h, h, !0), u.colorAttachment.set(_t298.texture);
      }

      s.bindFramebuffer.set(u.framebuffer), s.viewport.set([0, 0, h, h]), t.useProgram("hillshadePrepare").draw(s, l.TRIANGLES, a, r, n, e.CullFaceMode.disabled, function (t, i) {
        var o = i.stride,
            a = e.create();
        return e.ortho(a, 0, e.EXTENT, -e.EXTENT, 0, 0, 1), e.translate(a, a, [0, -e.EXTENT, 0]), {
          u_matrix: a,
          u_image: 1,
          u_dimension: [o, o],
          u_zoom: t.overscaledZ,
          u_unpack: i.unpackVector
        };
      }(i.tileID, c), o.id, t.rasterBoundsBuffer, t.quadTriangleIndexBuffer, t.rasterBoundsSegments), i.needsHillshadePrepare = !1;
    }

    var Pt = function (t, i) {
      return {
        u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
        u_image0: new e.Uniform1i(t, i.u_image0),
        u_skirt_height: new e.Uniform1f(t, i.u_skirt_height)
      };
    },
        Mt = function (e, t) {
      return {
        u_matrix: e,
        u_image0: 0,
        u_skirt_height: t
      };
    },
        zt = new ( /*#__PURE__*/function () {
      function _class18() {
        _classCallCheck(this, _class18);

        this.operations = {};
      }

      _createClass(_class18, [{
        key: "newMorphing",
        value: function newMorphing(e, t, i, o, a) {
          if (e in this.operations) {
            var _t299 = this.operations[e];
            _t299.to.tileID.key !== i.tileID.key && (_t299.queued = i);
          } else this.operations[e] = {
            startTime: o,
            phase: 0,
            duration: a,
            from: t,
            to: i,
            queued: null
          };
        }
      }, {
        key: "getMorphValuesForProxy",
        value: function getMorphValuesForProxy(e) {
          if (!(e in this.operations)) return null;
          var t = this.operations[e];
          return {
            from: t.from,
            to: t.to,
            phase: t.phase
          };
        }
      }, {
        key: "update",
        value: function update(e) {
          for (var _t300 in this.operations) {
            var _i197 = this.operations[_t300];

            for (_i197.phase = (e - _i197.startTime) / _i197.duration; _i197.phase >= 1 || !this._validOp(_i197);) {
              if (!this._nextOp(_i197, e)) {
                delete this.operations[_t300];
                break;
              }
            }
          }
        }
      }, {
        key: "_nextOp",
        value: function _nextOp(e, t) {
          return !!e.queued && (e.from = e.to, e.to = e.queued, e.queued = null, e.phase = 0, e.startTime = t, !0);
        }
      }, {
        key: "_validOp",
        value: function _validOp(e) {
          return e.from.hasData() && e.to.hasData();
        }
      }]);

      return _class18;
    }())(),
        At = {
      0: null,
      1: "TERRAIN_VERTEX_MORPHING"
    };

    function Dt(t, i, o, a, r) {
      var n = t.context,
          s = n.gl;
      var l = t.useProgram("terrainRaster"),
          c = 0;
      var h = t.colorModeForRenderPass(),
          u = new e.DepthMode(s.LEQUAL, e.DepthMode.ReadWrite, t.depthRangeFor3D);
      zt.update(r);

      var d = t.transform,
          _ = 6 * Math.pow(1.5, 22 - d.zoom) * i.exaggeration();

      var m, p, f;

      for (var _g14 of a) {
        var _a114 = o.getTile(_g14),
            _v12 = e.StencilMode.disabled,
            _x10 = i.prevTerrainTileForTile[_g14.key],
            _y12 = i.terrainTileForTile[_g14.key];

        f = _y12, null != (p = _x10) && null != f && p.hasData() && f.hasData() && null != p.demTexture && null != f.demTexture && p.tileID.key !== f.tileID.key && zt.newMorphing(_g14.key, _x10, _y12, r, 250), n.activeTexture.set(s.TEXTURE0), _a114.texture.bind(s.LINEAR, s.CLAMP_TO_EDGE, s.LINEAR_MIPMAP_NEAREST);

        var _b11 = zt.getMorphValuesForProxy(_g14.key),
            _w9 = _b11 ? 1 : 0;

        var _T5 = void 0;

        _b11 && (_T5 = {
          morphing: {
            srcDemTile: _b11.from,
            dstDemTile: _b11.to,
            phase: e.easeCubicInOut(_b11.phase)
          }
        });

        var _E3 = Mt(_g14.posMatrix, Lt(_g14.canonical, d.renderWorldCopies) ? _ / 10 : _);

        c !== (m = _w9) && (l = t.useProgram("terrainRaster", null, At[m]), c = m), i.setupElevationDraw(_a114, l, _T5), l.draw(n, s.TRIANGLES, u, _v12, h, e.CullFaceMode.backCCW, _E3, "terrain_raster", i.gridBuffer, i.gridIndexBuffer, i.gridSegments);
      }
    }

    function Lt(e, t) {
      var i = 1 << e.z;
      return !t && (0 === e.x || e.x === i - 1) || 0 === e.y || e.y === i - 1;
    }

    var Rt = function (e) {
      return {
        u_matrix: e
      };
    };

    function kt(t, i, o, a, r) {
      if (r > 0) {
        var _n135 = e.browser.now(),
            _s108 = (_n135 - t.timeAdded) / r,
            _l45 = i ? (_n135 - i.timeAdded) / r : -1,
            _c32 = o.getSource(),
            _h25 = a.coveringZoomLevel({
          tileSize: _c32.tileSize,
          roundZoom: _c32.roundZoom
        }),
            _u38 = !i || Math.abs(i.tileID.overscaledZ - _h25) > Math.abs(t.tileID.overscaledZ - _h25),
            _d16 = _u38 && t.refreshedUponExpiration ? 1 : e.clamp(_u38 ? _s108 : 1 - _l45, 0, 1);

        return t.refreshedUponExpiration && _s108 >= 1 && (t.refreshedUponExpiration = !1), i ? {
          opacity: 1,
          mix: 1 - _d16
        } : {
          opacity: _d16,
          mix: 0
        };
      }

      return {
        opacity: 1,
        mix: 0
      };
    }

    var Bt = /*#__PURE__*/function (_e$SourceCache) {
      _inherits(Bt, _e$SourceCache);

      var _super113 = _createSuper(Bt);

      function Bt(e) {
        var _this98;

        _classCallCheck(this, Bt);

        var t = I("proxy", {
          type: "geojson",
          maxzoom: e.transform.maxZoom
        }, new g(B(), null), e.style);
        _this98 = _super113.call(this, "proxy", t, !1), t.setEventedParent(_assertThisInitialized(_this98)), _this98.map = _this98.getSource().map = e, _this98.used = _this98._sourceLoaded = !0, _this98.renderCache = [], _this98.renderCachePool = [], _this98.proxyCachedFBO = {};
        return _this98;
      }

      _createClass(Bt, [{
        key: "update",
        value: function update(t, i, o) {
          var _this99 = this;

          if (t.freezeTileCoverage) return;
          this.transform = t;
          var a = t.coveringTiles({
            tileSize: this._source.tileSize,
            minzoom: this._source.minzoom,
            maxzoom: this._source.maxzoom,
            roundZoom: this._source.roundZoom,
            reparseOverscaled: this._source.reparseOverscaled,
            useElevationData: !0
          }).reduce(function (i, o) {
            if (i[o.key] = "", !_this99._tiles[o.key]) {
              var _i198 = new e.Tile(o, _this99._source.tileSize * o.overscaleFactor(), t.tileZoom);

              _i198.state = "loaded", _this99._tiles[o.key] = _i198;
            }

            return i;
          }, {});

          for (var _e313 in this._tiles) {
            _e313 in a || (this.freeFBO(_e313), this._tiles[_e313].state = "unloaded", delete this._tiles[_e313]);
          }
        }
      }, {
        key: "freeFBO",
        value: function freeFBO(e) {
          var t = this.proxyCachedFBO[e];

          if (void 0 !== t) {
            var _this$renderCachePool;

            var _i199 = Object.values(t);

            (_this$renderCachePool = this.renderCachePool).push.apply(_this$renderCachePool, _toConsumableArray(_i199)), delete this.proxyCachedFBO[e];
          }
        }
      }, {
        key: "deallocRenderCache",
        value: function deallocRenderCache() {
          this.renderCache.forEach(function (e) {
            return e.fb.destroy();
          }), this.renderCache = [], this.renderCachePool = [], this.proxyCachedFBO = {};
        }
      }]);

      return Bt;
    }(e.SourceCache);

    var Ft = /*#__PURE__*/function (_e$OverscaledTileID) {
      _inherits(Ft, _e$OverscaledTileID);

      var _super114 = _createSuper(Ft);

      function Ft(e, t, i) {
        var _this100;

        _classCallCheck(this, Ft);

        _this100 = _super114.call(this, e.overscaledZ, e.wrap, e.canonical.z, e.canonical.x, e.canonical.y), _this100.proxyTileKey = t, _this100.posMatrix = i;
        return _this100;
      }

      return Ft;
    }(e.OverscaledTileID);

    var Ot = /*#__PURE__*/function (_e$Elevation) {
      _inherits(Ot, _e$Elevation);

      var _super115 = _createSuper(Ot);

      function Ot(t, i) {
        var _this101;

        _classCallCheck(this, Ot);

        _this101 = _super115.call(this), _this101.painter = t, _this101.terrainTileForTile = {}, _this101.prevTerrainTileForTile = {};

        var [o, a, r] = function (t) {
          var i = new e.StructArrayLayout4i8(),
              o = new e.StructArrayLayout3ui6();
          i.reserve(17161), o.reserve(33800);
          var a = e.EXTENT / 128,
              r = e.EXTENT + a / 2,
              n = r + a;

          for (var _t301 = -a; _t301 < n; _t301 += a) {
            for (var _o84 = -a; _o84 < n; _o84 += a) {
              var _a115 = _o84 < 0 || _o84 > r || _t301 < 0 || _t301 > r ? 24575 : 0,
                  _n136 = e.clamp(Math.round(_o84), 0, e.EXTENT),
                  _s109 = e.clamp(Math.round(_t301), 0, e.EXTENT);

              i.emplaceBack(_n136 + _a115, _s109, _n136, _s109);
            }
          }

          var s = function (e, t) {
            var i = 131 * t + e;
            o.emplaceBack(i + 1, i, i + 131), o.emplaceBack(i + 131, i + 131 + 1, i + 1);
          };

          for (var _e314 = 1; _e314 < 129; _e314++) {
            for (var _t302 = 1; _t302 < 129; _t302++) {
              s(_t302, _e314);
            }
          }

          return [0, 129].forEach(function (e) {
            for (var _t303 = 0; _t303 < 130; _t303++) {
              s(_t303, e), s(e, _t303);
            }
          }), [i, o, 32768];
        }(),
            n = t.context;

        _this101.gridBuffer = n.createVertexBuffer(o, E.members), _this101.gridIndexBuffer = n.createIndexBuffer(a), _this101.gridSegments = e.SegmentVector.simpleSegment(0, 0, o.length, a.length), _this101.gridNoSkirtSegments = e.SegmentVector.simpleSegment(0, 0, o.length, r), _this101.proxyCoords = [], _this101.proxiedCoords = {}, _this101._visibleDemTiles = [], _this101._drapedRenderBatches = [], _this101._sourceTilesOverlap = {}, _this101.proxySourceCache = new Bt(i.map), _this101.orthoMatrix = e.create(), e.ortho(_this101.orthoMatrix, 0, e.EXTENT, 0, e.EXTENT, 0, 1);
        var s = n.gl;
        _this101._overlapStencilMode = new e.StencilMode({
          func: s.GEQUAL,
          mask: 255
        }, 0, 255, s.KEEP, s.KEEP, s.REPLACE), _this101._previousZoom = t.transform.zoom, _this101.pool = [], _this101._findCoveringTileCache = {}, _this101._tilesDirty = {}, _this101.style = i, _this101._useVertexMorphing = !0;
        return _this101;
      }

      _createClass(Ot, [{
        key: "style",
        set: function (e) {
          e.on("data", this._onStyleDataEvent.bind(this)), e.on("neworder", this._checkRenderCacheEfficiency.bind(this)), this._style = e, this._checkRenderCacheEfficiency();
        }
      }, {
        key: "update",
        value: function update(t, i, o) {
          var _this102 = this;

          if (t && t.terrain) {
            this._style !== t && (this.style = t), this.enabled = !0;
            var _a116 = t.terrain.properties;
            this.sourceCache = t._getSourceCache(_a116.get("source")), this._exaggeration = _a116.get("exaggeration");

            var _r227 = function () {
              _this102.sourceCache.used && e.warnOnce("Raster DEM source '".concat(_this102.sourceCache.id, "' is used both for terrain and as layer source.\n") + "This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.");

              var t = _this102.sourceCache.getSource().tileSize / 128,
                  o = _this102.proxySourceCache.getSource().tileSize;

              _this102.sourceCache.update(i, t * o, !0), _this102._findCoveringTileCache[_this102.sourceCache.id] = {};
            };

            this.sourceCache.usedForTerrain || (this._findCoveringTileCache[this.sourceCache.id] = {}, this.sourceCache.usedForTerrain = !0, _r227(), this._initializing = !0), _r227(), i.updateElevation(!o), this._findCoveringTileCache[this.proxySourceCache.id] = {}, this.proxySourceCache.update(i), this._emptyDEMTextureDirty = !0;
          } else this._disable();
        }
      }, {
        key: "_checkRenderCacheEfficiency",
        value: function _checkRenderCacheEfficiency() {
          var t = this.renderCacheEfficiency(this._style);
          this._style.map._optimizeForTerrain || 100 !== t.efficiency && e.warnOnce("Terrain render cache efficiency is not optimal (".concat(t.efficiency, "%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '").concat(t.firstUndrapedLayer, "' or create a map using optimizeForTerrain: true option."));
        }
      }, {
        key: "_onStyleDataEvent",
        value: function _onStyleDataEvent(e) {
          e.coord && "source" === e.dataType ? this._clearRenderCacheForTile(e.sourceCacheId, e.coord) : "style" === e.dataType && (this._invalidateRenderCache = !0);
        }
      }, {
        key: "_disable",
        value: function _disable() {
          if (this.enabled && (this.enabled = !1, this.proxySourceCache.deallocRenderCache(), this._style)) for (var _e315 in this._style._sourceCaches) {
            this._style._sourceCaches[_e315].usedForTerrain = !1;
          }
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this._disable(), this._emptyDEMTexture && this._emptyDEMTexture.destroy(), this.pool.forEach(function (e) {
            return e.fb.destroy();
          }), this.pool = [], this._depthFBO && (this._depthFBO.destroy(), delete this._depthFBO, delete this._depthTexture);
        }
      }, {
        key: "_source",
        value: function _source() {
          return this.enabled ? this.sourceCache : null;
        }
      }, {
        key: "exaggeration",
        value: function exaggeration() {
          return this._exaggeration;
        }
      }, {
        key: "visibleDemTiles",
        get: function () {
          return this._visibleDemTiles;
        }
      }, {
        key: "drapeBufferSize",
        get: function () {
          var e = 2 * this.proxySourceCache.getSource().tileSize;
          return [e, e];
        }
      }, {
        key: "useVertexMorphing",
        set: function (e) {
          this._useVertexMorphing = e;
        }
      }, {
        key: "updateTileBinding",
        value: function updateTileBinding(t) {
          var _this103 = this;

          if (!this.enabled) return;
          this.prevTerrainTileForTile = this.terrainTileForTile;
          var i = this.proxySourceCache,
              o = this.painter.transform;
          this._initializing && (this._initializing = 0 === o._centerAltitude && -1 === this.getAtPoint(e.MercatorCoordinate.fromLngLat(o.center), -1), this._emptyDEMTextureDirty = !this._initializing);
          var a = this.painter.options;
          this.renderCached = (a.zooming || a.moving || a.rotating || !!this.forceRenderCached) && !this._invalidateRenderCache, this._invalidateRenderCache = !1;
          var r = this.proxyCoords = i.getIds().map(function (e) {
            var t = i.getTileByID(e).tileID;
            return t.posMatrix = o.calculatePosMatrix(t.toUnwrapped()), t;
          });
          !function (t, i) {
            var o = i.transform.pointCoordinate(i.transform.getCameraPoint()),
                a = new e.Point(o.x, o.y);
            t.sort(function (t, i) {
              if (i.overscaledZ - t.overscaledZ) return i.overscaledZ - t.overscaledZ;
              var o = new e.Point(t.canonical.x + (1 << t.canonical.z) * t.wrap, t.canonical.y),
                  r = new e.Point(i.canonical.x + (1 << i.canonical.z) * i.wrap, i.canonical.y),
                  n = a.mult(1 << t.canonical.z);
              return n.x -= .5, n.y -= .5, n.distSqr(o) - n.distSqr(r);
            });
          }(r, this.painter), this._previousZoom = o.zoom;
          var n = this.proxyToSource || {};
          this.proxyToSource = {}, r.forEach(function (e) {
            _this103.proxyToSource[e.key] = {};
          }), this.terrainTileForTile = {};
          var s = this._style._sourceCaches;

          for (var _e316 in s) {
            var _i200 = s[_e316];
            if (!_i200.used) continue;
            if (_i200 !== this.sourceCache && (this._findCoveringTileCache[_i200.id] = {}), this._setupProxiedCoordsForOrtho(_i200, t[_e316], n), _i200.usedForTerrain) continue;
            var _o85 = t[_e316];
            _i200.getSource().reparseOverscaled && this._assignTerrainTiles(_o85);
          }

          this.proxiedCoords[i.id] = r.map(function (e) {
            return new Ft(e, e.key, _this103.orthoMatrix);
          }), this._assignTerrainTiles(r), this._prepareDEMTextures(), this._setupDrapedRenderBatches(), this._setupRenderCache(n), this.renderingToTexture = !1, this._initFBOPool(), this._updateTimestamp = e.browser.now();
          var l = {};
          this._visibleDemTiles = [];

          for (var _e317 of this.proxyCoords) {
            var _t304 = this.terrainTileForTile[_e317.key];
            if (!_t304) continue;
            var _i201 = _t304.tileID.key;
            _i201 in l || (this._visibleDemTiles.push(_t304), l[_i201] = _i201);
          }
        }
      }, {
        key: "_assignTerrainTiles",
        value: function _assignTerrainTiles(e) {
          var _this104 = this;

          this._initializing || e.forEach(function (e) {
            if (_this104.terrainTileForTile[e.key]) return;

            var t = _this104._findTileCoveringTileID(e, _this104.sourceCache);

            t && (_this104.terrainTileForTile[e.key] = t);
          });
        }
      }, {
        key: "_prepareDEMTextures",
        value: function _prepareDEMTextures() {
          var e = this.painter.context,
              t = e.gl;

          for (var _i202 in this.terrainTileForTile) {
            var _o86 = this.terrainTileForTile[_i202],
                _a117 = _o86.dem;
            !_a117 || _o86.demTexture && !_o86.needsDEMTextureUpload || (e.activeTexture.set(t.TEXTURE1), St(this.painter, _o86, _a117));
          }
        }
      }, {
        key: "_prepareDemTileUniforms",
        value: function _prepareDemTileUniforms(e, t, i, o) {
          if (!t || null == t.demTexture) return !1;
          var a = e.tileID.canonical,
              r = Math.pow(2, t.tileID.canonical.z - a.z),
              n = o || "";
          return i["u_dem_tl".concat(n)] = [a.x * r % 1, a.y * r % 1], i["u_dem_scale".concat(n)] = r, !0;
        }
      }, {
        key: "emptyDEMTexture",
        get: function () {
          return !this._emptyDEMTextureDirty && this._emptyDEMTexture ? this._emptyDEMTexture : this._updateEmptyDEMTexture();
        }
      }, {
        key: "_getLoadedAreaMinimum",
        value: function _getLoadedAreaMinimum() {
          var e = 0;

          var t = this._visibleDemTiles.reduce(function (t, i) {
            if (!i.dem) return t;
            var o = i.dem.tree.minimums[0];
            return o > 0 && e++, t + o;
          }, 0);

          return e ? t / e : 0;
        }
      }, {
        key: "_updateEmptyDEMTexture",
        value: function _updateEmptyDEMTexture() {
          var t = this.painter.context,
              i = t.gl;
          t.activeTexture.set(i.TEXTURE2);

          var o = this._getLoadedAreaMinimum(),
              a = {
            width: 1,
            height: 1,
            data: new Uint8Array(e.DEMData.pack(o, this.sourceCache.getSource().encoding))
          };

          this._emptyDEMTextureDirty = !1;
          var r = this._emptyDEMTexture;
          return r ? r.update(a, {
            premultiply: !1
          }) : r = this._emptyDEMTexture = new e.Texture(t, a, i.RGBA, {
            premultiply: !1
          }), r;
        }
      }, {
        key: "setupElevationDraw",
        value: function setupElevationDraw(t, i, o) {
          var a = this.painter.context,
              r = a.gl,
              n = (s = this.sourceCache.getSource().encoding, {
            u_dem: 2,
            u_dem_prev: 4,
            u_dem_unpack: e.DEMData.getUnpackVector(s),
            u_dem_tl: [0, 0],
            u_dem_tl_prev: [0, 0],
            u_dem_scale: 0,
            u_dem_scale_prev: 0,
            u_dem_size: 0,
            u_dem_lerp: 1,
            u_depth: 3,
            u_depth_size_inv: [0, 0],
            u_exaggeration: 0
          });
          var s;
          n.u_dem_size = this.sourceCache.getSource().tileSize, n.u_exaggeration = this.exaggeration();
          var l = null,
              c = null,
              h = 1;

          if (o && o.morphing && this._useVertexMorphing) {
            var _e318 = o.morphing.srcDemTile,
                _i203 = o.morphing.dstDemTile;
            h = o.morphing.phase, _e318 && _i203 && (this._prepareDemTileUniforms(t, _e318, n, "_prev") && (c = _e318), this._prepareDemTileUniforms(t, _i203, n) && (l = _i203));
          }

          if (c && l ? (a.activeTexture.set(r.TEXTURE2), l.demTexture.bind(r.NEAREST, r.CLAMP_TO_EDGE, r.NEAREST), a.activeTexture.set(r.TEXTURE4), c.demTexture.bind(r.NEAREST, r.CLAMP_TO_EDGE, r.NEAREST), n.u_dem_lerp = h) : (l = this.terrainTileForTile[t.tileID.key], a.activeTexture.set(r.TEXTURE2), (this._prepareDemTileUniforms(t, l, n) ? l.demTexture : this.emptyDEMTexture).bind(r.NEAREST, r.CLAMP_TO_EDGE, r.NEAREST)), o && o.useDepthForOcclusion && (a.activeTexture.set(r.TEXTURE3), this._depthTexture.bind(r.NEAREST, r.CLAMP_TO_EDGE, r.NEAREST), n.u_depth_size_inv = [1 / this._depthFBO.width, 1 / this._depthFBO.height]), o && o.useMeterToDem && l) {
            var _t305 = (1 << l.tileID.canonical.z) * e.mercatorZfromAltitude(1, this.painter.transform.center.lat) * this.sourceCache.getSource().tileSize;

            n.u_meter_to_dem = _t305;
          }

          o && o.labelPlaneMatrixInv && (n.u_label_plane_matrix_inv = o.labelPlaneMatrixInv), i.setTerrainUniformValues(a, n);
        }
      }, {
        key: "renderBatch",
        value: function renderBatch(t) {
          var _this105 = this;

          if (0 === this._drapedRenderBatches.length) return t + 1;
          this.renderingToTexture = !0;

          var i = this.painter,
              o = this.painter.context,
              a = this.proxySourceCache,
              r = this.proxiedCoords[a.id],
              n = function () {
            o.bindFramebuffer.set(null), o.viewport.set([0, 0, i.width, i.height]), _this105.renderingToTexture = !1;
          },
              s = this._drapedRenderBatches.shift();

          var l = [];
          var c = i.style.order;
          var h = 0;

          for (var _u39 = 0; _u39 < r.length; _u39++) {
            var _d17 = r[_u39],
                _12 = a.getTileByID(_d17.proxyTileKey),
                _m15 = a.proxyCachedFBO[_d17.key] ? a.proxyCachedFBO[_d17.key][t] : void 0;

            var _p17 = void 0,
                _f14 = void 0;

            if (_p17 = this.currentFBO = void 0 !== _m15 ? a.renderCache[_m15] : this.pool[h++], _12.texture = _p17.tex, void 0 === _m15 || _p17.dirty) {
              o.bindFramebuffer.set(_p17.fb.framebuffer), this.renderedToTile = !1, _p17.dirty && (o.clear({
                color: e.Color.transparent
              }), _p17.dirty = !1);

              for (var _e319 = s.start; _e319 <= s.end; ++_e319) {
                var _t306 = i.style._layers[c[_e319]];
                if (_t306.isHidden(i.transform.zoom)) continue;

                var _a118 = i.style._getLayerSourceCache(_t306),
                    _r228 = _a118 ? this.proxyToSource[_d17.key][_a118.id] : [_d17];

                if (!_r228) continue;
                var _n137 = _r228;
                o.viewport.set([0, 0, _p17.fb.width, _p17.fb.height]), _f14 !== (_a118 ? _a118.id : null) && (this._setupStencil(_r228, _t306, _a118), _f14 = _a118 ? _a118.id : null), i.renderLayer(i, _a118, _t306, _n137);
              }

              _p17.dirty = this.renderedToTile, this.renderedToTile && l.push(_12.tileID), 5 === h && (h = 0, l.length > 0 && (n(), Dt(i, this, a, l, this._updateTimestamp), this.renderingToTexture = !0, l = []));
            } else l.push(_12.tileID);
          }

          return n(), l.length > 0 && Dt(i, this, a, l, this._updateTimestamp), s.end + 1;
        }
      }, {
        key: "postRender",
        value: function postRender() {}
      }, {
        key: "renderCacheEfficiency",
        value: function renderCacheEfficiency(e) {
          var t = e.order.length;
          if (0 === t) return {
            efficiency: 100
          };
          var i,
              o = 0,
              a = 0,
              r = !1;

          for (var _n138 = 0; _n138 < t; ++_n138) {
            var _t307 = e._layers[e.order[_n138]];
            this._style.isLayerDraped(_t307) ? (r && ++o, ++a) : r || (r = !0, i = _t307.id);
          }

          return 0 === a ? {
            efficiency: 100
          } : {
            efficiency: 100 * (1 - o / a),
            firstUndrapedLayer: i
          };
        }
      }, {
        key: "raycast",
        value: function raycast(e, t, i) {
          if (!this._visibleDemTiles) return null;

          var o = this._visibleDemTiles.filter(function (e) {
            return e.dem;
          }).map(function (o) {
            var a = o.tileID,
                r = Math.pow(2, a.overscaledZ),
                {
              x: n,
              y: s
            } = a.canonical,
                l = n / r,
                c = (n + 1) / r,
                h = s / r,
                u = (s + 1) / r;
            return {
              minx: l,
              miny: h,
              maxx: c,
              maxy: u,
              t: o.dem.tree.raycastRoot(l, h, c, u, e, t, i),
              tile: o
            };
          });

          o.sort(function (e, t) {
            return (null !== e.t ? e.t : Number.MAX_VALUE) - (null !== t.t ? t.t : Number.MAX_VALUE);
          });

          for (var _a119 of o) {
            if (null == _a119.t) return null;

            var _o87 = _a119.tile.dem.tree.raycast(_a119.minx, _a119.miny, _a119.maxx, _a119.maxy, e, t, i);

            if (null != _o87) return _o87;
          }

          return null;
        }
      }, {
        key: "_createFBO",
        value: function _createFBO() {
          var t = this.painter.context,
              i = t.gl,
              o = this.drapeBufferSize;
          t.activeTexture.set(i.TEXTURE0);
          var a = new e.Texture(t, {
            width: o[0],
            height: o[1],
            data: null
          }, i.RGBA);
          a.bind(i.LINEAR, i.CLAMP_TO_EDGE);
          var r = t.createFramebuffer(o[0], o[1], !1);
          return r.colorAttachment.set(a.texture), t.extTextureFilterAnisotropic && !t.extTextureFilterAnisotropicForceOff && i.texParameterf(i.TEXTURE_2D, t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, t.extTextureFilterAnisotropicMax), {
            fb: r,
            tex: a,
            dirty: !1,
            ref: 1
          };
        }
      }, {
        key: "_initFBOPool",
        value: function _initFBOPool() {
          for (; this.pool.length < Math.min(5, this.proxyCoords.length);) {
            this.pool.push(this._createFBO());
          }
        }
      }, {
        key: "_shouldDisableRenderCache",
        value: function _shouldDisableRenderCache() {
          var _this106 = this;

          return !this.renderCached || this._style.order.some(function (e) {
            var t = _this106._style._layers[e],
                i = !t.isHidden(_this106.painter.transform.zoom),
                o = t.getCrossfadeParameters();
            return "custom" !== t.type && !i && !!o && 1 !== o.t;
          });
        }
      }, {
        key: "_clearRasterFadeFromRenderCache",
        value: function _clearRasterFadeFromRenderCache() {
          var e = !1;

          for (var _t308 in this._style._sourceCaches) {
            if (this._style._sourceCaches[_t308]._source instanceof T) {
              e = !0;
              break;
            }
          }

          if (e) for (var _e320 = 0; _e320 < this._style.order.length; ++_e320) {
            var _t309 = this._style._layers[this._style.order[_e320]],
                _i204 = _t309.isHidden(this.painter.transform.zoom),
                _o88 = this._style._getLayerSourceCache(_t309);

            if ("raster" !== _t309.type || _i204 || !_o88) continue;

            var _a120 = _t309.paint.get("raster-fade-duration");

            for (var _e321 of this.proxyCoords) {
              var _t310 = this.proxyToSource[_e321.key][_o88.id];
              if (_t310) for (var _e322 of _t310) {
                var _t311 = kt(_o88.getTile(_e322), _o88.findLoadedParent(_e322, 0), _o88, this.painter.transform, _a120);

                (1 !== _t311.opacity || 0 !== _t311.mix) && this._clearRenderCacheForTile(_o88.id, _e322);
              }
            }
          }
        }
      }, {
        key: "_setupDrapedRenderBatches",
        value: function _setupDrapedRenderBatches() {
          var e = this._style.order,
              t = e.length;
          if (0 === t) return;
          var i = [];
          var o,
              a = 0,
              r = this._style._layers[e[a]];

          for (; !this._style.isLayerDraped(r) && r.isHidden(this.painter.transform.zoom) && ++a < t;) {
            r = this._style._layers[e[a]];
          }

          for (; a < t; ++a) {
            var _t312 = this._style._layers[e[a]];
            _t312.isHidden(this.painter.transform.zoom) || (this._style.isLayerDraped(_t312) ? void 0 === o && (o = a) : void 0 !== o && (i.push({
              start: o,
              end: a - 1
            }), o = void 0));
          }

          void 0 !== o && i.push({
            start: o,
            end: a - 1
          }), this._drapedRenderBatches = i;
        }
      }, {
        key: "_setupRenderCache",
        value: function _setupRenderCache(e) {
          var t = this.proxySourceCache;

          if (this._shouldDisableRenderCache()) {
            if (t.renderCache.length > t.renderCachePool.length) {
              var _e323 = Object.values(t.proxyCachedFBO);

              t.proxyCachedFBO = {};

              for (var _i205 = 0; _i205 < _e323.length; ++_i205) {
                var _t$renderCachePool;

                var _o89 = Object.values(_e323[_i205]);

                (_t$renderCachePool = t.renderCachePool).push.apply(_t$renderCachePool, _toConsumableArray(_o89));
              }
            }

            return;
          }

          this._clearRasterFadeFromRenderCache();

          var i = this.proxyCoords,
              o = this._tilesDirty;

          for (var _a121 = i.length - 1; _a121 >= 0; _a121--) {
            var _r229 = i[_a121];

            if (t.getTileByID(_r229.key), void 0 !== t.proxyCachedFBO[_r229.key]) {
              var _i206 = e[_r229.key],
                  _a122 = this.proxyToSource[_r229.key];
              var _n139 = 0;

              var _loop10 = function (_e324) {
                var t = _a122[_e324],
                    r = _i206[_e324];

                if (!r || r.length !== t.length || t.some(function (t, i) {
                  return t !== r[i] || o[_e324] && o[_e324].hasOwnProperty(t.key);
                })) {
                  _n139 = -1;
                  return "break";
                }

                ++_n139;
              };

              for (var _e324 in _a122) {
                var _ret4 = _loop10(_e324);

                if (_ret4 === "break") break;
              }

              for (var _e325 in t.proxyCachedFBO[_r229.key]) {
                t.renderCache[t.proxyCachedFBO[_r229.key][_e325]].dirty = _n139 < 0 || _n139 !== Object.values(_i206).length;
              }
            } else for (var _e326 = 0; _e326 < this._drapedRenderBatches.length; ++_e326) {
              var _i207 = this._drapedRenderBatches[_e326];

              var _o90 = t.renderCachePool.pop();

              void 0 === _o90 && t.renderCache.length < 50 && (_o90 = t.renderCache.length, t.renderCache.push(this._createFBO())), void 0 !== _o90 && (void 0 === t.proxyCachedFBO[_r229.key] && (t.proxyCachedFBO[_r229.key] = {}), t.proxyCachedFBO[_r229.key][_i207.start] = _o90, t.renderCache[_o90].dirty = !0);
            }
          }

          this._tilesDirty = {};
        }
      }, {
        key: "_setupStencil",
        value: function _setupStencil(t, i, o) {
          if (!o || !this._sourceTilesOverlap[o.id]) return void (this._overlapStencilType && (this._overlapStencilType = !1));
          var a = this.painter.context,
              r = a.gl;
          if (t.length <= 1) return void (this._overlapStencilType = !1);
          var n = this.currentFBO,
              s = n.fb;
          var l;
          if (i.isTileClipped()) l = t.length, this._overlapStencilMode.test = {
            func: r.EQUAL,
            mask: 255
          }, this._overlapStencilType = "Clip";else {
            if (!(t[0].overscaledZ > t[t.length - 1].overscaledZ)) return void (this._overlapStencilType = !1);
            l = 1, this._overlapStencilMode.test = {
              func: r.GREATER,
              mask: 255
            }, this._overlapStencilType = "Mask";
          }

          if (!s.depthAttachment) {
            var _t313 = a.createRenderbuffer(a.gl.DEPTH_STENCIL, s.width, s.height);

            s.depthAttachment = new e.DepthStencilAttachment(a, s.framebuffer), s.depthAttachment.set(_t313), a.clear({
              stencil: 0
            });
          }

          n.ref + l > 255 && (a.clear({
            stencil: 0
          }), n.ref = 0), n.ref += l, this._overlapStencilMode.ref = n.ref, i.isTileClipped() && this._renderTileClippingMasks(t, this._overlapStencilMode.ref);
        }
      }, {
        key: "stencilModeForRTTOverlap",
        value: function stencilModeForRTTOverlap(t) {
          return this.renderingToTexture && this._overlapStencilType ? ("Clip" === this._overlapStencilType && (this._overlapStencilMode.ref = this.painter._tileClippingMaskIDs[t.key]), this._overlapStencilMode) : e.StencilMode.disabled;
        }
      }, {
        key: "_renderTileClippingMasks",
        value: function _renderTileClippingMasks(t, i) {
          var o = this.painter,
              a = this.painter.context,
              r = a.gl;
          o._tileClippingMaskIDs = {}, a.setColorMode(e.ColorMode.disabled), a.setDepthMode(e.DepthMode.disabled);
          var n = o.useProgram("clippingMask");

          for (var _s110 of t) {
            var _t314 = o._tileClippingMaskIDs[_s110.key] = --i;

            n.draw(a, r.TRIANGLES, e.DepthMode.disabled, new e.StencilMode({
              func: r.ALWAYS,
              mask: 0
            }, _t314, 255, r.KEEP, r.KEEP, r.REPLACE), e.ColorMode.disabled, e.CullFaceMode.disabled, Rt(_s110.posMatrix), "$clipping", o.tileExtentBuffer, o.quadTriangleIndexBuffer, o.tileExtentSegments);
          }
        }
      }, {
        key: "pointCoordinate",
        value: function pointCoordinate(t) {
          var i = this.painter.transform;
          if (t.x < 0 || t.x > i.width || t.y < 0 || t.y > i.height) return null;
          var o = [t.x, t.y, 1, 1];
          e.transformMat4(o, o, i.pixelMatrixInverse), e.scale$1(o, o, 1 / o[3]), o[0] /= i.worldSize, o[1] /= i.worldSize;
          var a = i._camera.position,
              r = e.mercatorZfromAltitude(1, i.center.lat),
              n = [a[0], a[1], a[2] / r, 0],
              s = e.subtract([], o.slice(0, 3), n);
          e.normalize(s, s);
          var l = this.raycast(n, s, this._exaggeration);
          return null !== l && l ? (e.scaleAndAdd(n, n, s, l), n[3] = n[2], n[2] *= r, n) : null;
        }
      }, {
        key: "drawDepth",
        value: function drawDepth() {
          var t = this.painter,
              i = t.context,
              o = this.proxySourceCache,
              a = Math.ceil(t.width),
              r = Math.ceil(t.height);

          if (!this._depthFBO || this._depthFBO.width === a && this._depthFBO.height === r || (this._depthFBO.destroy(), delete this._depthFBO, delete this._depthTexture), !this._depthFBO) {
            var _t315 = i.gl,
                _o91 = i.createFramebuffer(a, r, !0);

            i.activeTexture.set(_t315.TEXTURE0);

            var _n140 = new e.Texture(i, {
              width: a,
              height: r,
              data: null
            }, _t315.RGBA);

            _n140.bind(_t315.NEAREST, _t315.CLAMP_TO_EDGE), _o91.colorAttachment.set(_n140.texture);

            var _s111 = i.createRenderbuffer(i.gl.DEPTH_COMPONENT16, a, r);

            _o91.depthAttachment.set(_s111), this._depthFBO = _o91, this._depthTexture = _n140;
          }

          i.bindFramebuffer.set(this._depthFBO.framebuffer), i.viewport.set([0, 0, a, r]), function (t, i, o, a) {
            var r = t.context,
                n = r.gl;
            r.clear({
              depth: 1
            });
            var s = t.useProgram("terrainDepth"),
                l = new e.DepthMode(n.LESS, e.DepthMode.ReadWrite, t.depthRangeFor3D);

            for (var _t316 of a) {
              var _a123 = o.getTile(_t316),
                  _c33 = Mt(_t316.posMatrix, 0);

              i.setupElevationDraw(_a123, s), s.draw(r, n.TRIANGLES, l, e.StencilMode.disabled, e.ColorMode.unblended, e.CullFaceMode.backCCW, _c33, "terrain_depth", i.gridBuffer, i.gridIndexBuffer, i.gridNoSkirtSegments);
            }
          }(t, this, o, this.proxyCoords);
        }
      }, {
        key: "_setupProxiedCoordsForOrtho",
        value: function _setupProxiedCoordsForOrtho(e, t, i) {
          if (e.getSource() instanceof C) return this._setupProxiedCoordsForImageSource(e, t, i);
          this._findCoveringTileCache[e.id] = this._findCoveringTileCache[e.id] || {};
          var o = this.proxiedCoords[e.id] = [],
              a = this.proxyCoords;

          for (var _t317 = 0; _t317 < a.length; _t317++) {
            var _r230 = a[_t317],
                _n141 = this._findTileCoveringTileID(_r230, e);

            if (_n141) {
              var _t318 = this._createProxiedId(_r230, _n141, i[_r230.key] && i[_r230.key][e.id]);

              o.push(_t318), this.proxyToSource[_r230.key][e.id] = [_t318];
            }
          }

          var r = !1;

          for (var _a124 = 0; _a124 < t.length; _a124++) {
            var _n142 = e.getTile(t[_a124]);

            if (!_n142 || !_n142.hasData()) continue;

            var _s112 = this._findTileCoveringTileID(_n142.tileID, this.proxySourceCache);

            if (_s112 && _s112.tileID.canonical.z !== _n142.tileID.canonical.z) {
              var _t319 = this.proxyToSource[_s112.tileID.key][e.id],
                  _a125 = this._createProxiedId(_s112.tileID, _n142, i[_s112.tileID.key] && i[_s112.tileID.key][e.id]);

              _t319 ? _t319.splice(_t319.length - 1, 0, _a125) : this.proxyToSource[_s112.tileID.key][e.id] = [_a125], o.push(_a125), r = !0;
            }
          }

          this._sourceTilesOverlap[e.id] = r;
        }
      }, {
        key: "_setupProxiedCoordsForImageSource",
        value: function _setupProxiedCoordsForImageSource(t, i, o) {
          if (!t.getSource().loaded()) return;

          var a = this.proxiedCoords[t.id] = [],
              r = this.proxyCoords,
              n = t.getSource(),
              s = new e.Point(n.tileID.x, n.tileID.y)._div(1 << n.tileID.z),
              l = n.coordinates.map(e.MercatorCoordinate.fromLngLat).reduce(function (e, t) {
            return e.min.x = Math.min(e.min.x, t.x - s.x), e.min.y = Math.min(e.min.y, t.y - s.y), e.max.x = Math.max(e.max.x, t.x - s.x), e.max.y = Math.max(e.max.y, t.y - s.y), e;
          }, {
            min: new e.Point(Number.MAX_VALUE, Number.MAX_VALUE),
            max: new e.Point(-Number.MAX_VALUE, -Number.MAX_VALUE)
          }),
              c = function (t, i) {
            var o = t.wrap + t.canonical.x / (1 << t.canonical.z),
                a = t.canonical.y / (1 << t.canonical.z),
                r = e.EXTENT / (1 << t.canonical.z),
                n = i.wrap + i.canonical.x / (1 << i.canonical.z),
                s = i.canonical.y / (1 << i.canonical.z);
            return o + r < n + l.min.x || o > n + l.max.x || a + r < s + l.min.y || a > s + l.max.y;
          };

          for (var _e327 = 0; _e327 < r.length; _e327++) {
            var _n143 = r[_e327];

            for (var _e328 = 0; _e328 < i.length; _e328++) {
              var _r231 = t.getTile(i[_e328]);

              if (!_r231 || !_r231.hasData()) continue;
              if (c(_n143, _r231.tileID)) continue;

              var _s113 = this._createProxiedId(_n143, _r231, o[_n143.key] && o[_n143.key][t.id]),
                  _l46 = this.proxyToSource[_n143.key][t.id];

              _l46 ? _l46.push(_s113) : this.proxyToSource[_n143.key][t.id] = [_s113], a.push(_s113);
            }
          }
        }
      }, {
        key: "_createProxiedId",
        value: function _createProxiedId(t, i, o) {
          var a = this.orthoMatrix;

          if (o) {
            var _e329 = o.find(function (e) {
              return e.key === i.tileID.key;
            });

            if (_e329) return _e329;
          }

          if (i.tileID.key !== t.key) {
            var _o92 = t.canonical.z - i.tileID.canonical.z;

            var _r232, _n144, _s114;

            a = e.create();

            var _l47 = i.tileID.wrap - t.wrap << t.overscaledZ;

            _o92 > 0 ? (_r232 = e.EXTENT >> _o92, _n144 = _r232 * ((i.tileID.canonical.x << _o92) - t.canonical.x + _l47), _s114 = _r232 * ((i.tileID.canonical.y << _o92) - t.canonical.y)) : (_r232 = e.EXTENT << -_o92, _n144 = e.EXTENT * (i.tileID.canonical.x - (t.canonical.x + _l47 << -_o92)), _s114 = e.EXTENT * (i.tileID.canonical.y - (t.canonical.y << -_o92))), e.ortho(a, 0, _r232, 0, _r232, 0, 1), e.translate(a, a, [_n144, _s114, 0]);
          }

          return new Ft(i.tileID, t.key, a);
        }
      }, {
        key: "_findTileCoveringTileID",
        value: function _findTileCoveringTileID(t, i) {
          var o = i.getTile(t);
          if (o && o.hasData()) return o;
          var a = this._findCoveringTileCache[i.id],
              r = a[t.key];
          if (o = r ? i.getTileByID(r) : null, o && o.hasData() || null === r) return o;
          var n = o ? o.tileID : t,
              s = n.overscaledZ;
          var l = i.getSource().minzoom,
              c = [];

          if (!r) {
            var _a126 = i.getSource().maxzoom;

            if (t.canonical.z >= _a126) {
              var _o93 = t.canonical.z - _a126;

              i.getSource().reparseOverscaled ? (s = Math.max(t.canonical.z + 2, i.transform.tileZoom), n = new e.OverscaledTileID(s, t.wrap, _a126, t.canonical.x >> _o93, t.canonical.y >> _o93)) : 0 !== _o93 && (s = _a126, n = new e.OverscaledTileID(s, t.wrap, _a126, t.canonical.x >> _o93, t.canonical.y >> _o93));
            }

            n.key !== t.key && (c.push(n.key), o = i.getTile(n));
          }

          var h = function (e) {
            c.forEach(function (t) {
              a[t] = e;
            }), c.length = 0;
          };

          for (s -= 1; s >= l && (!o || !o.hasData()); s--) {
            o && h(o.tileID.key);

            var _e330 = n.calculateScaledKey(s);

            if (o = i.getTileByID(_e330), o && o.hasData()) break;
            var _t320 = a[_e330];
            if (null === _t320) break;
            void 0 === _t320 ? c.push(_e330) : o = i.getTileByID(_t320);
          }

          return h(o ? o.tileID.key : null), o && o.hasData() ? o : null;
        }
      }, {
        key: "findDEMTileFor",
        value: function findDEMTileFor(e) {
          return this.enabled ? this._findTileCoveringTileID(e, this.sourceCache) : null;
        }
      }, {
        key: "prepareDrawTile",
        value: function prepareDrawTile(e) {
          this.renderedToTile || (this.renderedToTile = !0);
        }
      }, {
        key: "_clearRenderCacheForTile",
        value: function _clearRenderCacheForTile(e, t) {
          var i = this._tilesDirty[e];
          i || (i = this._tilesDirty[e] = {}), i[t.key] = !0;
        }
      }]);

      return Ot;
    }(e.Elevation);

    function Ut(e) {
      var t = [];

      for (var _i208 = 0; _i208 < e.length; _i208++) {
        if (null === e[_i208]) continue;

        var _o94 = e[_i208].split(" ");

        t.push(_o94.pop());
      }

      return t;
    }

    var Nt = /*#__PURE__*/function () {
      function Nt(t, i, o, a, r, n) {
        _classCallCheck(this, Nt);

        var s = t.gl;
        this.program = s.createProgram();

        var l = Ut(o.staticAttributes),
            c = a ? a.getBinderAttributes() : [],
            h = l.concat(c),
            u = o.staticUniforms ? Ut(o.staticUniforms) : [],
            d = a ? a.getBinderUniforms() : [],
            _ = u.concat(d),
            m = [];

        for (var _e331 of _) {
          m.indexOf(_e331) < 0 && m.push(_e331);
        }

        var p = a ? a.defines() : [];
        p = p.concat(n.map(function (e) {
          return "#define ".concat(e);
        }));
        var f = p.concat(qe.fragmentSource, o.fragmentSource).join("\n"),
            g = p.concat(qe.vertexSource, Ve.vertexSource, o.vertexSource).join("\n"),
            v = s.createShader(s.FRAGMENT_SHADER);
        if (s.isContextLost()) return void (this.failedToCreate = !0);
        s.shaderSource(v, f), s.compileShader(v), s.attachShader(this.program, v);
        var x = s.createShader(s.VERTEX_SHADER);
        if (s.isContextLost()) return void (this.failedToCreate = !0);
        s.shaderSource(x, g), s.compileShader(x), s.attachShader(this.program, x), this.attributes = {};
        var y = {};
        this.numAttributes = h.length;

        for (var _e332 = 0; _e332 < this.numAttributes; _e332++) {
          h[_e332] && (s.bindAttribLocation(this.program, _e332, h[_e332]), this.attributes[h[_e332]] = _e332);
        }

        s.linkProgram(this.program), s.deleteShader(x), s.deleteShader(v);

        for (var _e333 = 0; _e333 < m.length; _e333++) {
          var _t321 = m[_e333];

          if (_t321 && !y[_t321]) {
            var _e334 = s.getUniformLocation(this.program, _t321);

            _e334 && (y[_t321] = _e334);
          }
        }

        this.fixedUniforms = r(t, y), this.binderUniforms = a ? a.getUniforms(t, y) : [], -1 !== n.indexOf("TERRAIN") && (this.terrainUniforms = function (t, i) {
          return {
            u_dem: new e.Uniform1i(t, i.u_dem),
            u_dem_prev: new e.Uniform1i(t, i.u_dem_prev),
            u_dem_unpack: new e.Uniform4f(t, i.u_dem_unpack),
            u_dem_tl: new e.Uniform2f(t, i.u_dem_tl),
            u_dem_scale: new e.Uniform1f(t, i.u_dem_scale),
            u_dem_tl_prev: new e.Uniform2f(t, i.u_dem_tl_prev),
            u_dem_scale_prev: new e.Uniform1f(t, i.u_dem_scale_prev),
            u_dem_size: new e.Uniform1f(t, i.u_dem_size),
            u_dem_lerp: new e.Uniform1f(t, i.u_dem_lerp),
            u_exaggeration: new e.Uniform1f(t, i.u_exaggeration),
            u_depth: new e.Uniform1i(t, i.u_depth),
            u_depth_size_inv: new e.Uniform2f(t, i.u_depth_size_inv),
            u_meter_to_dem: new e.Uniform1f(t, i.u_meter_to_dem),
            u_label_plane_matrix_inv: new e.UniformMatrix4f(t, i.u_label_plane_matrix_inv)
          };
        }(t, y));
      }

      _createClass(Nt, [{
        key: "setTerrainUniformValues",
        value: function setTerrainUniformValues(e, t) {
          if (!this.terrainUniforms) return;
          var i = this.terrainUniforms;

          if (!this.failedToCreate) {
            e.program.set(this.program);

            for (var _e335 in t) {
              i[_e335].set(t[_e335]);
            }
          }
        }
      }, {
        key: "draw",
        value: function draw(e, t, i, o, a, r, n, s, l, c, h, u, d, _, m, p) {
          var _f$LINES$f$TRIANGLES$;

          var f = e.gl;
          if (this.failedToCreate) return;
          e.program.set(this.program), e.setDepthMode(i), e.setStencilMode(o), e.setColorMode(a), e.setCullFace(r);

          for (var _e336 in this.fixedUniforms) {
            this.fixedUniforms[_e336].set(n[_e336]);
          }

          _ && _.setUniforms(e, this.binderUniforms, u, {
            zoom: d
          });
          var g = (_f$LINES$f$TRIANGLES$ = {}, _defineProperty(_f$LINES$f$TRIANGLES$, f.LINES, 2), _defineProperty(_f$LINES$f$TRIANGLES$, f.TRIANGLES, 3), _defineProperty(_f$LINES$f$TRIANGLES$, f.LINE_STRIP, 1), _f$LINES$f$TRIANGLES$)[t];

          for (var _i209 of h.get()) {
            var _o95 = _i209.vaos || (_i209.vaos = {});

            (_o95[s] || (_o95[s] = new Tt())).bind(e, this, l, _ ? _.getPaintVertexBuffers() : [], c, _i209.vertexOffset, m, p), f.drawElements(t, _i209.primitiveLength * g, f.UNSIGNED_SHORT, _i209.primitiveOffset * g * 2);
          }
        }
      }], [{
        key: "cacheKey",
        value: function cacheKey(e, t, i) {
          var o = "".concat(e).concat(i ? i.cacheKey : "");

          for (var _e337 of t) {
            o += "/".concat(_e337);
          }

          return o;
        }
      }]);

      return Nt;
    }();

    function Zt(e, t, i) {
      var o = 1 / v(i, 1, t.transform.tileZoom),
          a = Math.pow(2, i.tileID.overscaledZ),
          r = i.tileSize * Math.pow(2, t.transform.tileZoom) / a,
          n = r * (i.tileID.canonical.x + i.tileID.wrap * a),
          s = r * i.tileID.canonical.y;
      return {
        u_image: 0,
        u_texsize: i.imageAtlasTexture.size,
        u_scale: [o, e.fromScale, e.toScale],
        u_fade: e.t,
        u_pixel_coord_upper: [n >> 16, s >> 16],
        u_pixel_coord_lower: [65535 & n, 65535 & s]
      };
    }

    var Gt = function (t, i, o, a) {
      var r = i.style.light,
          n = r.properties.get("position"),
          s = [n.x, n.y, n.z],
          l = e.create$1();
      "viewport" === r.properties.get("anchor") && (e.fromRotation(l, -i.transform.angle), e.transformMat3(s, s, l));
      var c = r.properties.get("color");
      return {
        u_matrix: t,
        u_lightpos: s,
        u_lightintensity: r.properties.get("intensity"),
        u_lightcolor: [c.r, c.g, c.b],
        u_vertical_gradient: +o,
        u_opacity: a
      };
    },
        Vt = function (t, i, o, a, r, n, s) {
      return e.extend(Gt(t, i, o, a), Zt(n, i, s), {
        u_height_factor: -Math.pow(2, r.overscaledZ) / s.tileSize / 8
      });
    },
        qt = function (e) {
      return {
        u_matrix: e
      };
    },
        jt = function (t, i, o, a) {
      return e.extend(qt(t), Zt(o, i, a));
    },
        $t = function (e, t) {
      return {
        u_matrix: e,
        u_world: t
      };
    },
        Xt = function (t, i, o, a, r) {
      return e.extend(jt(t, i, o, a), {
        u_world: r
      });
    },
        Wt = function (t, i, o, a) {
      var r = t.transform;
      var n;

      if ("map" === a.paint.get("circle-pitch-alignment")) {
        var _e338 = v(o, 1, r.zoom);

        n = [_e338, _e338];
      } else n = r.pixelsToGLUnits;

      return {
        u_camera_to_center_distance: r.cameraToCenterDistance,
        u_matrix: t.translatePosMatrix(i.posMatrix, o, a.paint.get("circle-translate"), a.paint.get("circle-translate-anchor")),
        u_device_pixel_ratio: e.browser.devicePixelRatio,
        u_extrude_scale: n
      };
    },
        Ht = function (e) {
      var t = [];
      return "map" === e.paint.get("circle-pitch-alignment") && t.push("PITCH_WITH_MAP"), "map" === e.paint.get("circle-pitch-scale") && t.push("SCALE_WITH_MAP"), t;
    },
        Kt = function (t, i, o) {
      var a = e.EXTENT / o.tileSize;
      return {
        u_matrix: t,
        u_camera_to_center_distance: i.cameraToCenterDistance,
        u_extrude_scale: [i.pixelsToGLUnits[0] / a, i.pixelsToGLUnits[1] / a]
      };
    },
        Yt = function (e, t) {
      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      return {
        u_matrix: e,
        u_color: t,
        u_overlay: 0,
        u_overlay_scale: i
      };
    },
        Jt = function (e, t, i, o) {
      return {
        u_matrix: e,
        u_extrude_scale: v(t, 1, i),
        u_intensity: o
      };
    },
        Qt = function (t, i, o, a) {
      var r = t.transform;
      return {
        u_matrix: ai(t, i, o, a),
        u_ratio: 1 / v(i, 1, r.zoom),
        u_device_pixel_ratio: e.browser.devicePixelRatio,
        u_units_to_pixels: [1 / r.pixelsToGLUnits[0], 1 / r.pixelsToGLUnits[1]]
      };
    },
        ei = function (t, i, o, a, r) {
      return e.extend(Qt(t, i, o, a), {
        u_image: 0,
        u_image_height: r
      });
    },
        ti = function (t, i, o, a, r) {
      var n = t.transform,
          s = oi(i, n);
      return {
        u_matrix: ai(t, i, o, r),
        u_texsize: i.imageAtlasTexture.size,
        u_ratio: 1 / v(i, 1, n.zoom),
        u_device_pixel_ratio: e.browser.devicePixelRatio,
        u_image: 0,
        u_scale: [s, a.fromScale, a.toScale],
        u_fade: a.t,
        u_units_to_pixels: [1 / n.pixelsToGLUnits[0], 1 / n.pixelsToGLUnits[1]]
      };
    },
        ii = function (t, i, o, a, r, n) {
      var s = t.lineAtlas,
          l = oi(i, t.transform),
          c = "round" === o.layout.get("line-cap"),
          h = s.getDash(a.from, c),
          u = s.getDash(a.to, c),
          d = h.width * r.fromScale,
          _ = u.width * r.toScale;

      return e.extend(Qt(t, i, o, n), {
        u_patternscale_a: [l / d, -h.height / 2],
        u_patternscale_b: [l / _, -u.height / 2],
        u_sdfgamma: s.width / (256 * Math.min(d, _) * e.browser.devicePixelRatio) / 2,
        u_image: 0,
        u_tex_y_a: h.y,
        u_tex_y_b: u.y,
        u_mix: r.t
      });
    };

    function oi(e, t) {
      return 1 / v(e, 1, t.tileZoom);
    }

    function ai(e, t, i, o) {
      return e.translatePosMatrix(o || t.tileID.posMatrix, t, i.paint.get("line-translate"), i.paint.get("line-translate-anchor"));
    }

    var ri = function (e, t, i, o, a) {
      return {
        u_matrix: e,
        u_tl_parent: t,
        u_scale_parent: i,
        u_buffer_scale: 1,
        u_fade_t: o.mix,
        u_opacity: o.opacity * a.paint.get("raster-opacity"),
        u_image0: 0,
        u_image1: 1,
        u_brightness_low: a.paint.get("raster-brightness-min"),
        u_brightness_high: a.paint.get("raster-brightness-max"),
        u_saturation_factor: (n = a.paint.get("raster-saturation"), n > 0 ? 1 - 1 / (1.001 - n) : -n),
        u_contrast_factor: (r = a.paint.get("raster-contrast"), r > 0 ? 1 / (1 - r) : 1 + r),
        u_spin_weights: ni(a.paint.get("raster-hue-rotate"))
      };
      var r, n;
    };

    function ni(e) {
      e *= Math.PI / 180;
      var t = Math.sin(e),
          i = Math.cos(e);
      return [(2 * i + 1) / 3, (-Math.sqrt(3) * t - i + 1) / 3, (Math.sqrt(3) * t - i + 1) / 3];
    }

    var si = function (e, t, i, o, a, r, n, s, l, c) {
      var h = a.transform;
      return {
        u_is_size_zoom_constant: +("constant" === e || "source" === e),
        u_is_size_feature_constant: +("constant" === e || "camera" === e),
        u_size_t: t ? t.uSizeT : 0,
        u_size: t ? t.uSize : 0,
        u_camera_to_center_distance: h.cameraToCenterDistance,
        u_pitch: h.pitch / 360 * 2 * Math.PI,
        u_rotate_symbol: +i,
        u_aspect_ratio: h.width / h.height,
        u_fade_change: a.options.fadeDuration ? a.symbolFadeChange : 1,
        u_matrix: r,
        u_label_plane_matrix: n,
        u_coord_matrix: s,
        u_is_text: +l,
        u_pitch_with_map: +o,
        u_texsize: c,
        u_texture: 0
      };
    },
        li = function (t, i, o, a, r, n, s, l, c, h, u) {
      var {
        cameraToCenterDistance: d,
        _pitch: _
      } = r.transform;
      return e.extend(si(t, i, o, a, r, n, s, l, c, h), {
        u_gamma_scale: a ? d * Math.cos(r.terrain ? 0 : _) : 1,
        u_device_pixel_ratio: e.browser.devicePixelRatio,
        u_is_halo: +u
      });
    },
        ci = function (t, i, o, a, r, n, s, l, c, h) {
      return e.extend(li(t, i, o, a, r, n, s, l, !0, c, !0), {
        u_texsize_icon: h,
        u_texture_icon: 1
      });
    },
        hi = function (e, t, i) {
      return {
        u_matrix: e,
        u_opacity: t,
        u_color: i
      };
    },
        ui = function (t, i, o, a, r, n) {
      return e.extend(function (e, t, i, o) {
        var a = i.imageManager.getPattern(e.from.toString()),
            r = i.imageManager.getPattern(e.to.toString()),
            {
          width: n,
          height: s
        } = i.imageManager.getPixelSize(),
            l = Math.pow(2, o.tileID.overscaledZ),
            c = o.tileSize * Math.pow(2, i.transform.tileZoom) / l,
            h = c * (o.tileID.canonical.x + o.tileID.wrap * l),
            u = c * o.tileID.canonical.y;
        return {
          u_image: 0,
          u_pattern_tl_a: a.tl,
          u_pattern_br_a: a.br,
          u_pattern_tl_b: r.tl,
          u_pattern_br_b: r.br,
          u_texsize: [n, s],
          u_mix: t.t,
          u_pattern_size_a: a.displaySize,
          u_pattern_size_b: r.displaySize,
          u_scale_a: t.fromScale,
          u_scale_b: t.toScale,
          u_tile_units_to_pixels: 1 / v(o, 1, i.transform.tileZoom),
          u_pixel_coord_upper: [h >> 16, u >> 16],
          u_pixel_coord_lower: [65535 & h, 65535 & u]
        };
      }(a, n, o, r), {
        u_matrix: t,
        u_opacity: i
      });
    },
        di = {
      fillExtrusion: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_lightpos: new e.Uniform3f(t, i.u_lightpos),
          u_lightintensity: new e.Uniform1f(t, i.u_lightintensity),
          u_lightcolor: new e.Uniform3f(t, i.u_lightcolor),
          u_vertical_gradient: new e.Uniform1f(t, i.u_vertical_gradient),
          u_opacity: new e.Uniform1f(t, i.u_opacity)
        };
      },
      fillExtrusionPattern: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_lightpos: new e.Uniform3f(t, i.u_lightpos),
          u_lightintensity: new e.Uniform1f(t, i.u_lightintensity),
          u_lightcolor: new e.Uniform3f(t, i.u_lightcolor),
          u_vertical_gradient: new e.Uniform1f(t, i.u_vertical_gradient),
          u_height_factor: new e.Uniform1f(t, i.u_height_factor),
          u_image: new e.Uniform1i(t, i.u_image),
          u_texsize: new e.Uniform2f(t, i.u_texsize),
          u_pixel_coord_upper: new e.Uniform2f(t, i.u_pixel_coord_upper),
          u_pixel_coord_lower: new e.Uniform2f(t, i.u_pixel_coord_lower),
          u_scale: new e.Uniform3f(t, i.u_scale),
          u_fade: new e.Uniform1f(t, i.u_fade),
          u_opacity: new e.Uniform1f(t, i.u_opacity)
        };
      },
      fill: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix)
        };
      },
      fillPattern: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_image: new e.Uniform1i(t, i.u_image),
          u_texsize: new e.Uniform2f(t, i.u_texsize),
          u_pixel_coord_upper: new e.Uniform2f(t, i.u_pixel_coord_upper),
          u_pixel_coord_lower: new e.Uniform2f(t, i.u_pixel_coord_lower),
          u_scale: new e.Uniform3f(t, i.u_scale),
          u_fade: new e.Uniform1f(t, i.u_fade)
        };
      },
      fillOutline: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_world: new e.Uniform2f(t, i.u_world)
        };
      },
      fillOutlinePattern: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_world: new e.Uniform2f(t, i.u_world),
          u_image: new e.Uniform1i(t, i.u_image),
          u_texsize: new e.Uniform2f(t, i.u_texsize),
          u_pixel_coord_upper: new e.Uniform2f(t, i.u_pixel_coord_upper),
          u_pixel_coord_lower: new e.Uniform2f(t, i.u_pixel_coord_lower),
          u_scale: new e.Uniform3f(t, i.u_scale),
          u_fade: new e.Uniform1f(t, i.u_fade)
        };
      },
      circle: function (t, i) {
        return {
          u_camera_to_center_distance: new e.Uniform1f(t, i.u_camera_to_center_distance),
          u_extrude_scale: new e.Uniform2f(t, i.u_extrude_scale),
          u_device_pixel_ratio: new e.Uniform1f(t, i.u_device_pixel_ratio),
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix)
        };
      },
      collisionBox: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_camera_to_center_distance: new e.Uniform1f(t, i.u_camera_to_center_distance),
          u_extrude_scale: new e.Uniform2f(t, i.u_extrude_scale)
        };
      },
      collisionCircle: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_inv_matrix: new e.UniformMatrix4f(t, i.u_inv_matrix),
          u_camera_to_center_distance: new e.Uniform1f(t, i.u_camera_to_center_distance),
          u_viewport_size: new e.Uniform2f(t, i.u_viewport_size)
        };
      },
      debug: function (t, i) {
        return {
          u_color: new e.UniformColor(t, i.u_color),
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_overlay: new e.Uniform1i(t, i.u_overlay),
          u_overlay_scale: new e.Uniform1f(t, i.u_overlay_scale)
        };
      },
      clippingMask: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix)
        };
      },
      heatmap: function (t, i) {
        return {
          u_extrude_scale: new e.Uniform1f(t, i.u_extrude_scale),
          u_intensity: new e.Uniform1f(t, i.u_intensity),
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix)
        };
      },
      heatmapTexture: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_world: new e.Uniform2f(t, i.u_world),
          u_image: new e.Uniform1i(t, i.u_image),
          u_color_ramp: new e.Uniform1i(t, i.u_color_ramp),
          u_opacity: new e.Uniform1f(t, i.u_opacity)
        };
      },
      hillshade: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_image: new e.Uniform1i(t, i.u_image),
          u_latrange: new e.Uniform2f(t, i.u_latrange),
          u_light: new e.Uniform2f(t, i.u_light),
          u_shadow: new e.UniformColor(t, i.u_shadow),
          u_highlight: new e.UniformColor(t, i.u_highlight),
          u_accent: new e.UniformColor(t, i.u_accent)
        };
      },
      hillshadePrepare: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_image: new e.Uniform1i(t, i.u_image),
          u_dimension: new e.Uniform2f(t, i.u_dimension),
          u_zoom: new e.Uniform1f(t, i.u_zoom),
          u_unpack: new e.Uniform4f(t, i.u_unpack)
        };
      },
      line: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_ratio: new e.Uniform1f(t, i.u_ratio),
          u_device_pixel_ratio: new e.Uniform1f(t, i.u_device_pixel_ratio),
          u_units_to_pixels: new e.Uniform2f(t, i.u_units_to_pixels)
        };
      },
      lineGradient: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_ratio: new e.Uniform1f(t, i.u_ratio),
          u_device_pixel_ratio: new e.Uniform1f(t, i.u_device_pixel_ratio),
          u_units_to_pixels: new e.Uniform2f(t, i.u_units_to_pixels),
          u_image: new e.Uniform1i(t, i.u_image),
          u_image_height: new e.Uniform1f(t, i.u_image_height)
        };
      },
      linePattern: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_texsize: new e.Uniform2f(t, i.u_texsize),
          u_ratio: new e.Uniform1f(t, i.u_ratio),
          u_device_pixel_ratio: new e.Uniform1f(t, i.u_device_pixel_ratio),
          u_image: new e.Uniform1i(t, i.u_image),
          u_units_to_pixels: new e.Uniform2f(t, i.u_units_to_pixels),
          u_scale: new e.Uniform3f(t, i.u_scale),
          u_fade: new e.Uniform1f(t, i.u_fade)
        };
      },
      lineSDF: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_ratio: new e.Uniform1f(t, i.u_ratio),
          u_device_pixel_ratio: new e.Uniform1f(t, i.u_device_pixel_ratio),
          u_units_to_pixels: new e.Uniform2f(t, i.u_units_to_pixels),
          u_patternscale_a: new e.Uniform2f(t, i.u_patternscale_a),
          u_patternscale_b: new e.Uniform2f(t, i.u_patternscale_b),
          u_sdfgamma: new e.Uniform1f(t, i.u_sdfgamma),
          u_image: new e.Uniform1i(t, i.u_image),
          u_tex_y_a: new e.Uniform1f(t, i.u_tex_y_a),
          u_tex_y_b: new e.Uniform1f(t, i.u_tex_y_b),
          u_mix: new e.Uniform1f(t, i.u_mix)
        };
      },
      raster: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_tl_parent: new e.Uniform2f(t, i.u_tl_parent),
          u_scale_parent: new e.Uniform1f(t, i.u_scale_parent),
          u_buffer_scale: new e.Uniform1f(t, i.u_buffer_scale),
          u_fade_t: new e.Uniform1f(t, i.u_fade_t),
          u_opacity: new e.Uniform1f(t, i.u_opacity),
          u_image0: new e.Uniform1i(t, i.u_image0),
          u_image1: new e.Uniform1i(t, i.u_image1),
          u_brightness_low: new e.Uniform1f(t, i.u_brightness_low),
          u_brightness_high: new e.Uniform1f(t, i.u_brightness_high),
          u_saturation_factor: new e.Uniform1f(t, i.u_saturation_factor),
          u_contrast_factor: new e.Uniform1f(t, i.u_contrast_factor),
          u_spin_weights: new e.Uniform3f(t, i.u_spin_weights)
        };
      },
      symbolIcon: function (t, i) {
        return {
          u_is_size_zoom_constant: new e.Uniform1i(t, i.u_is_size_zoom_constant),
          u_is_size_feature_constant: new e.Uniform1i(t, i.u_is_size_feature_constant),
          u_size_t: new e.Uniform1f(t, i.u_size_t),
          u_size: new e.Uniform1f(t, i.u_size),
          u_camera_to_center_distance: new e.Uniform1f(t, i.u_camera_to_center_distance),
          u_pitch: new e.Uniform1f(t, i.u_pitch),
          u_rotate_symbol: new e.Uniform1i(t, i.u_rotate_symbol),
          u_aspect_ratio: new e.Uniform1f(t, i.u_aspect_ratio),
          u_fade_change: new e.Uniform1f(t, i.u_fade_change),
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_label_plane_matrix: new e.UniformMatrix4f(t, i.u_label_plane_matrix),
          u_coord_matrix: new e.UniformMatrix4f(t, i.u_coord_matrix),
          u_is_text: new e.Uniform1i(t, i.u_is_text),
          u_pitch_with_map: new e.Uniform1i(t, i.u_pitch_with_map),
          u_texsize: new e.Uniform2f(t, i.u_texsize),
          u_texture: new e.Uniform1i(t, i.u_texture)
        };
      },
      symbolSDF: function (t, i) {
        return {
          u_is_size_zoom_constant: new e.Uniform1i(t, i.u_is_size_zoom_constant),
          u_is_size_feature_constant: new e.Uniform1i(t, i.u_is_size_feature_constant),
          u_size_t: new e.Uniform1f(t, i.u_size_t),
          u_size: new e.Uniform1f(t, i.u_size),
          u_camera_to_center_distance: new e.Uniform1f(t, i.u_camera_to_center_distance),
          u_pitch: new e.Uniform1f(t, i.u_pitch),
          u_rotate_symbol: new e.Uniform1i(t, i.u_rotate_symbol),
          u_aspect_ratio: new e.Uniform1f(t, i.u_aspect_ratio),
          u_fade_change: new e.Uniform1f(t, i.u_fade_change),
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_label_plane_matrix: new e.UniformMatrix4f(t, i.u_label_plane_matrix),
          u_coord_matrix: new e.UniformMatrix4f(t, i.u_coord_matrix),
          u_is_text: new e.Uniform1i(t, i.u_is_text),
          u_pitch_with_map: new e.Uniform1i(t, i.u_pitch_with_map),
          u_texsize: new e.Uniform2f(t, i.u_texsize),
          u_texture: new e.Uniform1i(t, i.u_texture),
          u_gamma_scale: new e.Uniform1f(t, i.u_gamma_scale),
          u_device_pixel_ratio: new e.Uniform1f(t, i.u_device_pixel_ratio),
          u_is_halo: new e.Uniform1i(t, i.u_is_halo)
        };
      },
      symbolTextAndIcon: function (t, i) {
        return {
          u_is_size_zoom_constant: new e.Uniform1i(t, i.u_is_size_zoom_constant),
          u_is_size_feature_constant: new e.Uniform1i(t, i.u_is_size_feature_constant),
          u_size_t: new e.Uniform1f(t, i.u_size_t),
          u_size: new e.Uniform1f(t, i.u_size),
          u_camera_to_center_distance: new e.Uniform1f(t, i.u_camera_to_center_distance),
          u_pitch: new e.Uniform1f(t, i.u_pitch),
          u_rotate_symbol: new e.Uniform1i(t, i.u_rotate_symbol),
          u_aspect_ratio: new e.Uniform1f(t, i.u_aspect_ratio),
          u_fade_change: new e.Uniform1f(t, i.u_fade_change),
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_label_plane_matrix: new e.UniformMatrix4f(t, i.u_label_plane_matrix),
          u_coord_matrix: new e.UniformMatrix4f(t, i.u_coord_matrix),
          u_is_text: new e.Uniform1i(t, i.u_is_text),
          u_pitch_with_map: new e.Uniform1i(t, i.u_pitch_with_map),
          u_texsize: new e.Uniform2f(t, i.u_texsize),
          u_texsize_icon: new e.Uniform2f(t, i.u_texsize_icon),
          u_texture: new e.Uniform1i(t, i.u_texture),
          u_texture_icon: new e.Uniform1i(t, i.u_texture_icon),
          u_gamma_scale: new e.Uniform1f(t, i.u_gamma_scale),
          u_device_pixel_ratio: new e.Uniform1f(t, i.u_device_pixel_ratio),
          u_is_halo: new e.Uniform1i(t, i.u_is_halo)
        };
      },
      background: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_opacity: new e.Uniform1f(t, i.u_opacity),
          u_color: new e.UniformColor(t, i.u_color)
        };
      },
      backgroundPattern: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_opacity: new e.Uniform1f(t, i.u_opacity),
          u_image: new e.Uniform1i(t, i.u_image),
          u_pattern_tl_a: new e.Uniform2f(t, i.u_pattern_tl_a),
          u_pattern_br_a: new e.Uniform2f(t, i.u_pattern_br_a),
          u_pattern_tl_b: new e.Uniform2f(t, i.u_pattern_tl_b),
          u_pattern_br_b: new e.Uniform2f(t, i.u_pattern_br_b),
          u_texsize: new e.Uniform2f(t, i.u_texsize),
          u_mix: new e.Uniform1f(t, i.u_mix),
          u_pattern_size_a: new e.Uniform2f(t, i.u_pattern_size_a),
          u_pattern_size_b: new e.Uniform2f(t, i.u_pattern_size_b),
          u_scale_a: new e.Uniform1f(t, i.u_scale_a),
          u_scale_b: new e.Uniform1f(t, i.u_scale_b),
          u_pixel_coord_upper: new e.Uniform2f(t, i.u_pixel_coord_upper),
          u_pixel_coord_lower: new e.Uniform2f(t, i.u_pixel_coord_lower),
          u_tile_units_to_pixels: new e.Uniform1f(t, i.u_tile_units_to_pixels)
        };
      },
      terrainRaster: Pt,
      terrainDepth: Pt,
      skybox: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_sun_direction: new e.Uniform3f(t, i.u_sun_direction),
          u_cubemap: new e.Uniform1i(t, i.u_cubemap),
          u_opacity: new e.Uniform1f(t, i.u_opacity),
          u_temporal_offset: new e.Uniform1f(t, i.u_temporal_offset)
        };
      },
      skyboxGradient: function (t, i) {
        return {
          u_matrix: new e.UniformMatrix4f(t, i.u_matrix),
          u_color_ramp: new e.Uniform1i(t, i.u_color_ramp),
          u_center_direction: new e.Uniform3f(t, i.u_center_direction),
          u_radius: new e.Uniform1f(t, i.u_radius),
          u_opacity: new e.Uniform1f(t, i.u_opacity),
          u_temporal_offset: new e.Uniform1f(t, i.u_temporal_offset)
        };
      },
      skyboxCapture: function (t, i) {
        return {
          u_matrix_3f: new e.UniformMatrix3f(t, i.u_matrix_3f),
          u_sun_direction: new e.Uniform3f(t, i.u_sun_direction),
          u_sun_intensity: new e.Uniform1f(t, i.u_sun_intensity),
          u_color_tint_r: new e.Uniform4f(t, i.u_color_tint_r),
          u_color_tint_m: new e.Uniform4f(t, i.u_color_tint_m),
          u_luminance: new e.Uniform1f(t, i.u_luminance)
        };
      }
    };

    var _i;

    function mi(t, i, o, a, r, n, s) {
      var l = t.context,
          c = l.gl,
          h = t.useProgram("collisionBox"),
          u = [];
      var d = 0,
          _ = 0;

      for (var _m16 = 0; _m16 < a.length; _m16++) {
        var _p18 = a[_m16],
            _f15 = i.getTile(_p18),
            _g15 = _f15.getBucket(o);

        if (!_g15) continue;
        var _v13 = _p18.posMatrix;
        0 === r[0] && 0 === r[1] || (_v13 = t.translatePosMatrix(_p18.posMatrix, _f15, r, n));

        var _x11 = s ? _g15.textCollisionBox : _g15.iconCollisionBox,
            _y13 = _g15.collisionCircleArray;

        if (_y13.length > 0) {
          var _i210 = e.create(),
              _o96 = _v13;

          e.mul(_i210, _g15.placementInvProjMatrix, t.transform.glCoordMatrix), e.mul(_i210, _i210, _g15.placementViewportMatrix), u.push({
            circleArray: _y13,
            circleOffset: _,
            transform: _o96,
            invTransform: _i210
          }), d += _y13.length / 4, _ = d;
        }

        _x11 && (t.terrain && t.terrain.setupElevationDraw(_f15, h), h.draw(l, c.LINES, e.DepthMode.disabled, e.StencilMode.disabled, t.colorModeForRenderPass(), e.CullFaceMode.disabled, Kt(_v13, t.transform, _f15), o.id, _x11.layoutVertexBuffer, _x11.indexBuffer, _x11.segments, null, t.transform.zoom, null, _x11.collisionVertexBuffer, _x11.collisionVertexBufferExt));
      }

      if (!s || !u.length) return;
      var m = t.useProgram("collisionCircle"),
          p = new e.StructArrayLayout2f1f2i16();
      p.resize(4 * d), p._trim();
      var f = 0;

      for (var _e339 of u) {
        for (var _t322 = 0; _t322 < _e339.circleArray.length / 4; _t322++) {
          var _i211 = 4 * _t322,
              _o97 = _e339.circleArray[_i211 + 0],
              _a127 = _e339.circleArray[_i211 + 1],
              _r233 = _e339.circleArray[_i211 + 2],
              _n145 = _e339.circleArray[_i211 + 3];

          p.emplace(f++, _o97, _a127, _r233, _n145, 0), p.emplace(f++, _o97, _a127, _r233, _n145, 1), p.emplace(f++, _o97, _a127, _r233, _n145, 2), p.emplace(f++, _o97, _a127, _r233, _n145, 3);
        }
      }

      (!_i || _i.length < 2 * d) && (_i = function (t) {
        var i = 2 * t,
            o = new e.StructArrayLayout3ui6();
        o.resize(i), o._trim();

        for (var _e340 = 0; _e340 < i; _e340++) {
          var _t323 = 6 * _e340;

          o.uint16[_t323 + 0] = 4 * _e340 + 0, o.uint16[_t323 + 1] = 4 * _e340 + 1, o.uint16[_t323 + 2] = 4 * _e340 + 2, o.uint16[_t323 + 3] = 4 * _e340 + 2, o.uint16[_t323 + 4] = 4 * _e340 + 3, o.uint16[_t323 + 5] = 4 * _e340 + 0;
        }

        return o;
      }(d));
      var g = l.createIndexBuffer(_i, !0),
          v = l.createVertexBuffer(p, e.collisionCircleLayout.members, !0);

      for (var _i212 of u) {
        var _a128 = {
          u_matrix: _i212.transform,
          u_inv_matrix: _i212.invTransform,
          u_camera_to_center_distance: (x = t.transform).cameraToCenterDistance,
          u_viewport_size: [x.width, x.height]
        };
        m.draw(l, c.TRIANGLES, e.DepthMode.disabled, e.StencilMode.disabled, t.colorModeForRenderPass(), e.CullFaceMode.disabled, _a128, o.id, v, g, e.SegmentVector.simpleSegment(0, 2 * _i212.circleOffset, _i212.circleArray.length, _i212.circleArray.length / 2), null, t.transform.zoom, null, null, null);
      }

      var x;
      v.destroy(), g.destroy();
    }

    var pi = e.identity(new Float32Array(16));

    function fi(t, i, o, a, r, n) {
      var {
        horizontalAlign: s,
        verticalAlign: l
      } = e.getAnchorAlignment(t),
          c = -(s - .5) * i,
          h = -(l - .5) * o,
          u = e.evaluateVariableOffset(t, a);
      return new e.Point((c / r + u[0]) * n, (h / r + u[1]) * n);
    }

    function gi(t, i, o, a, r, n, s, l, c, h, u, d) {
      var _ = t.text.placedSymbolArray,
          m = t.text.dynamicLayoutVertexArray,
          p = t.icon.dynamicLayoutVertexArray,
          f = {};
      m.clear();

      for (var _p19 = 0; _p19 < _.length; _p19++) {
        var _g16 = _.get(_p19),
            _v14 = t.allowVerticalPlacement && !_g16.placedOrientation,
            _x12 = _g16.hidden || !_g16.crossTileID || _v14 ? null : a[_g16.crossTileID];

        if (_x12) {
          var _a129 = new e.Point(_g16.anchorX, _g16.anchorY),
              _13 = d(_a129),
              _p20 = Y(_a129, o ? l : s, _13),
              _v15 = J(n.cameraToCenterDistance, _p20.signedDistanceFromCamera);

          var _y14 = r.evaluateSizeForFeature(t.textSizeData, h, _g16) * _v15 / e.ONE_EM;

          o && (_y14 *= t.tilePixelRatio / c);

          var {
            width: _b12,
            height: _w10,
            anchor: _T6,
            textOffset: _E4,
            textBoxScale: _C4
          } = _x12,
              _S6 = fi(_T6, _b12, _w10, _E4, _C4, _y14),
              _I4 = o ? Y(_a129.add(_S6), s, _13).point : _p20.point.add(i ? _S6.rotate(-n.angle) : _S6),
              _P2 = t.allowVerticalPlacement && _g16.placedOrientation === e.WritingMode.vertical ? Math.PI / 2 : 0;

          for (var _t324 = 0; _t324 < _g16.numGlyphs; _t324++) {
            e.addDynamicAttributes(m, _I4, _P2);
          }

          u && _g16.associatedIconIndex >= 0 && (f[_g16.associatedIconIndex] = {
            shiftedAnchor: _I4,
            angle: _P2
          });
        } else se(_g16.numGlyphs, m);
      }

      if (u) {
        p.clear();
        var _i213 = t.icon.placedSymbolArray;

        for (var _t325 = 0; _t325 < _i213.length; _t325++) {
          var _o98 = _i213.get(_t325);

          if (_o98.hidden) se(_o98.numGlyphs, p);else {
            var _i214 = f[_t325];
            if (_i214) for (var _t326 = 0; _t326 < _o98.numGlyphs; _t326++) {
              e.addDynamicAttributes(p, _i214.shiftedAnchor, _i214.angle);
            } else se(_o98.numGlyphs, p);
          }
        }

        t.icon.dynamicLayoutVertexBuffer.updateData(p);
      }

      t.text.dynamicLayoutVertexBuffer.updateData(m);
    }

    function vi(e, t, i) {
      return i.iconsInText && t ? "symbolTextAndIcon" : e ? "symbolSDF" : "symbolIcon";
    }

    function xi(t, i, o, a, r, n, s, l, c, h, u, d) {
      var _ = t.context,
          m = _.gl,
          p = t.transform,
          f = "map" === l,
          g = "map" === c,
          x = f && "point" !== o.layout.get("symbol-placement"),
          y = f && !g && !x,
          b = void 0 !== o.layout.get("symbol-sort-key").constantOr(1);
      var w = !1;
      var T = t.depthModeForSublayer(0, e.DepthMode.ReadOnly),
          E = o.layout.get("text-variable-anchor"),
          C = [],
          S = t.terrain && g ? ["PITCH_WITH_MAP_TERRAIN"] : null;

      var _loop11 = function (_l48) {
        var a = i.getTile(_l48),
            c = a.getBucket(o);
        if (!c) return "continue";
        var u = r ? c.text : c.icon;
        if (!u || !u.segments.get().length) return "continue";

        var d = u.programConfigurations.get(o.id),
            _ = r || c.sdfIcons,
            T = r ? c.textSizeData : c.iconSizeData,
            I = g || 0 !== p.pitch,
            P = t.useProgram(vi(_, r, c), d, S),
            M = e.evaluateSizeForZoom(T, p.zoom);

        var z = void 0,
            A = void 0,
            D = void 0,
            L = void 0,
            R = [0, 0],
            k = null;

        if (r) {
          if (A = a.glyphAtlasTexture, D = m.LINEAR, z = a.glyphAtlasTexture.size, c.iconsInText) {
            R = a.imageAtlasTexture.size, k = a.imageAtlasTexture;

            var _e342 = "composite" === T.kind || "camera" === T.kind;

            L = I || t.options.rotating || t.options.zooming || _e342 ? m.LINEAR : m.NEAREST;
          }
        } else {
          var _e343 = 1 !== o.layout.get("icon-size").constantOr(0) || c.iconsNeedLinear;

          A = a.imageAtlasTexture, D = _ || t.options.rotating || t.options.zooming || _e343 || I ? m.LINEAR : m.NEAREST, z = a.imageAtlasTexture.size;
        }

        var B = v(a, 1, t.transform.zoom),
            F = H(_l48.posMatrix, g, f, t.transform, B),
            O = t.terrain && g && x ? e.invert(new Float32Array(16), F) : pi,
            U = K(_l48.posMatrix, g, f, t.transform, B),
            N = E && c.hasTextData(),
            Z = "none" !== o.layout.get("icon-text-fit") && N && c.hasIconData();

        if (x) {
          var _e344 = p.elevation;
          ee(c, _l48.posMatrix, t, r, F, U, g, h, _e344 ? function (t) {
            return _e344.getAtTileOffset(_l48, t.x, t.y);
          } : null);
        }

        var G = t.translatePosMatrix(_l48.posMatrix, a, n, s),
            V = x || r && E || Z ? pi : F,
            q = t.translatePosMatrix(U, a, n, s, !0),
            j = _ && 0 !== o.paint.get(r ? "text-halo-width" : "icon-halo-width").constantOr(1);

        var $ = void 0;
        $ = _ ? c.iconsInText ? ci(T.kind, M, y, g, t, G, V, q, z, R) : li(T.kind, M, y, g, t, G, V, q, r, z, !0) : si(T.kind, M, y, g, t, G, V, q, r, z);
        var X = {
          program: P,
          buffers: u,
          uniformValues: $,
          atlasTexture: A,
          atlasTextureIcon: k,
          atlasInterpolation: D,
          atlasInterpolationIcon: L,
          isSDF: _,
          hasHalo: j,
          tile: a,
          labelPlaneMatrixInv: O
        };

        if (b && c.canOverlap) {
          w = !0;

          var _t327 = u.segments.get();

          for (var _i216 of _t327) {
            C.push({
              segments: new e.SegmentVector([_i216]),
              sortKey: _i216.sortKey,
              state: X
            });
          }
        } else C.push({
          segments: u.segments,
          sortKey: 0,
          state: X
        });
      };

      for (var _l48 of a) {
        var _ret5 = _loop11(_l48);

        if (_ret5 === "continue") continue;
      }

      w && C.sort(function (e, t) {
        return e.sortKey - t.sortKey;
      });

      for (var _e341 of C) {
        var _i215 = _e341.state;

        if (t.terrain && t.terrain.setupElevationDraw(_i215.tile, _i215.program, {
          useDepthForOcclusion: !0,
          labelPlaneMatrixInv: _i215.labelPlaneMatrixInv
        }), _.activeTexture.set(m.TEXTURE0), _i215.atlasTexture.bind(_i215.atlasInterpolation, m.CLAMP_TO_EDGE), _i215.atlasTextureIcon && (_.activeTexture.set(m.TEXTURE1), _i215.atlasTextureIcon && _i215.atlasTextureIcon.bind(_i215.atlasInterpolationIcon, m.CLAMP_TO_EDGE)), _i215.isSDF) {
          var _a130 = _i215.uniformValues;
          _i215.hasHalo && (_a130.u_is_halo = 1, yi(_i215.buffers, _e341.segments, o, t, _i215.program, T, u, d, _a130)), _a130.u_is_halo = 0;
        }

        yi(_i215.buffers, _e341.segments, o, t, _i215.program, T, u, d, _i215.uniformValues);
      }
    }

    function yi(t, i, o, a, r, n, s, l, c) {
      var h = a.context;
      r.draw(h, h.gl.TRIANGLES, n, s, l, e.CullFaceMode.disabled, c, o.id, t.layoutVertexBuffer, t.indexBuffer, i, o.paint, a.transform.zoom, t.programConfigurations.get(o.id), t.dynamicLayoutVertexBuffer, t.opacityVertexBuffer);
    }

    function bi(t, i, o, a, r, n, s) {
      var l = t.context.gl,
          c = o.paint.get("fill-pattern"),
          h = c && c.constantOr(1),
          u = o.getCrossfadeParameters();

      var d, _, m, p, f;

      s ? (_ = h && !o.getPaintProperty("fill-outline-color") ? "fillOutlinePattern" : "fillOutline", d = l.LINES) : (_ = h ? "fillPattern" : "fill", d = l.TRIANGLES);

      for (var _g17 of a) {
        var _a131 = i.getTile(_g17);

        if (h && !_a131.patternsLoaded()) continue;

        var _v16 = _a131.getBucket(o);

        if (!_v16) continue;
        t.prepareDrawTile(_g17);

        var _x13 = _v16.programConfigurations.get(o.id),
            _y15 = t.useProgram(_, _x13);

        h && (t.context.activeTexture.set(l.TEXTURE0), _a131.imageAtlasTexture.bind(l.LINEAR, l.CLAMP_TO_EDGE), _x13.updatePaintBuffers(u));

        var _b13 = c.constantOr(null);

        if (_b13 && _a131.imageAtlas) {
          var _e345 = _a131.imageAtlas,
              _t328 = _e345.patternPositions[_b13.to.toString()],
              _i217 = _e345.patternPositions[_b13.from.toString()];

          _t328 && _i217 && _x13.setConstantPatternPositions(_t328, _i217);
        }

        var _w11 = t.translatePosMatrix(_g17.posMatrix, _a131, o.paint.get("fill-translate"), o.paint.get("fill-translate-anchor"));

        if (s) {
          p = _v16.indexBuffer2, f = _v16.segments2;

          var _e346 = t.terrain && t.terrain.renderingToTexture ? t.terrain.drapeBufferSize : [l.drawingBufferWidth, l.drawingBufferHeight];

          m = "fillOutlinePattern" === _ && h ? Xt(_w11, t, u, _a131, _e346) : $t(_w11, _e346);
        } else p = _v16.indexBuffer, f = _v16.segments, m = h ? jt(_w11, t, u, _a131) : qt(_w11);

        _y15.draw(t.context, d, r, t.stencilModeForClipping(_g17), n, e.CullFaceMode.disabled, m, o.id, _v16.layoutVertexBuffer, p, f, o.paint, t.transform.zoom, _x13);
      }
    }

    function wi(t, i, o, a, r, n, s) {
      var l = t.context,
          c = l.gl,
          h = o.paint.get("fill-extrusion-pattern"),
          u = h.constantOr(1),
          d = o.getCrossfadeParameters(),
          _ = o.paint.get("fill-extrusion-opacity");

      for (var _m17 of a) {
        var _a132 = i.getTile(_m17),
            _p21 = _a132.getBucket(o);

        if (!_p21) continue;

        var _f16 = _p21.programConfigurations.get(o.id),
            _g18 = t.useProgram(u ? "fillExtrusionPattern" : "fillExtrusion", _f16);

        if (t.terrain) {
          var _e347 = t.terrain;
          if (!_p21.enableTerrain) continue;

          if (_e347.setupElevationDraw(_a132, _g18, {
            useMeterToDem: !0
          }), Ti(l, i, _m17, _p21, o, _e347), !_p21.centroidVertexBuffer) {
            var _e348 = _g18.attributes.a_centroid_pos;
            void 0 !== _e348 && c.vertexAttrib2f(_e348, 0, 0);
          }
        }

        u && (t.context.activeTexture.set(c.TEXTURE0), _a132.imageAtlasTexture.bind(c.LINEAR, c.CLAMP_TO_EDGE), _f16.updatePaintBuffers(d));

        var _v17 = h.constantOr(null);

        if (_v17 && _a132.imageAtlas) {
          var _e349 = _a132.imageAtlas,
              _t329 = _e349.patternPositions[_v17.to.toString()],
              _i218 = _e349.patternPositions[_v17.from.toString()];

          _t329 && _i218 && _f16.setConstantPatternPositions(_t329, _i218);
        }

        var _x14 = t.translatePosMatrix(_m17.posMatrix, _a132, o.paint.get("fill-extrusion-translate"), o.paint.get("fill-extrusion-translate-anchor")),
            _y16 = o.paint.get("fill-extrusion-vertical-gradient"),
            _b14 = u ? Vt(_x14, t, _y16, _, _m17, d, _a132) : Gt(_x14, t, _y16, _);

        _g18.draw(l, l.gl.TRIANGLES, r, n, s, e.CullFaceMode.backCCW, _b14, o.id, _p21.layoutVertexBuffer, _p21.indexBuffer, _p21.segments, o.paint, t.transform.zoom, _f16, t.terrain ? _p21.centroidVertexBuffer : null);
      }
    }

    function Ti(t, i, o, a, r, n) {
      var s = [function (t) {
        var i = t.canonical.x - 1,
            o = t.wrap;
        return i < 0 && (i = (1 << t.canonical.z) - 1, o--), new e.OverscaledTileID(t.overscaledZ, o, t.canonical.z, i, t.canonical.y);
      }, function (t) {
        var i = t.canonical.x + 1,
            o = t.wrap;
        return i === 1 << t.canonical.z && (i = 0, o++), new e.OverscaledTileID(t.overscaledZ, o, t.canonical.z, i, t.canonical.y);
      }, function (t) {
        return new e.OverscaledTileID(t.overscaledZ, t.wrap, t.canonical.z, t.canonical.x, (0 === t.canonical.y ? 1 << t.canonical.z : t.canonical.y) - 1);
      }, function (t) {
        return new e.OverscaledTileID(t.overscaledZ, t.wrap, t.canonical.z, t.canonical.x, t.canonical.y === (1 << t.canonical.z) - 1 ? 0 : t.canonical.y + 1);
      }],
          l = function (e) {
        var t = i.getSource().maxzoom;

        for (var _o99 of [0, -1, 1]) {
          if (e.overscaledZ + _o99 < t) continue;
          if (_o99 > 0 && e.overscaledZ < t) continue;

          var _a133 = i.getTileByID(e.calculateScaledKey(e.overscaledZ + _o99));

          if (_a133 && _a133.hasData()) {
            var _e350 = _a133.getBucket(r);

            if (_e350) return _e350;
          }
        }
      },
          c = [0, 0, 0],
          h = function (t, i) {
        return c[0] = Math.min(t.min.y, i.min.y), c[1] = Math.max(t.max.y, i.max.y), c[2] = e.EXTENT - i.min.x > t.max.x ? i.min.x - e.EXTENT : t.max.x, c;
      },
          u = function (t, i) {
        return c[0] = Math.min(t.min.x, i.min.x), c[1] = Math.max(t.max.x, i.max.x), c[2] = e.EXTENT - i.min.y > t.max.y ? i.min.y - e.EXTENT : t.max.y, c;
      },
          d = [function (e, t) {
        return h(e, t);
      }, function (e, t) {
        return h(t, e);
      }, function (e, t) {
        return u(e, t);
      }, function (e, t) {
        return u(t, e);
      }],
          _ = new e.Point(0, 0);

      var m, p, f;

      var g = function (t, i, a, r, s) {
        var l = [[r ? a : t, r ? t : a, 0], [r ? a : i, r ? i : a, 0]],
            c = s < 0 ? e.EXTENT + s : s,
            h = [r ? c : (t + i) / 2, r ? (t + i) / 2 : c, 0];
        return 0 === a && s < 0 || 0 !== a && s > 0 ? n.getForTilePoints(f, [h], !0, p) : l.push(h), n.getForTilePoints(o, l, !0, m), Math.max(l[0][2], l[1][2], h[2]) / n.exaggeration();
      };

      for (var _t330 = 0; _t330 < 4; _t330++) {
        var _i219 = a.borders[_t330];
        if (0 === _i219.length && (a.borderDone[_t330] = !0), a.borderDone[_t330]) continue;

        var _r234 = f = s[_t330](o),
            _c34 = l(_r234);

        if (!_c34 || !_c34.enableTerrain) continue;
        if (p = n.findDEMTileFor(_r234), !p || !p.dem) continue;

        if (!m) {
          var _e351 = n.findDEMTileFor(o);

          if (!_e351 || !_e351.dem) return;
          m = _e351;
        }

        var _h26 = (_t330 < 2 ? 1 : 5) - _t330,
            _u40 = _c34.borders[_h26];

        var _v18 = 0;

        for (var _o100 = 0; _o100 < _i219.length; _o100++) {
          var _r235 = a.featuresOnBorder[_i219[_o100]],
              _n146 = _r235.borders[_t330];

          var _s115 = void 0;

          for (; _v18 < _u40.length && (_s115 = _c34.featuresOnBorder[_u40[_v18]], !(_s115.borders[_h26][1] > _n146[0] + 3));) {
            _c34.borderDone[_h26] || _c34.encodeCentroid(void 0, _s115, !1), _v18++;
          }

          if (_s115 && _v18 < _u40.length) {
            var _i220 = _v18;
            var _o101 = 0;

            for (; !(_s115.borders[_h26][0] > _n146[1] - 3) && (_o101++, ++_v18 !== _u40.length);) {
              _s115 = _c34.featuresOnBorder[_u40[_v18]];
            }

            if (_s115 = _c34.featuresOnBorder[_u40[_i220]], _r235.intersectsCount() > 1 || _s115.intersectsCount() > 1 || 1 !== _o101) {
              1 !== _o101 && (_v18 = _i220), a.encodeCentroid(void 0, _r235, !1), _c34.borderDone[_h26] || _c34.encodeCentroid(void 0, _s115, !1);
              continue;
            }

            var _l49 = d[_t330](_r235, _s115),
                _m18 = _t330 % 2 ? e.EXTENT - 1 : 0;

            _.x = g(_l49[0], Math.min(e.EXTENT - 1, _l49[1]), _m18, _t330 < 2, _l49[2]), _.y = 0, a.encodeCentroid(_, _r235, !1), _c34.borderDone[_h26] || _c34.encodeCentroid(_, _s115, !1);
          } else a.encodeCentroid(void 0, _r235, !1);
        }

        a.borderDone[_t330] = a.needsCentroidUpdate = !0, _c34.borderDone[_h26] || (_c34.borderDone[_h26] = _c34.needsCentroidUpdate = !0);
      }

      (a.needsCentroidUpdate || !a.centroidVertexBuffer && 0 !== a.centroidVertexArray.length) && a.uploadCentroid(t);
    }

    var Ei = new e.Color(1, 0, 0, 1),
        Ci = new e.Color(0, 1, 0, 1),
        Si = new e.Color(0, 0, 1, 1),
        Ii = new e.Color(1, 0, 1, 1),
        Pi = new e.Color(0, 1, 1, 1);

    function Mi(e, t, i, o) {
      Ai(e, 0, t + i / 2, e.transform.width, i, o);
    }

    function zi(e, t, i, o) {
      Ai(e, t - i / 2, 0, i, e.transform.height, o);
    }

    function Ai(t, i, o, a, r, n) {
      var s = t.context,
          l = s.gl;
      l.enable(l.SCISSOR_TEST), l.scissor(i * e.browser.devicePixelRatio, o * e.browser.devicePixelRatio, a * e.browser.devicePixelRatio, r * e.browser.devicePixelRatio), s.clear({
        color: n
      }), l.disable(l.SCISSOR_TEST);
    }

    function Di(t, i, o) {
      var a = t.context,
          r = a.gl,
          n = o.posMatrix,
          s = t.useProgram("debug"),
          l = i.getTileByID(o.key);
      t.terrain && t.terrain.setupElevationDraw(l, s);
      var c = e.DepthMode.disabled,
          h = e.StencilMode.disabled,
          u = t.colorModeForRenderPass();
      a.activeTexture.set(r.TEXTURE0), t.emptyTexture.bind(r.LINEAR, r.CLAMP_TO_EDGE), s.draw(a, r.LINE_STRIP, c, h, u, e.CullFaceMode.disabled, Yt(n, e.Color.red), "$debug", t.debugBuffer, t.tileBorderIndexBuffer, t.debugSegments);

      var d = l.latestRawTileData,
          _ = Math.floor((d && d.byteLength || 0) / 1024),
          m = i.getTile(o).tileSize,
          p = 512 / Math.min(m, 512) * (o.overscaledZ / t.transform.zoom) * .5;

      var f = o.canonical.toString();
      o.overscaledZ !== o.canonical.z && (f += " => ".concat(o.overscaledZ)), function (e, t) {
        e.initDebugOverlayCanvas();
        var i = e.debugOverlayCanvas,
            o = e.context.gl,
            a = e.debugOverlayCanvas.getContext("2d");
        a.clearRect(0, 0, i.width, i.height), a.shadowColor = "white", a.shadowBlur = 2, a.lineWidth = 1.5, a.strokeStyle = "white", a.textBaseline = "top", a.font = "bold 36px Open Sans, sans-serif", a.fillText(t, 5, 5), a.strokeText(t, 5, 5), e.debugOverlayTexture.update(i), e.debugOverlayTexture.bind(o.LINEAR, o.CLAMP_TO_EDGE);
      }(t, "".concat(f, " ").concat(_, "kb")), s.draw(a, r.TRIANGLES, c, h, e.ColorMode.alphaBlended, e.CullFaceMode.disabled, Yt(n, e.Color.transparent, p), "$debug", t.debugBuffer, t.quadTriangleIndexBuffer, t.debugSegments);
    }

    var Li = e.createLayout([{
      name: "a_pos_3f",
      components: 3,
      type: "Float32"
    }]),
        {
      members: Ri
    } = Li;

    function ki(e, t, i, o) {
      e.emplaceBack(t, i, o);
    }

    var Bi = function Bi(t) {
      _classCallCheck(this, Bi);

      this.vertexArray = new e.StructArrayLayout3f12(), this.indices = new e.StructArrayLayout3ui6(), ki(this.vertexArray, -1, -1, 1), ki(this.vertexArray, 1, -1, 1), ki(this.vertexArray, -1, 1, 1), ki(this.vertexArray, 1, 1, 1), ki(this.vertexArray, -1, -1, -1), ki(this.vertexArray, 1, -1, -1), ki(this.vertexArray, -1, 1, -1), ki(this.vertexArray, 1, 1, -1), this.indices.emplaceBack(5, 1, 3), this.indices.emplaceBack(3, 7, 5), this.indices.emplaceBack(6, 2, 0), this.indices.emplaceBack(0, 4, 6), this.indices.emplaceBack(2, 6, 7), this.indices.emplaceBack(7, 3, 2), this.indices.emplaceBack(5, 4, 0), this.indices.emplaceBack(0, 1, 5), this.indices.emplaceBack(0, 2, 3), this.indices.emplaceBack(3, 1, 0), this.indices.emplaceBack(7, 6, 4), this.indices.emplaceBack(4, 5, 7), this.vertexBuffer = t.createVertexBuffer(this.vertexArray, Ri), this.indexBuffer = t.createIndexBuffer(this.indices), this.segment = e.SegmentVector.simpleSegment(0, 0, 36, 12);
    };

    function Fi(t, i, o, a, r, n) {
      var s = t.gl,
          l = i.paint.get("sky-atmosphere-color"),
          c = i.paint.get("sky-atmosphere-halo-color"),
          h = i.paint.get("sky-atmosphere-sun-intensity"),
          u = function (e, t, i, o, a) {
        return {
          u_matrix_3f: e,
          u_sun_direction: t,
          u_sun_intensity: i,
          u_color_tint_r: [o.r, o.g, o.b, o.a],
          u_color_tint_m: [a.r, a.g, a.b, a.a],
          u_luminance: 5e-5
        };
      }(e.fromMat4([], a), r, h, l, c);

      s.framebufferTexture2D(s.FRAMEBUFFER, s.COLOR_ATTACHMENT0, s.TEXTURE_CUBE_MAP_POSITIVE_X + n, i.skyboxTexture, 0), o.draw(t, s.TRIANGLES, e.DepthMode.disabled, e.StencilMode.disabled, e.ColorMode.unblended, e.CullFaceMode.frontCW, u, "skyboxCapture", i.skyboxGeometry.vertexBuffer, i.skyboxGeometry.indexBuffer, i.skyboxGeometry.segment);
    }

    var Oi = {
      symbol: function (t, i, o, a, r) {
        if ("translucent" !== t.renderPass) return;
        var n = e.StencilMode.disabled,
            s = t.colorModeForRenderPass();
        o.layout.get("text-variable-anchor") && function (t, i, o, a, r, n, s) {
          var l = i.transform,
              c = "map" === r,
              h = "map" === n;

          var _loop12 = function (_r236) {
            var t = a.getTile(_r236),
                n = t.getBucket(o);
            if (!n || !n.text || !n.text.segments.get().length) return "continue";

            var u = e.evaluateSizeForZoom(n.textSizeData, l.zoom),
                d = v(t, 1, i.transform.zoom),
                _ = H(_r236.posMatrix, h, c, i.transform, d),
                m = "none" !== o.layout.get("icon-text-fit") && n.hasIconData();

            if (u) {
              var _i221 = Math.pow(2, l.zoom - t.tileID.overscaledZ),
                  _o102 = l.elevation;

              gi(n, c, h, s, e.symbolSize, l, _, _r236.posMatrix, _i221, u, m, _o102 ? function (e) {
                return _o102.getAtTileOffset(_r236, e.x, e.y);
              } : function (e) {
                return 0;
              });
            }
          };

          for (var _r236 of t) {
            var _ret6 = _loop12(_r236);

            if (_ret6 === "continue") continue;
          }
        }(a, t, o, i, o.layout.get("text-rotation-alignment"), o.layout.get("text-pitch-alignment"), r), 0 !== o.paint.get("icon-opacity").constantOr(1) && xi(t, i, o, a, !1, o.paint.get("icon-translate"), o.paint.get("icon-translate-anchor"), o.layout.get("icon-rotation-alignment"), o.layout.get("icon-pitch-alignment"), o.layout.get("icon-keep-upright"), n, s), 0 !== o.paint.get("text-opacity").constantOr(1) && xi(t, i, o, a, !0, o.paint.get("text-translate"), o.paint.get("text-translate-anchor"), o.layout.get("text-rotation-alignment"), o.layout.get("text-pitch-alignment"), o.layout.get("text-keep-upright"), n, s), i.map.showCollisionBoxes && (mi(t, i, o, a, o.paint.get("text-translate"), o.paint.get("text-translate-anchor"), !0), mi(t, i, o, a, o.paint.get("icon-translate"), o.paint.get("icon-translate-anchor"), !1));
      },
      circle: function (t, i, o, a) {
        if ("translucent" !== t.renderPass) return;
        var r = o.paint.get("circle-opacity"),
            n = o.paint.get("circle-stroke-width"),
            s = o.paint.get("circle-stroke-opacity"),
            l = void 0 !== o.layout.get("circle-sort-key").constantOr(1);
        if (0 === r.constantOr(1) && (0 === n.constantOr(1) || 0 === s.constantOr(1))) return;

        var c = t.context,
            h = c.gl,
            u = t.depthModeForSublayer(0, e.DepthMode.ReadOnly),
            d = e.StencilMode.disabled,
            _ = t.colorModeForRenderPass(),
            m = [];

        for (var _r237 = 0; _r237 < a.length; _r237++) {
          var _n147 = a[_r237],
              _s116 = i.getTile(_n147),
              _c35 = _s116.getBucket(o);

          if (!_c35) continue;

          var _h27 = _c35.programConfigurations.get(o.id),
              _u41 = Ht(o),
              _d18 = {
            programConfiguration: _h27,
            program: t.useProgram("circle", _h27, _u41),
            layoutVertexBuffer: _c35.layoutVertexBuffer,
            indexBuffer: _c35.indexBuffer,
            uniformValues: Wt(t, _n147, _s116, o),
            tile: _s116
          };

          if (l) {
            var _t331 = _c35.segments.get();

            for (var _i222 of _t331) {
              m.push({
                segments: new e.SegmentVector([_i222]),
                sortKey: _i222.sortKey,
                state: _d18
              });
            }
          } else m.push({
            segments: _c35.segments,
            sortKey: 0,
            state: _d18
          });
        }

        l && m.sort(function (e, t) {
          return e.sortKey - t.sortKey;
        });

        for (var _i223 of m) {
          var {
            programConfiguration: _a134,
            program: _r238,
            layoutVertexBuffer: _n148,
            indexBuffer: _s117,
            uniformValues: _l50,
            tile: _m19
          } = _i223.state,
              _p22 = _i223.segments;
          t.terrain && t.terrain.setupElevationDraw(_m19, _r238, {
            useDepthForOcclusion: !0
          }), _r238.draw(c, h.TRIANGLES, u, d, _, e.CullFaceMode.disabled, _l50, o.id, _n148, _s117, _p22, o.paint, t.transform.zoom, _a134);
        }
      },
      heatmap: function (t, i, o, a) {
        if (0 !== o.paint.get("heatmap-opacity")) if ("offscreen" === t.renderPass) {
          var _r239 = t.context,
              _n149 = _r239.gl,
              _s118 = e.StencilMode.disabled,
              _l51 = new e.ColorMode([_n149.ONE, _n149.ONE], e.Color.transparent, [!0, !0, !0, !0]);

          !function (e, t, i) {
            var o = e.gl;
            e.activeTexture.set(o.TEXTURE1), e.viewport.set([0, 0, t.width / 4, t.height / 4]);
            var a = i.heatmapFbo;
            if (a) o.bindTexture(o.TEXTURE_2D, a.colorAttachment.get()), e.bindFramebuffer.set(a.framebuffer);else {
              var _r240 = o.createTexture();

              o.bindTexture(o.TEXTURE_2D, _r240), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_WRAP_S, o.CLAMP_TO_EDGE), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_WRAP_T, o.CLAMP_TO_EDGE), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_MIN_FILTER, o.LINEAR), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_MAG_FILTER, o.LINEAR), a = i.heatmapFbo = e.createFramebuffer(t.width / 4, t.height / 4, !1), function (e, t, i, o) {
                var a = e.gl;
                a.texImage2D(a.TEXTURE_2D, 0, a.RGBA, t.width / 4, t.height / 4, 0, a.RGBA, e.extRenderToTextureHalfFloat ? e.extTextureHalfFloat.HALF_FLOAT_OES : a.UNSIGNED_BYTE, null), o.colorAttachment.set(i);
              }(e, t, _r240, a);
            }
          }(_r239, t, o), _r239.clear({
            color: e.Color.transparent
          });

          for (var _c36 = 0; _c36 < a.length; _c36++) {
            var _h28 = a[_c36];
            if (i.hasRenderableParent(_h28)) continue;

            var _u42 = i.getTile(_h28),
                _d19 = _u42.getBucket(o);

            if (!_d19) continue;

            var _14 = _d19.programConfigurations.get(o.id),
                _m20 = t.useProgram("heatmap", _14),
                {
              zoom: _p23
            } = t.transform;

            t.terrain && t.terrain.setupElevationDraw(_u42, _m20), _m20.draw(_r239, _n149.TRIANGLES, e.DepthMode.disabled, _s118, _l51, e.CullFaceMode.disabled, Jt(_h28.posMatrix, _u42, _p23, o.paint.get("heatmap-intensity")), o.id, _d19.layoutVertexBuffer, _d19.indexBuffer, _d19.segments, o.paint, t.transform.zoom, _14);
          }

          _r239.viewport.set([0, 0, t.width, t.height]);
        } else "translucent" === t.renderPass && (t.context.setColorMode(t.colorModeForRenderPass()), function (t, i) {
          var o = t.context,
              a = o.gl,
              r = i.heatmapFbo;
          if (!r) return;
          o.activeTexture.set(a.TEXTURE0), a.bindTexture(a.TEXTURE_2D, r.colorAttachment.get()), o.activeTexture.set(a.TEXTURE1);
          var n = i.colorRampTexture;
          n || (n = i.colorRampTexture = new e.Texture(o, i.colorRamp, a.RGBA)), n.bind(a.LINEAR, a.CLAMP_TO_EDGE), t.useProgram("heatmapTexture").draw(o, a.TRIANGLES, e.DepthMode.disabled, e.StencilMode.disabled, t.colorModeForRenderPass(), e.CullFaceMode.disabled, function (t, i, o, a) {
            var r = e.create();
            e.ortho(r, 0, t.width, t.height, 0, 0, 1);
            var n = t.context.gl;
            return {
              u_matrix: r,
              u_world: [n.drawingBufferWidth, n.drawingBufferHeight],
              u_image: 0,
              u_color_ramp: 1,
              u_opacity: i.paint.get("heatmap-opacity")
            };
          }(t, i), i.id, t.viewportBuffer, t.quadTriangleIndexBuffer, t.viewportSegments, i.paint, t.transform.zoom);
        }(t, o));
      },
      line: function (t, i, o, a) {
        if ("translucent" !== t.renderPass) return;
        var r = o.paint.get("line-opacity"),
            n = o.paint.get("line-width");
        if (0 === r.constantOr(1) || 0 === n.constantOr(1)) return;

        var s = t.depthModeForSublayer(0, e.DepthMode.ReadOnly),
            l = t.colorModeForRenderPass(),
            c = o.paint.get("line-dasharray"),
            h = o.paint.get("line-pattern"),
            u = h.constantOr(1),
            d = o.paint.get("line-gradient"),
            _ = o.getCrossfadeParameters(),
            m = u ? "linePattern" : c ? "lineSDF" : d ? "lineGradient" : "line",
            p = t.context,
            f = p.gl;

        var g = !0;

        for (var _r241 of a) {
          var _a135 = i.getTile(_r241);

          if (u && !_a135.patternsLoaded()) continue;

          var _n150 = _a135.getBucket(o);

          if (!_n150) continue;
          t.prepareDrawTile(_r241);

          var _v19 = _n150.programConfigurations.get(o.id),
              _x15 = t.context.program.get(),
              _y17 = t.useProgram(m, _v19),
              _b15 = g || _y17.program !== _x15,
              _w12 = h.constantOr(null);

          if (_w12 && _a135.imageAtlas) {
            var _e352 = _a135.imageAtlas,
                _t332 = _e352.patternPositions[_w12.to.toString()],
                _i224 = _e352.patternPositions[_w12.from.toString()];

            _t332 && _i224 && _v19.setConstantPatternPositions(_t332, _i224);
          }

          var _T7 = t.terrain ? _r241.posMatrix : null,
              _E5 = u ? ti(t, _a135, o, _, _T7) : c ? ii(t, _a135, o, c, _, _T7) : d ? ei(t, _a135, o, _T7, _n150.lineClipsArray.length) : Qt(t, _a135, o, _T7);

          if (u) p.activeTexture.set(f.TEXTURE0), _a135.imageAtlasTexture.bind(f.LINEAR, f.CLAMP_TO_EDGE), _v19.updatePaintBuffers(_);else if (c && (_b15 || t.lineAtlas.dirty)) p.activeTexture.set(f.TEXTURE0), t.lineAtlas.bind(p);else if (d) {
            var _a136 = _n150.gradients[o.id];
            var _s119 = _a136.texture;

            if (o.gradientVersion !== _a136.version) {
              var _l52 = 256;

              if (o.stepInterpolant) {
                var _o103 = i.getSource().maxzoom,
                    _a137 = _r241.canonical.z === _o103 ? Math.ceil(1 << t.transform.maxZoom - _r241.canonical.z) : 1;

                _l52 = e.clamp(e.nextPowerOfTwo(_n150.maxLineLength / e.EXTENT * 1024 * _a137), 256, p.maxTextureSize);
              }

              _a136.gradient = e.renderColorRamp({
                expression: o.gradientExpression(),
                evaluationKey: "lineProgress",
                resolution: _l52,
                image: _a136.gradient || void 0,
                clips: _n150.lineClipsArray
              }), _a136.texture ? _a136.texture.update(_a136.gradient) : _a136.texture = new e.Texture(p, _a136.gradient, f.RGBA), _a136.version = o.gradientVersion, _s119 = _a136.texture;
            }

            p.activeTexture.set(f.TEXTURE0), _s119.bind(o.stepInterpolant ? f.NEAREST : f.LINEAR, f.CLAMP_TO_EDGE);
          }
          _y17.draw(p, f.TRIANGLES, s, t.stencilModeForClipping(_r241), l, e.CullFaceMode.disabled, _E5, o.id, _n150.layoutVertexBuffer, _n150.indexBuffer, _n150.segments, o.paint, t.transform.zoom, _v19, _n150.layoutVertexBuffer2), g = !1;
        }
      },
      fill: function (t, i, o, a) {
        var r = o.paint.get("fill-color"),
            n = o.paint.get("fill-opacity");
        if (0 === n.constantOr(1)) return;
        var s = t.colorModeForRenderPass(),
            l = o.paint.get("fill-pattern"),
            c = t.opaquePassEnabledForLayer() && !l.constantOr(1) && 1 === r.constantOr(e.Color.transparent).a && 1 === n.constantOr(0) ? "opaque" : "translucent";

        if (t.renderPass === c) {
          var _r242 = t.depthModeForSublayer(1, "opaque" === t.renderPass ? e.DepthMode.ReadWrite : e.DepthMode.ReadOnly);

          bi(t, i, o, a, _r242, s, !1);
        }

        if ("translucent" === t.renderPass && o.paint.get("fill-antialias")) {
          var _r243 = t.depthModeForSublayer(o.getPaintProperty("fill-outline-color") ? 2 : 0, e.DepthMode.ReadOnly);

          bi(t, i, o, a, _r243, s, !0);
        }
      },
      "fill-extrusion": function (t, i, o, a) {
        var r = o.paint.get("fill-extrusion-opacity");

        if (0 !== r && "translucent" === t.renderPass) {
          var _n151 = new e.DepthMode(t.context.gl.LEQUAL, e.DepthMode.ReadWrite, t.depthRangeFor3D);

          if (1 !== r || o.paint.get("fill-extrusion-pattern").constantOr(1)) wi(t, i, o, a, _n151, e.StencilMode.disabled, e.ColorMode.disabled), wi(t, i, o, a, _n151, t.stencilModeFor3D(), t.colorModeForRenderPass());else {
            var _r244 = t.colorModeForRenderPass();

            wi(t, i, o, a, _n151, e.StencilMode.disabled, _r244);
          }
        }
      },
      hillshade: function (t, i, o, a) {
        if ("offscreen" !== t.renderPass && "translucent" !== t.renderPass) return;
        var r = t.context,
            n = t.depthModeForSublayer(0, e.DepthMode.ReadOnly),
            s = t.colorModeForRenderPass(),
            l = t.terrain && t.terrain.renderingToTexture,
            [c, h] = "translucent" !== t.renderPass || l ? [{}, a] : t.stencilConfigForOverlap(a);

        for (var _a138 of h) {
          var _r245 = i.getTile(_a138);

          if (_r245.needsHillshadePrepare && "offscreen" === t.renderPass) It(t, _r245, o, n, e.StencilMode.disabled, s);else if ("translucent" === t.renderPass) {
            var _e353 = l && t.terrain ? t.terrain.stencilModeForRTTOverlap(_a138) : c[_a138.overscaledZ];

            Ct(t, _a138, _r245, o, n, _e353, s);
          }
        }

        r.viewport.set([0, 0, t.width, t.height]);
      },
      raster: function (t, i, o, a, r, n) {
        if ("translucent" !== t.renderPass) return;
        if (0 === o.paint.get("raster-opacity")) return;
        if (!a.length) return;
        var s = t.context,
            l = s.gl,
            c = i.getSource(),
            h = t.useProgram("raster"),
            u = t.colorModeForRenderPass(),
            d = t.terrain && t.terrain.renderingToTexture,
            [_, m] = c instanceof C || d ? [{}, a] : t.stencilConfigForOverlap(a),
            p = m[m.length - 1].overscaledZ,
            f = !t.options.moving;

        for (var _a139 of m) {
          var _r246 = d ? e.DepthMode.disabled : t.depthModeForSublayer(_a139.overscaledZ - p, 1 === o.paint.get("raster-opacity") ? e.DepthMode.ReadWrite : e.DepthMode.ReadOnly, l.LESS),
              _m21 = i.getTile(_a139);

          if (d && (!_m21 || !_m21.hasData())) continue;

          var _g19 = d ? _a139.posMatrix : t.transform.calculatePosMatrix(_a139.toUnwrapped(), f),
              _v20 = t.terrain && d ? t.terrain.stencilModeForRTTOverlap(_a139) : _[_a139.overscaledZ],
              _x16 = n ? 0 : o.paint.get("raster-fade-duration");

          _m21.registerFadeDuration(_x16);

          var _y18 = i.findLoadedParent(_a139, 0),
              _b16 = kt(_m21, _y18, i, t.transform, _x16);

          var _w13 = void 0,
              _T8 = void 0;

          t.terrain && t.terrain.prepareDrawTile(_a139);

          var _E6 = "nearest" === o.paint.get("raster-resampling") ? l.NEAREST : l.LINEAR;

          s.activeTexture.set(l.TEXTURE0), _m21.texture.bind(_E6, l.CLAMP_TO_EDGE, l.LINEAR_MIPMAP_NEAREST), s.activeTexture.set(l.TEXTURE1), _y18 ? (_y18.texture.bind(_E6, l.CLAMP_TO_EDGE, l.LINEAR_MIPMAP_NEAREST), _w13 = Math.pow(2, _y18.tileID.overscaledZ - _m21.tileID.overscaledZ), _T8 = [_m21.tileID.canonical.x * _w13 % 1, _m21.tileID.canonical.y * _w13 % 1]) : _m21.texture.bind(_E6, l.CLAMP_TO_EDGE, l.LINEAR_MIPMAP_NEAREST);

          var _S7 = ri(_g19, _T8 || [0, 0], _w13 || 1, _b16, o);

          c instanceof C ? h.draw(s, l.TRIANGLES, _r246, e.StencilMode.disabled, u, e.CullFaceMode.disabled, _S7, o.id, c.boundsBuffer, t.quadTriangleIndexBuffer, c.boundsSegments) : h.draw(s, l.TRIANGLES, _r246, _v20, u, e.CullFaceMode.disabled, _S7, o.id, t.rasterBoundsBuffer, t.quadTriangleIndexBuffer, t.rasterBoundsSegments);
        }
      },
      background: function (t, i, o, a) {
        var r = o.paint.get("background-color"),
            n = o.paint.get("background-opacity");
        if (0 === n) return;
        var s = t.context,
            l = s.gl,
            c = t.transform,
            h = c.tileSize,
            u = o.paint.get("background-pattern");
        if (t.isPatternMissing(u)) return;
        var d = !u && 1 === r.a && 1 === n && t.opaquePassEnabledForLayer() ? "opaque" : "translucent";
        if (t.renderPass !== d) return;
        var _ = e.StencilMode.disabled,
            m = t.depthModeForSublayer(0, "opaque" === d ? e.DepthMode.ReadWrite : e.DepthMode.ReadOnly),
            p = t.colorModeForRenderPass(),
            f = t.useProgram(u ? "backgroundPattern" : "background"),
            g = a || c.coveringTiles({
          tileSize: h
        });
        u && (s.activeTexture.set(l.TEXTURE0), t.imageManager.bind(t.context));
        var v = o.getCrossfadeParameters();

        for (var _i225 of g) {
          var _c37 = a ? _i225.posMatrix : t.transform.calculatePosMatrix(_i225.toUnwrapped());

          t.prepareDrawTile(_i225);

          var _d20 = u ? ui(_c37, n, t, u, {
            tileID: _i225,
            tileSize: h
          }, v) : hi(_c37, n, r);

          f.draw(s, l.TRIANGLES, m, _, p, e.CullFaceMode.disabled, _d20, o.id, t.tileExtentBuffer, t.quadTriangleIndexBuffer, t.tileExtentSegments);
        }
      },
      sky: function (t, i, o) {
        var a = o.paint.get("sky-opacity");
        if (0 === a) return;
        var r = t.context,
            n = o.paint.get("sky-type"),
            s = new e.DepthMode(r.gl.LEQUAL, e.DepthMode.ReadOnly, [0, 1]),
            l = t.frameCounter / 1e3 % 1;
        "atmosphere" === n ? "offscreen" === t.renderPass ? o.needsSkyboxCapture(t) && (function (t, i, o, a) {
          var r = t.context,
              n = r.gl;
          var s = i.skyboxFbo;

          if (!s) {
            s = i.skyboxFbo = r.createFramebuffer(32, 32, !1), i.skyboxGeometry = new Bi(r), i.skyboxTexture = r.gl.createTexture(), n.bindTexture(n.TEXTURE_CUBE_MAP, i.skyboxTexture), n.texParameteri(n.TEXTURE_CUBE_MAP, n.TEXTURE_WRAP_S, n.CLAMP_TO_EDGE), n.texParameteri(n.TEXTURE_CUBE_MAP, n.TEXTURE_WRAP_T, n.CLAMP_TO_EDGE), n.texParameteri(n.TEXTURE_CUBE_MAP, n.TEXTURE_MIN_FILTER, n.LINEAR), n.texParameteri(n.TEXTURE_CUBE_MAP, n.TEXTURE_MAG_FILTER, n.LINEAR);

            for (var _e354 = 0; _e354 < 6; ++_e354) {
              n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X + _e354, 0, n.RGBA, 32, 32, 0, n.RGBA, n.UNSIGNED_BYTE, null);
            }
          }

          r.bindFramebuffer.set(s.framebuffer), r.viewport.set([0, 0, 32, 32]);
          var l = i.getCenter(t, !0),
              c = t.useProgram("skyboxCapture"),
              h = new Float64Array(16);
          e.identity(h), e.rotateY(h, h, .5 * -Math.PI), Fi(r, i, c, h, l, 0), e.identity(h), e.rotateY(h, h, .5 * Math.PI), Fi(r, i, c, h, l, 1), e.identity(h), e.rotateX(h, h, .5 * -Math.PI), Fi(r, i, c, h, l, 2), e.identity(h), e.rotateX(h, h, .5 * Math.PI), Fi(r, i, c, h, l, 3), e.identity(h), Fi(r, i, c, h, l, 4), e.identity(h), e.rotateY(h, h, Math.PI), Fi(r, i, c, h, l, 5), r.viewport.set([0, 0, t.width, t.height]);
        }(t, o), o.markSkyboxValid(t)) : "sky" === t.renderPass && function (t, i, o, a, r) {
          var n = t.context,
              s = n.gl,
              l = t.transform,
              c = t.useProgram("skybox");
          n.activeTexture.set(s.TEXTURE0), s.bindTexture(s.TEXTURE_CUBE_MAP, i.skyboxTexture);

          var h = function (e, t, i, o, a) {
            return {
              u_matrix: e,
              u_sun_direction: t,
              u_cubemap: 0,
              u_opacity: o,
              u_temporal_offset: a
            };
          }(l.skyboxMatrix, i.getCenter(t, !1), 0, a, r);

          c.draw(n, s.TRIANGLES, o, e.StencilMode.disabled, t.colorModeForRenderPass(), e.CullFaceMode.backCW, h, "skybox", i.skyboxGeometry.vertexBuffer, i.skyboxGeometry.indexBuffer, i.skyboxGeometry.segment);
        }(t, o, s, a, l) : "gradient" === n && "sky" === t.renderPass && function (t, i, o, a, r) {
          var n = t.context,
              s = n.gl,
              l = t.transform,
              c = t.useProgram("skyboxGradient");
          i.skyboxGeometry || (i.skyboxGeometry = new Bi(n)), n.activeTexture.set(s.TEXTURE0);
          var h = i.colorRampTexture;
          h || (h = i.colorRampTexture = new e.Texture(n, i.colorRamp, s.RGBA)), h.bind(s.LINEAR, s.CLAMP_TO_EDGE);

          var u = function (t, i, o, a, r) {
            return {
              u_matrix: t,
              u_color_ramp: 0,
              u_center_direction: i,
              u_radius: e.degToRad(o),
              u_opacity: a,
              u_temporal_offset: r
            };
          }(l.skyboxMatrix, i.getCenter(t, !1), i.paint.get("sky-gradient-radius"), a, r);

          c.draw(n, s.TRIANGLES, o, e.StencilMode.disabled, t.colorModeForRenderPass(), e.CullFaceMode.backCW, u, "skyboxGradient", i.skyboxGeometry.vertexBuffer, i.skyboxGeometry.indexBuffer, i.skyboxGeometry.segment);
        }(t, o, s, a, l);
      },
      debug: function (e, t, i) {
        for (var _o104 = 0; _o104 < i.length; _o104++) {
          Di(e, t, i[_o104]);
        }
      },
      custom: function (t, i, o) {
        var a = t.context,
            r = o.implementation;

        if ("offscreen" === t.renderPass) {
          var _e355 = r.prerender;
          _e355 && (t.setCustomLayerDefaults(), a.setColorMode(t.colorModeForRenderPass()), _e355.call(r, a.gl, t.transform.customLayerMatrix()), a.setDirty(), t.setBaseState());
        } else if ("translucent" === t.renderPass) {
          t.setCustomLayerDefaults(), a.setColorMode(t.colorModeForRenderPass()), a.setStencilMode(e.StencilMode.disabled);

          var _i226 = "3d" === r.renderingMode ? new e.DepthMode(t.context.gl.LEQUAL, e.DepthMode.ReadWrite, t.depthRangeFor3D) : t.depthModeForSublayer(0, e.DepthMode.ReadOnly);

          a.setDepthMode(_i226), r.render(a.gl, t.transform.customLayerMatrix()), a.setDirty(), t.setBaseState(), a.bindFramebuffer.set(null);
        }
      }
    };

    var Ui = /*#__PURE__*/function () {
      function Ui(t, i) {
        _classCallCheck(this, Ui);

        this.context = new e.Context(t), this.transform = i, this._tileTextures = {}, this.frameCopies = [], this.loadTimeStamps = [], this.setup(), this.numSublayers = e.SourceCache.maxUnderzooming + e.SourceCache.maxOverzooming + 1, this.depthEpsilon = 1 / Math.pow(2, 16), this.crossTileSymbolIndex = new ke(), this.gpuTimers = {}, this.frameCounter = 0;
      }

      _createClass(Ui, [{
        key: "updateTerrain",
        value: function updateTerrain(e, t) {
          var i = !!e && !!e.terrain;
          if (!(i || this._terrain && this._terrain.enabled)) return;
          this._terrain || (this._terrain = new Ot(this, e));
          var o = this._terrain;
          this.transform.elevation = i ? o : null, o.update(e, this.transform, t);
        }
      }, {
        key: "terrain",
        get: function () {
          return this._terrain && this._terrain.enabled ? this._terrain : null;
        }
      }, {
        key: "resize",
        value: function resize(t, i) {
          if (this.width = t * e.browser.devicePixelRatio, this.height = i * e.browser.devicePixelRatio, this.context.viewport.set([0, 0, this.width, this.height]), this.style) for (var _e356 of this.style.order) {
            this.style._layers[_e356].resize();
          }
        }
      }, {
        key: "setup",
        value: function setup() {
          var t = this.context,
              i = new e.StructArrayLayout2i4();
          i.emplaceBack(0, 0), i.emplaceBack(e.EXTENT, 0), i.emplaceBack(0, e.EXTENT), i.emplaceBack(e.EXTENT, e.EXTENT), this.tileExtentBuffer = t.createVertexBuffer(i, e.posAttributes.members), this.tileExtentSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2);
          var o = new e.StructArrayLayout2i4();
          o.emplaceBack(0, 0), o.emplaceBack(e.EXTENT, 0), o.emplaceBack(0, e.EXTENT), o.emplaceBack(e.EXTENT, e.EXTENT), this.debugBuffer = t.createVertexBuffer(o, e.posAttributes.members), this.debugSegments = e.SegmentVector.simpleSegment(0, 0, 4, 5);
          var a = new e.StructArrayLayout4i8();
          a.emplaceBack(0, 0, 0, 0), a.emplaceBack(e.EXTENT, 0, e.EXTENT, 0), a.emplaceBack(0, e.EXTENT, 0, e.EXTENT), a.emplaceBack(e.EXTENT, e.EXTENT, e.EXTENT, e.EXTENT), this.rasterBoundsBuffer = t.createVertexBuffer(a, E.members), this.rasterBoundsSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2);
          var r = new e.StructArrayLayout2i4();
          r.emplaceBack(0, 0), r.emplaceBack(1, 0), r.emplaceBack(0, 1), r.emplaceBack(1, 1), this.viewportBuffer = t.createVertexBuffer(r, e.posAttributes.members), this.viewportSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2);
          var n = new e.StructArrayLayout1ui2();
          n.emplaceBack(0), n.emplaceBack(1), n.emplaceBack(3), n.emplaceBack(2), n.emplaceBack(0), this.tileBorderIndexBuffer = t.createIndexBuffer(n);
          var s = new e.StructArrayLayout3ui6();
          s.emplaceBack(0, 1, 2), s.emplaceBack(2, 1, 3), this.quadTriangleIndexBuffer = t.createIndexBuffer(s), this.emptyTexture = new e.Texture(t, {
            width: 1,
            height: 1,
            data: new Uint8Array([0, 0, 0, 0])
          }, t.gl.RGBA);
          var l = this.context.gl;
          this.stencilClearMode = new e.StencilMode({
            func: l.ALWAYS,
            mask: 0
          }, 0, 255, l.ZERO, l.ZERO, l.ZERO), this.loadTimeStamps.push(e.window.performance.now());
        }
      }, {
        key: "clearStencil",
        value: function clearStencil() {
          var t = this.context,
              i = t.gl;
          this.nextStencilID = 1, this.currentStencilSource = void 0;
          var o = e.create();
          e.ortho(o, 0, this.width, this.height, 0, 0, 1), e.scale(o, o, [i.drawingBufferWidth, i.drawingBufferHeight, 0]), this.useProgram("clippingMask").draw(t, i.TRIANGLES, e.DepthMode.disabled, this.stencilClearMode, e.ColorMode.disabled, e.CullFaceMode.disabled, Rt(o), "$clipping", this.viewportBuffer, this.quadTriangleIndexBuffer, this.viewportSegments);
        }
      }, {
        key: "_renderTileClippingMasks",
        value: function _renderTileClippingMasks(t, i, o) {
          if (!(i && this.currentStencilSource !== i.id && t.isTileClipped() && o && o.length)) return;
          this.currentStencilSource = i.id;
          var a = this.context,
              r = a.gl;
          this.nextStencilID + o.length > 256 && this.clearStencil(), a.setColorMode(e.ColorMode.disabled), a.setDepthMode(e.DepthMode.disabled);
          var n = this.useProgram("clippingMask");
          this._tileClippingMaskIDs = {};

          for (var _t333 of o) {
            var _i227 = this._tileClippingMaskIDs[_t333.key] = this.nextStencilID++;

            n.draw(a, r.TRIANGLES, e.DepthMode.disabled, new e.StencilMode({
              func: r.ALWAYS,
              mask: 0
            }, _i227, 255, r.KEEP, r.KEEP, r.REPLACE), e.ColorMode.disabled, e.CullFaceMode.disabled, Rt(_t333.posMatrix), "$clipping", this.tileExtentBuffer, this.quadTriangleIndexBuffer, this.tileExtentSegments);
          }
        }
      }, {
        key: "stencilModeFor3D",
        value: function stencilModeFor3D() {
          this.currentStencilSource = void 0, this.nextStencilID + 1 > 256 && this.clearStencil();
          var t = this.nextStencilID++,
              i = this.context.gl;
          return new e.StencilMode({
            func: i.NOTEQUAL,
            mask: 255
          }, t, 255, i.KEEP, i.KEEP, i.REPLACE);
        }
      }, {
        key: "stencilModeForClipping",
        value: function stencilModeForClipping(t) {
          if (this.terrain) return this.terrain.stencilModeForRTTOverlap(t);
          var i = this.context.gl;
          return new e.StencilMode({
            func: i.EQUAL,
            mask: 255
          }, this._tileClippingMaskIDs[t.key], 0, i.KEEP, i.KEEP, i.REPLACE);
        }
      }, {
        key: "stencilConfigForOverlap",
        value: function stencilConfigForOverlap(t) {
          var i = this.context.gl,
              o = t.sort(function (e, t) {
            return t.overscaledZ - e.overscaledZ;
          }),
              a = o[o.length - 1].overscaledZ,
              r = o[0].overscaledZ - a + 1;

          if (r > 1) {
            this.currentStencilSource = void 0, this.nextStencilID + r > 256 && this.clearStencil();
            var _t334 = {};

            for (var _o105 = 0; _o105 < r; _o105++) {
              _t334[_o105 + a] = new e.StencilMode({
                func: i.GEQUAL,
                mask: 255
              }, _o105 + this.nextStencilID, 255, i.KEEP, i.KEEP, i.REPLACE);
            }

            return this.nextStencilID += r, [_t334, o];
          }

          return [_defineProperty({}, a, e.StencilMode.disabled), o];
        }
      }, {
        key: "colorModeForRenderPass",
        value: function colorModeForRenderPass() {
          var t = this.context.gl;

          if (this._showOverdrawInspector) {
            var _i228 = 1 / 8;

            return new e.ColorMode([t.CONSTANT_COLOR, t.ONE], new e.Color(_i228, _i228, _i228, 0), [!0, !0, !0, !0]);
          }

          return "opaque" === this.renderPass ? e.ColorMode.unblended : e.ColorMode.alphaBlended;
        }
      }, {
        key: "depthModeForSublayer",
        value: function depthModeForSublayer(t, i, o) {
          if (!this.opaquePassEnabledForLayer()) return e.DepthMode.disabled;
          var a = 1 - ((1 + this.currentLayer) * this.numSublayers + t) * this.depthEpsilon;
          return new e.DepthMode(o || this.context.gl.LEQUAL, i, [a, a]);
        }
      }, {
        key: "opaquePassEnabledForLayer",
        value: function opaquePassEnabledForLayer() {
          return this.currentLayer < this.opaquePassCutoff;
        }
      }, {
        key: "render",
        value: function render(t, i) {
          var _this107 = this;

          this.style = t, this.options = i, this.lineAtlas = t.lineAtlas, this.imageManager = t.imageManager, this.glyphManager = t.glyphManager, this.symbolFadeChange = t.placement.symbolFadeChange(e.browser.now()), this.imageManager.beginFrame();
          var o = this.style.order,
              a = this.style._sourceCaches;

          for (var _e357 in a) {
            var _t335 = a[_e357];
            _t335.used && _t335.prepare(this.context);
          }

          var r = {},
              n = {},
              s = {};

          for (var _e358 in a) {
            var _t336 = a[_e358];
            r[_e358] = _t336.getVisibleCoordinates(), n[_e358] = r[_e358].slice().reverse(), s[_e358] = _t336.getVisibleCoordinates(!0).reverse();
          }

          this.opaquePassCutoff = 1 / 0;

          for (var _e359 = 0; _e359 < o.length; _e359++) {
            if (this.style._layers[o[_e359]].is3D()) {
              this.opaquePassCutoff = _e359;
              break;
            }
          }

          this.terrain && (this.terrain.updateTileBinding(s), this.opaquePassCutoff = 0), this.renderPass = "offscreen";

          for (var _e360 of o) {
            var _i229 = this.style._layers[_e360],
                _o106 = t._getLayerSourceCache(_i229);

            if (!_i229.hasOffscreenPass() || _i229.isHidden(this.transform.zoom)) continue;

            var _a140 = _o106 ? n[_o106.id] : void 0;

            ("custom" === _i229.type || _i229.isSky() || _a140 && _a140.length) && this.renderLayer(this, _o106, _i229, _a140);
          }

          if (this.depthRangeFor3D = [0, 1 - (t.order.length + 2) * this.numSublayers * this.depthEpsilon], this.terrain && (this.style.hasSymbolLayers() || this.style.hasCircleLayers()) && this.terrain.drawDepth(), this.context.bindFramebuffer.set(null), this.context.viewport.set([0, 0, this.width, this.height]), this.context.clear({
            color: i.showOverdrawInspector ? e.Color.black : e.Color.transparent,
            depth: 1
          }), this.clearStencil(), this._showOverdrawInspector = i.showOverdrawInspector, this.renderPass = "opaque", !this.terrain) for (this.currentLayer = o.length - 1; this.currentLayer >= 0; this.currentLayer--) {
            var _e361 = this.style._layers[o[this.currentLayer]],
                _i230 = t._getLayerSourceCache(_e361);

            if (_e361.isSky()) continue;

            var _a141 = _i230 ? n[_i230.id] : void 0;

            this._renderTileClippingMasks(_e361, _i230, _a141), this.renderLayer(this, _i230, _e361, _a141);
          }
          if (this.renderPass = "sky", this.transform.isHorizonVisible()) for (this.currentLayer = 0; this.currentLayer < o.length; this.currentLayer++) {
            var _e362 = this.style._layers[o[this.currentLayer]],
                _i231 = t._getLayerSourceCache(_e362);

            _e362.isSky() && this.renderLayer(this, _i231, _e362, _i231 ? n[_i231.id] : void 0);
          }

          for (this.renderPass = "translucent", this.currentLayer = 0; this.currentLayer < o.length;) {
            var _e363 = this.style._layers[o[this.currentLayer]],
                _i232 = t._getLayerSourceCache(_e363);

            if (_e363.isSky()) {
              ++this.currentLayer;
              continue;
            }

            if (this.terrain && this.style.isLayerDraped(_e363)) {
              if (_e363.isHidden(this.transform.zoom)) {
                ++this.currentLayer;
                continue;
              }

              this.currentLayer = this.terrain.renderBatch(this.currentLayer);
              continue;
            }

            var _a142 = _i232 ? ("symbol" === _e363.type ? s : n)[_i232.id] : void 0;

            this._renderTileClippingMasks(_e363, _i232, _i232 ? r[_i232.id] : void 0), this.renderLayer(this, _i232, _e363, _a142), ++this.currentLayer;
          }

          if (this.terrain && this.terrain.postRender(), this.options.showTileBoundaries || this.options.showQueryGeometry) {
            var _i233 = null;
            e.values(this.style._layers).forEach(function (e) {
              var o = t._getLayerSourceCache(e);

              o && !e.isHidden(_this107.transform.zoom) && (!_i233 || _i233.getSource().maxzoom < o.getSource().maxzoom) && (_i233 = o);
            }), _i233 && this.options.showTileBoundaries && Oi.debug(this, _i233, _i233.getVisibleCoordinates());
          }

          this.options.showPadding && function (e) {
            var t = e.transform.padding;
            Mi(e, e.transform.height - (t.top || 0), 3, Ei), Mi(e, t.bottom || 0, 3, Ci), zi(e, t.left || 0, 3, Si), zi(e, e.transform.width - (t.right || 0), 3, Ii);
            var i = e.transform.centerPoint;
            !function (e, t, i, o) {
              Ai(e, t - 1, i - 10, 2, 20, o), Ai(e, t - 10, i - 1, 20, 2, o);
            }(e, i.x, e.transform.height - i.y, Pi);
          }(this), this.context.setDefault(), this.frameCounter = (this.frameCounter + 1) % e.MAX_SAFE_INTEGER, this.tileLoaded && this.options.speedIndexTiming && (this.loadTimeStamps.push(e.window.performance.now()), this.saveCanvasCopy());
        }
      }, {
        key: "renderLayer",
        value: function renderLayer(e, t, i, o) {
          i.isHidden(this.transform.zoom) || ("background" === i.type || "sky" === i.type || "custom" === i.type || o && o.length) && (this.id = i.id, this.gpuTimingStart(i), Oi[i.type](e, t, i, o, this.style.placement.variableOffsets, this.options.isInitialLoad), this.gpuTimingEnd());
        }
      }, {
        key: "gpuTimingStart",
        value: function gpuTimingStart(e) {
          if (!this.options.gpuTiming) return;
          var t = this.context.extTimerQuery;
          var i = this.gpuTimers[e.id];
          i || (i = this.gpuTimers[e.id] = {
            calls: 0,
            cpuTime: 0,
            query: t.createQueryEXT()
          }), i.calls++, t.beginQueryEXT(t.TIME_ELAPSED_EXT, i.query);
        }
      }, {
        key: "gpuTimingEnd",
        value: function gpuTimingEnd() {
          if (!this.options.gpuTiming) return;
          var e = this.context.extTimerQuery;
          e.endQueryEXT(e.TIME_ELAPSED_EXT);
        }
      }, {
        key: "collectGpuTimers",
        value: function collectGpuTimers() {
          var e = this.gpuTimers;
          return this.gpuTimers = {}, e;
        }
      }, {
        key: "queryGpuTimers",
        value: function queryGpuTimers(e) {
          var t = {};

          for (var _i234 in e) {
            var _o107 = e[_i234],
                _a143 = this.context.extTimerQuery,
                _r247 = _a143.getQueryObjectEXT(_o107.query, _a143.QUERY_RESULT_EXT) / 1e6;

            _a143.deleteQueryEXT(_o107.query), t[_i234] = _r247;
          }

          return t;
        }
      }, {
        key: "translatePosMatrix",
        value: function translatePosMatrix(t, i, o, a, r) {
          if (!o[0] && !o[1]) return t;
          var n = r ? "map" === a ? this.transform.angle : 0 : "viewport" === a ? -this.transform.angle : 0;

          if (n) {
            var _e364 = Math.sin(n),
                _t337 = Math.cos(n);

            o = [o[0] * _t337 - o[1] * _e364, o[0] * _e364 + o[1] * _t337];
          }

          var s = [r ? o[0] : v(i, o[0], this.transform.zoom), r ? o[1] : v(i, o[1], this.transform.zoom), 0],
              l = new Float32Array(16);
          return e.translate(l, t, s), l;
        }
      }, {
        key: "saveTileTexture",
        value: function saveTileTexture(e) {
          var t = this._tileTextures[e.size[0]];
          t ? t.push(e) : this._tileTextures[e.size[0]] = [e];
        }
      }, {
        key: "getTileTexture",
        value: function getTileTexture(e) {
          var t = this._tileTextures[e];
          return t && t.length > 0 ? t.pop() : null;
        }
      }, {
        key: "isPatternMissing",
        value: function isPatternMissing(e) {
          if (!e) return !1;
          if (!e.from || !e.to) return !0;
          var t = this.imageManager.getPattern(e.from.toString()),
              i = this.imageManager.getPattern(e.to.toString());
          return !t || !i;
        }
      }, {
        key: "currentGlobalDefines",
        value: function currentGlobalDefines() {
          var e = this.terrain && this.terrain.renderingToTexture,
              t = [];
          return this.terrain && !this.terrain.renderingToTexture && t.push("TERRAIN"), e && t.push("RENDER_TO_TEXTURE"), this._showOverdrawInspector && t.push("OVERDRAW_INSPECTOR"), t;
        }
      }, {
        key: "useProgram",
        value: function useProgram(e, t, i) {
          this.cache = this.cache || {};
          var o = i || [],
              a = this.currentGlobalDefines().concat(o),
              r = Nt.cacheKey(e, a, t);
          return this.cache[r] || (this.cache[r] = new Nt(this.context, e, wt[e], t, di[e], a)), this.cache[r];
        }
      }, {
        key: "setCustomLayerDefaults",
        value: function setCustomLayerDefaults() {
          this.context.unbindVAO(), this.context.cullFace.setDefault(), this.context.activeTexture.setDefault(), this.context.pixelStoreUnpack.setDefault(), this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.context.pixelStoreUnpackFlipY.setDefault();
        }
      }, {
        key: "setBaseState",
        value: function setBaseState() {
          var e = this.context.gl;
          this.context.cullFace.set(!1), this.context.viewport.set([0, 0, this.width, this.height]), this.context.blendEquation.set(e.FUNC_ADD);
        }
      }, {
        key: "initDebugOverlayCanvas",
        value: function initDebugOverlayCanvas() {
          null == this.debugOverlayCanvas && (this.debugOverlayCanvas = e.window.document.createElement("canvas"), this.debugOverlayCanvas.width = 512, this.debugOverlayCanvas.height = 512, this.debugOverlayTexture = new e.Texture(this.context, this.debugOverlayCanvas, this.context.gl.RGBA));
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this._terrain && this._terrain.destroy(), this.emptyTexture.destroy(), this.debugOverlayTexture && this.debugOverlayTexture.destroy();
        }
      }, {
        key: "prepareDrawTile",
        value: function prepareDrawTile(e) {
          this.terrain && this.terrain.prepareDrawTile(e);
        }
      }, {
        key: "setTileLoadedFlag",
        value: function setTileLoadedFlag(e) {
          this.tileLoaded = e;
        }
      }, {
        key: "saveCanvasCopy",
        value: function saveCanvasCopy() {
          this.frameCopies.push(this.canvasCopy()), this.tileLoaded = !1;
        }
      }, {
        key: "canvasCopy",
        value: function canvasCopy() {
          var e = this.context.gl,
              t = e.createTexture();
          return e.bindTexture(e.TEXTURE_2D, t), e.copyTexImage2D(e.TEXTURE_2D, 0, e.RGBA, 0, 0, e.drawingBufferWidth, e.drawingBufferHeight, 0), t;
        }
      }, {
        key: "getCanvasCopiesAndTimestamps",
        value: function getCanvasCopiesAndTimestamps() {
          return {
            canvasCopies: this.frameCopies,
            timeStamps: this.loadTimeStamps
          };
        }
      }]);

      return Ui;
    }();

    var Ni = /*#__PURE__*/function () {
      function Ni() {
        var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
        var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;

        _classCallCheck(this, Ni);

        if (isNaN(e) || e < 0 || isNaN(t) || t < 0 || isNaN(i) || i < 0 || isNaN(o) || o < 0) throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");
        this.top = e, this.bottom = t, this.left = i, this.right = o;
      }

      _createClass(Ni, [{
        key: "interpolate",
        value: function interpolate(t, i, o) {
          return null != i.top && null != t.top && (this.top = e.number(t.top, i.top, o)), null != i.bottom && null != t.bottom && (this.bottom = e.number(t.bottom, i.bottom, o)), null != i.left && null != t.left && (this.left = e.number(t.left, i.left, o)), null != i.right && null != t.right && (this.right = e.number(t.right, i.right, o)), this;
        }
      }, {
        key: "getCenter",
        value: function getCenter(t, i) {
          var o = e.clamp((this.left + t - this.right) / 2, 0, t),
              a = e.clamp((this.top + i - this.bottom) / 2, 0, i);
          return new e.Point(o, a);
        }
      }, {
        key: "equals",
        value: function equals(e) {
          return this.top === e.top && this.bottom === e.bottom && this.left === e.left && this.right === e.right;
        }
      }, {
        key: "clone",
        value: function clone() {
          return new Ni(this.top, this.bottom, this.left, this.right);
        }
      }, {
        key: "toJSON",
        value: function toJSON() {
          return {
            top: this.top,
            bottom: this.bottom,
            left: this.left,
            right: this.right
          };
        }
      }]);

      return Ni;
    }();

    function Zi(e, t) {
      return [e[4 * t], e[4 * t + 1], e[4 * t + 2], e[4 * t + 3]];
    }

    function Gi(e, t, i) {
      e[4 * t + 0] = i[0], e[4 * t + 1] = i[1], e[4 * t + 2] = i[2], e[4 * t + 3] = i[3];
    }

    function Vi(t, i) {
      var o = Zi(t, 3);
      e.fromQuat(t, i), Gi(t, 3, o);
    }

    function qi(e, t) {
      Gi(e, 3, [t[0], t[1], t[2], 1]);
    }

    function ji(t, i) {
      var o = e.identity$1([]);
      return e.rotateZ$1(o, o, -i), e.rotateX$1(o, o, -t), o;
    }

    function $i(t, i) {
      var o = [t[0], t[1], 0],
          a = [i[0], i[1], 0];

      if (e.length(o) >= 1e-15) {
        var _t338 = e.normalize([], o);

        e.scale$2(a, _t338, e.dot(a, _t338)), i[0] = a[0], i[1] = a[1];
      }

      var r = e.cross([], i, t);
      if (e.len(r) < 1e-15) return null;
      var n = Math.atan2(-r[1], r[0]);
      return ji(Math.atan2(Math.sqrt(t[0] * t[0] + t[1] * t[1]), -t[2]), n);
    }

    var Xi = /*#__PURE__*/function () {
      function Xi(e, t) {
        _classCallCheck(this, Xi);

        this.position = e, this.orientation = t;
      }

      _createClass(Xi, [{
        key: "position",
        get: function () {
          return this._position;
        },
        set: function (t) {
          this._position = this._renderWorldCopies ? function (t) {
            if (!t) return;
            var i = Array.isArray(t) ? new e.MercatorCoordinate(t[0], t[1], t[2]) : t;
            return i.x = e.wrap(i.x, 0, 1), i;
          }(t) : t;
        }
      }, {
        key: "lookAtPoint",
        value: function lookAtPoint(t, i) {
          if (this.orientation = null, !this.position) return;
          var o = this._elevation ? this._elevation.getAtPoint(e.MercatorCoordinate.fromLngLat(t)) : 0,
              a = this.position,
              r = e.MercatorCoordinate.fromLngLat(t, o),
              n = [r.x - a.x, r.y - a.y, r.z - a.z];
          i || (i = [0, 0, 1]), i[2] = Math.abs(i[2]), this.orientation = $i(n, i);
        }
      }, {
        key: "setPitchBearing",
        value: function setPitchBearing(t, i) {
          this.orientation = ji(e.degToRad(t), e.degToRad(-i));
        }
      }]);

      return Xi;
    }();

    var Wi = /*#__PURE__*/function () {
      function Wi(t, i) {
        _classCallCheck(this, Wi);

        this._transform = e.identity([]), this._orientation = e.identity$1([]), i && (this._orientation = i, Vi(this._transform, this._orientation)), t && qi(this._transform, t);
      }

      _createClass(Wi, [{
        key: "mercatorPosition",
        get: function () {
          var t = this.position;
          return new e.MercatorCoordinate(t[0], t[1], t[2]);
        }
      }, {
        key: "position",
        get: function () {
          var e = Zi(this._transform, 3);
          return [e[0], e[1], e[2]];
        },
        set: function (e) {
          qi(this._transform, e);
        }
      }, {
        key: "orientation",
        get: function () {
          return this._orientation;
        },
        set: function (e) {
          this._orientation = e, Vi(this._transform, this._orientation);
        }
      }, {
        key: "getPitchBearing",
        value: function getPitchBearing() {
          var e = this.forward(),
              t = this.right();
          return {
            bearing: Math.atan2(-t[1], t[0]),
            pitch: Math.atan2(Math.sqrt(e[0] * e[0] + e[1] * e[1]), -e[2])
          };
        }
      }, {
        key: "setPitchBearing",
        value: function setPitchBearing(e, t) {
          this._orientation = ji(e, t), Vi(this._transform, this._orientation);
        }
      }, {
        key: "forward",
        value: function forward() {
          var e = Zi(this._transform, 2);
          return [-e[0], -e[1], -e[2]];
        }
      }, {
        key: "up",
        value: function up() {
          var e = Zi(this._transform, 1);
          return [-e[0], -e[1], -e[2]];
        }
      }, {
        key: "right",
        value: function right() {
          var e = Zi(this._transform, 0);
          return [e[0], e[1], e[2]];
        }
      }, {
        key: "getCameraToWorld",
        value: function getCameraToWorld(t, i) {
          var o = new Float64Array(16);
          return e.invert(o, this.getWorldToCamera(t, i)), o;
        }
      }, {
        key: "getWorldToCamera",
        value: function getWorldToCamera(t, i) {
          var o = new Float64Array(16),
              a = new Float64Array(4),
              r = this.position;
          return e.conjugate(a, this._orientation), e.scale$2(r, r, -t), e.fromQuat(o, a), e.translate(o, o, r), o[1] *= -1, o[5] *= -1, o[9] *= -1, o[13] *= -1, o[8] *= i, o[9] *= i, o[10] *= i, o[11] *= i, o;
        }
      }, {
        key: "getCameraToClipPerspective",
        value: function getCameraToClipPerspective(t, i, o, a) {
          var r = new Float64Array(16);
          return e.perspective(r, t, i, o, a), r;
        }
      }, {
        key: "clone",
        value: function clone() {
          return new Wi(_toConsumableArray(this.position), _toConsumableArray(this.orientation));
        }
      }]);

      return Wi;
    }();

    var Hi = /*#__PURE__*/function () {
      function Hi(t, i, o, a, r) {
        _classCallCheck(this, Hi);

        this.tileSize = 512, this.maxValidLatitude = 85.051129, this._renderWorldCopies = void 0 === r || r, this._minZoom = t || 0, this._maxZoom = i || 22, this._minPitch = null == o ? 0 : o, this._maxPitch = null == a ? 60 : a, this.setMaxBounds(), this.width = 0, this.height = 0, this._center = new e.LngLat(0, 0), this.zoom = 0, this.angle = 0, this._fov = .6435011087932844, this._pitch = 0, this._unmodified = !0, this._edgeInsets = new Ni(), this._posMatrixCache = {}, this._alignedPosMatrixCache = {}, this._camera = new Wi(), this._centerAltitude = 0, this.cameraElevationReference = "ground", this._horizonShift = .1;
      }

      _createClass(Hi, [{
        key: "clone",
        value: function clone() {
          var e = new Hi(this._minZoom, this._maxZoom, this._minPitch, this.maxPitch, this._renderWorldCopies);
          return e._elevation = this._elevation, e._centerAltitude = this._centerAltitude, e.tileSize = this.tileSize, e.latRange = this.latRange, e.width = this.width, e.height = this.height, e.cameraElevationReference = this.cameraElevationReference, e._center = this._center, e._setZoom(this.zoom), e._cameraZoom = this._cameraZoom, e.angle = this.angle, e._fov = this._fov, e._pitch = this._pitch, e._unmodified = this._unmodified, e._edgeInsets = this._edgeInsets.clone(), e._camera = this._camera.clone(), e._calcMatrices(), e.freezeTileCoverage = this.freezeTileCoverage, e;
        }
      }, {
        key: "elevation",
        get: function () {
          return this._elevation;
        },
        set: function (e) {
          this._elevation !== e && (this._elevation = e, e ? this._updateCenterElevation() && this._updateCameraOnTerrain() : (this._cameraZoom = null, this._centerAltitude = 0), this._calcMatrices());
        }
      }, {
        key: "updateElevation",
        value: function updateElevation(e) {
          this._terrainEnabled() && null == this._cameraZoom && this._updateCenterElevation() && this._updateCameraOnTerrain(), e && this._constrainCameraAltitude(), this._calcMatrices();
        }
      }, {
        key: "minZoom",
        get: function () {
          return this._minZoom;
        },
        set: function (e) {
          this._minZoom !== e && (this._minZoom = e, this.zoom = Math.max(this.zoom, e));
        }
      }, {
        key: "maxZoom",
        get: function () {
          return this._maxZoom;
        },
        set: function (e) {
          this._maxZoom !== e && (this._maxZoom = e, this.zoom = Math.min(this.zoom, e));
        }
      }, {
        key: "minPitch",
        get: function () {
          return this._minPitch;
        },
        set: function (e) {
          this._minPitch !== e && (this._minPitch = e, this.pitch = Math.max(this.pitch, e));
        }
      }, {
        key: "maxPitch",
        get: function () {
          return this._maxPitch;
        },
        set: function (e) {
          this._maxPitch !== e && (this._maxPitch = e, this.pitch = Math.min(this.pitch, e));
        }
      }, {
        key: "renderWorldCopies",
        get: function () {
          return this._renderWorldCopies;
        },
        set: function (e) {
          void 0 === e ? e = !0 : null === e && (e = !1), this._renderWorldCopies = e;
        }
      }, {
        key: "worldSize",
        get: function () {
          return this.tileSize * this.scale;
        }
      }, {
        key: "centerOffset",
        get: function () {
          return this.centerPoint._sub(this.size._div(2));
        }
      }, {
        key: "size",
        get: function () {
          return new e.Point(this.width, this.height);
        }
      }, {
        key: "bearing",
        get: function () {
          return -this.angle / Math.PI * 180;
        },
        set: function (t) {
          var i = -e.wrap(t, -180, 180) * Math.PI / 180;
          this.angle !== i && (this._unmodified = !1, this.angle = i, this._calcMatrices(), this.rotationMatrix = e.create$2(), e.rotate(this.rotationMatrix, this.rotationMatrix, this.angle));
        }
      }, {
        key: "pitch",
        get: function () {
          return this._pitch / Math.PI * 180;
        },
        set: function (t) {
          var i = e.clamp(t, this.minPitch, this.maxPitch) / 180 * Math.PI;
          this._pitch !== i && (this._unmodified = !1, this._pitch = i, this._calcMatrices());
        }
      }, {
        key: "fov",
        get: function () {
          return this._fov / Math.PI * 180;
        },
        set: function (e) {
          e = Math.max(.01, Math.min(60, e)), this._fov !== e && (this._unmodified = !1, this._fov = e / 180 * Math.PI, this._calcMatrices());
        }
      }, {
        key: "zoom",
        get: function () {
          return this._zoom;
        },
        set: function (e) {
          var t = Math.min(Math.max(e, this.minZoom), this.maxZoom);
          this._zoom !== t && (this._unmodified = !1, this._setZoom(t), this._terrainEnabled() && this._updateCameraOnTerrain(), this._constrain(), this._calcMatrices());
        }
      }, {
        key: "_setZoom",
        value: function _setZoom(e) {
          this._zoom = e, this.scale = this.zoomScale(e), this.tileZoom = Math.floor(e), this.zoomFraction = e - this.tileZoom;
        }
      }, {
        key: "_updateCenterElevation",
        value: function _updateCenterElevation() {
          if (!this._elevation) return !1;

          var t = this._elevation.getAtPoint(e.MercatorCoordinate.fromLngLat(this.center), -1);

          return -1 === t ? (this._cameraZoom = null, !1) : (this._centerAltitude = t, !0);
        }
      }, {
        key: "_updateCameraOnTerrain",
        value: function _updateCameraOnTerrain() {
          var t = this.cameraToCenterDistance / this.worldSize,
              i = e.mercatorZfromAltitude(this._centerAltitude, this.center.lat);
          this._cameraZoom = this._zoomFromMercatorZ(i + t);
        }
      }, {
        key: "center",
        get: function () {
          return this._center;
        },
        set: function (e) {
          e.lat === this._center.lat && e.lng === this._center.lng || (this._unmodified = !1, this._center = e, this._terrainEnabled() && ("ground" === this.cameraElevationReference ? this._updateCenterElevation() ? this._updateCameraOnTerrain() : this._cameraZoom = null : this._updateZoomFromElevation()), this._constrain(), this._calcMatrices());
        }
      }, {
        key: "_updateZoomFromElevation",
        value: function _updateZoomFromElevation() {
          if (null == this._cameraZoom || !this._elevation) return;

          var t = this._cameraZoom,
              i = this._elevation.getAtPoint(e.MercatorCoordinate.fromLngLat(this.center)),
              o = e.mercatorZfromAltitude(i, this.center.lat),
              a = this._mercatorZfromZoom(t),
              r = this._mercatorZfromZoom(this._maxZoom),
              n = Math.max(a - o, r);

          this._setZoom(this._zoomFromMercatorZ(n));
        }
      }, {
        key: "padding",
        get: function () {
          return this._edgeInsets.toJSON();
        },
        set: function (e) {
          this._edgeInsets.equals(e) || (this._unmodified = !1, this._edgeInsets.interpolate(this._edgeInsets, e, 1), this._calcMatrices());
        }
      }, {
        key: "computeZoomRelativeTo",
        value: function computeZoomRelativeTo(t) {
          var i = this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint, t.toAltitude()));
          var o;
          o = t.z < this._camera.position[2] ? [i.x, i.y, i.z] : [t.x, t.y, t.z];
          var a = e.length(e.sub([], this._camera.position, o));
          return e.clamp(this._zoomFromMercatorZ(a), this._minZoom, this._maxZoom);
        }
      }, {
        key: "setFreeCameraOptions",
        value: function setFreeCameraOptions(t) {
          if (!this.height) return;
          if (!t.position && !t.orientation) return;

          this._updateCameraState();

          var i = !1;

          if (t.orientation && !e.exactEquals(t.orientation, this._camera.orientation) && (i = this._setCameraOrientation(t.orientation)), t.position) {
            var _o108 = [t.position.x, t.position.y, t.position.z];
            e.exactEquals$1(_o108, this._camera.position) || (this._setCameraPosition(_o108), i = !0);
          }

          i && (this._updateStateFromCamera(), this.recenterOnTerrain());
        }
      }, {
        key: "getFreeCameraOptions",
        value: function getFreeCameraOptions() {
          this._updateCameraState();

          var t = this._camera.position,
              i = new Xi();
          return i.position = new e.MercatorCoordinate(t[0], t[1], t[2]), i.orientation = this._camera.orientation, i._elevation = this.elevation, i._renderWorldCopies = this._renderWorldCopies, i;
        }
      }, {
        key: "_setCameraOrientation",
        value: function _setCameraOrientation(t) {
          if (!e.length$1(t)) return !1;
          e.normalize$1(t, t);
          var i = e.transformQuat([], [0, 0, -1], t),
              o = e.transformQuat([], [0, -1, 0], t);
          if (o[2] < 0) return !1;
          var a = $i(i, o);
          return !!a && (this._camera.orientation = a, !0);
        }
      }, {
        key: "_setCameraPosition",
        value: function _setCameraPosition(t) {
          var i = this.zoomScale(this.minZoom) * this.tileSize,
              o = this.zoomScale(this.maxZoom) * this.tileSize,
              a = this.cameraToCenterDistance;
          t[2] = e.clamp(t[2], a / o, a / i), this._camera.position = t;
        }
      }, {
        key: "centerPoint",
        get: function () {
          return this._edgeInsets.getCenter(this.width, this.height);
        }
      }, {
        key: "fovAboveCenter",
        get: function () {
          return this._fov * (.5 + this.centerOffset.y / this.height);
        }
      }, {
        key: "isPaddingEqual",
        value: function isPaddingEqual(e) {
          return this._edgeInsets.equals(e);
        }
      }, {
        key: "interpolatePadding",
        value: function interpolatePadding(e, t, i) {
          this._unmodified = !1, this._edgeInsets.interpolate(e, t, i), this._constrain(), this._calcMatrices();
        }
      }, {
        key: "coveringZoomLevel",
        value: function coveringZoomLevel(e) {
          var t = (e.roundZoom ? Math.round : Math.floor)(this.zoom + this.scaleZoom(this.tileSize / e.tileSize));
          return Math.max(0, t);
        }
      }, {
        key: "getVisibleUnwrappedCoordinates",
        value: function getVisibleUnwrappedCoordinates(t) {
          var i = [new e.UnwrappedTileID(0, t)];

          if (this._renderWorldCopies) {
            var _o109 = this.pointCoordinate(new e.Point(0, 0)),
                _a144 = this.pointCoordinate(new e.Point(this.width, 0)),
                _r248 = this.pointCoordinate(new e.Point(this.width, this.height)),
                _n152 = this.pointCoordinate(new e.Point(0, this.height)),
                _s120 = Math.floor(Math.min(_o109.x, _a144.x, _r248.x, _n152.x)),
                _l53 = Math.floor(Math.max(_o109.x, _a144.x, _r248.x, _n152.x)),
                _c38 = 1;

            for (var _o110 = _s120 - _c38; _o110 <= _l53 + _c38; _o110++) {
              0 !== _o110 && i.push(new e.UnwrappedTileID(_o110, t));
            }
          }

          return i;
        }
      }, {
        key: "coveringTiles",
        value: function coveringTiles(t) {
          var _this108 = this;

          var i = this.coveringZoomLevel(t);
          var o = i,
              a = !!t.useElevationData;
          if (void 0 !== t.minzoom && i < t.minzoom) return [];
          void 0 !== t.maxzoom && i > t.maxzoom && (i = t.maxzoom);

          var r = e.MercatorCoordinate.fromLngLat(this.center),
              n = 1 << i,
              s = [n * r.x, n * r.y, 0],
              l = e.Frustum.fromInvProjectionMatrix(this.invProjMatrix, this.worldSize, i),
              c = this.pointCoordinate(this.getCameraPoint()),
              h = n * e.mercatorZfromAltitude(1, this.center.lat),
              u = this._camera.position[2] / e.mercatorZfromAltitude(1, this.center.lat),
              d = [n * c.x, n * c.y, u],
              _ = this.cameraToCenterDistance / t.tileSize * (t.roundZoom ? 1 : .502),
              m = this.pitch <= 60 && this._edgeInsets.top <= this._edgeInsets.bottom && !this._elevation ? i : 0,
              p = this.elevation ? 1e4 * this.elevation.exaggeration() : 0,
              f = function (t) {
            return {
              aabb: new e.Aabb([t * n, 0, -p], [(t + 1) * n, n, p]),
              zoom: 0,
              x: 0,
              y: 0,
              wrap: t,
              fullyVisible: !1
            };
          },
              g = [],
              v = [],
              x = i,
              y = t.reparseOverscaled ? o : i,
              b = function (e, t) {
            if (!_this108._elevation) return;

            var i = _this108._elevation.getMinMaxForTile(t);

            i && (e.min[2] = i.min, e.max[2] = i.max, e.center[2] = (e.min[2] + e.max[2]) / 2);
          },
              w = function (e) {
            return e * e;
          },
              T = w((u - this._centerAltitude) * h),
              E = function (e, t) {
            if (t * w(.707) < e) return 1;
            var i = Math.sqrt(t / e);
            return i / (1 / .707 + (Math.pow(1.1, i - 1 / .707 + 1) - 1) / (1.1 - 1) - 1);
          };

          if (this._renderWorldCopies) for (var _e365 = 1; _e365 <= 3; _e365++) {
            g.push(f(-_e365)), g.push(f(_e365));
          }

          for (g.push(f(0)); g.length > 0;) {
            var _o111 = g.pop(),
                _r249 = _o111.x,
                _n153 = _o111.y;

            var _c39 = _o111.fullyVisible;

            if (!_c39) {
              var _e366 = _o111.aabb.intersects(l);

              if (0 === _e366) continue;
              _c39 = 2 === _e366;
            }

            var _u43 = !0;

            if (m <= _o111.zoom && _o111.zoom < x) {
              var _e367 = _o111.aabb.distanceX(d),
                  _t339 = _o111.aabb.distanceY(d);

              var _i235 = T;
              a && (_i235 = w(_o111.aabb.distanceZ(d) * h));

              var _r250 = _e367 * _e367 + _t339 * _t339 + _i235;

              _u43 = _r250 < w((1 << x - _o111.zoom) * _ * E(Math.max(_i235, T), _r250));
            }

            if (_o111.zoom !== x && _u43) for (var _t340 = 0; _t340 < 4; _t340++) {
              var _i236 = (_r249 << 1) + _t340 % 2,
                  _s121 = (_n153 << 1) + (_t340 >> 1),
                  _l54 = _o111.aabb.quadrant(_t340);

              var _h29 = null;
              a && _o111.zoom > x - 6 && (_h29 = new e.OverscaledTileID(_o111.zoom + 1 === x ? y : _o111.zoom + 1, _o111.wrap, _o111.zoom + 1, _i236, _s121), b(_l54, _h29)), g.push({
                aabb: _l54,
                zoom: _o111.zoom + 1,
                x: _i236,
                y: _s121,
                wrap: _o111.wrap,
                fullyVisible: _c39,
                tileID: _h29
              });
            } else {
              var _a145 = _o111.zoom === x ? y : _o111.zoom;

              if (t.minzoom && t.minzoom > _a145) continue;

              var _l55 = s[0] - (.5 + _r249 + (_o111.wrap << _o111.zoom)) * (1 << i - _o111.zoom),
                  _c40 = s[1] - .5 - _n153,
                  _h30 = _o111.tileID ? _o111.tileID : new e.OverscaledTileID(_a145, _o111.wrap, _o111.zoom, _r249, _n153);

              v.push({
                tileID: _h30,
                distanceSq: _l55 * _l55 + _c40 * _c40
              });
            }
          }

          return v.sort(function (e, t) {
            return e.distanceSq - t.distanceSq;
          }).map(function (e) {
            return e.tileID;
          });
        }
      }, {
        key: "resize",
        value: function resize(e, t) {
          this.width = e, this.height = t, this.pixelsToGLUnits = [2 / e, -2 / t], this._constrain(), this._calcMatrices();
        }
      }, {
        key: "unmodified",
        get: function () {
          return this._unmodified;
        }
      }, {
        key: "zoomScale",
        value: function zoomScale(e) {
          return Math.pow(2, e);
        }
      }, {
        key: "scaleZoom",
        value: function scaleZoom(e) {
          return Math.log(e) / Math.LN2;
        }
      }, {
        key: "project",
        value: function project(t) {
          var i = e.clamp(t.lat, -this.maxValidLatitude, this.maxValidLatitude);
          return new e.Point(e.mercatorXfromLng(t.lng) * this.worldSize, e.mercatorYfromLat(i) * this.worldSize);
        }
      }, {
        key: "unproject",
        value: function unproject(t) {
          return new e.MercatorCoordinate(t.x / this.worldSize, t.y / this.worldSize).toLngLat();
        }
      }, {
        key: "point",
        get: function () {
          return this.project(this.center);
        }
      }, {
        key: "setLocationAtPoint",
        value: function setLocationAtPoint(t, i) {
          var o = this.pointCoordinate(i),
              a = this.pointCoordinate(this.centerPoint),
              r = this.locationCoordinate(t),
              n = new e.MercatorCoordinate(r.x - (o.x - a.x), r.y - (o.y - a.y));
          this.center = this.coordinateLocation(n), this._renderWorldCopies && (this.center = this.center.wrap());
        }
      }, {
        key: "setLocation",
        value: function setLocation(e) {
          this.center = this.coordinateLocation(e), this._renderWorldCopies && (this.center = this.center.wrap());
        }
      }, {
        key: "locationPoint",
        value: function locationPoint(e) {
          return this._coordinatePoint(this.locationCoordinate(e), !1);
        }
      }, {
        key: "locationPoint3D",
        value: function locationPoint3D(e) {
          return this._coordinatePoint(this.locationCoordinate(e), !0);
        }
      }, {
        key: "pointLocation",
        value: function pointLocation(e) {
          return this.coordinateLocation(this.pointCoordinate(e));
        }
      }, {
        key: "pointLocation3D",
        value: function pointLocation3D(e) {
          return this.coordinateLocation(this.pointCoordinate3D(e));
        }
      }, {
        key: "locationCoordinate",
        value: function locationCoordinate(t) {
          return e.MercatorCoordinate.fromLngLat(t);
        }
      }, {
        key: "coordinateLocation",
        value: function coordinateLocation(e) {
          return e.toLngLat();
        }
      }, {
        key: "pointRayIntersection",
        value: function pointRayIntersection(t, i) {
          var o = null != i ? i : this._centerAltitude,
              a = [t.x, t.y, 0, 1],
              r = [t.x, t.y, 1, 1];
          e.transformMat4(a, a, this.pixelMatrixInverse), e.transformMat4(r, r, this.pixelMatrixInverse);
          var n = r[3];
          e.scale$1(a, a, 1 / a[3]), e.scale$1(r, r, 1 / n);
          var s = a[2],
              l = r[2];
          return {
            p0: a,
            p1: r,
            t: s === l ? 0 : (o - s) / (l - s)
          };
        }
      }, {
        key: "screenPointToMercatorRay",
        value: function screenPointToMercatorRay(t) {
          var i = [t.x, t.y, 0, 1],
              o = [t.x, t.y, 1, 1];
          return e.transformMat4(i, i, this.pixelMatrixInverse), e.transformMat4(o, o, this.pixelMatrixInverse), e.scale$1(i, i, 1 / i[3]), e.scale$1(o, o, 1 / o[3]), i[2] = e.mercatorZfromAltitude(i[2], this._center.lat) * this.worldSize, o[2] = e.mercatorZfromAltitude(o[2], this._center.lat) * this.worldSize, e.scale$1(i, i, 1 / this.worldSize), e.scale$1(o, o, 1 / this.worldSize), new e.Ray([i[0], i[1], i[2]], e.normalize([], e.sub([], o, i)));
        }
      }, {
        key: "rayIntersectionCoordinate",
        value: function rayIntersectionCoordinate(t) {
          var {
            p0: i,
            p1: o,
            t: a
          } = t,
              r = e.mercatorZfromAltitude(i[2], this._center.lat),
              n = e.mercatorZfromAltitude(o[2], this._center.lat);
          return new e.MercatorCoordinate(e.number(i[0], o[0], a) / this.worldSize, e.number(i[1], o[1], a) / this.worldSize, e.number(r, n, a));
        }
      }, {
        key: "pointCoordinate",
        value: function pointCoordinate(t) {
          var i = this.horizonLineFromTop(!1),
              o = new e.Point(t.x, Math.max(i, t.y));
          return this.rayIntersectionCoordinate(this.pointRayIntersection(o));
        }
      }, {
        key: "pointCoordinate3D",
        value: function pointCoordinate3D(t) {
          if (!this.elevation) return this.pointCoordinate(t);
          var i = this.elevation;
          var o = this.elevation.pointCoordinate(t);
          if (o) return new e.MercatorCoordinate(o[0], o[1], o[2]);
          var a = 0,
              r = this.horizonLineFromTop();
          if (t.y > r) return this.pointCoordinate(t);
          var n = .02 * r,
              s = t.clone();

          for (var _t341 = 0; _t341 < 10 && r - a > n; _t341++) {
            s.y = e.number(a, r, .66);

            var _t342 = i.pointCoordinate(s);

            _t342 ? (r = s.y, o = _t342) : a = s.y;
          }

          return o ? new e.MercatorCoordinate(o[0], o[1], o[2]) : this.pointCoordinate(t);
        }
      }, {
        key: "isPointAboveHorizon",
        value: function isPointAboveHorizon(e) {
          if (this.elevation) return !this.elevation.pointCoordinate(e);
          {
            var _t343 = this.horizonLineFromTop();

            return e.y < _t343;
          }
        }
      }, {
        key: "_coordinatePoint",
        value: function _coordinatePoint(t, i) {
          var o = i && this.elevation ? this.elevation.getAtPoint(t, this._centerAltitude) : this._centerAltitude,
              a = [t.x * this.worldSize, t.y * this.worldSize, o + t.toAltitude(), 1];
          return e.transformMat4(a, a, this.pixelMatrix), a[3] > 0 ? new e.Point(a[0] / a[3], a[1] / a[3]) : new e.Point(Number.MAX_VALUE, Number.MAX_VALUE);
        }
      }, {
        key: "getBounds",
        value: function getBounds() {
          return this._terrainEnabled() ? this._getBounds3D() : new e.LngLatBounds().extend(this.pointLocation(new e.Point(0, 0))).extend(this.pointLocation(new e.Point(this.width, 0))).extend(this.pointLocation(new e.Point(this.width, this.height))).extend(this.pointLocation(new e.Point(0, this.height)));
        }
      }, {
        key: "_getBounds3D",
        value: function _getBounds3D() {
          var _this109 = this;

          var t = this.elevation,
              i = t.visibleDemTiles.reduce(function (e, t) {
            if (t.dem) {
              var _i237 = t.dem.tree;
              e.min = Math.min(e.min, _i237.minimums[0]), e.max = Math.max(e.max, _i237.maximums[0]);
            }

            return e;
          }, {
            min: Number.MAX_VALUE,
            max: 0
          });
          i.min *= t.exaggeration(), i.max *= t.exaggeration();
          var o = this.horizonLineFromTop();
          return [new e.Point(0, o), new e.Point(this.width, o), new e.Point(this.width, this.height), new e.Point(0, this.height)].reduce(function (e, t) {
            return e.extend(_this109.coordinateLocation(_this109.rayIntersectionCoordinate(_this109.pointRayIntersection(t, i.min)))).extend(_this109.coordinateLocation(_this109.rayIntersectionCoordinate(_this109.pointRayIntersection(t, i.max))));
          }, new e.LngLatBounds());
        }
      }, {
        key: "horizonLineFromTop",
        value: function horizonLineFromTop() {
          var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;
          var t = this.height / 2 / Math.tan(this._fov / 2) / Math.tan(Math.max(this._pitch, .1)) + this.centerOffset.y,
              i = this.height / 2 - .97 * t;
          return e ? Math.max(0, i) : i;
        }
      }, {
        key: "getMaxBounds",
        value: function getMaxBounds() {
          return this.latRange && 2 === this.latRange.length && this.lngRange && 2 === this.lngRange.length ? new e.LngLatBounds([this.lngRange[0], this.latRange[0]], [this.lngRange[1], this.latRange[1]]) : null;
        }
      }, {
        key: "setMaxBounds",
        value: function setMaxBounds(e) {
          e ? (this.lngRange = [e.getWest(), e.getEast()], this.latRange = [e.getSouth(), e.getNorth()], this._constrain()) : (this.lngRange = null, this.latRange = [-this.maxValidLatitude, this.maxValidLatitude]);
        }
      }, {
        key: "calculatePosMatrix",
        value: function calculatePosMatrix(t) {
          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;
          var o = t.key,
              a = i ? this._alignedPosMatrixCache : this._posMatrixCache;
          if (a[o]) return a[o];
          var r = t.canonical,
              n = this.worldSize / this.zoomScale(r.z),
              s = r.x + Math.pow(2, r.z) * t.wrap,
              l = e.identity(new Float64Array(16));
          return e.translate(l, l, [s * n, r.y * n, 0]), e.scale(l, l, [n / e.EXTENT, n / e.EXTENT, 1]), e.multiply(l, i ? this.alignedProjMatrix : this.projMatrix, l), a[o] = new Float32Array(l), a[o];
        }
      }, {
        key: "customLayerMatrix",
        value: function customLayerMatrix() {
          return this.mercatorMatrix.slice();
        }
      }, {
        key: "recenterOnTerrain",
        value: function recenterOnTerrain() {
          if (!this._elevation) return;
          var t = this._elevation;

          this._updateCameraState();

          var i = this._camera.position,
              o = this._camera.forward();

          if (i.z <= 0 || o[2] >= 0) return;
          var a = e.mercatorZfromAltitude(1, this._center.lat);
          i[2] /= a, o[2] /= a, e.normalize(o, o);
          var r = t.raycast(i, o, t.exaggeration());

          if (r) {
            var _t344 = e.scaleAndAdd([], i, o, r),
                _a146 = new e.MercatorCoordinate(_t344[0], _t344[1], e.mercatorZfromAltitude(_t344[2], e.latFromMercatorY(_t344[1]))),
                _n154 = this._camera.position,
                _s122 = _a146.z + e.length([_a146.x - _n154[0], _a146.y - _n154[1], _a146.z - _n154[2]]);

            this._cameraZoom = this._zoomFromMercatorZ(_s122), this._centerAltitude = _a146.toAltitude(), this._center = _a146.toLngLat(), this._updateZoomFromElevation(), this._constrain(), this._calcMatrices();
          }
        }
      }, {
        key: "_constrainCameraAltitude",
        value: function _constrainCameraAltitude() {
          if (!this._elevation) return;
          var t = this._elevation;

          this._updateCameraState();

          var i = t.getAtPoint(this._camera.mercatorPosition),
              o = this._minimumHeightOverTerrain() * Math.cos(e.degToRad(this._maxPitch)),
              a = e.mercatorZfromAltitude(i, this._center.lat),
              r = this._camera.position[2] - a;

          if (r < o) {
            var _t345 = e.MercatorCoordinate.fromLngLat(this._center, this._centerAltitude),
                _i238 = this._camera.mercatorPosition,
                _a147 = [_t345.x - _i238.x, _t345.y - _i238.y, _t345.z - _i238.z],
                _n155 = e.length(_a147);

            _a147[2] -= o - r;

            var _s123 = e.length(_a147);

            if (0 === _s123) return;
            e.scale$2(_a147, _a147, _n155 / _s123), this._camera.position = [_t345.x - _a147[0], _t345.y - _a147[1], _t345.z - _a147[2]], this._camera.orientation = $i(_a147, this._camera.up()), this._updateStateFromCamera();
          }
        }
      }, {
        key: "_constrain",
        value: function _constrain() {
          if (!this.center || !this.width || !this.height || this._constraining) return;
          this._constraining = !0;
          var t,
              i,
              o,
              a,
              r = -90,
              n = 90,
              s = -180,
              l = 180;
          var c = this.size,
              h = this._unmodified;

          if (this.latRange) {
            var _i239 = this.latRange;
            r = e.mercatorYfromLat(_i239[1]) * this.worldSize, n = e.mercatorYfromLat(_i239[0]) * this.worldSize, t = n - r < c.y ? c.y / (n - r) : 0;
          }

          if (this.lngRange) {
            var _t346 = this.lngRange;
            s = e.mercatorXfromLng(_t346[0]) * this.worldSize, l = e.mercatorXfromLng(_t346[1]) * this.worldSize, i = l - s < c.x ? c.x / (l - s) : 0;
          }

          var u = this.point,
              d = Math.max(i || 0, t || 0);
          if (d) return this.center = this.unproject(new e.Point(i ? (l + s) / 2 : u.x, t ? (n + r) / 2 : u.y)), this.zoom += this.scaleZoom(d), this._unmodified = h, void (this._constraining = !1);

          if (this.latRange) {
            var _e368 = u.y,
                _t347 = c.y / 2;

            _e368 - _t347 < r && (a = r + _t347), _e368 + _t347 > n && (a = n - _t347);
          }

          if (this.lngRange) {
            var _e369 = u.x,
                _t348 = c.x / 2;

            _e369 - _t348 < s && (o = s + _t348), _e369 + _t348 > l && (o = l - _t348);
          }

          void 0 === o && void 0 === a || (this.center = this.unproject(new e.Point(void 0 !== o ? o : u.x, void 0 !== a ? a : u.y))), this._constrainCameraAltitude(), this._unmodified = h, this._constraining = !1;
        }
      }, {
        key: "_minZoomForBounds",
        value: function _minZoomForBounds() {
          var _this110 = this;

          var t = function (e, t) {
            return Math.log2(e / (_this110.tileSize * Math.abs(t[1] - t[0])));
          };

          var i = 0;

          if (this.latRange) {
            var _o112 = this.latRange;
            i = t(this.height, [e.mercatorYfromLat(_o112[0]), e.mercatorYfromLat(_o112[1])]);
          }

          var o = 0;

          if (this.lngRange) {
            var _i240 = this.lngRange;
            o = t(this.width, [e.mercatorXfromLng(_i240[0]), e.mercatorXfromLng(_i240[1])]);
          }

          return Math.max(i, o);
        }
      }, {
        key: "_maxCameraBoundsDistance",
        value: function _maxCameraBoundsDistance() {
          return this._mercatorZfromZoom(this._minZoomForBounds());
        }
      }, {
        key: "_calcMatrices",
        value: function _calcMatrices() {
          if (!this.height) return;
          var t = this.centerOffset;
          this.cameraToCenterDistance = .5 / Math.tan(this._fov / 2) * this.height;
          var i = e.mercatorZfromAltitude(1, this.center.lat) * this.worldSize;

          this._updateCameraState();

          var o = Math.PI / 2 + this._pitch,
              a = this.fovAboveCenter,
              r = this._camera.position[2] * this.worldSize / Math.cos(this._pitch),
              n = Math.sin(a) * r / Math.sin(e.clamp(Math.PI - o - a, .01, Math.PI - .01)),
              s = this.point,
              l = s.x,
              c = s.y,
              h = Math.cos(Math.PI / 2 - this._pitch) * n + r,
              u = Math.min(1.01 * h, r * (1 / this._horizonShift)),
              d = this.height / 50,
              _ = this._camera.getWorldToCamera(this.worldSize, i),
              m = this._camera.getCameraToClipPerspective(this._fov, this.width / this.height, d, u);

          m[8] = 2 * -t.x / this.width, m[9] = 2 * t.y / this.height;
          var p = e.mul([], m, _);
          this.mercatorMatrix = e.scale([], p, [this.worldSize, this.worldSize, this.worldSize / i]), this.projMatrix = p, this.invProjMatrix = e.invert(new Float64Array(16), this.projMatrix);
          var f = new Float32Array(16);
          e.identity(f), e.scale(f, f, [1, -1, 1]), e.rotateX(f, f, this._pitch), e.rotateZ(f, f, this.angle);
          var g = e.perspective(new Float32Array(16), this._fov, this.width / this.height, d, u),
              v = (Math.PI / 2 - this._pitch) * (this.height / this._fov) * this._horizonShift;
          g[8] = 2 * -t.x / this.width, g[9] = 2 * (t.y + v) / this.height, this.skyboxMatrix = e.multiply(f, g, f);
          var x = this.width % 2 / 2,
              y = this.height % 2 / 2,
              b = Math.cos(this.angle),
              w = Math.sin(this.angle),
              T = l - Math.round(l) + b * x + w * y,
              E = c - Math.round(c) + b * y + w * x,
              C = new Float64Array(p);
          if (e.translate(C, C, [T > .5 ? T - 1 : T, E > .5 ? E - 1 : E, 0]), this.alignedProjMatrix = C, p = e.create(), e.scale(p, p, [this.width / 2, -this.height / 2, 1]), e.translate(p, p, [1, -1, 0]), this.labelPlaneMatrix = p, p = e.create(), e.scale(p, p, [1, -1, 1]), e.translate(p, p, [-1, -1, 0]), e.scale(p, p, [2 / this.width, 2 / this.height, 1]), this.glCoordMatrix = p, this.pixelMatrix = e.multiply(new Float64Array(16), this.labelPlaneMatrix, this.projMatrix), p = e.invert(new Float64Array(16), this.pixelMatrix), !p) throw new Error("failed to invert matrix");
          this.pixelMatrixInverse = p, this._posMatrixCache = {}, this._alignedPosMatrixCache = {};
        }
      }, {
        key: "_updateCameraState",
        value: function _updateCameraState() {
          if (!this.height) return;

          this._camera.setPitchBearing(this._pitch, this.angle);

          var t = this._camera.forward(),
              i = this.cameraToCenterDistance,
              o = this.point,
              a = this._mercatorZfromZoom(this._cameraZoom ? this._cameraZoom : this._zoom) - e.mercatorZfromAltitude(this._centerAltitude, this.center.lat),
              r = this.cameraToCenterDistance / a;

          this._camera.position = [o.x / this.worldSize - t[0] * i / r, o.y / this.worldSize - t[1] * i / r, e.mercatorZfromAltitude(this._centerAltitude, this._center.lat) + -t[2] * i / r];
        }
      }, {
        key: "_translateCameraConstrained",
        value: function _translateCameraConstrained(t) {
          var i = this._maxCameraBoundsDistance() * Math.cos(this._pitch),
              o = t[2];
          var a = 1;
          o > 0 && (a = Math.min((i - this._camera.position[2]) / o, 1)), this._camera.position = e.scaleAndAdd([], this._camera.position, t, a), this._updateStateFromCamera();
        }
      }, {
        key: "_updateStateFromCamera",
        value: function _updateStateFromCamera() {
          var t = this._camera.position,
              i = this._camera.forward(),
              {
            pitch: o,
            bearing: a
          } = this._camera.getPitchBearing(),
              r = e.mercatorZfromAltitude(this._centerAltitude, this.center.lat),
              n = this._mercatorZfromZoom(this._maxZoom) * Math.cos(e.degToRad(this._maxPitch)),
              s = Math.max((t[2] - r) / Math.cos(o), n),
              l = this._zoomFromMercatorZ(s);

          e.scaleAndAdd(t, t, i, s), this._pitch = e.clamp(o, e.degToRad(this.minPitch), e.degToRad(this.maxPitch)), this.angle = e.wrap(a, -Math.PI, Math.PI), this._setZoom(e.clamp(l, this._minZoom, this._maxZoom)), this._terrainEnabled() && this._updateCameraOnTerrain(), this._center = new e.MercatorCoordinate(t[0], t[1], t[2]).toLngLat(), this._unmodified = !1, this._constrain(), this._calcMatrices();
        }
      }, {
        key: "_worldSizeFromZoom",
        value: function _worldSizeFromZoom(e) {
          return Math.pow(2, e) * this.tileSize;
        }
      }, {
        key: "_mercatorZfromZoom",
        value: function _mercatorZfromZoom(e) {
          return this.cameraToCenterDistance / this._worldSizeFromZoom(e);
        }
      }, {
        key: "_minimumHeightOverTerrain",
        value: function _minimumHeightOverTerrain() {
          var e = Math.min((null != this._cameraZoom ? this._cameraZoom : this._zoom) + 2, this._maxZoom);
          return this._mercatorZfromZoom(e);
        }
      }, {
        key: "_zoomFromMercatorZ",
        value: function _zoomFromMercatorZ(e) {
          return this.scaleZoom(this.cameraToCenterDistance / (e * this.tileSize));
        }
      }, {
        key: "_terrainEnabled",
        value: function _terrainEnabled() {
          return !!this._elevation;
        }
      }, {
        key: "isHorizonVisibleForPoints",
        value: function isHorizonVisibleForPoints(t, i) {
          var o = Math.min(t.x, i.x),
              a = Math.max(t.x, i.x),
              r = Math.min(t.y, i.y),
              n = Math.max(t.y, i.y),
              s = [new e.Point(o, r), new e.Point(a, n), new e.Point(o, n), new e.Point(a, r)],
              l = this._renderWorldCopies ? -3 : 0,
              c = this._renderWorldCopies ? 4 : 1;

          for (var _e370 of s) {
            var _t349 = this.pointRayIntersection(_e370);

            if (_t349.t < 0) return !0;

            var _i241 = this.rayIntersectionCoordinate(_t349);

            if (_i241.x < l || _i241.y < 0 || _i241.x > c || _i241.y > 1) return !0;
          }

          return !1;
        }
      }, {
        key: "isHorizonVisible",
        value: function isHorizonVisible() {
          return this.pitch + e.radToDeg(this.fovAboveCenter) > 88 || this.isHorizonVisibleForPoints(new e.Point(0, 0), new e.Point(this.width, this.height));
        }
      }, {
        key: "zoomDeltaToMovement",
        value: function zoomDeltaToMovement(t, i) {
          var o = e.length(e.sub([], this._camera.position, t)),
              a = this._zoomFromMercatorZ(o) + i;
          return o - this._mercatorZfromZoom(a);
        }
      }, {
        key: "getCameraPoint",
        value: function getCameraPoint() {
          var t = Math.tan(this._pitch) * (this.cameraToCenterDistance || 1);
          return this.centerPoint.add(new e.Point(0, t));
        }
      }]);

      return Hi;
    }();

    var Ki = /*#__PURE__*/function () {
      function Ki(t) {
        _classCallCheck(this, Ki);

        this._hashName = t && encodeURIComponent(t), e.bindAll(["_getCurrentHash", "_onHashChange", "_updateHash"], this), this._updateHash = function (e, t) {
          var i = !1,
              o = null;

          var a = function () {
            o = null, i && (e(), o = setTimeout(a, 300), i = !1);
          };

          return function () {
            return i = !0, o || a(), o;
          };
        }(this._updateHashUnthrottled.bind(this));
      }

      _createClass(Ki, [{
        key: "addTo",
        value: function addTo(t) {
          return this._map = t, e.window.addEventListener("hashchange", this._onHashChange, !1), this._map.on("moveend", this._updateHash), this;
        }
      }, {
        key: "remove",
        value: function remove() {
          return e.window.removeEventListener("hashchange", this._onHashChange, !1), this._map.off("moveend", this._updateHash), clearTimeout(this._updateHash()), delete this._map, this;
        }
      }, {
        key: "getHashString",
        value: function getHashString(t) {
          var i = this._map.getCenter(),
              o = Math.round(100 * this._map.getZoom()) / 100,
              a = Math.ceil((o * Math.LN2 + Math.log(512 / 360 / .5)) / Math.LN10),
              r = Math.pow(10, a),
              n = Math.round(i.lng * r) / r,
              s = Math.round(i.lat * r) / r,
              l = this._map.getBearing(),
              c = this._map.getPitch();

          var h = "";

          if (h += t ? "/".concat(n, "/").concat(s, "/").concat(o) : "".concat(o, "/").concat(s, "/").concat(n), (l || c) && (h += "/".concat(Math.round(10 * l) / 10)), c && (h += "/".concat(Math.round(c))), this._hashName) {
            var _t350 = this._hashName;

            var _i242 = !1;

            var _o113 = e.window.location.hash.slice(1).split("&").map(function (e) {
              var o = e.split("=")[0];
              return o === _t350 ? (_i242 = !0, "".concat(o, "=").concat(h)) : e;
            }).filter(function (e) {
              return e;
            });

            return _i242 || _o113.push("".concat(_t350, "=").concat(h)), "#".concat(_o113.join("&"));
          }

          return "#".concat(h);
        }
      }, {
        key: "_getCurrentHash",
        value: function _getCurrentHash() {
          var _this111 = this;

          var t = e.window.location.hash.replace("#", "");

          if (this._hashName) {
            var _e371;

            return t.split("&").map(function (e) {
              return e.split("=");
            }).forEach(function (t) {
              t[0] === _this111._hashName && (_e371 = t);
            }), (_e371 && _e371[1] || "").split("/");
          }

          return t.split("/");
        }
      }, {
        key: "_onHashChange",
        value: function _onHashChange() {
          var e = this._getCurrentHash();

          if (e.length >= 3 && !e.some(function (e) {
            return isNaN(e);
          })) {
            var _t351 = this._map.dragRotate.isEnabled() && this._map.touchZoomRotate.isEnabled() ? +(e[3] || 0) : this._map.getBearing();

            return this._map.jumpTo({
              center: [+e[2], +e[1]],
              zoom: +e[0],
              bearing: _t351,
              pitch: +(e[4] || 0)
            }), !0;
          }

          return !1;
        }
      }, {
        key: "_updateHashUnthrottled",
        value: function _updateHashUnthrottled() {
          var t = e.window.location.href.replace(/(#.+)?$/, this.getHashString());
          e.window.history.replaceState(e.window.history.state, null, t);
        }
      }]);

      return Ki;
    }();

    var Yi = {
      linearity: .3,
      easing: e.bezier(0, 0, .3, 1)
    },
        Ji = e.extend({
      deceleration: 2500,
      maxSpeed: 1400
    }, Yi),
        Qi = e.extend({
      deceleration: 20,
      maxSpeed: 1400
    }, Yi),
        eo = e.extend({
      deceleration: 1e3,
      maxSpeed: 360
    }, Yi),
        to = e.extend({
      deceleration: 1e3,
      maxSpeed: 90
    }, Yi);

    var io = /*#__PURE__*/function () {
      function io(e) {
        _classCallCheck(this, io);

        this._map = e, this.clear();
      }

      _createClass(io, [{
        key: "clear",
        value: function clear() {
          this._inertiaBuffer = [];
        }
      }, {
        key: "record",
        value: function record(t) {
          this._drainInertiaBuffer(), this._inertiaBuffer.push({
            time: e.browser.now(),
            settings: t
          });
        }
      }, {
        key: "_drainInertiaBuffer",
        value: function _drainInertiaBuffer() {
          var t = this._inertiaBuffer,
              i = e.browser.now();

          for (; t.length > 0 && i - t[0].time > 160;) {
            t.shift();
          }
        }
      }, {
        key: "_onMoveEnd",
        value: function _onMoveEnd(t) {
          if (this._drainInertiaBuffer(), this._inertiaBuffer.length < 2) return;
          var i = {
            zoom: 0,
            bearing: 0,
            pitch: 0,
            pan: new e.Point(0, 0),
            pinchAround: void 0,
            around: void 0
          };

          for (var {
            settings: _e372
          } of this._inertiaBuffer) {
            i.zoom += _e372.zoomDelta || 0, i.bearing += _e372.bearingDelta || 0, i.pitch += _e372.pitchDelta || 0, _e372.panDelta && i.pan._add(_e372.panDelta), _e372.around && (i.around = _e372.around), _e372.pinchAround && (i.pinchAround = _e372.pinchAround);
          }

          var o = this._inertiaBuffer[this._inertiaBuffer.length - 1].time - this._inertiaBuffer[0].time,
              a = {};

          if (i.pan.mag()) {
            var _r251 = ao(i.pan.mag(), o, e.extend({}, Ji, t || {}));

            a.offset = i.pan.mult(_r251.amount / i.pan.mag()), a.center = this._map.transform.center, oo(a, _r251);
          }

          if (i.zoom) {
            var _e373 = ao(i.zoom, o, Qi);

            a.zoom = this._map.transform.zoom + _e373.amount, oo(a, _e373);
          }

          if (i.bearing) {
            var _t352 = ao(i.bearing, o, eo);

            a.bearing = this._map.transform.bearing + e.clamp(_t352.amount, -179, 179), oo(a, _t352);
          }

          if (i.pitch) {
            var _e374 = ao(i.pitch, o, to);

            a.pitch = this._map.transform.pitch + _e374.amount, oo(a, _e374);
          }

          if (a.zoom || a.bearing) {
            var _e375 = void 0 === i.pinchAround ? i.around : i.pinchAround;

            a.around = _e375 ? this._map.unproject(_e375) : this._map.getCenter();
          }

          return this.clear(), e.extend(a, {
            noMoveStart: !0
          });
        }
      }]);

      return io;
    }();

    function oo(e, t) {
      (!e.duration || e.duration < t.duration) && (e.duration = t.duration, e.easing = t.easing);
    }

    function ao(t, i, o) {
      var {
        maxSpeed: a,
        linearity: r,
        deceleration: n
      } = o,
          s = e.clamp(t * r / (i / 1e3), -a, a),
          l = Math.abs(s) / (n * r);
      return {
        easing: o.easing,
        duration: 1e3 * l,
        amount: s * (l / 2)
      };
    }

    var ro = /*#__PURE__*/function (_e$Event) {
      _inherits(ro, _e$Event);

      var _super116 = _createSuper(ro);

      function ro(t, i, o) {
        var _this112;

        var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};

        _classCallCheck(this, ro);

        var n = a.mousePos(i.getCanvasContainer(), o),
            s = i.unproject(n);
        _this112 = _super116.call(this, t, e.extend({
          point: n,
          lngLat: s,
          originalEvent: o
        }, r)), _this112._defaultPrevented = !1, _this112.target = i;
        return _this112;
      }

      _createClass(ro, [{
        key: "preventDefault",
        value: function preventDefault() {
          this._defaultPrevented = !0;
        }
      }, {
        key: "defaultPrevented",
        get: function () {
          return this._defaultPrevented;
        }
      }]);

      return ro;
    }(e.Event);

    var no = /*#__PURE__*/function (_e$Event2) {
      _inherits(no, _e$Event2);

      var _super117 = _createSuper(no);

      function no(t, i, o) {
        var _this113;

        _classCallCheck(this, no);

        var r = "touchend" === t ? o.changedTouches : o.touches,
            n = a.touchPos(i.getCanvasContainer(), r),
            s = n.map(function (e) {
          return i.unproject(e);
        }),
            l = n.reduce(function (e, t, i, o) {
          return e.add(t.div(o.length));
        }, new e.Point(0, 0));
        _this113 = _super117.call(this, t, {
          points: n,
          point: l,
          lngLats: s,
          lngLat: i.unproject(l),
          originalEvent: o
        }), _this113._defaultPrevented = !1;
        return _this113;
      }

      _createClass(no, [{
        key: "preventDefault",
        value: function preventDefault() {
          this._defaultPrevented = !0;
        }
      }, {
        key: "defaultPrevented",
        get: function () {
          return this._defaultPrevented;
        }
      }]);

      return no;
    }(e.Event);

    var so = /*#__PURE__*/function (_e$Event3) {
      _inherits(so, _e$Event3);

      var _super118 = _createSuper(so);

      function so(e, t, i) {
        var _this114;

        _classCallCheck(this, so);

        _this114 = _super118.call(this, e, {
          originalEvent: i
        }), _this114._defaultPrevented = !1;
        return _this114;
      }

      _createClass(so, [{
        key: "preventDefault",
        value: function preventDefault() {
          this._defaultPrevented = !0;
        }
      }, {
        key: "defaultPrevented",
        get: function () {
          return this._defaultPrevented;
        }
      }]);

      return so;
    }(e.Event);

    var lo = /*#__PURE__*/function () {
      function lo(e, t) {
        _classCallCheck(this, lo);

        this._map = e, this._clickTolerance = t.clickTolerance;
      }

      _createClass(lo, [{
        key: "reset",
        value: function reset() {
          delete this._mousedownPos;
        }
      }, {
        key: "wheel",
        value: function wheel(e) {
          return this._firePreventable(new so(e.type, this._map, e));
        }
      }, {
        key: "mousedown",
        value: function mousedown(e, t) {
          return this._mousedownPos = t, this._firePreventable(new ro(e.type, this._map, e));
        }
      }, {
        key: "mouseup",
        value: function mouseup(e) {
          this._map.fire(new ro(e.type, this._map, e));
        }
      }, {
        key: "click",
        value: function click(e, t) {
          this._mousedownPos && this._mousedownPos.dist(t) >= this._clickTolerance || this._map.fire(new ro(e.type, this._map, e));
        }
      }, {
        key: "dblclick",
        value: function dblclick(e) {
          return this._firePreventable(new ro(e.type, this._map, e));
        }
      }, {
        key: "mouseover",
        value: function mouseover(e) {
          this._map.fire(new ro(e.type, this._map, e));
        }
      }, {
        key: "mouseout",
        value: function mouseout(e) {
          this._map.fire(new ro(e.type, this._map, e));
        }
      }, {
        key: "touchstart",
        value: function touchstart(e) {
          return this._firePreventable(new no(e.type, this._map, e));
        }
      }, {
        key: "touchmove",
        value: function touchmove(e) {
          this._map.fire(new no(e.type, this._map, e));
        }
      }, {
        key: "touchend",
        value: function touchend(e) {
          this._map.fire(new no(e.type, this._map, e));
        }
      }, {
        key: "touchcancel",
        value: function touchcancel(e) {
          this._map.fire(new no(e.type, this._map, e));
        }
      }, {
        key: "_firePreventable",
        value: function _firePreventable(e) {
          if (this._map.fire(e), e.defaultPrevented) return {};
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return !0;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return !1;
        }
      }, {
        key: "enable",
        value: function enable() {}
      }, {
        key: "disable",
        value: function disable() {}
      }]);

      return lo;
    }();

    var co = /*#__PURE__*/function () {
      function co(e) {
        _classCallCheck(this, co);

        this._map = e;
      }

      _createClass(co, [{
        key: "reset",
        value: function reset() {
          this._delayContextMenu = !1, delete this._contextMenuEvent;
        }
      }, {
        key: "mousemove",
        value: function mousemove(e) {
          this._map.fire(new ro(e.type, this._map, e));
        }
      }, {
        key: "mousedown",
        value: function mousedown() {
          this._delayContextMenu = !0;
        }
      }, {
        key: "mouseup",
        value: function mouseup() {
          this._delayContextMenu = !1, this._contextMenuEvent && (this._map.fire(new ro("contextmenu", this._map, this._contextMenuEvent)), delete this._contextMenuEvent);
        }
      }, {
        key: "contextmenu",
        value: function contextmenu(e) {
          this._delayContextMenu ? this._contextMenuEvent = e : this._map.fire(new ro(e.type, this._map, e)), this._map.listens("contextmenu") && e.preventDefault();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return !0;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return !1;
        }
      }, {
        key: "enable",
        value: function enable() {}
      }, {
        key: "disable",
        value: function disable() {}
      }]);

      return co;
    }();

    var ho = /*#__PURE__*/function () {
      function ho(e, t) {
        _classCallCheck(this, ho);

        this._map = e, this._el = e.getCanvasContainer(), this._container = e.getContainer(), this._clickTolerance = t.clickTolerance || 1;
      }

      _createClass(ho, [{
        key: "isEnabled",
        value: function isEnabled() {
          return !!this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return !!this._active;
        }
      }, {
        key: "enable",
        value: function enable() {
          this.isEnabled() || (this._enabled = !0);
        }
      }, {
        key: "disable",
        value: function disable() {
          this.isEnabled() && (this._enabled = !1);
        }
      }, {
        key: "mousedown",
        value: function mousedown(e, t) {
          this.isEnabled() && e.shiftKey && 0 === e.button && (a.disableDrag(), this._startPos = this._lastPos = t, this._active = !0);
        }
      }, {
        key: "mousemoveWindow",
        value: function mousemoveWindow(e, t) {
          if (!this._active) return;
          var i = t;
          if (this._lastPos.equals(i) || !this._box && i.dist(this._startPos) < this._clickTolerance) return;
          var o = this._startPos;
          this._lastPos = i, this._box || (this._box = a.create("div", "mapboxgl-boxzoom", this._container), this._container.classList.add("mapboxgl-crosshair"), this._fireEvent("boxzoomstart", e));
          var r = Math.min(o.x, i.x),
              n = Math.max(o.x, i.x),
              s = Math.min(o.y, i.y),
              l = Math.max(o.y, i.y);
          a.setTransform(this._box, "translate(".concat(r, "px,").concat(s, "px)")), this._box.style.width = "".concat(n - r, "px"), this._box.style.height = "".concat(l - s, "px");
        }
      }, {
        key: "mouseupWindow",
        value: function mouseupWindow(t, i) {
          var _this115 = this;

          if (!this._active) return;
          if (0 !== t.button) return;
          var o = this._startPos,
              r = i;
          if (this.reset(), a.suppressClick(), o.x !== r.x || o.y !== r.y) return this._map.fire(new e.Event("boxzoomend", {
            originalEvent: t
          })), {
            cameraAnimation: function (e) {
              return e.fitScreenCoordinates(o, r, _this115._map.getBearing(), {
                linear: !1
              });
            }
          };

          this._fireEvent("boxzoomcancel", t);
        }
      }, {
        key: "keydown",
        value: function keydown(e) {
          this._active && 27 === e.keyCode && (this.reset(), this._fireEvent("boxzoomcancel", e));
        }
      }, {
        key: "reset",
        value: function reset() {
          this._active = !1, this._container.classList.remove("mapboxgl-crosshair"), this._box && (a.remove(this._box), this._box = null), a.enableDrag(), delete this._startPos, delete this._lastPos;
        }
      }, {
        key: "_fireEvent",
        value: function _fireEvent(t, i) {
          return this._map.fire(new e.Event(t, {
            originalEvent: i
          }));
        }
      }]);

      return ho;
    }();

    function uo(e, t) {
      var i = {};

      for (var _o114 = 0; _o114 < e.length; _o114++) {
        i[e[_o114].identifier] = t[_o114];
      }

      return i;
    }

    var _o = /*#__PURE__*/function () {
      function _o(e) {
        _classCallCheck(this, _o);

        this.reset(), this.numTouches = e.numTouches;
      }

      _createClass(_o, [{
        key: "reset",
        value: function reset() {
          delete this.centroid, delete this.startTime, delete this.touches, this.aborted = !1;
        }
      }, {
        key: "touchstart",
        value: function touchstart(t, i, o) {
          (this.centroid || o.length > this.numTouches) && (this.aborted = !0), this.aborted || (void 0 === this.startTime && (this.startTime = t.timeStamp), o.length === this.numTouches && (this.centroid = function (t) {
            var i = new e.Point(0, 0);

            for (var _e376 of t) {
              i._add(_e376);
            }

            return i.div(t.length);
          }(i), this.touches = uo(o, i)));
        }
      }, {
        key: "touchmove",
        value: function touchmove(e, t, i) {
          if (this.aborted || !this.centroid) return;
          var o = uo(i, t);

          for (var _e377 in this.touches) {
            var _t353 = this.touches[_e377],
                _i243 = o[_e377];
            (!_i243 || _i243.dist(_t353) > 30) && (this.aborted = !0);
          }
        }
      }, {
        key: "touchend",
        value: function touchend(e, t, i) {
          if ((!this.centroid || e.timeStamp - this.startTime > 500) && (this.aborted = !0), 0 === i.length) {
            var _e378 = !this.aborted && this.centroid;

            if (this.reset(), _e378) return _e378;
          }
        }
      }]);

      return _o;
    }();

    var mo = /*#__PURE__*/function () {
      function mo(e) {
        _classCallCheck(this, mo);

        this.singleTap = new _o(e), this.numTaps = e.numTaps, this.reset();
      }

      _createClass(mo, [{
        key: "reset",
        value: function reset() {
          this.lastTime = 1 / 0, delete this.lastTap, this.count = 0, this.singleTap.reset();
        }
      }, {
        key: "touchstart",
        value: function touchstart(e, t, i) {
          this.singleTap.touchstart(e, t, i);
        }
      }, {
        key: "touchmove",
        value: function touchmove(e, t, i) {
          this.singleTap.touchmove(e, t, i);
        }
      }, {
        key: "touchend",
        value: function touchend(e, t, i) {
          var o = this.singleTap.touchend(e, t, i);

          if (o) {
            var _t354 = e.timeStamp - this.lastTime < 500,
                _i244 = !this.lastTap || this.lastTap.dist(o) < 30;

            if (_t354 && _i244 || this.reset(), this.count++, this.lastTime = e.timeStamp, this.lastTap = o, this.count === this.numTaps) return this.reset(), o;
          }
        }
      }]);

      return mo;
    }();

    var po = /*#__PURE__*/function () {
      function po() {
        _classCallCheck(this, po);

        this._zoomIn = new mo({
          numTouches: 1,
          numTaps: 2
        }), this._zoomOut = new mo({
          numTouches: 2,
          numTaps: 1
        }), this.reset();
      }

      _createClass(po, [{
        key: "reset",
        value: function reset() {
          this._active = !1, this._zoomIn.reset(), this._zoomOut.reset();
        }
      }, {
        key: "touchstart",
        value: function touchstart(e, t, i) {
          this._zoomIn.touchstart(e, t, i), this._zoomOut.touchstart(e, t, i);
        }
      }, {
        key: "touchmove",
        value: function touchmove(e, t, i) {
          this._zoomIn.touchmove(e, t, i), this._zoomOut.touchmove(e, t, i);
        }
      }, {
        key: "touchend",
        value: function touchend(e, t, i) {
          var _this116 = this;

          var o = this._zoomIn.touchend(e, t, i),
              a = this._zoomOut.touchend(e, t, i);

          return o ? (this._active = !0, e.preventDefault(), setTimeout(function () {
            return _this116.reset();
          }, 0), {
            cameraAnimation: function (t) {
              return t.easeTo({
                duration: 300,
                zoom: t.getZoom() + 1,
                around: t.unproject(o)
              }, {
                originalEvent: e
              });
            }
          }) : a ? (this._active = !0, e.preventDefault(), setTimeout(function () {
            return _this116.reset();
          }, 0), {
            cameraAnimation: function (t) {
              return t.easeTo({
                duration: 300,
                zoom: t.getZoom() - 1,
                around: t.unproject(a)
              }, {
                originalEvent: e
              });
            }
          }) : void 0;
        }
      }, {
        key: "touchcancel",
        value: function touchcancel() {
          this.reset();
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return po;
    }();

    var fo = {
      0: 1,
      2: 2
    };

    var go = /*#__PURE__*/function () {
      function go(e) {
        _classCallCheck(this, go);

        this.reset(), this._clickTolerance = e.clickTolerance || 1;
      }

      _createClass(go, [{
        key: "reset",
        value: function reset() {
          this._active = !1, this._moved = !1, delete this._lastPoint, delete this._eventButton;
        }
      }, {
        key: "_correctButton",
        value: function _correctButton(e, t) {
          return !1;
        }
      }, {
        key: "_move",
        value: function _move(e, t) {
          return {};
        }
      }, {
        key: "mousedown",
        value: function mousedown(e, t) {
          if (this._lastPoint) return;
          var i = a.mouseButton(e);
          this._correctButton(e, i) && (this._lastPoint = t, this._eventButton = i);
        }
      }, {
        key: "mousemoveWindow",
        value: function mousemoveWindow(e, t) {
          var i = this._lastPoint;
          if (i) if (e.preventDefault(), function (e, t) {
            var i = fo[t];
            return void 0 === e.buttons || (e.buttons & i) !== i;
          }(e, this._eventButton)) this.reset();else if (this._moved || !(t.dist(i) < this._clickTolerance)) return this._moved = !0, this._lastPoint = t, this._move(i, t);
        }
      }, {
        key: "mouseupWindow",
        value: function mouseupWindow(e) {
          this._lastPoint && a.mouseButton(e) === this._eventButton && (this._moved && a.suppressClick(), this.reset());
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return go;
    }();

    var vo = /*#__PURE__*/function (_go) {
      _inherits(vo, _go);

      var _super119 = _createSuper(vo);

      function vo() {
        _classCallCheck(this, vo);

        return _super119.apply(this, arguments);
      }

      _createClass(vo, [{
        key: "mousedown",
        value: function mousedown(e, t) {
          _get(_getPrototypeOf(vo.prototype), "mousedown", this).call(this, e, t), this._lastPoint && (this._active = !0);
        }
      }, {
        key: "_correctButton",
        value: function _correctButton(e, t) {
          return 0 === t && !e.ctrlKey;
        }
      }, {
        key: "_move",
        value: function _move(e, t) {
          return {
            around: t,
            panDelta: t.sub(e)
          };
        }
      }]);

      return vo;
    }(go);

    var xo = /*#__PURE__*/function (_go2) {
      _inherits(xo, _go2);

      var _super120 = _createSuper(xo);

      function xo() {
        _classCallCheck(this, xo);

        return _super120.apply(this, arguments);
      }

      _createClass(xo, [{
        key: "_correctButton",
        value: function _correctButton(e, t) {
          return 0 === t && e.ctrlKey || 2 === t;
        }
      }, {
        key: "_move",
        value: function _move(e, t) {
          var i = .8 * (t.x - e.x);
          if (i) return this._active = !0, {
            bearingDelta: i
          };
        }
      }, {
        key: "contextmenu",
        value: function contextmenu(e) {
          e.preventDefault();
        }
      }]);

      return xo;
    }(go);

    var yo = /*#__PURE__*/function (_go3) {
      _inherits(yo, _go3);

      var _super121 = _createSuper(yo);

      function yo() {
        _classCallCheck(this, yo);

        return _super121.apply(this, arguments);
      }

      _createClass(yo, [{
        key: "_correctButton",
        value: function _correctButton(e, t) {
          return 0 === t && e.ctrlKey || 2 === t;
        }
      }, {
        key: "_move",
        value: function _move(e, t) {
          var i = -.5 * (t.y - e.y);
          if (i) return this._active = !0, {
            pitchDelta: i
          };
        }
      }, {
        key: "contextmenu",
        value: function contextmenu(e) {
          e.preventDefault();
        }
      }]);

      return yo;
    }(go);

    var bo = /*#__PURE__*/function () {
      function bo(e) {
        _classCallCheck(this, bo);

        this._minTouches = 1, this._clickTolerance = e.clickTolerance || 1, this.reset();
      }

      _createClass(bo, [{
        key: "reset",
        value: function reset() {
          this._active = !1, this._touches = {}, this._sum = new e.Point(0, 0);
        }
      }, {
        key: "touchstart",
        value: function touchstart(e, t, i) {
          return this._calculateTransform(e, t, i);
        }
      }, {
        key: "touchmove",
        value: function touchmove(e, t, i) {
          if (this._active && !(i.length < this._minTouches)) return e.preventDefault(), this._calculateTransform(e, t, i);
        }
      }, {
        key: "touchend",
        value: function touchend(e, t, i) {
          this._calculateTransform(e, t, i), this._active && i.length < this._minTouches && this.reset();
        }
      }, {
        key: "touchcancel",
        value: function touchcancel() {
          this.reset();
        }
      }, {
        key: "_calculateTransform",
        value: function _calculateTransform(t, i, o) {
          o.length > 0 && (this._active = !0);
          var a = uo(o, i),
              r = new e.Point(0, 0),
              n = new e.Point(0, 0);
          var s = 0;

          for (var _e379 in a) {
            var _t355 = a[_e379],
                _i245 = this._touches[_e379];
            _i245 && (r._add(_t355), n._add(_t355.sub(_i245)), s++, a[_e379] = _t355);
          }

          if (this._touches = a, s < this._minTouches || !n.mag()) return;
          var l = n.div(s);
          return this._sum._add(l), this._sum.mag() < this._clickTolerance ? void 0 : {
            around: r.div(s),
            panDelta: l
          };
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return bo;
    }();

    var wo = /*#__PURE__*/function () {
      function wo() {
        _classCallCheck(this, wo);

        this.reset();
      }

      _createClass(wo, [{
        key: "reset",
        value: function reset() {
          this._active = !1, delete this._firstTwoTouches;
        }
      }, {
        key: "_start",
        value: function _start(e) {}
      }, {
        key: "_move",
        value: function _move(e, t, i) {
          return {};
        }
      }, {
        key: "touchstart",
        value: function touchstart(e, t, i) {
          this._firstTwoTouches || i.length < 2 || (this._firstTwoTouches = [i[0].identifier, i[1].identifier], this._start([t[0], t[1]]));
        }
      }, {
        key: "touchmove",
        value: function touchmove(e, t, i) {
          if (!this._firstTwoTouches) return;
          e.preventDefault();
          var [o, a] = this._firstTwoTouches,
              r = To(i, t, o),
              n = To(i, t, a);
          if (!r || !n) return;
          var s = this._aroundCenter ? null : r.add(n).div(2);
          return this._move([r, n], s, e);
        }
      }, {
        key: "touchend",
        value: function touchend(e, t, i) {
          if (!this._firstTwoTouches) return;
          var [o, r] = this._firstTwoTouches,
              n = To(i, t, o),
              s = To(i, t, r);
          n && s || (this._active && a.suppressClick(), this.reset());
        }
      }, {
        key: "touchcancel",
        value: function touchcancel() {
          this.reset();
        }
      }, {
        key: "enable",
        value: function enable(e) {
          this._enabled = !0, this._aroundCenter = !!e && "center" === e.around;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return wo;
    }();

    function To(e, t, i) {
      for (var _o115 = 0; _o115 < e.length; _o115++) {
        if (e[_o115].identifier === i) return t[_o115];
      }
    }

    function Eo(e, t) {
      return Math.log(e / t) / Math.LN2;
    }

    var Co = /*#__PURE__*/function (_wo) {
      _inherits(Co, _wo);

      var _super122 = _createSuper(Co);

      function Co() {
        _classCallCheck(this, Co);

        return _super122.apply(this, arguments);
      }

      _createClass(Co, [{
        key: "reset",
        value: function reset() {
          _get(_getPrototypeOf(Co.prototype), "reset", this).call(this), delete this._distance, delete this._startDistance;
        }
      }, {
        key: "_start",
        value: function _start(e) {
          this._startDistance = this._distance = e[0].dist(e[1]);
        }
      }, {
        key: "_move",
        value: function _move(e, t) {
          var i = this._distance;
          if (this._distance = e[0].dist(e[1]), this._active || !(Math.abs(Eo(this._distance, this._startDistance)) < .1)) return this._active = !0, {
            zoomDelta: Eo(this._distance, i),
            pinchAround: t
          };
        }
      }]);

      return Co;
    }(wo);

    function So(e, t) {
      return 180 * e.angleWith(t) / Math.PI;
    }

    var Io = /*#__PURE__*/function (_wo2) {
      _inherits(Io, _wo2);

      var _super123 = _createSuper(Io);

      function Io() {
        _classCallCheck(this, Io);

        return _super123.apply(this, arguments);
      }

      _createClass(Io, [{
        key: "reset",
        value: function reset() {
          _get(_getPrototypeOf(Io.prototype), "reset", this).call(this), delete this._minDiameter, delete this._startVector, delete this._vector;
        }
      }, {
        key: "_start",
        value: function _start(e) {
          this._startVector = this._vector = e[0].sub(e[1]), this._minDiameter = e[0].dist(e[1]);
        }
      }, {
        key: "_move",
        value: function _move(e, t) {
          var i = this._vector;
          if (this._vector = e[0].sub(e[1]), this._active || !this._isBelowThreshold(this._vector)) return this._active = !0, {
            bearingDelta: So(this._vector, i),
            pinchAround: t
          };
        }
      }, {
        key: "_isBelowThreshold",
        value: function _isBelowThreshold(e) {
          this._minDiameter = Math.min(this._minDiameter, e.mag());
          var t = 25 / (Math.PI * this._minDiameter) * 360,
              i = So(e, this._startVector);
          return Math.abs(i) < t;
        }
      }]);

      return Io;
    }(wo);

    function Po(e) {
      return Math.abs(e.y) > Math.abs(e.x);
    }

    var Mo = /*#__PURE__*/function (_wo3) {
      _inherits(Mo, _wo3);

      var _super124 = _createSuper(Mo);

      function Mo() {
        _classCallCheck(this, Mo);

        return _super124.apply(this, arguments);
      }

      _createClass(Mo, [{
        key: "reset",
        value: function reset() {
          _get(_getPrototypeOf(Mo.prototype), "reset", this).call(this), this._valid = void 0, delete this._firstMove, delete this._lastPoints;
        }
      }, {
        key: "_start",
        value: function _start(e) {
          this._lastPoints = e, Po(e[0].sub(e[1])) && (this._valid = !1);
        }
      }, {
        key: "_move",
        value: function _move(e, t, i) {
          var o = e[0].sub(this._lastPoints[0]),
              a = e[1].sub(this._lastPoints[1]);
          if (this._valid = this.gestureBeginsVertically(o, a, i.timeStamp), this._valid) return this._lastPoints = e, this._active = !0, {
            pitchDelta: (o.y + a.y) / 2 * -.5
          };
        }
      }, {
        key: "gestureBeginsVertically",
        value: function gestureBeginsVertically(e, t, i) {
          if (void 0 !== this._valid) return this._valid;
          var o = e.mag() >= 2,
              a = t.mag() >= 2;
          if (!o && !a) return;
          if (!o || !a) return void 0 === this._firstMove && (this._firstMove = i), i - this._firstMove < 100 && void 0;
          var r = e.y > 0 == t.y > 0;
          return Po(e) && Po(t) && r;
        }
      }]);

      return Mo;
    }(wo);

    var zo = {
      panStep: 100,
      bearingStep: 15,
      pitchStep: 10
    };

    var Ao = /*#__PURE__*/function () {
      function Ao() {
        _classCallCheck(this, Ao);

        var e = zo;
        this._panStep = e.panStep, this._bearingStep = e.bearingStep, this._pitchStep = e.pitchStep, this._rotationDisabled = !1;
      }

      _createClass(Ao, [{
        key: "reset",
        value: function reset() {
          this._active = !1;
        }
      }, {
        key: "keydown",
        value: function keydown(e) {
          var _this117 = this;

          if (e.altKey || e.ctrlKey || e.metaKey) return;
          var t = 0,
              i = 0,
              o = 0,
              a = 0,
              r = 0;

          switch (e.keyCode) {
            case 61:
            case 107:
            case 171:
            case 187:
              t = 1;
              break;

            case 189:
            case 109:
            case 173:
              t = -1;
              break;

            case 37:
              e.shiftKey ? i = -1 : (e.preventDefault(), a = -1);
              break;

            case 39:
              e.shiftKey ? i = 1 : (e.preventDefault(), a = 1);
              break;

            case 38:
              e.shiftKey ? o = 1 : (e.preventDefault(), r = -1);
              break;

            case 40:
              e.shiftKey ? o = -1 : (e.preventDefault(), r = 1);
              break;

            default:
              return;
          }

          return this._rotationDisabled && (i = 0, o = 0), {
            cameraAnimation: function (n) {
              var s = n.getZoom();
              n.easeTo({
                duration: 300,
                easeId: "keyboardHandler",
                easing: Do,
                zoom: t ? Math.round(s) + t * (e.shiftKey ? 2 : 1) : s,
                bearing: n.getBearing() + i * _this117._bearingStep,
                pitch: n.getPitch() + o * _this117._pitchStep,
                offset: [-a * _this117._panStep, -r * _this117._panStep],
                center: n.getCenter()
              }, {
                originalEvent: e
              });
            }
          };
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }, {
        key: "disableRotation",
        value: function disableRotation() {
          this._rotationDisabled = !0;
        }
      }, {
        key: "enableRotation",
        value: function enableRotation() {
          this._rotationDisabled = !1;
        }
      }]);

      return Ao;
    }();

    function Do(e) {
      return e * (2 - e);
    }

    var Lo = /*#__PURE__*/function () {
      function Lo(t, i) {
        _classCallCheck(this, Lo);

        this._map = t, this._el = t.getCanvasContainer(), this._handler = i, this._delta = 0, this._defaultZoomRate = .01, this._wheelZoomRate = 1 / 450, e.bindAll(["_onTimeout"], this);
      }

      _createClass(Lo, [{
        key: "setZoomRate",
        value: function setZoomRate(e) {
          this._defaultZoomRate = e;
        }
      }, {
        key: "setWheelZoomRate",
        value: function setWheelZoomRate(e) {
          this._wheelZoomRate = e;
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return !!this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return !!this._active || void 0 !== this._finishTimeout;
        }
      }, {
        key: "isZooming",
        value: function isZooming() {
          return !!this._zooming;
        }
      }, {
        key: "enable",
        value: function enable(e) {
          this.isEnabled() || (this._enabled = !0, this._aroundCenter = e && "center" === e.around);
        }
      }, {
        key: "disable",
        value: function disable() {
          this.isEnabled() && (this._enabled = !1);
        }
      }, {
        key: "wheel",
        value: function wheel(t) {
          if (!this.isEnabled()) return;
          var i = t.deltaMode === e.window.WheelEvent.DOM_DELTA_LINE ? 40 * t.deltaY : t.deltaY;
          var o = e.browser.now(),
              a = o - (this._lastWheelEventTime || 0);
          this._lastWheelEventTime = o, 0 !== i && i % 4.000244140625 == 0 ? this._type = "wheel" : 0 !== i && Math.abs(i) < 4 ? this._type = "trackpad" : a > 400 ? (this._type = null, this._lastValue = i, this._timeout = setTimeout(this._onTimeout, 40, t)) : this._type || (this._type = Math.abs(a * i) < 200 ? "trackpad" : "wheel", this._timeout && (clearTimeout(this._timeout), this._timeout = null, i += this._lastValue)), t.shiftKey && i && (i /= 4), this._type && (this._lastWheelEvent = t, this._delta -= i, this._active || this._start(t)), t.preventDefault();
        }
      }, {
        key: "_onTimeout",
        value: function _onTimeout(e) {
          this._type = "wheel", this._delta -= this._lastValue, this._active || this._start(e);
        }
      }, {
        key: "_start",
        value: function _start(e) {
          if (!this._delta) return;
          this._frameId && (this._frameId = null), this._active = !0, this.isZooming() || (this._zooming = !0), this._finishTimeout && (clearTimeout(this._finishTimeout), delete this._finishTimeout);
          var t = a.mousePos(this._el, e);
          this._aroundPoint = this._aroundCenter ? this._map.transform.centerPoint : t, this._aroundCoord = this._map.transform.pointCoordinate3D(this._aroundPoint), this._targetZoom = void 0, this._frameId || (this._frameId = !0, this._handler._triggerRenderFrame());
        }
      }, {
        key: "renderFrame",
        value: function renderFrame() {
          var _this118 = this;

          if (!this._frameId) return;
          if (this._frameId = null, !this.isActive()) return;

          var t = this._map.transform,
              i = function () {
            return t._terrainEnabled() ? t.computeZoomRelativeTo(_this118._aroundCoord) : t.zoom;
          };

          if (0 !== this._delta) {
            var _e380 = "wheel" === this._type && Math.abs(this._delta) > 4.000244140625 ? this._wheelZoomRate : this._defaultZoomRate;

            var _o116 = 2 / (1 + Math.exp(-Math.abs(this._delta * _e380)));

            this._delta < 0 && 0 !== _o116 && (_o116 = 1 / _o116);

            var _a148 = i(),
                _r252 = Math.pow(2, _a148),
                _n156 = "number" == typeof this._targetZoom ? t.zoomScale(this._targetZoom) : _r252;

            this._targetZoom = Math.min(t.maxZoom, Math.max(t.minZoom, t.scaleZoom(_n156 * _o116))), "wheel" === this._type && (this._startZoom = i(), this._easing = this._smoothOutEasing(200)), this._delta = 0;
          }

          var o = "number" == typeof this._targetZoom ? this._targetZoom : i(),
              a = this._startZoom,
              r = this._easing;
          var n,
              s = !1;

          if ("wheel" === this._type && a && r) {
            var _t356 = Math.min((e.browser.now() - this._lastWheelEventTime) / 200, 1),
                _i246 = r(_t356);

            n = e.number(a, o, _i246), _t356 < 1 ? this._frameId || (this._frameId = !0) : s = !0;
          } else n = o, s = !0;

          return this._active = !0, s && (this._active = !1, this._finishTimeout = setTimeout(function () {
            _this118._zooming = !1, _this118._handler._triggerRenderFrame(), delete _this118._targetZoom, delete _this118._finishTimeout;
          }, 200)), {
            noInertia: !0,
            needsRenderFrame: !s,
            zoomDelta: n - i(),
            around: this._aroundPoint,
            aroundCoord: this._aroundCoord,
            originalEvent: this._lastWheelEvent
          };
        }
      }, {
        key: "_smoothOutEasing",
        value: function _smoothOutEasing(t) {
          var i = e.ease;

          if (this._prevEase) {
            var _t357 = this._prevEase,
                _o117 = (e.browser.now() - _t357.start) / _t357.duration,
                _a149 = _t357.easing(_o117 + .01) - _t357.easing(_o117),
                _r253 = .27 / Math.sqrt(_a149 * _a149 + 1e-4) * .01,
                _n157 = Math.sqrt(.0729 - _r253 * _r253);

            i = e.bezier(_r253, _n157, .25, 1);
          }

          return this._prevEase = {
            start: e.browser.now(),
            duration: t,
            easing: i
          }, i;
        }
      }, {
        key: "reset",
        value: function reset() {
          this._active = !1;
        }
      }]);

      return Lo;
    }();

    var Ro = /*#__PURE__*/function () {
      function Ro(e, t) {
        _classCallCheck(this, Ro);

        this._clickZoom = e, this._tapZoom = t;
      }

      _createClass(Ro, [{
        key: "enable",
        value: function enable() {
          this._clickZoom.enable(), this._tapZoom.enable();
        }
      }, {
        key: "disable",
        value: function disable() {
          this._clickZoom.disable(), this._tapZoom.disable();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._clickZoom.isEnabled() && this._tapZoom.isEnabled();
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._clickZoom.isActive() || this._tapZoom.isActive();
        }
      }]);

      return Ro;
    }();

    var ko = /*#__PURE__*/function () {
      function ko() {
        _classCallCheck(this, ko);

        this.reset();
      }

      _createClass(ko, [{
        key: "reset",
        value: function reset() {
          this._active = !1;
        }
      }, {
        key: "dblclick",
        value: function dblclick(e, t) {
          return e.preventDefault(), {
            cameraAnimation: function (i) {
              i.easeTo({
                duration: 300,
                zoom: i.getZoom() + (e.shiftKey ? -1 : 1),
                around: i.unproject(t)
              }, {
                originalEvent: e
              });
            }
          };
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return ko;
    }();

    var Bo = /*#__PURE__*/function () {
      function Bo() {
        _classCallCheck(this, Bo);

        this._tap = new mo({
          numTouches: 1,
          numTaps: 1
        }), this.reset();
      }

      _createClass(Bo, [{
        key: "reset",
        value: function reset() {
          this._active = !1, delete this._swipePoint, delete this._swipeTouch, delete this._tapTime, this._tap.reset();
        }
      }, {
        key: "touchstart",
        value: function touchstart(e, t, i) {
          this._swipePoint || (this._tapTime && e.timeStamp - this._tapTime > 500 && this.reset(), this._tapTime ? i.length > 0 && (this._swipePoint = t[0], this._swipeTouch = i[0].identifier) : this._tap.touchstart(e, t, i));
        }
      }, {
        key: "touchmove",
        value: function touchmove(e, t, i) {
          if (this._tapTime) {
            if (this._swipePoint) {
              if (i[0].identifier !== this._swipeTouch) return;

              var _o118 = t[0],
                  _a150 = _o118.y - this._swipePoint.y;

              return this._swipePoint = _o118, e.preventDefault(), this._active = !0, {
                zoomDelta: _a150 / 128
              };
            }
          } else this._tap.touchmove(e, t, i);
        }
      }, {
        key: "touchend",
        value: function touchend(e, t, i) {
          this._tapTime ? this._swipePoint && 0 === i.length && this.reset() : this._tap.touchend(e, t, i) && (this._tapTime = e.timeStamp);
        }
      }, {
        key: "touchcancel",
        value: function touchcancel() {
          this.reset();
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return Bo;
    }();

    var Fo = /*#__PURE__*/function () {
      function Fo(e, t, i) {
        _classCallCheck(this, Fo);

        this._el = e, this._mousePan = t, this._touchPan = i;
      }

      _createClass(Fo, [{
        key: "enable",
        value: function enable(e) {
          this._inertiaOptions = e || {}, this._mousePan.enable(), this._touchPan.enable(), this._el.classList.add("mapboxgl-touch-drag-pan");
        }
      }, {
        key: "disable",
        value: function disable() {
          this._mousePan.disable(), this._touchPan.disable(), this._el.classList.remove("mapboxgl-touch-drag-pan");
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._mousePan.isEnabled() && this._touchPan.isEnabled();
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._mousePan.isActive() || this._touchPan.isActive();
        }
      }]);

      return Fo;
    }();

    var Oo = /*#__PURE__*/function () {
      function Oo(e, t, i) {
        _classCallCheck(this, Oo);

        this._pitchWithRotate = e.pitchWithRotate, this._mouseRotate = t, this._mousePitch = i;
      }

      _createClass(Oo, [{
        key: "enable",
        value: function enable() {
          this._mouseRotate.enable(), this._pitchWithRotate && this._mousePitch.enable();
        }
      }, {
        key: "disable",
        value: function disable() {
          this._mouseRotate.disable(), this._mousePitch.disable();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._mouseRotate.isEnabled() && (!this._pitchWithRotate || this._mousePitch.isEnabled());
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._mouseRotate.isActive() || this._mousePitch.isActive();
        }
      }]);

      return Oo;
    }();

    var Uo = /*#__PURE__*/function () {
      function Uo(e, t, i, o) {
        _classCallCheck(this, Uo);

        this._el = e, this._touchZoom = t, this._touchRotate = i, this._tapDragZoom = o, this._rotationDisabled = !1, this._enabled = !0;
      }

      _createClass(Uo, [{
        key: "enable",
        value: function enable(e) {
          this._touchZoom.enable(e), this._rotationDisabled || this._touchRotate.enable(e), this._tapDragZoom.enable(), this._el.classList.add("mapboxgl-touch-zoom-rotate");
        }
      }, {
        key: "disable",
        value: function disable() {
          this._touchZoom.disable(), this._touchRotate.disable(), this._tapDragZoom.disable(), this._el.classList.remove("mapboxgl-touch-zoom-rotate");
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._touchZoom.isEnabled() && (this._rotationDisabled || this._touchRotate.isEnabled()) && this._tapDragZoom.isEnabled();
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._touchZoom.isActive() || this._touchRotate.isActive() || this._tapDragZoom.isActive();
        }
      }, {
        key: "disableRotation",
        value: function disableRotation() {
          this._rotationDisabled = !0, this._touchRotate.disable();
        }
      }, {
        key: "enableRotation",
        value: function enableRotation() {
          this._rotationDisabled = !1, this._touchZoom.isEnabled() && this._touchRotate.enable();
        }
      }]);

      return Uo;
    }();

    var No = function (e) {
      return e.zoom || e.drag || e.pitch || e.rotate;
    };

    var Zo = /*#__PURE__*/function (_e$Event4) {
      _inherits(Zo, _e$Event4);

      var _super125 = _createSuper(Zo);

      function Zo() {
        _classCallCheck(this, Zo);

        return _super125.apply(this, arguments);
      }

      return Zo;
    }(e.Event);

    var Go = /*#__PURE__*/function () {
      function Go() {
        _classCallCheck(this, Go);

        this.constants = [1, 1, .01], this.radius = 0;
      }

      _createClass(Go, [{
        key: "setup",
        value: function setup(t, i) {
          var o = e.sub([], i, t);
          this.radius = e.length(o[2] < 0 ? e.div([], o, this.constants) : [o[0], o[1], 0]);
        }
      }, {
        key: "projectRay",
        value: function projectRay(t) {
          e.div(t, t, this.constants), e.normalize(t, t), e.mul$1(t, t, this.constants);
          var i = e.scale$2([], t, this.radius);

          if (i[2] > 0) {
            var _t358 = e.scale$2([], [0, 0, 1], e.dot(i, [0, 0, 1])),
                _o119 = e.scale$2([], e.normalize([], [i[0], i[1], 0]), this.radius),
                _a151 = e.add([], i, e.scale$2([], e.sub([], e.add([], _o119, _t358), i), 2));

            i[0] = _a151[0], i[1] = _a151[1];
          }

          return i;
        }
      }]);

      return Go;
    }();

    function Vo(e) {
      return e.panDelta && e.panDelta.mag() || e.zoomDelta || e.bearingDelta || e.pitchDelta;
    }

    var qo = /*#__PURE__*/function () {
      function qo(t, i) {
        _classCallCheck(this, qo);

        this._map = t, this._el = this._map.getCanvasContainer(), this._handlers = [], this._handlersById = {}, this._changes = [], this._inertia = new io(t), this._bearingSnap = i.bearingSnap, this._previousActiveHandlers = {}, this._trackingEllipsoid = new Go(), this._dragOrigin = null, this._eventsInProgress = {}, this._addDefaultHandlers(i), e.bindAll(["handleEvent", "handleWindowEvent"], this);
        var o = this._el;
        this._listeners = [[o, "touchstart", {
          passive: !0
        }], [o, "touchmove", {
          passive: !1
        }], [o, "touchend", void 0], [o, "touchcancel", void 0], [o, "mousedown", void 0], [o, "mousemove", void 0], [o, "mouseup", void 0], [e.window.document, "mousemove", {
          capture: !0
        }], [e.window.document, "mouseup", void 0], [o, "mouseover", void 0], [o, "mouseout", void 0], [o, "dblclick", void 0], [o, "click", void 0], [o, "keydown", {
          capture: !1
        }], [o, "keyup", void 0], [o, "wheel", {
          passive: !1
        }], [o, "contextmenu", void 0], [e.window, "blur", void 0]];

        for (var [_t359, _i247, _o120] of this._listeners) {
          a.addEventListener(_t359, _i247, _t359 === e.window.document ? this.handleWindowEvent : this.handleEvent, _o120);
        }
      }

      _createClass(qo, [{
        key: "destroy",
        value: function destroy() {
          for (var [_t360, _i248, _o121] of this._listeners) {
            a.removeEventListener(_t360, _i248, _t360 === e.window.document ? this.handleWindowEvent : this.handleEvent, _o121);
          }
        }
      }, {
        key: "_addDefaultHandlers",
        value: function _addDefaultHandlers(e) {
          var t = this._map,
              i = t.getCanvasContainer();

          this._add("mapEvent", new lo(t, e));

          var o = t.boxZoom = new ho(t, e);

          this._add("boxZoom", o);

          var a = new po(),
              r = new ko();
          t.doubleClickZoom = new Ro(r, a), this._add("tapZoom", a), this._add("clickZoom", r);
          var n = new Bo();

          this._add("tapDragZoom", n);

          var s = t.touchPitch = new Mo();

          this._add("touchPitch", s);

          var l = new xo(e),
              c = new yo(e);
          t.dragRotate = new Oo(e, l, c), this._add("mouseRotate", l, ["mousePitch"]), this._add("mousePitch", c, ["mouseRotate"]);
          var h = new vo(e),
              u = new bo(e);
          t.dragPan = new Fo(i, h, u), this._add("mousePan", h), this._add("touchPan", u, ["touchZoom", "touchRotate"]);

          var d = new Io(),
              _ = new Co();

          t.touchZoomRotate = new Uo(i, _, d, n), this._add("touchRotate", d, ["touchPan", "touchZoom"]), this._add("touchZoom", _, ["touchPan", "touchRotate"]), this._add("blockableMapEvent", new co(t));
          var m = t.scrollZoom = new Lo(t, this);

          this._add("scrollZoom", m, ["mousePan"]);

          var p = t.keyboard = new Ao();

          this._add("keyboard", p);

          for (var _i249 of ["boxZoom", "doubleClickZoom", "tapDragZoom", "touchPitch", "dragRotate", "dragPan", "touchZoomRotate", "scrollZoom", "keyboard"]) {
            e.interactive && e[_i249] && t[_i249].enable(e[_i249]);
          }
        }
      }, {
        key: "_add",
        value: function _add(e, t, i) {
          this._handlers.push({
            handlerName: e,
            handler: t,
            allowed: i
          }), this._handlersById[e] = t;
        }
      }, {
        key: "stop",
        value: function stop(e) {
          if (!this._updatingCamera) {
            for (var {
              handler: _e381
            } of this._handlers) {
              _e381.reset();
            }

            this._inertia.clear(), this._fireEvents({}, {}, e), this._changes = [];
          }
        }
      }, {
        key: "isActive",
        value: function isActive() {
          for (var {
            handler: _e382
          } of this._handlers) {
            if (_e382.isActive()) return !0;
          }

          return !1;
        }
      }, {
        key: "isZooming",
        value: function isZooming() {
          return !!this._eventsInProgress.zoom || this._map.scrollZoom.isZooming();
        }
      }, {
        key: "isRotating",
        value: function isRotating() {
          return !!this._eventsInProgress.rotate;
        }
      }, {
        key: "isMoving",
        value: function isMoving() {
          return Boolean(No(this._eventsInProgress)) || this.isZooming();
        }
      }, {
        key: "_blockedByActive",
        value: function _blockedByActive(e, t, i) {
          for (var _o122 in e) {
            if (_o122 !== i && (!t || t.indexOf(_o122) < 0)) return !0;
          }

          return !1;
        }
      }, {
        key: "handleWindowEvent",
        value: function handleWindowEvent(e) {
          this.handleEvent(e, "".concat(e.type, "Window"));
        }
      }, {
        key: "_getMapTouches",
        value: function _getMapTouches(e) {
          var t = [];

          for (var _i250 of e) {
            this._el.contains(_i250.target) && t.push(_i250);
          }

          return t;
        }
      }, {
        key: "handleEvent",
        value: function handleEvent(e, t) {
          if ("blur" === e.type) return void this.stop(!0);
          this._updatingCamera = !0;
          var i = "renderFrame" === e.type ? void 0 : e,
              o = {
            needsRenderFrame: !1
          },
              r = {},
              n = {},
              s = e.touches ? this._getMapTouches(e.touches) : void 0,
              l = s ? a.touchPos(this._el, s) : a.mousePos(this._el, e);

          for (var {
            handlerName: _a152,
            handler: _c41,
            allowed: _h31
          } of this._handlers) {
            if (!_c41.isEnabled()) continue;

            var _u44 = void 0;

            this._blockedByActive(n, _h31, _a152) ? _c41.reset() : _c41[t || e.type] && (_u44 = _c41[t || e.type](e, l, s), this.mergeHandlerResult(o, r, _u44, _a152, i), _u44 && _u44.needsRenderFrame && this._triggerRenderFrame()), (_u44 || _c41.isActive()) && (n[_a152] = _c41);
          }

          var c = {};

          for (var _e383 in this._previousActiveHandlers) {
            n[_e383] || (c[_e383] = i);
          }

          this._previousActiveHandlers = n, (Object.keys(c).length || Vo(o)) && (this._changes.push([o, r, c]), this._triggerRenderFrame()), (Object.keys(n).length || Vo(o)) && this._map._stop(!0), this._updatingCamera = !1;
          var {
            cameraAnimation: h
          } = o;
          h && (this._inertia.clear(), this._fireEvents({}, {}, !0), this._changes = [], h(this._map));
        }
      }, {
        key: "mergeHandlerResult",
        value: function mergeHandlerResult(t, i, o, a, r) {
          if (!o) return;
          e.extend(t, o);
          var n = {
            handlerName: a,
            originalEvent: o.originalEvent || r
          };
          void 0 !== o.zoomDelta && (i.zoom = n), void 0 !== o.panDelta && (i.drag = n), void 0 !== o.pitchDelta && (i.pitch = n), void 0 !== o.bearingDelta && (i.rotate = n);
        }
      }, {
        key: "_applyChanges",
        value: function _applyChanges() {
          var t = {},
              i = {},
              o = {};

          for (var [_a153, _r254, _n158] of this._changes) {
            _a153.panDelta && (t.panDelta = (t.panDelta || new e.Point(0, 0))._add(_a153.panDelta)), _a153.zoomDelta && (t.zoomDelta = (t.zoomDelta || 0) + _a153.zoomDelta), _a153.bearingDelta && (t.bearingDelta = (t.bearingDelta || 0) + _a153.bearingDelta), _a153.pitchDelta && (t.pitchDelta = (t.pitchDelta || 0) + _a153.pitchDelta), void 0 !== _a153.around && (t.around = _a153.around), void 0 !== _a153.aroundCoord && (t.aroundCoord = _a153.aroundCoord), void 0 !== _a153.pinchAround && (t.pinchAround = _a153.pinchAround), _a153.noInertia && (t.noInertia = _a153.noInertia), e.extend(i, _r254), e.extend(o, _n158);
          }

          this._updateMapTransform(t, i, o), this._changes = [];
        }
      }, {
        key: "_updateMapTransform",
        value: function _updateMapTransform(t, i, o) {
          var _this119 = this;

          var a = this._map,
              r = a.transform,
              n = function (e) {
            return [e.x, e.y, e.z];
          };

          if (function (e) {
            var t = _this119._eventsInProgress.drag;
            return t && !_this119._handlersById[t.handlerName].isActive();
          }() && !Vo(t)) {
            var _e384 = r.zoom;
            r.cameraElevationReference = "sea", r.recenterOnTerrain(), r.cameraElevationReference = "ground", _e384 !== r.zoom && this._map._update(!0);
          }

          if (!Vo(t)) return this._fireEvents(i, o, !0);
          var {
            panDelta: s,
            zoomDelta: l,
            bearingDelta: c,
            pitchDelta: h,
            around: u,
            aroundCoord: d,
            pinchAround: _
          } = t;
          void 0 !== _ && (u = _), function (e) {
            return i.drag && !_this119._eventsInProgress.drag;
          }() && u && (this._dragOrigin = n(r.pointCoordinate3D(u)), this._trackingEllipsoid.setup(r._camera.position, this._dragOrigin)), r.cameraElevationReference = "sea", a._stop(!0), u = u || a.transform.centerPoint, c && (r.bearing += c), h && (r.pitch += h), r._updateCameraState();
          var m = [0, 0, 0];

          if (s) {
            var _e385 = r.screenPointToMercatorRay(u),
                _t361 = r.screenPointToMercatorRay(u.sub(s)),
                _i251 = this._trackingEllipsoid.projectRay(_e385.dir),
                _o123 = this._trackingEllipsoid.projectRay(_t361.dir);

            m[0] = _o123[0] - _i251[0], m[1] = _o123[1] - _i251[1];
          }

          var p = r.zoom,
              f = [0, 0, 0];

          if (l) {
            var _t362 = n(d || r.pointCoordinate3D(u)),
                _i252 = {
              dir: e.normalize([], e.sub([], _t362, r._camera.position))
            },
                _o124 = r.screenPointToMercatorRay(r.centerPoint);

            if (_i252.dir[2] < 0) {
              var _a154 = e.altitudeFromMercatorZ(_t362[2], _t362[1]),
                  _s124 = r.rayIntersectionCoordinate(r.pointRayIntersection(r.centerPoint, _a154)),
                  _c42 = r.zoomDeltaToMovement(n(_s124), l) * (_o124.dir[2] / _i252.dir[2]);

              e.scale$2(f, _i252.dir, _c42);
            } else if (r._terrainEnabled()) {
              var _o125 = r.zoomDeltaToMovement(_t362, l);

              e.scale$2(f, _i252.dir, _o125);
            }
          }

          var g = e.add(m, m, f);
          r._translateCameraConstrained(g), l && Math.abs(r.zoom - p) > 1e-4 && r.recenterOnTerrain(), r.cameraElevationReference = "ground", this._map._update(), t.noInertia || this._inertia.record(t), this._fireEvents(i, o, !0);
        }
      }, {
        key: "_fireEvents",
        value: function _fireEvents(t, i, o) {
          var _this120 = this;

          var a = No(this._eventsInProgress),
              r = No(t),
              n = {};

          for (var _e386 in t) {
            var {
              originalEvent: _i253
            } = t[_e386];
            this._eventsInProgress[_e386] || (n["".concat(_e386, "start")] = _i253), this._eventsInProgress[_e386] = t[_e386];
          }

          !a && r && this._fireEvent("movestart", r.originalEvent);

          for (var _e387 in n) {
            this._fireEvent(_e387, n[_e387]);
          }

          r && this._fireEvent("move", r.originalEvent);

          for (var _e388 in t) {
            var {
              originalEvent: _i254
            } = t[_e388];

            this._fireEvent(_e388, _i254);
          }

          var s = {};
          var l;

          for (var _e389 in this._eventsInProgress) {
            var {
              handlerName: _t363,
              originalEvent: _o126
            } = this._eventsInProgress[_e389];
            this._handlersById[_t363].isActive() || (delete this._eventsInProgress[_e389], l = i[_t363] || _o126, s["".concat(_e389, "end")] = l);
          }

          for (var _e390 in s) {
            this._fireEvent(_e390, s[_e390]);
          }

          var c = No(this._eventsInProgress);

          if (o && (a || r) && !c) {
            this._updatingCamera = !0;

            var _t364 = this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),
                _i255 = function (e) {
              return 0 !== e && -_this120._bearingSnap < e && e < _this120._bearingSnap;
            };

            _t364 ? (_i255(_t364.bearing || this._map.getBearing()) && (_t364.bearing = 0), this._map.easeTo(_t364, {
              originalEvent: l
            })) : (this._map.fire(new e.Event("moveend", {
              originalEvent: l
            })), _i255(this._map.getBearing()) && this._map.resetNorth()), this._updatingCamera = !1;
          }
        }
      }, {
        key: "_fireEvent",
        value: function _fireEvent(t, i) {
          this._map.fire(new e.Event(t, i ? {
            originalEvent: i
          } : {}));
        }
      }, {
        key: "_requestFrame",
        value: function _requestFrame() {
          var _this121 = this;

          return this._map.triggerRepaint(), this._map._renderTaskQueue.add(function (e) {
            delete _this121._frameId, _this121.handleEvent(new Zo("renderFrame", {
              timeStamp: e
            })), _this121._applyChanges();
          });
        }
      }, {
        key: "_triggerRenderFrame",
        value: function _triggerRenderFrame() {
          void 0 === this._frameId && (this._frameId = this._requestFrame());
        }
      }]);

      return qo;
    }();

    var jo = /*#__PURE__*/function (_e$Evented9) {
      _inherits(jo, _e$Evented9);

      var _super126 = _createSuper(jo);

      function jo(t, i) {
        var _this122;

        _classCallCheck(this, jo);

        _this122 = _super126.call(this), _this122._moving = !1, _this122._zooming = !1, _this122.transform = t, _this122._bearingSnap = i.bearingSnap, e.bindAll(["_renderFrameCallback"], _assertThisInitialized(_this122));
        return _this122;
      }

      _createClass(jo, [{
        key: "getCenter",
        value: function getCenter() {
          return new e.LngLat(this.transform.center.lng, this.transform.center.lat);
        }
      }, {
        key: "setCenter",
        value: function setCenter(e, t) {
          return this.jumpTo({
            center: e
          }, t);
        }
      }, {
        key: "panBy",
        value: function panBy(t, i, o) {
          return t = e.Point.convert(t).mult(-1), this.panTo(this.transform.center, e.extend({
            offset: t
          }, i), o);
        }
      }, {
        key: "panTo",
        value: function panTo(t, i, o) {
          return this.easeTo(e.extend({
            center: t
          }, i), o);
        }
      }, {
        key: "getZoom",
        value: function getZoom() {
          return this.transform.zoom;
        }
      }, {
        key: "setZoom",
        value: function setZoom(e, t) {
          return this.jumpTo({
            zoom: e
          }, t), this;
        }
      }, {
        key: "zoomTo",
        value: function zoomTo(t, i, o) {
          return this.easeTo(e.extend({
            zoom: t
          }, i), o);
        }
      }, {
        key: "zoomIn",
        value: function zoomIn(e, t) {
          return this.zoomTo(this.getZoom() + 1, e, t), this;
        }
      }, {
        key: "zoomOut",
        value: function zoomOut(e, t) {
          return this.zoomTo(this.getZoom() - 1, e, t), this;
        }
      }, {
        key: "getBearing",
        value: function getBearing() {
          return this.transform.bearing;
        }
      }, {
        key: "setBearing",
        value: function setBearing(e, t) {
          return this.jumpTo({
            bearing: e
          }, t), this;
        }
      }, {
        key: "getPadding",
        value: function getPadding() {
          return this.transform.padding;
        }
      }, {
        key: "setPadding",
        value: function setPadding(e, t) {
          return this.jumpTo({
            padding: e
          }, t), this;
        }
      }, {
        key: "rotateTo",
        value: function rotateTo(t, i, o) {
          return this.easeTo(e.extend({
            bearing: t
          }, i), o);
        }
      }, {
        key: "resetNorth",
        value: function resetNorth(t, i) {
          return this.rotateTo(0, e.extend({
            duration: 1e3
          }, t), i), this;
        }
      }, {
        key: "resetNorthPitch",
        value: function resetNorthPitch(t, i) {
          return this.easeTo(e.extend({
            bearing: 0,
            pitch: 0,
            duration: 1e3
          }, t), i), this;
        }
      }, {
        key: "snapToNorth",
        value: function snapToNorth(e, t) {
          return Math.abs(this.getBearing()) < this._bearingSnap ? this.resetNorth(e, t) : this;
        }
      }, {
        key: "getPitch",
        value: function getPitch() {
          return this.transform.pitch;
        }
      }, {
        key: "setPitch",
        value: function setPitch(e, t) {
          return this.jumpTo({
            pitch: e
          }, t), this;
        }
      }, {
        key: "cameraForBounds",
        value: function cameraForBounds(t, i) {
          t = e.LngLatBounds.convert(t);
          var o = i && i.bearing || 0;
          return this._cameraForBoxAndBearing(t.getNorthWest(), t.getSouthEast(), o, i);
        }
      }, {
        key: "_extendCameraOptions",
        value: function _extendCameraOptions(t) {
          var i = {
            top: 0,
            bottom: 0,
            right: 0,
            left: 0
          };

          if ("number" == typeof (t = e.extend({
            padding: i,
            offset: [0, 0],
            maxZoom: this.transform.maxZoom
          }, t)).padding) {
            var _e391 = t.padding;
            t.padding = {
              top: _e391,
              bottom: _e391,
              right: _e391,
              left: _e391
            };
          }

          return t.padding = e.extend(i, t.padding), t;
        }
      }, {
        key: "_cameraForBoxAndBearing",
        value: function _cameraForBoxAndBearing(t, i, o, a) {
          var r = this._extendCameraOptions(a),
              n = this.transform,
              s = n.padding,
              l = n.project(e.LngLat.convert(t)),
              c = n.project(e.LngLat.convert(i)),
              h = l.rotate(-e.degToRad(o)),
              u = c.rotate(-e.degToRad(o)),
              d = new e.Point(Math.max(h.x, u.x), Math.max(h.y, u.y)),
              _ = new e.Point(Math.min(h.x, u.x), Math.min(h.y, u.y)),
              m = d.sub(_),
              p = (n.width - (s.left + s.right + r.padding.left + r.padding.right)) / m.x,
              f = (n.height - (s.top + s.bottom + r.padding.top + r.padding.bottom)) / m.y;

          if (f < 0 || p < 0) return void e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");
          var g = Math.min(n.scaleZoom(n.scale * Math.min(p, f)), r.maxZoom),
              v = "number" == typeof r.offset.x ? new e.Point(r.offset.x, r.offset.y) : e.Point.convert(r.offset),
              x = new e.Point((r.padding.left - r.padding.right) / 2, (r.padding.top - r.padding.bottom) / 2).rotate(o * Math.PI / 180),
              y = v.add(x).mult(n.scale / n.zoomScale(g));
          return {
            center: n.unproject(l.add(c).div(2).sub(y)),
            zoom: g,
            bearing: o
          };
        }
      }, {
        key: "_cameraForBox",
        value: function _cameraForBox(t, i, o, a, r) {
          var n = this._extendCameraOptions(r);

          o = o || 0, a = a || 0, t = e.LngLat.convert(t), i = e.LngLat.convert(i);
          var s = this.transform.clone();
          s.padding = n.padding;
          var l = this.getFreeCameraOptions(),
              c = new e.LngLat(.5 * (t.lng + i.lng), .5 * (t.lat + i.lat)),
              h = .5 * (o + a);
          if (s._camera.position[2] < e.mercatorZfromAltitude(h, c.lat)) return void e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");
          l.lookAtPoint(c), s.setFreeCameraOptions(l);

          var u = e.MercatorCoordinate.fromLngLat(t),
              d = e.MercatorCoordinate.fromLngLat(i),
              _ = s.pointRayIntersection(s.centerPoint, h),
              m = [(p = s.rayIntersectionCoordinate(_)).x, p.y, p.z];

          var p;
          var f = s.screenPointToMercatorRay(s.centerPoint);
          var g,
              v = 0;

          do {
            var _t365 = Math.floor(s.zoom),
                _i256 = 1 << _t365,
                _r255 = Math.min(_i256 * u.x, _i256 * d.x),
                _n159 = Math.min(_i256 * u.y, _i256 * d.y),
                _l56 = Math.max(_i256 * u.x, _i256 * d.x),
                _c43 = Math.max(_i256 * u.y, _i256 * d.y),
                _h32 = new e.Aabb([_r255, _n159, o], [_l56, _c43, a]),
                _15 = e.Frustum.fromInvProjectionMatrix(s.invProjMatrix, s.worldSize, _t365);

            if (2 !== _h32.intersects(_15)) {
              g && (s._camera.position = e.scaleAndAdd([], s._camera.position, f.dir, -g), s._updateStateFromCamera());
              break;
            }

            var _p24 = e.sub([], s._camera.position, m);

            g = .5 * e.length(_p24), s._camera.position = e.scaleAndAdd([], s._camera.position, f.dir, g);

            try {
              s._updateStateFromCamera();
            } catch (t) {
              return void e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");
            }
          } while (++v < 10);

          return {
            center: s.center,
            zoom: s.zoom,
            bearing: s.bearing,
            pitch: s.pitch
          };
        }
      }, {
        key: "fitBounds",
        value: function fitBounds(e, t, i) {
          return this._fitInternal(this.cameraForBounds(e, t), t, i);
        }
      }, {
        key: "_raycastElevationBox",
        value: function _raycastElevationBox(t, i) {
          var o = this.transform.elevation;
          if (!o) return;
          var a = new e.Point(t.x, i.y),
              r = new e.Point(i.x, t.y),
              n = o.pointCoordinate(t);
          if (!n) return;
          var s = o.pointCoordinate(i);
          if (!s) return;
          var l = o.pointCoordinate(a);
          if (!l) return;
          var c = o.pointCoordinate(r);
          if (!c) return;

          var h = new e.MercatorCoordinate(n[0], n[1]).toLngLat(),
              u = new e.MercatorCoordinate(s[0], s[1]).toLngLat(),
              d = new e.MercatorCoordinate(l[0], l[1]).toLngLat(),
              _ = new e.MercatorCoordinate(c[0], c[1]).toLngLat(),
              m = Math.min(h.lng, Math.min(u.lng, Math.min(d.lng, _.lng))),
              p = Math.min(h.lat, Math.min(u.lat, Math.min(d.lat, _.lat))),
              f = Math.max(h.lng, Math.max(u.lng, Math.max(d.lng, _.lng))),
              g = Math.max(h.lat, Math.max(u.lat, Math.max(d.lat, _.lat))),
              v = Math.min(n[3], Math.min(s[3], Math.min(l[3], c[3]))),
              x = Math.max(n[3], Math.max(s[3], Math.max(l[3], c[3])));

          return {
            minLngLat: new e.LngLat(m, p),
            maxLngLat: new e.LngLat(f, g),
            minAltitude: v,
            maxAltitude: x
          };
        }
      }, {
        key: "fitScreenCoordinates",
        value: function fitScreenCoordinates(t, i, o, a, r) {
          var n, s, l, c;

          var h = e.Point.convert(t),
              u = e.Point.convert(i),
              d = this._raycastElevationBox(h, u);

          if (d) n = d.minLngLat, s = d.maxLngLat, l = d.minAltitude, c = d.maxAltitude;else {
            if (this.transform.isHorizonVisibleForPoints(h, u)) return this;
            n = this.transform.pointLocation(h), s = this.transform.pointLocation(u);
          }
          return this._fitInternal(0 === this.transform.pitch ? this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(t)), this.transform.pointLocation(e.Point.convert(i)), o, a) : this._cameraForBox(n, s, l, c, a), a, r);
        }
      }, {
        key: "_fitInternal",
        value: function _fitInternal(t, i, o) {
          return t ? (delete (i = e.extend(t, i)).padding, i.linear ? this.easeTo(i, o) : this.flyTo(i, o)) : this;
        }
      }, {
        key: "jumpTo",
        value: function jumpTo(t, i) {
          this.stop();
          var o = this.transform;
          var a = !1,
              r = !1,
              n = !1;
          return "zoom" in t && o.zoom !== +t.zoom && (a = !0, o.zoom = +t.zoom), void 0 !== t.center && (o.center = e.LngLat.convert(t.center)), "bearing" in t && o.bearing !== +t.bearing && (r = !0, o.bearing = +t.bearing), "pitch" in t && o.pitch !== +t.pitch && (n = !0, o.pitch = +t.pitch), null == t.padding || o.isPaddingEqual(t.padding) || (o.padding = t.padding), this.fire(new e.Event("movestart", i)).fire(new e.Event("move", i)), a && this.fire(new e.Event("zoomstart", i)).fire(new e.Event("zoom", i)).fire(new e.Event("zoomend", i)), r && this.fire(new e.Event("rotatestart", i)).fire(new e.Event("rotate", i)).fire(new e.Event("rotateend", i)), n && this.fire(new e.Event("pitchstart", i)).fire(new e.Event("pitch", i)).fire(new e.Event("pitchend", i)), this.fire(new e.Event("moveend", i));
        }
      }, {
        key: "getFreeCameraOptions",
        value: function getFreeCameraOptions() {
          return this.transform.getFreeCameraOptions();
        }
      }, {
        key: "setFreeCameraOptions",
        value: function setFreeCameraOptions(t, i) {
          this.stop();
          var o = this.transform,
              a = o.zoom,
              r = o.pitch,
              n = o.bearing;
          o.setFreeCameraOptions(t);
          var s = a !== o.zoom,
              l = r !== o.pitch,
              c = n !== o.bearing;
          return this.fire(new e.Event("movestart", i)).fire(new e.Event("move", i)), s && this.fire(new e.Event("zoomstart", i)).fire(new e.Event("zoom", i)).fire(new e.Event("zoomend", i)), c && this.fire(new e.Event("rotatestart", i)).fire(new e.Event("rotate", i)).fire(new e.Event("rotateend", i)), l && this.fire(new e.Event("pitchstart", i)).fire(new e.Event("pitch", i)).fire(new e.Event("pitchend", i)), this.fire(new e.Event("moveend", i)), this;
        }
      }, {
        key: "easeTo",
        value: function easeTo(t, i) {
          var _this123 = this;

          this._stop(!1, t.easeId), (!1 === (t = e.extend({
            offset: [0, 0],
            duration: 500,
            easing: e.ease
          }, t)).animate || !t.essential && e.browser.prefersReducedMotion) && (t.duration = 0);
          var o = this.transform,
              a = this.getZoom(),
              r = this.getBearing(),
              n = this.getPitch(),
              s = this.getPadding(),
              l = "zoom" in t ? +t.zoom : a,
              c = "bearing" in t ? this._normalizeBearing(t.bearing, r) : r,
              h = "pitch" in t ? +t.pitch : n,
              u = "padding" in t ? t.padding : o.padding,
              d = e.Point.convert(t.offset);

          var _ = o.centerPoint.add(d);

          var m = o.pointLocation(_),
              p = e.LngLat.convert(t.center || m);

          this._normalizeCenter(p);

          var f = o.project(m),
              g = o.project(p).sub(f),
              v = o.zoomScale(l - a);
          var x, y;
          t.around && (x = e.LngLat.convert(t.around), y = o.locationPoint(x));
          var b = {
            moving: this._moving,
            zooming: this._zooming,
            rotating: this._rotating,
            pitching: this._pitching
          };
          return this._zooming = this._zooming || l !== a, this._rotating = this._rotating || r !== c, this._pitching = this._pitching || h !== n, this._padding = !o.isPaddingEqual(u), this._easeId = t.easeId, this._prepareEase(i, t.noMoveStart, b), this._ease(function (t) {
            if (_this123._zooming && (o.zoom = e.number(a, l, t)), _this123._rotating && (o.bearing = e.number(r, c, t)), _this123._pitching && (o.pitch = e.number(n, h, t)), _this123._padding && (o.interpolatePadding(s, u, t), _ = o.centerPoint.add(d)), x) o.setLocationAtPoint(x, y);else {
              var _e392 = o.zoomScale(o.zoom - a),
                  _i257 = l > a ? Math.min(2, v) : Math.max(.5, v),
                  _r256 = Math.pow(_i257, 1 - t),
                  _n160 = o.unproject(f.add(g.mult(t * _r256)).mult(_e392));

              o.setLocationAtPoint(o.renderWorldCopies ? _n160.wrap() : _n160, _);
            }

            _this123._fireMoveEvents(i);
          }, function (e) {
            o.recenterOnTerrain(), _this123._afterEase(i, e);
          }, t), this;
        }
      }, {
        key: "_prepareEase",
        value: function _prepareEase(t, i) {
          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
          this._moving = !0, this.transform.cameraElevationReference = "sea", i || o.moving || this.fire(new e.Event("movestart", t)), this._zooming && !o.zooming && this.fire(new e.Event("zoomstart", t)), this._rotating && !o.rotating && this.fire(new e.Event("rotatestart", t)), this._pitching && !o.pitching && this.fire(new e.Event("pitchstart", t));
        }
      }, {
        key: "_fireMoveEvents",
        value: function _fireMoveEvents(t) {
          this.fire(new e.Event("move", t)), this._zooming && this.fire(new e.Event("zoom", t)), this._rotating && this.fire(new e.Event("rotate", t)), this._pitching && this.fire(new e.Event("pitch", t));
        }
      }, {
        key: "_afterEase",
        value: function _afterEase(t, i) {
          if (this._easeId && i && this._easeId === i) return;
          delete this._easeId, this.transform.cameraElevationReference = "ground";
          var o = this._zooming,
              a = this._rotating,
              r = this._pitching;
          this._moving = !1, this._zooming = !1, this._rotating = !1, this._pitching = !1, this._padding = !1, o && this.fire(new e.Event("zoomend", t)), a && this.fire(new e.Event("rotateend", t)), r && this.fire(new e.Event("pitchend", t)), this.fire(new e.Event("moveend", t));
        }
      }, {
        key: "flyTo",
        value: function flyTo(t, i) {
          var _this124 = this;

          if (!t.essential && e.browser.prefersReducedMotion) {
            var _o127 = e.pick(t, ["center", "zoom", "bearing", "pitch", "around"]);

            return this.jumpTo(_o127, i);
          }

          this.stop(), t = e.extend({
            offset: [0, 0],
            speed: 1.2,
            curve: 1.42,
            easing: e.ease
          }, t);

          var o = this.transform,
              a = this.getZoom(),
              r = this.getBearing(),
              n = this.getPitch(),
              s = this.getPadding(),
              l = "zoom" in t ? e.clamp(+t.zoom, o.minZoom, o.maxZoom) : a,
              c = "bearing" in t ? this._normalizeBearing(t.bearing, r) : r,
              h = "pitch" in t ? +t.pitch : n,
              u = "padding" in t ? t.padding : o.padding,
              d = o.zoomScale(l - a),
              _ = e.Point.convert(t.offset);

          var m = o.centerPoint.add(_);
          var p = o.pointLocation(m),
              f = e.LngLat.convert(t.center || p);

          this._normalizeCenter(f);

          var g = o.project(p),
              v = o.project(f).sub(g);
          var x = t.curve;
          var y = Math.max(o.width, o.height),
              b = y / d,
              w = v.mag();

          if ("minZoom" in t) {
            var _i258 = e.clamp(Math.min(t.minZoom, a, l), o.minZoom, o.maxZoom),
                _r257 = y / o.zoomScale(_i258 - a);

            x = Math.sqrt(_r257 / w * 2);
          }

          var T = x * x;

          function E(e) {
            var t = (b * b - y * y + (e ? -1 : 1) * T * T * w * w) / (2 * (e ? b : y) * T * w);
            return Math.log(Math.sqrt(t * t + 1) - t);
          }

          function C(e) {
            return (Math.exp(e) - Math.exp(-e)) / 2;
          }

          function S(e) {
            return (Math.exp(e) + Math.exp(-e)) / 2;
          }

          var I = E(0);

          var P = function (e) {
            return S(I) / S(I + x * e);
          },
              M = function (e) {
            return y * ((S(I) * (C(t = I + x * e) / S(t)) - C(I)) / T) / w;
            var t;
          },
              z = (E(1) - I) / x;

          if (Math.abs(w) < 1e-6 || !isFinite(z)) {
            if (Math.abs(y - b) < 1e-6) return this.easeTo(t, i);

            var _e393 = b < y ? -1 : 1;

            z = Math.abs(Math.log(b / y)) / x, M = function () {
              return 0;
            }, P = function (t) {
              return Math.exp(_e393 * x * t);
            };
          }

          return t.duration = "duration" in t ? +t.duration : 1e3 * z / ("screenSpeed" in t ? +t.screenSpeed / x : +t.speed), t.maxDuration && t.duration > t.maxDuration && (t.duration = 0), this._zooming = !0, this._rotating = r !== c, this._pitching = h !== n, this._padding = !o.isPaddingEqual(u), this._prepareEase(i, !1), this._ease(function (t) {
            var d = t * z,
                p = 1 / P(d);
            o.zoom = 1 === t ? l : a + o.scaleZoom(p), _this124._rotating && (o.bearing = e.number(r, c, t)), _this124._pitching && (o.pitch = e.number(n, h, t)), _this124._padding && (o.interpolatePadding(s, u, t), m = o.centerPoint.add(_));
            var x = 1 === t ? f : o.unproject(g.add(v.mult(M(d))).mult(p));
            o.setLocationAtPoint(o.renderWorldCopies ? x.wrap() : x, m), o._updateCenterElevation(), _this124._fireMoveEvents(i);
          }, function () {
            return _this124._afterEase(i);
          }, t), this;
        }
      }, {
        key: "isEasing",
        value: function isEasing() {
          return !!this._easeFrameId;
        }
      }, {
        key: "stop",
        value: function stop() {
          return this._stop();
        }
      }, {
        key: "_stop",
        value: function _stop(e, t) {
          if (this._easeFrameId && (this._cancelRenderFrame(this._easeFrameId), delete this._easeFrameId, delete this._onEaseFrame), this._onEaseEnd) {
            var _e394 = this._onEaseEnd;
            delete this._onEaseEnd, _e394.call(this, t);
          }

          if (!e) {
            var _e395 = this.handlers;
            _e395 && _e395.stop(!1);
          }

          return this;
        }
      }, {
        key: "_ease",
        value: function _ease(t, i, o) {
          !1 === o.animate || 0 === o.duration ? (t(1), i()) : (this._easeStart = e.browser.now(), this._easeOptions = o, this._onEaseFrame = t, this._onEaseEnd = i, this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback));
        }
      }, {
        key: "_renderFrameCallback",
        value: function _renderFrameCallback() {
          var t = Math.min((e.browser.now() - this._easeStart) / this._easeOptions.duration, 1);
          this._onEaseFrame(this._easeOptions.easing(t)), t < 1 ? this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback) : this.stop();
        }
      }, {
        key: "_normalizeBearing",
        value: function _normalizeBearing(t, i) {
          t = e.wrap(t, -180, 180);
          var o = Math.abs(t - i);
          return Math.abs(t - 360 - i) < o && (t -= 360), Math.abs(t + 360 - i) < o && (t += 360), t;
        }
      }, {
        key: "_normalizeCenter",
        value: function _normalizeCenter(e) {
          var t = this.transform;
          if (!t.renderWorldCopies || t.lngRange) return;
          var i = e.lng - t.center.lng;
          e.lng += i > 180 ? -360 : i < -180 ? 360 : 0;
        }
      }]);

      return jo;
    }(e.Evented);

    var $o = /*#__PURE__*/function () {
      function $o() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

        _classCallCheck(this, $o);

        this.options = t, e.bindAll(["_toggleAttribution", "_updateEditLink", "_updateData", "_updateCompact"], this);
      }

      _createClass($o, [{
        key: "getDefaultPosition",
        value: function getDefaultPosition() {
          return "bottom-right";
        }
      }, {
        key: "onAdd",
        value: function onAdd(e) {
          var t = this.options && this.options.compact;
          return this._map = e, this._container = a.create("div", "mapboxgl-ctrl mapboxgl-ctrl-attrib"), this._compactButton = a.create("button", "mapboxgl-ctrl-attrib-button", this._container), this._compactButton.addEventListener("click", this._toggleAttribution), this._setElementTitle(this._compactButton, "ToggleAttribution"), this._innerContainer = a.create("div", "mapboxgl-ctrl-attrib-inner", this._container), this._innerContainer.setAttribute("role", "list"), t && this._container.classList.add("mapboxgl-compact"), this._updateAttributions(), this._updateEditLink(), this._map.on("styledata", this._updateData), this._map.on("sourcedata", this._updateData), this._map.on("moveend", this._updateEditLink), void 0 === t && (this._map.on("resize", this._updateCompact), this._updateCompact()), this._container;
        }
      }, {
        key: "onRemove",
        value: function onRemove() {
          a.remove(this._container), this._map.off("styledata", this._updateData), this._map.off("sourcedata", this._updateData), this._map.off("moveend", this._updateEditLink), this._map.off("resize", this._updateCompact), this._map = void 0, this._attribHTML = void 0;
        }
      }, {
        key: "_setElementTitle",
        value: function _setElementTitle(e, t) {
          var i = this._map._getUIString("AttributionControl.".concat(t));

          e.title = i, e.setAttribute("aria-label", i);
        }
      }, {
        key: "_toggleAttribution",
        value: function _toggleAttribution() {
          this._container.classList.contains("mapboxgl-compact-show") ? (this._container.classList.remove("mapboxgl-compact-show"), this._compactButton.setAttribute("aria-pressed", "false")) : (this._container.classList.add("mapboxgl-compact-show"), this._compactButton.setAttribute("aria-pressed", "true"));
        }
      }, {
        key: "_updateEditLink",
        value: function _updateEditLink() {
          var t = this._editLink;
          t || (t = this._editLink = this._container.querySelector(".mapbox-improve-map"));
          var i = [{
            key: "owner",
            value: this.styleOwner
          }, {
            key: "id",
            value: this.styleId
          }, {
            key: "access_token",
            value: this._map._requestManager._customAccessToken || e.config.ACCESS_TOKEN
          }];

          if (t) {
            var _o128 = i.reduce(function (e, t, o) {
              return t.value && (e += "".concat(t.key, "=").concat(t.value).concat(o < i.length - 1 ? "&" : "")), e;
            }, "?");

            t.href = "".concat(e.config.FEEDBACK_URL, "/").concat(_o128).concat(this._map._hash ? this._map._hash.getHashString(!0) : ""), t.rel = "noopener nofollow", this._setElementTitle(t, "MapFeedback");
          }
        }
      }, {
        key: "_updateData",
        value: function _updateData(e) {
          !e || "metadata" !== e.sourceDataType && "visibility" !== e.sourceDataType && "style" !== e.dataType || (this._updateAttributions(), this._updateEditLink());
        }
      }, {
        key: "_updateAttributions",
        value: function _updateAttributions() {
          if (!this._map.style) return;
          var e = [];

          if (this.options.customAttribution && (Array.isArray(this.options.customAttribution) ? e = e.concat(this.options.customAttribution.map(function (e) {
            return "string" != typeof e ? "" : e;
          })) : "string" == typeof this.options.customAttribution && e.push(this.options.customAttribution)), this._map.style.stylesheet) {
            var _e396 = this._map.style.stylesheet;
            this.styleOwner = _e396.owner, this.styleId = _e396.id;
          }

          var t = this._map.style._sourceCaches;

          for (var _i259 in t) {
            var _o129 = t[_i259];

            if (_o129.used) {
              var _t366 = _o129.getSource();

              _t366.attribution && e.indexOf(_t366.attribution) < 0 && e.push(_t366.attribution);
            }
          }

          e.sort(function (e, t) {
            return e.length - t.length;
          }), e = e.filter(function (t, i) {
            for (var _o130 = i + 1; _o130 < e.length; _o130++) {
              if (e[_o130].indexOf(t) >= 0) return !1;
            }

            return !0;
          });
          var i = e.join(" | ");
          i !== this._attribHTML && (this._attribHTML = i, e.length ? (this._innerContainer.innerHTML = i, this._container.classList.remove("mapboxgl-attrib-empty")) : this._container.classList.add("mapboxgl-attrib-empty"), this._editLink = null);
        }
      }, {
        key: "_updateCompact",
        value: function _updateCompact() {
          this._map.getCanvasContainer().offsetWidth <= 640 ? this._container.classList.add("mapboxgl-compact") : this._container.classList.remove("mapboxgl-compact", "mapboxgl-compact-show");
        }
      }]);

      return $o;
    }();

    var Xo = /*#__PURE__*/function () {
      function Xo() {
        _classCallCheck(this, Xo);

        e.bindAll(["_updateLogo"], this), e.bindAll(["_updateCompact"], this);
      }

      _createClass(Xo, [{
        key: "onAdd",
        value: function onAdd(e) {
          this._map = e, this._container = a.create("div", "mapboxgl-ctrl");
          var t = a.create("a", "mapboxgl-ctrl-logo");
          return t.target = "_blank", t.rel = "noopener nofollow", t.href = "https://www.mapbox.com/", t.setAttribute("aria-label", this._map._getUIString("LogoControl.Title")), t.setAttribute("rel", "noopener nofollow"), this._container.appendChild(t), this._container.style.display = "none", this._map.on("sourcedata", this._updateLogo), this._updateLogo(), this._map.on("resize", this._updateCompact), this._updateCompact(), this._container;
        }
      }, {
        key: "onRemove",
        value: function onRemove() {
          a.remove(this._container), this._map.off("sourcedata", this._updateLogo), this._map.off("resize", this._updateCompact);
        }
      }, {
        key: "getDefaultPosition",
        value: function getDefaultPosition() {
          return "bottom-left";
        }
      }, {
        key: "_updateLogo",
        value: function _updateLogo(e) {
          e && "metadata" !== e.sourceDataType || (this._container.style.display = this._logoRequired() ? "block" : "none");
        }
      }, {
        key: "_logoRequired",
        value: function _logoRequired() {
          if (!this._map.style) return;
          var e = this._map.style._sourceCaches;
          if (0 === Object.entries(e).length) return !0;

          for (var _t367 in e) {
            var _i260 = e[_t367].getSource();

            if (_i260.hasOwnProperty("mapbox_logo") && !_i260.mapbox_logo) return !1;
          }

          return !0;
        }
      }, {
        key: "_updateCompact",
        value: function _updateCompact() {
          var e = this._container.children;

          if (e.length) {
            var _t368 = e[0];
            this._map.getCanvasContainer().offsetWidth < 250 ? _t368.classList.add("mapboxgl-compact") : _t368.classList.remove("mapboxgl-compact");
          }
        }
      }]);

      return Xo;
    }();

    var Wo = /*#__PURE__*/function () {
      function Wo() {
        _classCallCheck(this, Wo);

        this._queue = [], this._id = 0, this._cleared = !1, this._currentlyRunning = !1;
      }

      _createClass(Wo, [{
        key: "add",
        value: function add(e) {
          var t = ++this._id;
          return this._queue.push({
            callback: e,
            id: t,
            cancelled: !1
          }), t;
        }
      }, {
        key: "remove",
        value: function remove(e) {
          var t = this._currentlyRunning,
              i = t ? this._queue.concat(t) : this._queue;

          for (var _t369 of i) {
            if (_t369.id === e) return void (_t369.cancelled = !0);
          }
        }
      }, {
        key: "run",
        value: function run() {
          var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
          var t = this._currentlyRunning = this._queue;
          this._queue = [];

          for (var _i261 of t) {
            if (!_i261.cancelled && (_i261.callback(e), this._cleared)) break;
          }

          this._cleared = !1, this._currentlyRunning = !1;
        }
      }, {
        key: "clear",
        value: function clear() {
          this._currentlyRunning && (this._cleared = !0), this._queue = [];
        }
      }]);

      return Wo;
    }();

    var Ho = {
      "AttributionControl.ToggleAttribution": "Toggle attribution",
      "AttributionControl.MapFeedback": "Map feedback",
      "FullscreenControl.Enter": "Enter fullscreen",
      "FullscreenControl.Exit": "Exit fullscreen",
      "GeolocateControl.FindMyLocation": "Find my location",
      "GeolocateControl.LocationNotAvailable": "Location not available",
      "LogoControl.Title": "Mapbox logo",
      "NavigationControl.ResetBearing": "Reset bearing to north",
      "NavigationControl.ZoomIn": "Zoom in",
      "NavigationControl.ZoomOut": "Zoom out",
      "ScaleControl.Feet": "ft",
      "ScaleControl.Meters": "m",
      "ScaleControl.Kilometers": "km",
      "ScaleControl.Miles": "mi",
      "ScaleControl.NauticalMiles": "nm"
    },
        {
      HTMLImageElement: Ko,
      HTMLElement: Yo,
      ImageBitmap: Jo
    } = e.window,
        Qo = {
      center: [0, 0],
      zoom: 0,
      bearing: 0,
      pitch: 0,
      minZoom: -2,
      maxZoom: 22,
      minPitch: 0,
      maxPitch: 85,
      interactive: !0,
      scrollZoom: !0,
      boxZoom: !0,
      dragRotate: !0,
      dragPan: !0,
      keyboard: !0,
      doubleClickZoom: !0,
      touchZoomRotate: !0,
      touchPitch: !0,
      bearingSnap: 7,
      clickTolerance: 3,
      pitchWithRotate: !0,
      hash: !1,
      attributionControl: !0,
      failIfMajorPerformanceCaveat: !1,
      preserveDrawingBuffer: !1,
      trackResize: !0,
      optimizeForTerrain: !0,
      renderWorldCopies: !0,
      refreshExpiredTiles: !0,
      maxTileCacheSize: null,
      localIdeographFontFamily: "sans-serif",
      localFontFamily: null,
      transformRequest: null,
      accessToken: null,
      fadeDuration: 300,
      crossSourceCollisions: !0
    };

    function ea(e) {
      e.parentNode && e.parentNode.removeChild(e);
    }

    var ta = {
      showCompass: !0,
      showZoom: !0,
      visualizePitch: !1
    };

    var ia = /*#__PURE__*/function () {
      function ia(t, i) {
        var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;

        _classCallCheck(this, ia);

        this._clickTolerance = 10, this.element = i, this.mouseRotate = new xo({
          clickTolerance: t.dragRotate._mouseRotate._clickTolerance
        }), this.map = t, o && (this.mousePitch = new yo({
          clickTolerance: t.dragRotate._mousePitch._clickTolerance
        })), e.bindAll(["mousedown", "mousemove", "mouseup", "touchstart", "touchmove", "touchend", "reset"], this), a.addEventListener(i, "mousedown", this.mousedown), a.addEventListener(i, "touchstart", this.touchstart, {
          passive: !1
        }), a.addEventListener(i, "touchmove", this.touchmove), a.addEventListener(i, "touchend", this.touchend), a.addEventListener(i, "touchcancel", this.reset);
      }

      _createClass(ia, [{
        key: "down",
        value: function down(e, t) {
          this.mouseRotate.mousedown(e, t), this.mousePitch && this.mousePitch.mousedown(e, t), a.disableDrag();
        }
      }, {
        key: "move",
        value: function move(e, t) {
          var i = this.map,
              o = this.mouseRotate.mousemoveWindow(e, t);

          if (o && o.bearingDelta && i.setBearing(i.getBearing() + o.bearingDelta), this.mousePitch) {
            var _o131 = this.mousePitch.mousemoveWindow(e, t);

            _o131 && _o131.pitchDelta && i.setPitch(i.getPitch() + _o131.pitchDelta);
          }
        }
      }, {
        key: "off",
        value: function off() {
          var e = this.element;
          a.removeEventListener(e, "mousedown", this.mousedown), a.removeEventListener(e, "touchstart", this.touchstart, {
            passive: !1
          }), a.removeEventListener(e, "touchmove", this.touchmove), a.removeEventListener(e, "touchend", this.touchend), a.removeEventListener(e, "touchcancel", this.reset), this.offTemp();
        }
      }, {
        key: "offTemp",
        value: function offTemp() {
          a.enableDrag(), a.removeEventListener(e.window, "mousemove", this.mousemove), a.removeEventListener(e.window, "mouseup", this.mouseup);
        }
      }, {
        key: "mousedown",
        value: function mousedown(t) {
          this.down(e.extend({}, t, {
            ctrlKey: !0,
            preventDefault: function () {
              return t.preventDefault();
            }
          }), a.mousePos(this.element, t)), a.addEventListener(e.window, "mousemove", this.mousemove), a.addEventListener(e.window, "mouseup", this.mouseup);
        }
      }, {
        key: "mousemove",
        value: function mousemove(e) {
          this.move(e, a.mousePos(this.element, e));
        }
      }, {
        key: "mouseup",
        value: function mouseup(e) {
          this.mouseRotate.mouseupWindow(e), this.mousePitch && this.mousePitch.mouseupWindow(e), this.offTemp();
        }
      }, {
        key: "touchstart",
        value: function touchstart(e) {
          1 !== e.targetTouches.length ? this.reset() : (this._startPos = this._lastPos = a.touchPos(this.element, e.targetTouches)[0], this.down({
            type: "mousedown",
            button: 0,
            ctrlKey: !0,
            preventDefault: function () {
              return e.preventDefault();
            }
          }, this._startPos));
        }
      }, {
        key: "touchmove",
        value: function touchmove(e) {
          1 !== e.targetTouches.length ? this.reset() : (this._lastPos = a.touchPos(this.element, e.targetTouches)[0], this.move({
            preventDefault: function () {
              return e.preventDefault();
            }
          }, this._lastPos));
        }
      }, {
        key: "touchend",
        value: function touchend(e) {
          0 === e.targetTouches.length && this._startPos && this._lastPos && this._startPos.dist(this._lastPos) < this._clickTolerance && this.element.click(), this.reset();
        }
      }, {
        key: "reset",
        value: function reset() {
          this.mouseRotate.reset(), this.mousePitch && this.mousePitch.reset(), delete this._startPos, delete this._lastPos, this.offTemp();
        }
      }]);

      return ia;
    }();

    function oa(t, i, o) {
      if (t = new e.LngLat(t.lng, t.lat), i) {
        var _a155 = new e.LngLat(t.lng - 360, t.lat),
            _r258 = new e.LngLat(t.lng + 360, t.lat),
            _n161 = 360 * Math.ceil(Math.abs(t.lng - o.center.lng) / 360),
            _s125 = o.locationPoint(t).distSqr(i),
            _l57 = i.x < 0 || i.y < 0 || i.x > o.width || i.y > o.height;

        o.locationPoint(_a155).distSqr(i) < _s125 && (_l57 || Math.abs(_a155.lng - o.center.lng) < _n161) ? t = _a155 : o.locationPoint(_r258).distSqr(i) < _s125 && (_l57 || Math.abs(_r258.lng - o.center.lng) < _n161) && (t = _r258);
      }

      for (; Math.abs(t.lng - o.center.lng) > 180;) {
        var _e397 = o.locationPoint(t);

        if (_e397.x >= 0 && _e397.y >= 0 && _e397.x <= o.width && _e397.y <= o.height) break;
        t.lng > o.center.lng ? t.lng -= 360 : t.lng += 360;
      }

      return t;
    }

    var aa = {
      center: "translate(-50%,-50%)",
      top: "translate(-50%,0)",
      "top-left": "translate(0,0)",
      "top-right": "translate(-100%,0)",
      bottom: "translate(-50%,-100%)",
      "bottom-left": "translate(0,-100%)",
      "bottom-right": "translate(-100%,-100%)",
      left: "translate(0,-50%)",
      right: "translate(-100%,-50%)"
    };

    function ra(e, t, i) {
      var o = e.classList;

      for (var _e398 in aa) {
        o.remove("mapboxgl-".concat(i, "-anchor-").concat(_e398));
      }

      o.add("mapboxgl-".concat(i, "-anchor-").concat(t));
    }

    var na = /*#__PURE__*/function (_e$Evented10) {
      _inherits(na, _e$Evented10);

      var _super127 = _createSuper(na);

      function na(t, i) {
        var _this125;

        _classCallCheck(this, na);

        if (_this125 = _super127.call(this), (t instanceof e.window.HTMLElement || i) && (t = e.extend({
          element: t
        }, i)), e.bindAll(["_update", "_onMove", "_onUp", "_addDragHandler", "_onMapClick", "_onKeyPress"], _assertThisInitialized(_this125)), _this125._anchor = t && t.anchor || "center", _this125._color = t && t.color || "#3FB1CE", _this125._scale = t && t.scale || 1, _this125._draggable = t && t.draggable || !1, _this125._clickTolerance = t && t.clickTolerance || 0, _this125._isDragging = !1, _this125._state = "inactive", _this125._rotation = t && t.rotation || 0, _this125._rotationAlignment = t && t.rotationAlignment || "auto", _this125._pitchAlignment = t && t.pitchAlignment && "auto" !== t.pitchAlignment ? t.pitchAlignment : _this125._rotationAlignment, t && t.element) _this125._element = t.element, _this125._offset = e.Point.convert(t && t.offset || [0, 0]);else {
          _this125._defaultMarker = !0, _this125._element = a.create("div"), _this125._element.setAttribute("aria-label", "Map marker");

          var _i262 = a.createNS("http://www.w3.org/2000/svg", "svg"),
              _o132 = 41,
              _r259 = 27;

          _i262.setAttributeNS(null, "display", "block"), _i262.setAttributeNS(null, "height", "".concat(_o132, "px")), _i262.setAttributeNS(null, "width", "".concat(_r259, "px")), _i262.setAttributeNS(null, "viewBox", "0 0 ".concat(_r259, " ").concat(_o132));

          var _n162 = a.createNS("http://www.w3.org/2000/svg", "g");

          _n162.setAttributeNS(null, "stroke", "none"), _n162.setAttributeNS(null, "stroke-width", "1"), _n162.setAttributeNS(null, "fill", "none"), _n162.setAttributeNS(null, "fill-rule", "evenodd");

          var _s126 = a.createNS("http://www.w3.org/2000/svg", "g");

          _s126.setAttributeNS(null, "fill-rule", "nonzero");

          var _l58 = a.createNS("http://www.w3.org/2000/svg", "g");

          _l58.setAttributeNS(null, "transform", "translate(3.0, 29.0)"), _l58.setAttributeNS(null, "fill", "#000000");
          var _c44 = [{
            rx: "10.5",
            ry: "5.25002273"
          }, {
            rx: "10.5",
            ry: "5.25002273"
          }, {
            rx: "9.5",
            ry: "4.77275007"
          }, {
            rx: "8.5",
            ry: "4.29549936"
          }, {
            rx: "7.5",
            ry: "3.81822308"
          }, {
            rx: "6.5",
            ry: "3.34094679"
          }, {
            rx: "5.5",
            ry: "2.86367051"
          }, {
            rx: "4.5",
            ry: "2.38636864"
          }];

          for (var _e399 of _c44) {
            var _t370 = a.createNS("http://www.w3.org/2000/svg", "ellipse");

            _t370.setAttributeNS(null, "opacity", "0.04"), _t370.setAttributeNS(null, "cx", "10.5"), _t370.setAttributeNS(null, "cy", "5.80029008"), _t370.setAttributeNS(null, "rx", _e399.rx), _t370.setAttributeNS(null, "ry", _e399.ry), _l58.appendChild(_t370);
          }

          var _h33 = a.createNS("http://www.w3.org/2000/svg", "g");

          _h33.setAttributeNS(null, "fill", _this125._color);

          var _u45 = a.createNS("http://www.w3.org/2000/svg", "path");

          _u45.setAttributeNS(null, "d", "M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"), _h33.appendChild(_u45);

          var _d21 = a.createNS("http://www.w3.org/2000/svg", "g");

          _d21.setAttributeNS(null, "opacity", "0.25"), _d21.setAttributeNS(null, "fill", "#000000");

          var _16 = a.createNS("http://www.w3.org/2000/svg", "path");

          _16.setAttributeNS(null, "d", "M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"), _d21.appendChild(_16);

          var _m22 = a.createNS("http://www.w3.org/2000/svg", "g");

          _m22.setAttributeNS(null, "transform", "translate(6.0, 7.0)"), _m22.setAttributeNS(null, "fill", "#FFFFFF");

          var _p25 = a.createNS("http://www.w3.org/2000/svg", "g");

          _p25.setAttributeNS(null, "transform", "translate(8.0, 8.0)");

          var _f17 = a.createNS("http://www.w3.org/2000/svg", "circle");

          _f17.setAttributeNS(null, "fill", "#000000"), _f17.setAttributeNS(null, "opacity", "0.25"), _f17.setAttributeNS(null, "cx", "5.5"), _f17.setAttributeNS(null, "cy", "5.5"), _f17.setAttributeNS(null, "r", "5.4999962");

          var _g20 = a.createNS("http://www.w3.org/2000/svg", "circle");

          _g20.setAttributeNS(null, "fill", "#FFFFFF"), _g20.setAttributeNS(null, "cx", "5.5"), _g20.setAttributeNS(null, "cy", "5.5"), _g20.setAttributeNS(null, "r", "5.4999962"), _p25.appendChild(_f17), _p25.appendChild(_g20), _s126.appendChild(_l58), _s126.appendChild(_h33), _s126.appendChild(_d21), _s126.appendChild(_m22), _s126.appendChild(_p25), _i262.appendChild(_s126), _i262.setAttributeNS(null, "height", "".concat(_o132 * _this125._scale, "px")), _i262.setAttributeNS(null, "width", "".concat(_r259 * _this125._scale, "px")), _this125._element.appendChild(_i262), _this125._offset = e.Point.convert(t && t.offset || [0, -14]);
        }
        _this125._element.classList.add("mapboxgl-marker"), _this125._element.addEventListener("dragstart", function (e) {
          e.preventDefault();
        }), _this125._element.addEventListener("mousedown", function (e) {
          e.preventDefault();
        }), ra(_this125._element, _this125._anchor, "marker"), _this125._popup = null;
        return _possibleConstructorReturn(_this125);
      }

      _createClass(na, [{
        key: "addTo",
        value: function addTo(e) {
          return this.remove(), this._map = e, e.getCanvasContainer().appendChild(this._element), e.on("move", this._update), e.on("moveend", this._update), this.setDraggable(this._draggable), this._update(), this._map.on("click", this._onMapClick), this;
        }
      }, {
        key: "remove",
        value: function remove() {
          return this._map && (this._map.off("click", this._onMapClick), this._map.off("move", this._update), this._map.off("moveend", this._update), this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler), this._map.off("mouseup", this._onUp), this._map.off("touchend", this._onUp), this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), delete this._map), a.remove(this._element), this._popup && this._popup.remove(), this;
        }
      }, {
        key: "getLngLat",
        value: function getLngLat() {
          return this._lngLat;
        }
      }, {
        key: "setLngLat",
        value: function setLngLat(t) {
          return this._lngLat = e.LngLat.convert(t), this._pos = null, this._popup && this._popup.setLngLat(this._lngLat), this._update(), this;
        }
      }, {
        key: "getElement",
        value: function getElement() {
          return this._element;
        }
      }, {
        key: "setPopup",
        value: function setPopup(e) {
          if (this._popup && (this._popup.remove(), this._popup = null, this._element.removeEventListener("keypress", this._onKeyPress), this._originalTabIndex || this._element.removeAttribute("tabindex")), e) {
            if (!("offset" in e.options)) {
              var _t371 = 38.1,
                  _i263 = 13.5,
                  _o133 = Math.sqrt(Math.pow(_i263, 2) / 2);

              e.options.offset = this._defaultMarker ? {
                top: [0, 0],
                "top-left": [0, 0],
                "top-right": [0, 0],
                bottom: [0, -_t371],
                "bottom-left": [_o133, -1 * (_t371 - _i263 + _o133)],
                "bottom-right": [-_o133, -1 * (_t371 - _i263 + _o133)],
                left: [_i263, -1 * (_t371 - _i263)],
                right: [-_i263, -1 * (_t371 - _i263)]
              } : this._offset;
            }

            this._popup = e, this._lngLat && this._popup.setLngLat(this._lngLat), this._originalTabIndex = this._element.getAttribute("tabindex"), this._originalTabIndex || this._element.setAttribute("tabindex", "0"), this._element.addEventListener("keypress", this._onKeyPress);
          }

          return this;
        }
      }, {
        key: "_onKeyPress",
        value: function _onKeyPress(e) {
          var t = e.code,
              i = e.charCode || e.keyCode;
          "Space" !== t && "Enter" !== t && 32 !== i && 13 !== i || this.togglePopup();
        }
      }, {
        key: "_onMapClick",
        value: function _onMapClick(e) {
          var t = e.originalEvent.target,
              i = this._element;
          this._popup && (t === i || i.contains(t)) && this.togglePopup();
        }
      }, {
        key: "getPopup",
        value: function getPopup() {
          return this._popup;
        }
      }, {
        key: "togglePopup",
        value: function togglePopup() {
          var e = this._popup;
          return e ? (e.isOpen() ? e.remove() : e.addTo(this._map), this) : this;
        }
      }, {
        key: "_updateOcclusion",
        value: function _updateOcclusion() {
          this._occlusionTimer || (this._occlusionTimer = setTimeout(this._onOcclusionTimer.bind(this), 60));
        }
      }, {
        key: "_onOcclusionTimer",
        value: function _onOcclusionTimer() {
          var e = this._map.transform,
              t = this._pos ? this._pos.sub(this._transformedOffset()) : null;

          if (t && t.x >= 0 && t.x < e.width && t.y >= 0 && t.y < e.height) {
            var _e400 = this._map.unproject(t),
                _i264 = this._map.getFreeCameraOptions();

            if (_i264.position) {
              var _t372 = _i264.position.toLngLat(),
                  _o134 = _t372.distanceTo(_e400),
                  _a156 = _t372.distanceTo(this._lngLat);

              this._element.classList.toggle("mapboxgl-marker-occluded", _o134 < .9 * _a156);
            }
          }

          this._occlusionTimer = null;
        }
      }, {
        key: "_update",
        value: function _update(e) {
          if (!this._map) return;
          this._map.transform.renderWorldCopies && (this._lngLat = oa(this._lngLat, this._pos, this._map.transform)), this._pos = this._map.project(this._lngLat)._add(this._transformedOffset()), this._map.transform.elevation && this._updateOcclusion();
          var t = "";
          "viewport" === this._rotationAlignment || "auto" === this._rotationAlignment ? t = "rotateZ(".concat(this._rotation, "deg)") : "map" === this._rotationAlignment && (t = "rotateZ(".concat(this._rotation - this._map.getBearing(), "deg)"));
          var i = "";
          "viewport" === this._pitchAlignment || "auto" === this._pitchAlignment ? i = "rotateX(0deg)" : "map" === this._pitchAlignment && (i = "rotateX(".concat(this._map.getPitch(), "deg)")), e && "moveend" !== e.type || (this._pos = this._pos.round()), a.setTransform(this._element, "".concat(aa[this._anchor], " translate(").concat(this._pos.x, "px, ").concat(this._pos.y, "px) ").concat(i, " ").concat(t));
        }
      }, {
        key: "_transformedOffset",
        value: function _transformedOffset() {
          if (!this._defaultMarker) return this._offset;

          var e = this._map.transform,
              t = this._offset.mult(this._scale);

          return "map" === this._rotationAlignment && t._rotate(e.angle), "map" === this._pitchAlignment && (t.y *= Math.cos(e._pitch)), t;
        }
      }, {
        key: "getOffset",
        value: function getOffset() {
          return this._offset;
        }
      }, {
        key: "setOffset",
        value: function setOffset(t) {
          return this._offset = e.Point.convert(t), this._update(), this;
        }
      }, {
        key: "_onMove",
        value: function _onMove(t) {
          if (!this._isDragging) {
            var _e401 = this._clickTolerance || this._map._clickTolerance;

            this._isDragging = t.point.dist(this._pointerdownPos) >= _e401;
          }

          this._isDragging && (this._pos = t.point.sub(this._positionDelta), this._lngLat = this._map.unproject(this._pos), this.setLngLat(this._lngLat), this._element.style.pointerEvents = "none", "pending" === this._state && (this._state = "active", this.fire(new e.Event("dragstart"))), this.fire(new e.Event("drag")));
        }
      }, {
        key: "_onUp",
        value: function _onUp() {
          this._element.style.pointerEvents = "auto", this._positionDelta = null, this._pointerdownPos = null, this._isDragging = !1, this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), "active" === this._state && this.fire(new e.Event("dragend")), this._state = "inactive";
        }
      }, {
        key: "_addDragHandler",
        value: function _addDragHandler(e) {
          this._element.contains(e.originalEvent.target) && (e.preventDefault(), this._positionDelta = e.point.sub(this._pos).add(this._transformedOffset()), this._pointerdownPos = e.point, this._state = "pending", this._map.on("mousemove", this._onMove), this._map.on("touchmove", this._onMove), this._map.once("mouseup", this._onUp), this._map.once("touchend", this._onUp));
        }
      }, {
        key: "setDraggable",
        value: function setDraggable(e) {
          return this._draggable = !!e, this._map && (e ? (this._map.on("mousedown", this._addDragHandler), this._map.on("touchstart", this._addDragHandler)) : (this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler))), this;
        }
      }, {
        key: "isDraggable",
        value: function isDraggable() {
          return this._draggable;
        }
      }, {
        key: "setRotation",
        value: function setRotation(e) {
          return this._rotation = e || 0, this._update(), this;
        }
      }, {
        key: "getRotation",
        value: function getRotation() {
          return this._rotation;
        }
      }, {
        key: "setRotationAlignment",
        value: function setRotationAlignment(e) {
          return this._rotationAlignment = e || "auto", this._update(), this;
        }
      }, {
        key: "getRotationAlignment",
        value: function getRotationAlignment() {
          return this._rotationAlignment;
        }
      }, {
        key: "setPitchAlignment",
        value: function setPitchAlignment(e) {
          return this._pitchAlignment = e && "auto" !== e ? e : this._rotationAlignment, this._update(), this;
        }
      }, {
        key: "getPitchAlignment",
        value: function getPitchAlignment() {
          return this._pitchAlignment;
        }
      }]);

      return na;
    }(e.Evented);

    var sa = {
      positionOptions: {
        enableHighAccuracy: !1,
        maximumAge: 0,
        timeout: 6e3
      },
      fitBoundsOptions: {
        maxZoom: 15
      },
      trackUserLocation: !1,
      showAccuracyCircle: !0,
      showUserLocation: !0
    };
    var la,
        ca = 0,
        ha = !1;
    var ua = {
      maxWidth: 100,
      unit: "metric"
    };

    function da(e, t, i) {
      var o = i && i.maxWidth || 100,
          a = e._container.clientHeight / 2,
          r = e.unproject([0, a]),
          n = e.unproject([o, a]),
          s = r.distanceTo(n);

      if (i && "imperial" === i.unit) {
        var _i265 = 3.2808 * s;

        _i265 > 5280 ? _a(t, o, _i265 / 5280, e._getUIString("ScaleControl.Miles")) : _a(t, o, _i265, e._getUIString("ScaleControl.Feet"));
      } else i && "nautical" === i.unit ? _a(t, o, s / 1852, e._getUIString("ScaleControl.NauticalMiles")) : s >= 1e3 ? _a(t, o, s / 1e3, e._getUIString("ScaleControl.Kilometers")) : _a(t, o, s, e._getUIString("ScaleControl.Meters"));
    }

    function _a(e, t, i, o) {
      var a = function (e) {
        var t = Math.pow(10, "".concat(Math.floor(e)).length - 1);
        var i = e / t;
        return i = i >= 10 ? 10 : i >= 5 ? 5 : i >= 3 ? 3 : i >= 2 ? 2 : i >= 1 ? 1 : function (e) {
          var t = Math.pow(10, Math.ceil(-Math.log(e) / Math.LN10));
          return Math.round(e * t) / t;
        }(i), t * i;
      }(i);

      e.style.width = "".concat(t * (a / i), "px"), e.innerHTML = "".concat(a, "&nbsp;").concat(o);
    }

    var ma = {
      closeButton: !0,
      closeOnClick: !0,
      focusAfterOpen: !0,
      className: "",
      maxWidth: "240px"
    },
        pa = ["a[href]", "[tabindex]:not([tabindex='-1'])", "[contenteditable]:not([contenteditable='false'])", "button:not([disabled])", "input:not([disabled])", "select:not([disabled])", "textarea:not([disabled])"].join(", "),
        fa = {
      version: e.version,
      supported: t,
      setRTLTextPlugin: e.setRTLTextPlugin,
      getRTLTextPluginStatus: e.getRTLTextPluginStatus,
      Map: /*#__PURE__*/function (_jo) {
        _inherits(Map, _jo);

        var _super128 = _createSuper(Map);

        function Map(t) {
          var _this126;

          _classCallCheck(this, Map);

          if (null != (t = e.extend({}, Qo, t)).minZoom && null != t.maxZoom && t.minZoom > t.maxZoom) throw new Error("maxZoom must be greater than or equal to minZoom");
          if (null != t.minPitch && null != t.maxPitch && t.minPitch > t.maxPitch) throw new Error("maxPitch must be greater than or equal to minPitch");
          if (null != t.minPitch && t.minPitch < 0) throw new Error("minPitch must be greater than or equal to 0");
          if (null != t.maxPitch && t.maxPitch > 85) throw new Error("maxPitch must be less than or equal to 85");

          if (_this126 = _super128.call(this, new Hi(t.minZoom, t.maxZoom, t.minPitch, t.maxPitch, t.renderWorldCopies), t), _this126._interactive = t.interactive, _this126._maxTileCacheSize = t.maxTileCacheSize, _this126._failIfMajorPerformanceCaveat = t.failIfMajorPerformanceCaveat, _this126._preserveDrawingBuffer = t.preserveDrawingBuffer, _this126._antialias = t.antialias, _this126._trackResize = t.trackResize, _this126._bearingSnap = t.bearingSnap, _this126._refreshExpiredTiles = t.refreshExpiredTiles, _this126._fadeDuration = t.fadeDuration, _this126._isInitialLoad = !0, _this126._crossSourceCollisions = t.crossSourceCollisions, _this126._crossFadingFactor = 1, _this126._collectResourceTiming = t.collectResourceTiming, _this126._optimizeForTerrain = t.optimizeForTerrain, _this126._renderTaskQueue = new Wo(), _this126._controls = [], _this126._mapId = e.uniqueId(), _this126._locale = e.extend({}, Ho, t.locale), _this126._clickTolerance = t.clickTolerance, _this126._requestManager = new e.RequestManager(t.transformRequest, t.accessToken), "string" == typeof t.container) {
            if (_this126._container = e.window.document.getElementById(t.container), !_this126._container) throw new Error("Container '".concat(t.container, "' not found."));
          } else {
            if (!(t.container instanceof Yo)) throw new Error("Invalid type: 'container' must be a String or HTMLElement.");
            _this126._container = t.container;
          }

          if (t.maxBounds && _this126.setMaxBounds(t.maxBounds), e.bindAll(["_onWindowOnline", "_onWindowResize", "_onMapScroll", "_contextLost", "_contextRestored"], _assertThisInitialized(_this126)), _this126._setupContainer(), _this126._setupPainter(), void 0 === _this126.painter) throw new Error("Failed to initialize WebGL.");
          _this126.on("move", function () {
            return _this126._update(!1);
          }), _this126.on("moveend", function () {
            return _this126._update(!1);
          }), _this126.on("zoom", function () {
            return _this126._update(!0);
          }), void 0 !== e.window && (e.window.addEventListener("online", _this126._onWindowOnline, !1), e.window.addEventListener("resize", _this126._onWindowResize, !1), e.window.addEventListener("orientationchange", _this126._onWindowResize, !1)), _this126.handlers = new qo(_assertThisInitialized(_this126), t), _this126._hash = t.hash && new Ki("string" == typeof t.hash && t.hash || void 0).addTo(_assertThisInitialized(_this126)), _this126._hash && _this126._hash._onHashChange() || (_this126.jumpTo({
            center: t.center,
            zoom: t.zoom,
            bearing: t.bearing,
            pitch: t.pitch
          }), t.bounds && (_this126.resize(), _this126.fitBounds(t.bounds, e.extend({}, t.fitBoundsOptions, {
            duration: 0
          })))), _this126.resize(), _this126._localFontFamily = t.localFontFamily, _this126._localIdeographFontFamily = t.localIdeographFontFamily, t.style && _this126.setStyle(t.style, {
            localFontFamily: _this126._localFontFamily,
            localIdeographFontFamily: _this126._localIdeographFontFamily
          }), t.attributionControl && _this126.addControl(new $o({
            customAttribution: t.customAttribution
          })), _this126._logoControl = new Xo(), _this126.addControl(_this126._logoControl, t.logoPosition), _this126.on("style.load", function () {
            _this126.transform.unmodified && _this126.jumpTo(_this126.style.stylesheet);
          }), _this126.on("data", function (t) {
            _this126._update("style" === t.dataType), _this126.fire(new e.Event("".concat(t.dataType, "data"), t));
          }), _this126.on("dataloading", function (t) {
            _this126.fire(new e.Event("".concat(t.dataType, "dataloading"), t));
          });
          return _possibleConstructorReturn(_this126);
        }

        _createClass(Map, [{
          key: "_getMapId",
          value: function _getMapId() {
            return this._mapId;
          }
        }, {
          key: "addControl",
          value: function addControl(t, i) {
            if (void 0 === i && (i = t.getDefaultPosition ? t.getDefaultPosition() : "top-right"), !t || !t.onAdd) return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));
            var o = t.onAdd(this);

            this._controls.push(t);

            var a = this._controlPositions[i];
            return -1 !== i.indexOf("bottom") ? a.insertBefore(o, a.firstChild) : a.appendChild(o), this;
          }
        }, {
          key: "removeControl",
          value: function removeControl(t) {
            if (!t || !t.onRemove) return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));

            var i = this._controls.indexOf(t);

            return i > -1 && this._controls.splice(i, 1), t.onRemove(this), this;
          }
        }, {
          key: "hasControl",
          value: function hasControl(e) {
            return this._controls.indexOf(e) > -1;
          }
        }, {
          key: "resize",
          value: function resize(t) {
            var i = this._containerDimensions(),
                o = i[0],
                a = i[1];

            this._resizeCanvas(o, a), this.transform.resize(o, a), this.painter.resize(o, a);
            var r = !this._moving;
            return r && (this.stop(), this.fire(new e.Event("movestart", t)).fire(new e.Event("move", t))), this.fire(new e.Event("resize", t)), r && this.fire(new e.Event("moveend", t)), this;
          }
        }, {
          key: "getBounds",
          value: function getBounds() {
            return this.transform.getBounds();
          }
        }, {
          key: "getMaxBounds",
          value: function getMaxBounds() {
            return this.transform.getMaxBounds();
          }
        }, {
          key: "setMaxBounds",
          value: function setMaxBounds(t) {
            return this.transform.setMaxBounds(e.LngLatBounds.convert(t)), this._update();
          }
        }, {
          key: "setMinZoom",
          value: function setMinZoom(e) {
            if ((e = null == e ? -2 : e) >= -2 && e <= this.transform.maxZoom) return this.transform.minZoom = e, this._update(), this.getZoom() < e && this.setZoom(e), this;
            throw new Error("minZoom must be between -2 and the current maxZoom, inclusive");
          }
        }, {
          key: "getMinZoom",
          value: function getMinZoom() {
            return this.transform.minZoom;
          }
        }, {
          key: "setMaxZoom",
          value: function setMaxZoom(e) {
            if ((e = null == e ? 22 : e) >= this.transform.minZoom) return this.transform.maxZoom = e, this._update(), this.getZoom() > e && this.setZoom(e), this;
            throw new Error("maxZoom must be greater than the current minZoom");
          }
        }, {
          key: "getMaxZoom",
          value: function getMaxZoom() {
            return this.transform.maxZoom;
          }
        }, {
          key: "setMinPitch",
          value: function setMinPitch(e) {
            if ((e = null == e ? 0 : e) < 0) throw new Error("minPitch must be greater than or equal to 0");
            if (e >= 0 && e <= this.transform.maxPitch) return this.transform.minPitch = e, this._update(), this.getPitch() < e && this.setPitch(e), this;
            throw new Error("minPitch must be between 0 and the current maxPitch, inclusive");
          }
        }, {
          key: "getMinPitch",
          value: function getMinPitch() {
            return this.transform.minPitch;
          }
        }, {
          key: "setMaxPitch",
          value: function setMaxPitch(e) {
            if ((e = null == e ? 85 : e) > 85) throw new Error("maxPitch must be less than or equal to 85");
            if (e >= this.transform.minPitch) return this.transform.maxPitch = e, this._update(), this.getPitch() > e && this.setPitch(e), this;
            throw new Error("maxPitch must be greater than the current minPitch");
          }
        }, {
          key: "getMaxPitch",
          value: function getMaxPitch() {
            return this.transform.maxPitch;
          }
        }, {
          key: "getRenderWorldCopies",
          value: function getRenderWorldCopies() {
            return this.transform.renderWorldCopies;
          }
        }, {
          key: "setRenderWorldCopies",
          value: function setRenderWorldCopies(e) {
            return this.transform.renderWorldCopies = e, this._update();
          }
        }, {
          key: "project",
          value: function project(t) {
            return this.transform.locationPoint3D(e.LngLat.convert(t));
          }
        }, {
          key: "unproject",
          value: function unproject(t) {
            return this.transform.pointLocation3D(e.Point.convert(t));
          }
        }, {
          key: "isMoving",
          value: function isMoving() {
            return this._moving || this.handlers && this.handlers.isMoving();
          }
        }, {
          key: "isZooming",
          value: function isZooming() {
            return this._zooming || this.handlers && this.handlers.isZooming();
          }
        }, {
          key: "isRotating",
          value: function isRotating() {
            return this._rotating || this.handlers && this.handlers.isRotating();
          }
        }, {
          key: "_createDelegatedListener",
          value: function _createDelegatedListener(e, t, i) {
            var _this127 = this;

            if ("mouseenter" === e || "mouseover" === e) {
              var _o135 = !1;

              var _a157 = function (a) {
                var r = _this127.getLayer(t) ? _this127.queryRenderedFeatures(a.point, {
                  layers: [t]
                }) : [];
                r.length ? _o135 || (_o135 = !0, i.call(_this127, new ro(e, _this127, a.originalEvent, {
                  features: r
                }))) : _o135 = !1;
              };

              return {
                layer: t,
                listener: i,
                delegates: {
                  mousemove: _a157,
                  mouseout: function () {
                    _o135 = !1;
                  }
                }
              };
            }

            if ("mouseleave" === e || "mouseout" === e) {
              var _o136 = !1;

              var _a158 = function (a) {
                (_this127.getLayer(t) ? _this127.queryRenderedFeatures(a.point, {
                  layers: [t]
                }) : []).length ? _o136 = !0 : _o136 && (_o136 = !1, i.call(_this127, new ro(e, _this127, a.originalEvent)));
              },
                  _r260 = function (t) {
                _o136 && (_o136 = !1, i.call(_this127, new ro(e, _this127, t.originalEvent)));
              };

              return {
                layer: t,
                listener: i,
                delegates: {
                  mousemove: _a158,
                  mouseout: _r260
                }
              };
            }

            {
              var _o137 = function (e) {
                var o = _this127.getLayer(t) ? _this127.queryRenderedFeatures(e.point, {
                  layers: [t]
                }) : [];
                o.length && (e.features = o, i.call(_this127, e), delete e.features);
              };

              return {
                layer: t,
                listener: i,
                delegates: _defineProperty({}, e, _o137)
              };
            }
          }
        }, {
          key: "on",
          value: function on(e, t, i) {
            if (void 0 === i) return _get(_getPrototypeOf(Map.prototype), "on", this).call(this, e, t);

            var o = this._createDelegatedListener(e, t, i);

            this._delegatedListeners = this._delegatedListeners || {}, this._delegatedListeners[e] = this._delegatedListeners[e] || [], this._delegatedListeners[e].push(o);

            for (var _e402 in o.delegates) {
              this.on(_e402, o.delegates[_e402]);
            }

            return this;
          }
        }, {
          key: "once",
          value: function once(e, t, i) {
            if (void 0 === i) return _get(_getPrototypeOf(Map.prototype), "once", this).call(this, e, t);

            var o = this._createDelegatedListener(e, t, i);

            for (var _e403 in o.delegates) {
              this.once(_e403, o.delegates[_e403]);
            }

            return this;
          }
        }, {
          key: "off",
          value: function off(e, t, i) {
            var _this128 = this;

            return void 0 === i ? _get(_getPrototypeOf(Map.prototype), "off", this).call(this, e, t) : (this._delegatedListeners && this._delegatedListeners[e] && function (o) {
              var a = _this128._delegatedListeners[e];

              for (var _e404 = 0; _e404 < a.length; _e404++) {
                var _o138 = a[_e404];

                if (_o138.layer === t && _o138.listener === i) {
                  for (var _e405 in _o138.delegates) {
                    _this128.off(_e405, _o138.delegates[_e405]);
                  }

                  return a.splice(_e404, 1), _this128;
                }
              }
            }(), this);
          }
        }, {
          key: "queryRenderedFeatures",
          value: function queryRenderedFeatures(t, i) {
            return this.style ? (void 0 !== i || void 0 === t || t instanceof e.Point || Array.isArray(t) || (i = t, t = void 0), this.style.queryRenderedFeatures(t = t || [[0, 0], [this.transform.width, this.transform.height]], i = i || {}, this.transform)) : [];
          }
        }, {
          key: "querySourceFeatures",
          value: function querySourceFeatures(e, t) {
            return this.style.querySourceFeatures(e, t);
          }
        }, {
          key: "setStyle",
          value: function setStyle(t, i) {
            return !1 !== (i = e.extend({}, {
              localIdeographFontFamily: this._localIdeographFontFamily,
              localFontFamily: this._localFontFamily
            }, i)).diff && i.localIdeographFontFamily === this._localIdeographFontFamily && i.localFontFamily === this._localFontFamily && this.style && t ? (this._diffStyle(t, i), this) : (this._localIdeographFontFamily = i.localIdeographFontFamily, this._localFontFamily = i.localFontFamily, this._updateStyle(t, i));
          }
        }, {
          key: "_getUIString",
          value: function _getUIString(e) {
            var t = this._locale[e];
            if (null == t) throw new Error("Missing UI string '".concat(e, "'"));
            return t;
          }
        }, {
          key: "_updateStyle",
          value: function _updateStyle(e, t) {
            return this.style && (this.style.setEventedParent(null), this.style._remove(), delete this.style), e && (this.style = new Ze(this, t || {}), this.style.setEventedParent(this, {
              style: this.style
            }), "string" == typeof e ? this.style.loadURL(e) : this.style.loadJSON(e)), this._updateTerrain(), this;
          }
        }, {
          key: "_lazyInitEmptyStyle",
          value: function _lazyInitEmptyStyle() {
            this.style || (this.style = new Ze(this, {}), this.style.setEventedParent(this, {
              style: this.style
            }), this.style.loadEmpty());
          }
        }, {
          key: "_diffStyle",
          value: function _diffStyle(t, i) {
            var _this129 = this;

            if ("string" == typeof t) {
              var _o139 = this._requestManager.normalizeStyleURL(t),
                  _a159 = this._requestManager.transformRequest(_o139, e.ResourceType.Style);

              e.getJSON(_a159, function (t, o) {
                t ? _this129.fire(new e.ErrorEvent(t)) : o && _this129._updateDiff(o, i);
              });
            } else "object" == _typeof(t) && this._updateDiff(t, i);
          }
        }, {
          key: "_updateDiff",
          value: function _updateDiff(t, i) {
            try {
              this.style.setState(t) && this._update(!0);
            } catch (o) {
              e.warnOnce("Unable to perform style diff: ".concat(o.message || o.error || o, ".  Rebuilding the style from scratch.")), this._updateStyle(t, i);
            }
          }
        }, {
          key: "getStyle",
          value: function getStyle() {
            if (this.style) return this.style.serialize();
          }
        }, {
          key: "isStyleLoaded",
          value: function isStyleLoaded() {
            return this.style ? this.style.loaded() : e.warnOnce("There is no style added to the map.");
          }
        }, {
          key: "addSource",
          value: function addSource(e, t) {
            return this._lazyInitEmptyStyle(), this.style.addSource(e, t), this._update(!0);
          }
        }, {
          key: "isSourceLoaded",
          value: function isSourceLoaded(t) {
            var i = this.style && this.style._getSourceCaches(t);

            if (0 !== i.length) return i.every(function (e) {
              return e.loaded();
            });
            this.fire(new e.ErrorEvent(new Error("There is no source with ID '".concat(t, "'"))));
          }
        }, {
          key: "areTilesLoaded",
          value: function areTilesLoaded() {
            var e = this.style && this.style._sourceCaches;

            for (var _t373 in e) {
              var _i266 = e[_t373]._tiles;

              for (var _e406 in _i266) {
                var _t374 = _i266[_e406];
                if ("loaded" !== _t374.state && "errored" !== _t374.state) return !1;
              }
            }

            return !0;
          }
        }, {
          key: "addSourceType",
          value: function addSourceType(e, t, i) {
            return this._lazyInitEmptyStyle(), this.style.addSourceType(e, t, i);
          }
        }, {
          key: "removeSource",
          value: function removeSource(e) {
            return this.style.removeSource(e), this._updateTerrain(), this._update(!0);
          }
        }, {
          key: "getSource",
          value: function getSource(e) {
            return this.style.getSource(e);
          }
        }, {
          key: "addImage",
          value: function addImage(t, i) {
            var {
              pixelRatio: o = 1,
              sdf: a = !1,
              stretchX: r,
              stretchY: n,
              content: s
            } = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

            if (this._lazyInitEmptyStyle(), i instanceof Ko || Jo && i instanceof Jo) {
              var {
                width: _l59,
                height: _c45,
                data: _h34
              } = e.browser.getImageData(i);
              this.style.addImage(t, {
                data: new e.RGBAImage({
                  width: _l59,
                  height: _c45
                }, _h34),
                pixelRatio: o,
                stretchX: r,
                stretchY: n,
                content: s,
                sdf: a,
                version: 0
              });
            } else {
              if (void 0 === i.width || void 0 === i.height) return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));
              {
                var {
                  width: _l60,
                  height: _c46,
                  data: _h35
                } = i,
                    _u46 = i;
                this.style.addImage(t, {
                  data: new e.RGBAImage({
                    width: _l60,
                    height: _c46
                  }, new Uint8Array(_h35)),
                  pixelRatio: o,
                  stretchX: r,
                  stretchY: n,
                  content: s,
                  sdf: a,
                  version: 0,
                  userImage: _u46
                }), _u46.onAdd && _u46.onAdd(this, t);
              }
            }
          }
        }, {
          key: "updateImage",
          value: function updateImage(t, i) {
            var o = this.style.getImage(t);
            if (!o) return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));
            var a = i instanceof Ko || Jo && i instanceof Jo ? e.browser.getImageData(i) : i,
                {
              width: r,
              height: n,
              data: s
            } = a;
            return void 0 === r || void 0 === n ? this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))) : r !== o.data.width || n !== o.data.height ? this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))) : (o.data.replace(s, !(i instanceof Ko || Jo && i instanceof Jo)), void this.style.updateImage(t, o));
          }
        }, {
          key: "hasImage",
          value: function hasImage(t) {
            return t ? !!this.style.getImage(t) : (this.fire(new e.ErrorEvent(new Error("Missing required image id"))), !1);
          }
        }, {
          key: "removeImage",
          value: function removeImage(e) {
            this.style.removeImage(e);
          }
        }, {
          key: "loadImage",
          value: function loadImage(t, i) {
            e.getImage(this._requestManager.transformRequest(t, e.ResourceType.Image), i);
          }
        }, {
          key: "listImages",
          value: function listImages() {
            return this.style.listImages();
          }
        }, {
          key: "addLayer",
          value: function addLayer(e, t) {
            return this._lazyInitEmptyStyle(), this.style.addLayer(e, t), this._update(!0);
          }
        }, {
          key: "moveLayer",
          value: function moveLayer(e, t) {
            return this.style.moveLayer(e, t), this._update(!0);
          }
        }, {
          key: "removeLayer",
          value: function removeLayer(e) {
            return this.style.removeLayer(e), this._update(!0);
          }
        }, {
          key: "getLayer",
          value: function getLayer(e) {
            return this.style.getLayer(e);
          }
        }, {
          key: "setLayerZoomRange",
          value: function setLayerZoomRange(e, t, i) {
            return this.style.setLayerZoomRange(e, t, i), this._update(!0);
          }
        }, {
          key: "setFilter",
          value: function setFilter(e, t) {
            var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
            return this.style.setFilter(e, t, i), this._update(!0);
          }
        }, {
          key: "getFilter",
          value: function getFilter(e) {
            return this.style.getFilter(e);
          }
        }, {
          key: "setPaintProperty",
          value: function setPaintProperty(e, t, i) {
            var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
            return this.style.setPaintProperty(e, t, i, o), this._update(!0);
          }
        }, {
          key: "getPaintProperty",
          value: function getPaintProperty(e, t) {
            return this.style.getPaintProperty(e, t);
          }
        }, {
          key: "setLayoutProperty",
          value: function setLayoutProperty(e, t, i) {
            var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
            return this.style.setLayoutProperty(e, t, i, o), this._update(!0);
          }
        }, {
          key: "getLayoutProperty",
          value: function getLayoutProperty(e, t) {
            return this.style.getLayoutProperty(e, t);
          }
        }, {
          key: "setLight",
          value: function setLight(e) {
            var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
            return this._lazyInitEmptyStyle(), this.style.setLight(e, t), this._update(!0);
          }
        }, {
          key: "getLight",
          value: function getLight() {
            return this.style.getLight();
          }
        }, {
          key: "setTerrain",
          value: function setTerrain(e) {
            return this._lazyInitEmptyStyle(), this.style.setTerrain(e), this._update(!0);
          }
        }, {
          key: "setFeatureState",
          value: function setFeatureState(e, t) {
            return this.style.setFeatureState(e, t), this._update();
          }
        }, {
          key: "removeFeatureState",
          value: function removeFeatureState(e, t) {
            return this.style.removeFeatureState(e, t), this._update();
          }
        }, {
          key: "getFeatureState",
          value: function getFeatureState(e) {
            return this.style.getFeatureState(e);
          }
        }, {
          key: "getContainer",
          value: function getContainer() {
            return this._container;
          }
        }, {
          key: "getCanvasContainer",
          value: function getCanvasContainer() {
            return this._canvasContainer;
          }
        }, {
          key: "getCanvas",
          value: function getCanvas() {
            return this._canvas;
          }
        }, {
          key: "_containerDimensions",
          value: function _containerDimensions() {
            var e = 0,
                t = 0;
            return this._container && (e = this._container.clientWidth || 400, t = this._container.clientHeight || 300), [e, t];
          }
        }, {
          key: "_detectMissingCSS",
          value: function _detectMissingCSS() {
            "rgb(250, 128, 114)" !== e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color") && e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.");
          }
        }, {
          key: "_setupContainer",
          value: function _setupContainer() {
            var e = this._container;
            e.classList.add("mapboxgl-map"), (this._missingCSSCanary = a.create("div", "mapboxgl-canary", e)).style.visibility = "hidden", this._detectMissingCSS();
            var t = this._canvasContainer = a.create("div", "mapboxgl-canvas-container", e);
            this._interactive && t.classList.add("mapboxgl-interactive"), this._canvas = a.create("canvas", "mapboxgl-canvas", t), this._canvas.addEventListener("webglcontextlost", this._contextLost, !1), this._canvas.addEventListener("webglcontextrestored", this._contextRestored, !1), this._canvas.setAttribute("tabindex", "0"), this._canvas.setAttribute("aria-label", "Map"), this._canvas.setAttribute("role", "region");

            var i = this._containerDimensions();

            this._resizeCanvas(i[0], i[1]);

            var o = this._controlContainer = a.create("div", "mapboxgl-control-container", e),
                r = this._controlPositions = {};
            ["top-left", "top-right", "bottom-left", "bottom-right"].forEach(function (e) {
              r[e] = a.create("div", "mapboxgl-ctrl-".concat(e), o);
            }), this._container.addEventListener("scroll", this._onMapScroll, !1);
          }
        }, {
          key: "_resizeCanvas",
          value: function _resizeCanvas(t, i) {
            var o = e.browser.devicePixelRatio || 1;
            this._canvas.width = o * t, this._canvas.height = o * i, this._canvas.style.width = "".concat(t, "px"), this._canvas.style.height = "".concat(i, "px");
          }
        }, {
          key: "_setupPainter",
          value: function _setupPainter() {
            var _this130 = this;

            var i = e.extend({}, t.webGLContextAttributes, {
              failIfMajorPerformanceCaveat: this._failIfMajorPerformanceCaveat,
              preserveDrawingBuffer: this._preserveDrawingBuffer,
              antialias: this._antialias || !1
            }),
                o = this._canvas.getContext("webgl", i) || this._canvas.getContext("experimental-webgl", i);

            o ? (this.painter = new Ui(o, this.transform), this.on("data", function (e) {
              "source" === e.dataType && _this130.painter.setTileLoadedFlag(!0);
            }), e.webpSupported.testSupport(o)) : this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")));
          }
        }, {
          key: "_contextLost",
          value: function _contextLost(t) {
            t.preventDefault(), this._frame && (this._frame.cancel(), this._frame = null), this.fire(new e.Event("webglcontextlost", {
              originalEvent: t
            }));
          }
        }, {
          key: "_contextRestored",
          value: function _contextRestored(t) {
            this._setupPainter(), this.resize(), this._update(), this.fire(new e.Event("webglcontextrestored", {
              originalEvent: t
            }));
          }
        }, {
          key: "_onMapScroll",
          value: function _onMapScroll(e) {
            if (e.target === this._container) return this._container.scrollTop = 0, this._container.scrollLeft = 0, !1;
          }
        }, {
          key: "loaded",
          value: function loaded() {
            return !this._styleDirty && !this._sourcesDirty && !!this.style && this.style.loaded();
          }
        }, {
          key: "_update",
          value: function _update(e) {
            return this.style ? (this._styleDirty = this._styleDirty || e, this._sourcesDirty = !0, this.triggerRepaint(), this) : this;
          }
        }, {
          key: "_requestRenderFrame",
          value: function _requestRenderFrame(e) {
            return this._update(), this._renderTaskQueue.add(e);
          }
        }, {
          key: "_cancelRenderFrame",
          value: function _cancelRenderFrame(e) {
            this._renderTaskQueue.remove(e);
          }
        }, {
          key: "_render",
          value: function _render(t) {
            var _this131 = this;

            var i,
                o = 0;
            var a = this.painter.context.extTimerQuery;
            if (this.listens("gpu-timing-frame") && (i = a.createQueryEXT(), a.beginQueryEXT(a.TIME_ELAPSED_EXT, i), o = e.browser.now()), this.painter.context.setDirty(), this.painter.setBaseState(), this._renderTaskQueue.run(t), this._removed) return;
            var r = !1;
            var n = this._isInitialLoad ? 0 : this._fadeDuration;

            if (this.style && this._styleDirty) {
              this._styleDirty = !1;

              var _t375 = this.transform.zoom,
                  _i267 = e.browser.now();

              this.style.zoomHistory.update(_t375, _i267);

              var _o140 = new e.EvaluationParameters(_t375, {
                now: _i267,
                fadeDuration: n,
                zoomHistory: this.style.zoomHistory,
                transition: this.style.getTransition()
              }),
                  _a160 = _o140.crossFadingFactor();

              1 === _a160 && _a160 === this._crossFadingFactor || (r = !0, this._crossFadingFactor = _a160), this.style.update(_o140);
            }

            if (this.style && this._sourcesDirty && (this._sourcesDirty = !1, this._updateTerrain(), this.style._updateSources(this.transform)), this._placementDirty = this.style && this.style._updatePlacement(this.painter.transform, this.showCollisionBoxes, n, this._crossSourceCollisions), this.painter.render(this.style, {
              showTileBoundaries: this.showTileBoundaries,
              showOverdrawInspector: this._showOverdrawInspector,
              showQueryGeometry: !!this._showQueryGeometry,
              rotating: this.isRotating(),
              zooming: this.isZooming(),
              moving: this.isMoving(),
              fadeDuration: n,
              isInitialLoad: this._isInitialLoad,
              showPadding: this.showPadding,
              gpuTiming: !!this.listens("gpu-timing-layer"),
              speedIndexTiming: this.speedIndexTiming
            }), this.fire(new e.Event("render")), this.loaded() && !this._loaded && (this._loaded = !0, this.fire(new e.Event("load"))), this.style && (this.style.hasTransitions() || r) && (this._styleDirty = !0), this.style && !this._placementDirty && this.style._releaseSymbolFadeTiles(), this.listens("gpu-timing-frame")) {
              var _t376 = e.browser.now() - o;

              a.endQueryEXT(a.TIME_ELAPSED_EXT, i), setTimeout(function () {
                var o = a.getQueryObjectEXT(i, a.QUERY_RESULT_EXT) / 1e6;
                a.deleteQueryEXT(i), _this131.fire(new e.Event("gpu-timing-frame", {
                  cpuTime: _t376,
                  gpuTime: o
                }));
              }, 50);
            }

            if (this.listens("gpu-timing-layer")) {
              var _t377 = this.painter.collectGpuTimers();

              setTimeout(function () {
                var i = _this131.painter.queryGpuTimers(_t377);

                _this131.fire(new e.Event("gpu-timing-layer", {
                  layerTimes: i
                }));
              }, 50);
            }

            var s = this._sourcesDirty || this._styleDirty || this._placementDirty;
            if (s || this._repaint) this.triggerRepaint();else if (this._triggerFrame(!1), !this.isMoving() && this.loaded() && (this.fire(new e.Event("idle")), this._isInitialLoad && this._authenticate(), this._isInitialLoad = !1, this.speedIndexTiming)) {
              var _t378 = this._calculateSpeedIndex();

              this.fire(new e.Event("speedindexcompleted", {
                speedIndex: _t378
              })), this.speedIndexTiming = !1;
            }
            return !this._loaded || this._fullyLoaded || s || (this._fullyLoaded = !0), this;
          }
        }, {
          key: "_authenticate",
          value: function _authenticate() {
            var _this132 = this;

            e.getMapSessionAPI(this._getMapId(), this._requestManager._skuToken, this._requestManager._customAccessToken, function (t) {
              if (t && (t.message === e.AUTH_ERR_MSG || 401 === t.status)) {
                console.error("Error: A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/"), e.browser.setErrorState();
                var _t379 = _this132.painter.context.gl;
                _this132._logoControl instanceof Xo && _this132._logoControl._updateLogo(), _t379 && _t379.clear(_t379.DEPTH_BUFFER_BIT | _t379.COLOR_BUFFER_BIT | _t379.STENCIL_BUFFER_BIT);
              }
            }), e.postMapLoadEvent(this._getMapId(), this._requestManager._skuToken, this._requestManager._customAccessToken, function () {});
          }
        }, {
          key: "_updateTerrain",
          value: function _updateTerrain() {
            this.painter.updateTerrain(this.style, this.isMoving() || this.isRotating() || this.isZooming());
          }
        }, {
          key: "_calculateSpeedIndex",
          value: function _calculateSpeedIndex() {
            var e = this.painter.canvasCopy(),
                t = this.painter.getCanvasCopiesAndTimestamps();
            t.timeStamps.push(performance.now());
            var i = this.painter.context.gl,
                o = i.createFramebuffer();

            function a(e) {
              i.framebufferTexture2D(i.FRAMEBUFFER, i.COLOR_ATTACHMENT0, i.TEXTURE_2D, e, 0);
              var t = new Uint8Array(i.drawingBufferWidth * i.drawingBufferHeight * 4);
              return i.readPixels(0, 0, i.drawingBufferWidth, i.drawingBufferHeight, i.RGBA, i.UNSIGNED_BYTE, t), t;
            }

            return i.bindFramebuffer(i.FRAMEBUFFER, o), this._canvasPixelComparison(a(e), t.canvasCopies.map(a), t.timeStamps);
          }
        }, {
          key: "_canvasPixelComparison",
          value: function _canvasPixelComparison(e, t, i) {
            var o = i[1] - i[0];
            var a = e.length / 4;

            for (var _r261 = 0; _r261 < t.length; _r261++) {
              var _n163 = t[_r261];
              var _s127 = 0;

              for (var _t380 = 0; _t380 < _n163.length; _t380 += 4) {
                _n163[_t380] === e[_t380] && _n163[_t380 + 1] === e[_t380 + 1] && _n163[_t380 + 2] === e[_t380 + 2] && _n163[_t380 + 3] === e[_t380 + 3] && (_s127 += 1);
              }

              o += (i[_r261 + 2] - i[_r261 + 1]) * (1 - _s127 / a);
            }

            return o;
          }
        }, {
          key: "remove",
          value: function remove() {
            this._hash && this._hash.remove();

            for (var _e407 of this._controls) {
              _e407.onRemove(this);
            }

            this._controls = [], this._frame && (this._frame.cancel(), this._frame = null), this._renderTaskQueue.clear(), this.painter.destroy(), this.handlers.destroy(), delete this.handlers, this.setStyle(null), void 0 !== e.window && (e.window.removeEventListener("resize", this._onWindowResize, !1), e.window.removeEventListener("orientationchange", this._onWindowResize, !1), e.window.removeEventListener("online", this._onWindowOnline, !1));
            var t = this.painter.context.gl.getExtension("WEBGL_lose_context");
            t && t.loseContext(), ea(this._canvasContainer), ea(this._controlContainer), ea(this._missingCSSCanary), this._container.classList.remove("mapboxgl-map"), this._removed = !0, this.fire(new e.Event("remove"));
          }
        }, {
          key: "triggerRepaint",
          value: function triggerRepaint() {
            this._triggerFrame(!0);
          }
        }, {
          key: "_triggerFrame",
          value: function _triggerFrame(t) {
            var _this133 = this;

            this._renderNextFrame = this._renderNextFrame || t, this.style && !this._frame && (this._frame = e.browser.frame(function (e) {
              var t = !!_this133._renderNextFrame;
              _this133._frame = null, _this133._renderNextFrame = null, t && _this133._render(e);
            }));
          }
        }, {
          key: "_onWindowOnline",
          value: function _onWindowOnline() {
            this._update();
          }
        }, {
          key: "_onWindowResize",
          value: function _onWindowResize(e) {
            this._trackResize && this.resize({
              originalEvent: e
            })._update();
          }
        }, {
          key: "showTileBoundaries",
          get: function () {
            return !!this._showTileBoundaries;
          },
          set: function (e) {
            this._showTileBoundaries !== e && (this._showTileBoundaries = e, this._update());
          }
        }, {
          key: "speedIndexTiming",
          get: function () {
            return !!this._speedIndexTiming;
          },
          set: function (e) {
            this._speedIndexTiming !== e && (this._speedIndexTiming = e, this._update());
          }
        }, {
          key: "showPadding",
          get: function () {
            return !!this._showPadding;
          },
          set: function (e) {
            this._showPadding !== e && (this._showPadding = e, this._update());
          }
        }, {
          key: "showCollisionBoxes",
          get: function () {
            return !!this._showCollisionBoxes;
          },
          set: function (e) {
            this._showCollisionBoxes !== e && (this._showCollisionBoxes = e, e ? this.style._generateCollisionBoxes() : this._update());
          }
        }, {
          key: "showOverdrawInspector",
          get: function () {
            return !!this._showOverdrawInspector;
          },
          set: function (e) {
            this._showOverdrawInspector !== e && (this._showOverdrawInspector = e, this._update());
          }
        }, {
          key: "repaint",
          get: function () {
            return !!this._repaint;
          },
          set: function (e) {
            this._repaint !== e && (this._repaint = e, this.triggerRepaint());
          }
        }, {
          key: "vertices",
          get: function () {
            return !!this._vertices;
          },
          set: function (e) {
            this._vertices = e, this._update();
          }
        }, {
          key: "_setCacheLimits",
          value: function _setCacheLimits(t, i) {
            e.setCacheLimits(t, i);
          }
        }, {
          key: "version",
          get: function () {
            return e.version;
          }
        }]);

        return Map;
      }(jo),
      NavigationControl: /*#__PURE__*/function () {
        function NavigationControl(t) {
          var _this134 = this;

          _classCallCheck(this, NavigationControl);

          this.options = e.extend({}, ta, t), this._container = a.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), this._container.addEventListener("contextmenu", function (e) {
            return e.preventDefault();
          }), this.options.showZoom && (e.bindAll(["_setButtonTitle", "_updateZoomButtons"], this), this._zoomInButton = this._createButton("mapboxgl-ctrl-zoom-in", function (e) {
            return _this134._map.zoomIn({}, {
              originalEvent: e
            });
          }), a.create("span", "mapboxgl-ctrl-icon", this._zoomInButton).setAttribute("aria-hidden", !0), this._zoomOutButton = this._createButton("mapboxgl-ctrl-zoom-out", function (e) {
            return _this134._map.zoomOut({}, {
              originalEvent: e
            });
          }), a.create("span", "mapboxgl-ctrl-icon", this._zoomOutButton).setAttribute("aria-hidden", !0)), this.options.showCompass && (e.bindAll(["_rotateCompassArrow"], this), this._compass = this._createButton("mapboxgl-ctrl-compass", function (e) {
            _this134.options.visualizePitch ? _this134._map.resetNorthPitch({}, {
              originalEvent: e
            }) : _this134._map.resetNorth({}, {
              originalEvent: e
            });
          }), this._compassIcon = a.create("span", "mapboxgl-ctrl-icon", this._compass), this._compassIcon.setAttribute("aria-hidden", !0));
        }

        _createClass(NavigationControl, [{
          key: "_updateZoomButtons",
          value: function _updateZoomButtons() {
            var e = this._map.getZoom(),
                t = e === this._map.getMaxZoom(),
                i = e === this._map.getMinZoom();

            this._zoomInButton.disabled = t, this._zoomOutButton.disabled = i, this._zoomInButton.setAttribute("aria-disabled", t.toString()), this._zoomOutButton.setAttribute("aria-disabled", i.toString());
          }
        }, {
          key: "_rotateCompassArrow",
          value: function _rotateCompassArrow() {
            var e = this.options.visualizePitch ? "scale(".concat(1 / Math.pow(Math.cos(this._map.transform.pitch * (Math.PI / 180)), .5), ") rotateX(").concat(this._map.transform.pitch, "deg) rotateZ(").concat(this._map.transform.angle * (180 / Math.PI), "deg)") : "rotate(".concat(this._map.transform.angle * (180 / Math.PI), "deg)");
            this._compassIcon.style.transform = e;
          }
        }, {
          key: "onAdd",
          value: function onAdd(e) {
            return this._map = e, this.options.showZoom && (this._setButtonTitle(this._zoomInButton, "ZoomIn"), this._setButtonTitle(this._zoomOutButton, "ZoomOut"), this._map.on("zoom", this._updateZoomButtons), this._updateZoomButtons()), this.options.showCompass && (this._setButtonTitle(this._compass, "ResetBearing"), this.options.visualizePitch && this._map.on("pitch", this._rotateCompassArrow), this._map.on("rotate", this._rotateCompassArrow), this._rotateCompassArrow(), this._handler = new ia(this._map, this._compass, this.options.visualizePitch)), this._container;
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            a.remove(this._container), this.options.showZoom && this._map.off("zoom", this._updateZoomButtons), this.options.showCompass && (this.options.visualizePitch && this._map.off("pitch", this._rotateCompassArrow), this._map.off("rotate", this._rotateCompassArrow), this._handler.off(), delete this._handler), delete this._map;
          }
        }, {
          key: "_createButton",
          value: function _createButton(e, t) {
            var i = a.create("button", e, this._container);
            return i.type = "button", i.addEventListener("click", t), i;
          }
        }, {
          key: "_setButtonTitle",
          value: function _setButtonTitle(e, t) {
            var i = this._map._getUIString("NavigationControl.".concat(t));

            e.title = i, e.setAttribute("aria-label", i);
          }
        }]);

        return NavigationControl;
      }(),
      GeolocateControl: /*#__PURE__*/function (_e$Evented11) {
        _inherits(GeolocateControl, _e$Evented11);

        var _super129 = _createSuper(GeolocateControl);

        function GeolocateControl(t) {
          var _this135;

          _classCallCheck(this, GeolocateControl);

          _this135 = _super129.call(this), _this135.options = e.extend({}, sa, t), e.bindAll(["_onSuccess", "_onError", "_onZoom", "_finish", "_setupUI", "_updateCamera", "_updateMarker"], _assertThisInitialized(_this135));
          return _this135;
        }

        _createClass(GeolocateControl, [{
          key: "onAdd",
          value: function onAdd(t) {
            var i;
            return this._map = t, this._container = a.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), i = this._setupUI, void 0 !== la ? i(la) : void 0 !== e.window.navigator.permissions ? e.window.navigator.permissions.query({
              name: "geolocation"
            }).then(function (e) {
              la = "denied" !== e.state, i(la);
            }) : (la = !!e.window.navigator.geolocation, i(la)), this._container;
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            void 0 !== this._geolocationWatchID && (e.window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0), this.options.showUserLocation && this._userLocationDotMarker && this._userLocationDotMarker.remove(), this.options.showAccuracyCircle && this._accuracyCircleMarker && this._accuracyCircleMarker.remove(), a.remove(this._container), this._map.off("zoom", this._onZoom), this._map = void 0, ca = 0, ha = !1;
          }
        }, {
          key: "_isOutOfMapMaxBounds",
          value: function _isOutOfMapMaxBounds(e) {
            var t = this._map.getMaxBounds(),
                i = e.coords;

            return t && (i.longitude < t.getWest() || i.longitude > t.getEast() || i.latitude < t.getSouth() || i.latitude > t.getNorth());
          }
        }, {
          key: "_setErrorState",
          value: function _setErrorState() {
            switch (this._watchState) {
              case "WAITING_ACTIVE":
                this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");
                break;

              case "ACTIVE_LOCK":
                this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");
                break;

              case "BACKGROUND":
                this._watchState = "BACKGROUND_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");
            }
          }
        }, {
          key: "_onSuccess",
          value: function _onSuccess(t) {
            if (this._map) {
              if (this._isOutOfMapMaxBounds(t)) return this._setErrorState(), this.fire(new e.Event("outofmaxbounds", t)), this._updateMarker(), void this._finish();
              if (this.options.trackUserLocation) switch (this._lastKnownPosition = t, this._watchState) {
                case "WAITING_ACTIVE":
                case "ACTIVE_LOCK":
                case "ACTIVE_ERROR":
                  this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                  break;

                case "BACKGROUND":
                case "BACKGROUND_ERROR":
                  this._watchState = "BACKGROUND", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");
              }
              this.options.showUserLocation && "OFF" !== this._watchState && this._updateMarker(t), this.options.trackUserLocation && "ACTIVE_LOCK" !== this._watchState || this._updateCamera(t), this.options.showUserLocation && this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"), this.fire(new e.Event("geolocate", t)), this._finish();
            }
          }
        }, {
          key: "_updateCamera",
          value: function _updateCamera(t) {
            var i = new e.LngLat(t.coords.longitude, t.coords.latitude),
                o = t.coords.accuracy,
                a = this._map.getBearing(),
                r = e.extend({
              bearing: a
            }, this.options.fitBoundsOptions);

            this._map.fitBounds(i.toBounds(o), r, {
              geolocateSource: !0
            });
          }
        }, {
          key: "_updateMarker",
          value: function _updateMarker(t) {
            if (t) {
              var _i268 = new e.LngLat(t.coords.longitude, t.coords.latitude);

              this._accuracyCircleMarker.setLngLat(_i268).addTo(this._map), this._userLocationDotMarker.setLngLat(_i268).addTo(this._map), this._accuracy = t.coords.accuracy, this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();
            } else this._userLocationDotMarker.remove(), this._accuracyCircleMarker.remove();
          }
        }, {
          key: "_updateCircleRadius",
          value: function _updateCircleRadius() {
            var e = this._map._container.clientHeight / 2,
                t = this._map.unproject([0, e]),
                i = this._map.unproject([1, e]),
                o = t.distanceTo(i),
                a = Math.ceil(2 * this._accuracy / o);

            this._circleElement.style.width = "".concat(a, "px"), this._circleElement.style.height = "".concat(a, "px");
          }
        }, {
          key: "_onZoom",
          value: function _onZoom() {
            this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();
          }
        }, {
          key: "_onError",
          value: function _onError(t) {
            if (this._map) {
              if (this.options.trackUserLocation) if (1 === t.code) {
                this._watchState = "OFF", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.disabled = !0;

                var _e408 = this._map._getUIString("GeolocateControl.LocationNotAvailable");

                this._geolocateButton.title = _e408, this._geolocateButton.setAttribute("aria-label", _e408), void 0 !== this._geolocationWatchID && this._clearWatch();
              } else {
                if (3 === t.code && ha) return;

                this._setErrorState();
              }
              "OFF" !== this._watchState && this.options.showUserLocation && this._dotElement.classList.add("mapboxgl-user-location-dot-stale"), this.fire(new e.Event("error", t)), this._finish();
            }
          }
        }, {
          key: "_finish",
          value: function _finish() {
            this._timeoutId && clearTimeout(this._timeoutId), this._timeoutId = void 0;
          }
        }, {
          key: "_setupUI",
          value: function _setupUI(t) {
            var _this136 = this;

            if (this._container.addEventListener("contextmenu", function (e) {
              return e.preventDefault();
            }), this._geolocateButton = a.create("button", "mapboxgl-ctrl-geolocate", this._container), a.create("span", "mapboxgl-ctrl-icon", this._geolocateButton).setAttribute("aria-hidden", !0), this._geolocateButton.type = "button", !1 === t) {
              e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");

              var _t381 = this._map._getUIString("GeolocateControl.LocationNotAvailable");

              this._geolocateButton.disabled = !0, this._geolocateButton.title = _t381, this._geolocateButton.setAttribute("aria-label", _t381);
            } else {
              var _e409 = this._map._getUIString("GeolocateControl.FindMyLocation");

              this._geolocateButton.title = _e409, this._geolocateButton.setAttribute("aria-label", _e409);
            }

            this.options.trackUserLocation && (this._geolocateButton.setAttribute("aria-pressed", "false"), this._watchState = "OFF"), this.options.showUserLocation && (this._dotElement = a.create("div", "mapboxgl-user-location-dot"), this._userLocationDotMarker = new na(this._dotElement), this._circleElement = a.create("div", "mapboxgl-user-location-accuracy-circle"), this._accuracyCircleMarker = new na({
              element: this._circleElement,
              pitchAlignment: "map"
            }), this.options.trackUserLocation && (this._watchState = "OFF"), this._map.on("zoom", this._onZoom)), this._geolocateButton.addEventListener("click", this.trigger.bind(this)), this._setup = !0, this.options.trackUserLocation && this._map.on("movestart", function (t) {
              t.geolocateSource || "ACTIVE_LOCK" !== _this136._watchState || t.originalEvent && "resize" === t.originalEvent.type || (_this136._watchState = "BACKGROUND", _this136._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"), _this136._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), _this136.fire(new e.Event("trackuserlocationend")));
            });
          }
        }, {
          key: "trigger",
          value: function trigger() {
            if (!this._setup) return e.warnOnce("Geolocate control triggered before added to a map"), !1;

            if (this.options.trackUserLocation) {
              switch (this._watchState) {
                case "OFF":
                  this._watchState = "WAITING_ACTIVE", this.fire(new e.Event("trackuserlocationstart"));
                  break;

                case "WAITING_ACTIVE":
                case "ACTIVE_LOCK":
                case "ACTIVE_ERROR":
                case "BACKGROUND_ERROR":
                  ca--, ha = !1, this._watchState = "OFF", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this.fire(new e.Event("trackuserlocationend"));
                  break;

                case "BACKGROUND":
                  this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._lastKnownPosition && this._updateCamera(this._lastKnownPosition), this.fire(new e.Event("trackuserlocationstart"));
              }

              switch (this._watchState) {
                case "WAITING_ACTIVE":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                  break;

                case "ACTIVE_LOCK":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");

                  break;

                case "ACTIVE_ERROR":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");
                  break;

                case "BACKGROUND":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");

                  break;

                case "BACKGROUND_ERROR":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");
              }

              if ("OFF" === this._watchState && void 0 !== this._geolocationWatchID) this._clearWatch();else if (void 0 === this._geolocationWatchID) {
                var _t382;

                this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "true"), ca++, ca > 1 ? (_t382 = {
                  maximumAge: 6e5,
                  timeout: 0
                }, ha = !0) : (_t382 = this.options.positionOptions, ha = !1), this._geolocationWatchID = e.window.navigator.geolocation.watchPosition(this._onSuccess, this._onError, _t382);
              }
            } else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess, this._onError, this.options.positionOptions), this._timeoutId = setTimeout(this._finish, 1e4);

            return !0;
          }
        }, {
          key: "_clearWatch",
          value: function _clearWatch() {
            e.window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0, this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "false"), this.options.showUserLocation && this._updateMarker(null);
          }
        }]);

        return GeolocateControl;
      }(e.Evented),
      AttributionControl: $o,
      ScaleControl: /*#__PURE__*/function () {
        function ScaleControl(t) {
          _classCallCheck(this, ScaleControl);

          this.options = e.extend({}, ua, t), e.bindAll(["_onMove", "setUnit"], this);
        }

        _createClass(ScaleControl, [{
          key: "getDefaultPosition",
          value: function getDefaultPosition() {
            return "bottom-left";
          }
        }, {
          key: "_onMove",
          value: function _onMove() {
            da(this._map, this._container, this.options);
          }
        }, {
          key: "onAdd",
          value: function onAdd(e) {
            return this._map = e, this._container = a.create("div", "mapboxgl-ctrl mapboxgl-ctrl-scale", e.getContainer()), this._map.on("move", this._onMove), this._onMove(), this._container;
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            a.remove(this._container), this._map.off("move", this._onMove), this._map = void 0;
          }
        }, {
          key: "setUnit",
          value: function setUnit(e) {
            this.options.unit = e, da(this._map, this._container, this.options);
          }
        }]);

        return ScaleControl;
      }(),
      FullscreenControl: /*#__PURE__*/function () {
        function FullscreenControl(t) {
          _classCallCheck(this, FullscreenControl);

          this._fullscreen = !1, t && t.container && (t.container instanceof e.window.HTMLElement ? this._container = t.container : e.warnOnce("Full screen control 'container' must be a DOM element.")), e.bindAll(["_onClickFullscreen", "_changeIcon"], this), "onfullscreenchange" in e.window.document ? this._fullscreenchange = "fullscreenchange" : "onwebkitfullscreenchange" in e.window.document && (this._fullscreenchange = "webkitfullscreenchange");
        }

        _createClass(FullscreenControl, [{
          key: "onAdd",
          value: function onAdd(t) {
            return this._map = t, this._container || (this._container = this._map.getContainer()), this._controlContainer = a.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), this._checkFullscreenSupport() ? this._setupUI() : (this._controlContainer.style.display = "none", e.warnOnce("This device does not support fullscreen mode.")), this._controlContainer;
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            a.remove(this._controlContainer), this._map = null, e.window.document.removeEventListener(this._fullscreenchange, this._changeIcon);
          }
        }, {
          key: "_checkFullscreenSupport",
          value: function _checkFullscreenSupport() {
            return !(!e.window.document.fullscreenEnabled && !e.window.document.webkitFullscreenEnabled);
          }
        }, {
          key: "_setupUI",
          value: function _setupUI() {
            var t = this._fullscreenButton = a.create("button", "mapboxgl-ctrl-fullscreen", this._controlContainer);
            a.create("span", "mapboxgl-ctrl-icon", t).setAttribute("aria-hidden", !0), t.type = "button", this._updateTitle(), this._fullscreenButton.addEventListener("click", this._onClickFullscreen), e.window.document.addEventListener(this._fullscreenchange, this._changeIcon);
          }
        }, {
          key: "_updateTitle",
          value: function _updateTitle() {
            var e = this._getTitle();

            this._fullscreenButton.setAttribute("aria-label", e), this._fullscreenButton.title = e;
          }
        }, {
          key: "_getTitle",
          value: function _getTitle() {
            return this._map._getUIString(this._isFullscreen() ? "FullscreenControl.Exit" : "FullscreenControl.Enter");
          }
        }, {
          key: "_isFullscreen",
          value: function _isFullscreen() {
            return this._fullscreen;
          }
        }, {
          key: "_changeIcon",
          value: function _changeIcon() {
            (e.window.document.fullscreenElement || e.window.document.webkitFullscreenElement) === this._container !== this._fullscreen && (this._fullscreen = !this._fullscreen, this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"), this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"), this._updateTitle());
          }
        }, {
          key: "_onClickFullscreen",
          value: function _onClickFullscreen() {
            this._isFullscreen() ? e.window.document.exitFullscreen ? e.window.document.exitFullscreen() : e.window.document.webkitCancelFullScreen && e.window.document.webkitCancelFullScreen() : this._container.requestFullscreen ? this._container.requestFullscreen() : this._container.webkitRequestFullscreen && this._container.webkitRequestFullscreen();
          }
        }]);

        return FullscreenControl;
      }(),
      Popup: /*#__PURE__*/function (_e$Evented12) {
        _inherits(Popup, _e$Evented12);

        var _super130 = _createSuper(Popup);

        function Popup(t) {
          var _this137;

          _classCallCheck(this, Popup);

          _this137 = _super130.call(this), _this137.options = e.extend(Object.create(ma), t), e.bindAll(["_update", "_onClose", "remove", "_onMouseMove", "_onMouseUp", "_onDrag"], _assertThisInitialized(_this137));
          return _this137;
        }

        _createClass(Popup, [{
          key: "addTo",
          value: function addTo(t) {
            return this._map && this.remove(), this._map = t, this.options.closeOnClick && this._map.on("click", this._onClose), this.options.closeOnMove && this._map.on("move", this._onClose), this._map.on("remove", this.remove), this._update(), this._focusFirstElement(), this._trackPointer ? (this._map.on("mousemove", this._onMouseMove), this._map.on("mouseup", this._onMouseUp), this._container && this._container.classList.add("mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.add("mapboxgl-track-pointer")) : this._map.on("move", this._update), this.fire(new e.Event("open")), this;
          }
        }, {
          key: "isOpen",
          value: function isOpen() {
            return !!this._map;
          }
        }, {
          key: "remove",
          value: function remove() {
            return this._content && a.remove(this._content), this._container && (a.remove(this._container), delete this._container), this._map && (this._map.off("move", this._update), this._map.off("move", this._onClose), this._map.off("click", this._onClose), this._map.off("remove", this.remove), this._map.off("mousemove", this._onMouseMove), this._map.off("mouseup", this._onMouseUp), this._map.off("drag", this._onDrag), delete this._map), this.fire(new e.Event("close")), this;
          }
        }, {
          key: "getLngLat",
          value: function getLngLat() {
            return this._lngLat;
          }
        }, {
          key: "setLngLat",
          value: function setLngLat(t) {
            return this._lngLat = e.LngLat.convert(t), this._pos = null, this._trackPointer = !1, this._update(), this._map && (this._map.on("move", this._update), this._map.off("mousemove", this._onMouseMove), this._container && this._container.classList.remove("mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")), this;
          }
        }, {
          key: "trackPointer",
          value: function trackPointer() {
            return this._trackPointer = !0, this._pos = null, this._update(), this._map && (this._map.off("move", this._update), this._map.on("mousemove", this._onMouseMove), this._map.on("drag", this._onDrag), this._container && this._container.classList.add("mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.add("mapboxgl-track-pointer")), this;
          }
        }, {
          key: "getElement",
          value: function getElement() {
            return this._container;
          }
        }, {
          key: "setText",
          value: function setText(t) {
            return this.setDOMContent(e.window.document.createTextNode(t));
          }
        }, {
          key: "setHTML",
          value: function setHTML(t) {
            var i = e.window.document.createDocumentFragment(),
                o = e.window.document.createElement("body");
            var a;

            for (o.innerHTML = t; a = o.firstChild, a;) {
              i.appendChild(a);
            }

            return this.setDOMContent(i);
          }
        }, {
          key: "getMaxWidth",
          value: function getMaxWidth() {
            return this._container && this._container.style.maxWidth;
          }
        }, {
          key: "setMaxWidth",
          value: function setMaxWidth(e) {
            return this.options.maxWidth = e, this._update(), this;
          }
        }, {
          key: "setDOMContent",
          value: function setDOMContent(e) {
            if (this._content) for (; this._content.hasChildNodes();) {
              this._content.firstChild && this._content.removeChild(this._content.firstChild);
            } else this._content = a.create("div", "mapboxgl-popup-content", this._container);
            return this._content.appendChild(e), this._createCloseButton(), this._update(), this._focusFirstElement(), this;
          }
        }, {
          key: "addClassName",
          value: function addClassName(e) {
            this._container && this._container.classList.add(e);
          }
        }, {
          key: "removeClassName",
          value: function removeClassName(e) {
            this._container && this._container.classList.remove(e);
          }
        }, {
          key: "setOffset",
          value: function setOffset(e) {
            return this.options.offset = e, this._update(), this;
          }
        }, {
          key: "toggleClassName",
          value: function toggleClassName(e) {
            if (this._container) return this._container.classList.toggle(e);
          }
        }, {
          key: "_createCloseButton",
          value: function _createCloseButton() {
            this.options.closeButton && (this._closeButton = a.create("button", "mapboxgl-popup-close-button", this._content), this._closeButton.type = "button", this._closeButton.setAttribute("aria-label", "Close popup"), this._closeButton.innerHTML = "&#215;", this._closeButton.addEventListener("click", this._onClose));
          }
        }, {
          key: "_onMouseUp",
          value: function _onMouseUp(e) {
            this._update(e.point);
          }
        }, {
          key: "_onMouseMove",
          value: function _onMouseMove(e) {
            this._update(e.point);
          }
        }, {
          key: "_onDrag",
          value: function _onDrag(e) {
            this._update(e.point);
          }
        }, {
          key: "_update",
          value: function _update(t) {
            var _this138 = this;

            if (!this._map || !this._lngLat && !this._trackPointer || !this._content) return;
            if (this._container || (this._container = a.create("div", "mapboxgl-popup", this._map.getContainer()), this._tip = a.create("div", "mapboxgl-popup-tip", this._container), this._container.appendChild(this._content), this.options.className && this.options.className.split(" ").forEach(function (e) {
              return _this138._container.classList.add(e);
            }), this._trackPointer && this._container.classList.add("mapboxgl-popup-track-pointer")), this.options.maxWidth && this._container.style.maxWidth !== this.options.maxWidth && (this._container.style.maxWidth = this.options.maxWidth), this._map.transform.renderWorldCopies && !this._trackPointer && (this._lngLat = oa(this._lngLat, this._pos, this._map.transform)), this._trackPointer && !t) return;
            var i = this._pos = this._trackPointer && t ? t : this._map.project(this._lngLat);
            var o = this.options.anchor;

            var r = function t(i) {
              if (i) {
                if ("number" == typeof i) {
                  var _t383 = Math.round(Math.sqrt(.5 * Math.pow(i, 2)));

                  return {
                    center: new e.Point(0, 0),
                    top: new e.Point(0, i),
                    "top-left": new e.Point(_t383, _t383),
                    "top-right": new e.Point(-_t383, _t383),
                    bottom: new e.Point(0, -i),
                    "bottom-left": new e.Point(_t383, -_t383),
                    "bottom-right": new e.Point(-_t383, -_t383),
                    left: new e.Point(i, 0),
                    right: new e.Point(-i, 0)
                  };
                }

                if (i instanceof e.Point || Array.isArray(i)) {
                  var _t384 = e.Point.convert(i);

                  return {
                    center: _t384,
                    top: _t384,
                    "top-left": _t384,
                    "top-right": _t384,
                    bottom: _t384,
                    "bottom-left": _t384,
                    "bottom-right": _t384,
                    left: _t384,
                    right: _t384
                  };
                }

                return {
                  center: e.Point.convert(i.center || [0, 0]),
                  top: e.Point.convert(i.top || [0, 0]),
                  "top-left": e.Point.convert(i["top-left"] || [0, 0]),
                  "top-right": e.Point.convert(i["top-right"] || [0, 0]),
                  bottom: e.Point.convert(i.bottom || [0, 0]),
                  "bottom-left": e.Point.convert(i["bottom-left"] || [0, 0]),
                  "bottom-right": e.Point.convert(i["bottom-right"] || [0, 0]),
                  left: e.Point.convert(i.left || [0, 0]),
                  right: e.Point.convert(i.right || [0, 0])
                };
              }

              return t(new e.Point(0, 0));
            }(this.options.offset);

            if (!o) {
              var _e410 = this._container.offsetWidth,
                  _t385 = this._container.offsetHeight;

              var _a161;

              _a161 = i.y + r.bottom.y < _t385 ? ["top"] : i.y > this._map.transform.height - _t385 ? ["bottom"] : [], i.x < _e410 / 2 ? _a161.push("left") : i.x > this._map.transform.width - _e410 / 2 && _a161.push("right"), o = 0 === _a161.length ? "bottom" : _a161.join("-");
            }

            var n = i.add(r[o]).round();
            a.setTransform(this._container, "".concat(aa[o], " translate(").concat(n.x, "px,").concat(n.y, "px)")), ra(this._container, o, "popup");
          }
        }, {
          key: "_focusFirstElement",
          value: function _focusFirstElement() {
            if (!this.options.focusAfterOpen || !this._container) return;

            var e = this._container.querySelector(pa);

            e && e.focus();
          }
        }, {
          key: "_onClose",
          value: function _onClose() {
            this.remove();
          }
        }]);

        return Popup;
      }(e.Evented),
      Marker: na,
      Style: Ze,
      LngLat: e.LngLat,
      LngLatBounds: e.LngLatBounds,
      Point: e.Point,
      MercatorCoordinate: e.MercatorCoordinate,
      FreeCameraOptions: Xi,
      Evented: e.Evented,
      config: e.config,
      prewarm: function () {
        B().acquire(L);
      },
      clearPrewarmedResources: function () {
        var e = k;
        e && (e.isPreloaded() && 1 === e.numActive() ? (e.release(L), k = null) : console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"));
      },

      get accessToken() {
        return e.config.ACCESS_TOKEN;
      },

      set accessToken(t) {
        e.config.ACCESS_TOKEN = t;
      },

      get baseApiUrl() {
        return e.config.API_URL;
      },

      set baseApiUrl(t) {
        e.config.API_URL = t;
      },

      get workerCount() {
        return R.workerCount;
      },

      set workerCount(e) {
        R.workerCount = e;
      },

      get maxParallelImageRequests() {
        return e.config.MAX_PARALLEL_IMAGE_REQUESTS;
      },

      set maxParallelImageRequests(t) {
        e.config.MAX_PARALLEL_IMAGE_REQUESTS = t;
      },

      clearStorage: function (t) {
        e.clearTileCache(t);
      },
      workerUrl: "",
      workerClass: null,
      setNow: e.browser.setNow,
      restoreNow: e.browser.restoreNow
    };
    return fa;
  }); //

  return mapboxgl;
});
},{}],"mapbox.js":[function(require,module,exports) {
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.displayMap = void 0;

var _mapboxGl = _interopRequireDefault(require("mapbox-gl"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var displayMap = function displayMap(locations) {
  _mapboxGl.default.accessToken = 'pk.eyJ1IjoiYXlveWltaWthIiwiYSI6ImNra2NremQ5bDAycjgyb3F1ZmQ2bGo5amsifQ.17VR-2CEdUffR_HcZJQ0qQ';
  var map = new _mapboxGl.default.Map({
    container: 'map',
    style: 'mapbox://styles/ayoyimika/ckkclzcs70e4a18pgasqep80v',
    scrollZoom: false // center: [-118.113491, 34.111745],
    // zoom: 10,
    // interactive: false

  });
  var bounds = new _mapboxGl.default.LngLatBounds();
  locations.forEach(function (loc) {
    // Create marker
    var el = document.createElement('div');
    el.className = 'marker'; // Add marker

    new _mapboxGl.default.Marker({
      element: el,
      anchor: 'bottom'
    }).setLngLat(loc.coordinates).addTo(map); // Add popup

    new _mapboxGl.default.Popup({
      offset: 30
    }).setLngLat(loc.coordinates).setHTML("<p>Day ".concat(loc.day, ": ").concat(loc.description, "</p>")).addTo(map); // Extend map bounds to include current location

    bounds.extend(loc.coordinates);
  });
  map.fitBounds(bounds, {
    padding: {
      top: 200,
      bottom: 150,
      left: 100,
      right: 100
    }
  });
};

exports.displayMap = displayMap;
},{"mapbox-gl":"../../node_modules/mapbox-gl/dist/mapbox-gl.js"}],"../../node_modules/axios/lib/helpers/bind.js":[function(require,module,exports) {
'use strict';

module.exports = function bind(fn, thisArg) {
  return function wrap() {
    var args = new Array(arguments.length);
    for (var i = 0; i < args.length; i++) {
      args[i] = arguments[i];
    }
    return fn.apply(thisArg, args);
  };
};

},{}],"../../node_modules/axios/lib/utils.js":[function(require,module,exports) {
'use strict';

var bind = require('./helpers/bind');

/*global toString:true*/

// utils is a library of generic helper functions non-specific to axios

var toString = Object.prototype.toString;

/**
 * Determine if a value is an Array
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an Array, otherwise false
 */
function isArray(val) {
  return toString.call(val) === '[object Array]';
}

/**
 * Determine if a value is undefined
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if the value is undefined, otherwise false
 */
function isUndefined(val) {
  return typeof val === 'undefined';
}

/**
 * Determine if a value is a Buffer
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Buffer, otherwise false
 */
function isBuffer(val) {
  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)
    && typeof val.constructor.isBuffer === 'function' && val.constructor.isBuffer(val);
}

/**
 * Determine if a value is an ArrayBuffer
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an ArrayBuffer, otherwise false
 */
function isArrayBuffer(val) {
  return toString.call(val) === '[object ArrayBuffer]';
}

/**
 * Determine if a value is a FormData
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an FormData, otherwise false
 */
function isFormData(val) {
  return (typeof FormData !== 'undefined') && (val instanceof FormData);
}

/**
 * Determine if a value is a view on an ArrayBuffer
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false
 */
function isArrayBufferView(val) {
  var result;
  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {
    result = ArrayBuffer.isView(val);
  } else {
    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);
  }
  return result;
}

/**
 * Determine if a value is a String
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a String, otherwise false
 */
function isString(val) {
  return typeof val === 'string';
}

/**
 * Determine if a value is a Number
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Number, otherwise false
 */
function isNumber(val) {
  return typeof val === 'number';
}

/**
 * Determine if a value is an Object
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an Object, otherwise false
 */
function isObject(val) {
  return val !== null && typeof val === 'object';
}

/**
 * Determine if a value is a plain Object
 *
 * @param {Object} val The value to test
 * @return {boolean} True if value is a plain Object, otherwise false
 */
function isPlainObject(val) {
  if (toString.call(val) !== '[object Object]') {
    return false;
  }

  var prototype = Object.getPrototypeOf(val);
  return prototype === null || prototype === Object.prototype;
}

/**
 * Determine if a value is a Date
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Date, otherwise false
 */
function isDate(val) {
  return toString.call(val) === '[object Date]';
}

/**
 * Determine if a value is a File
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a File, otherwise false
 */
function isFile(val) {
  return toString.call(val) === '[object File]';
}

/**
 * Determine if a value is a Blob
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Blob, otherwise false
 */
function isBlob(val) {
  return toString.call(val) === '[object Blob]';
}

/**
 * Determine if a value is a Function
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Function, otherwise false
 */
function isFunction(val) {
  return toString.call(val) === '[object Function]';
}

/**
 * Determine if a value is a Stream
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Stream, otherwise false
 */
function isStream(val) {
  return isObject(val) && isFunction(val.pipe);
}

/**
 * Determine if a value is a URLSearchParams object
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a URLSearchParams object, otherwise false
 */
function isURLSearchParams(val) {
  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;
}

/**
 * Trim excess whitespace off the beginning and end of a string
 *
 * @param {String} str The String to trim
 * @returns {String} The String freed of excess whitespace
 */
function trim(str) {
  return str.replace(/^\s*/, '').replace(/\s*$/, '');
}

/**
 * Determine if we're running in a standard browser environment
 *
 * This allows axios to run in a web worker, and react-native.
 * Both environments support XMLHttpRequest, but not fully standard globals.
 *
 * web workers:
 *  typeof window -> undefined
 *  typeof document -> undefined
 *
 * react-native:
 *  navigator.product -> 'ReactNative'
 * nativescript
 *  navigator.product -> 'NativeScript' or 'NS'
 */
function isStandardBrowserEnv() {
  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||
                                           navigator.product === 'NativeScript' ||
                                           navigator.product === 'NS')) {
    return false;
  }
  return (
    typeof window !== 'undefined' &&
    typeof document !== 'undefined'
  );
}

/**
 * Iterate over an Array or an Object invoking a function for each item.
 *
 * If `obj` is an Array callback will be called passing
 * the value, index, and complete array for each item.
 *
 * If 'obj' is an Object callback will be called passing
 * the value, key, and complete object for each property.
 *
 * @param {Object|Array} obj The object to iterate
 * @param {Function} fn The callback to invoke for each item
 */
function forEach(obj, fn) {
  // Don't bother if no value provided
  if (obj === null || typeof obj === 'undefined') {
    return;
  }

  // Force an array if not already something iterable
  if (typeof obj !== 'object') {
    /*eslint no-param-reassign:0*/
    obj = [obj];
  }

  if (isArray(obj)) {
    // Iterate over array values
    for (var i = 0, l = obj.length; i < l; i++) {
      fn.call(null, obj[i], i, obj);
    }
  } else {
    // Iterate over object keys
    for (var key in obj) {
      if (Object.prototype.hasOwnProperty.call(obj, key)) {
        fn.call(null, obj[key], key, obj);
      }
    }
  }
}

/**
 * Accepts varargs expecting each argument to be an object, then
 * immutably merges the properties of each object and returns result.
 *
 * When multiple objects contain the same key the later object in
 * the arguments list will take precedence.
 *
 * Example:
 *
 * ```js
 * var result = merge({foo: 123}, {foo: 456});
 * console.log(result.foo); // outputs 456
 * ```
 *
 * @param {Object} obj1 Object to merge
 * @returns {Object} Result of all merge properties
 */
function merge(/* obj1, obj2, obj3, ... */) {
  var result = {};
  function assignValue(val, key) {
    if (isPlainObject(result[key]) && isPlainObject(val)) {
      result[key] = merge(result[key], val);
    } else if (isPlainObject(val)) {
      result[key] = merge({}, val);
    } else if (isArray(val)) {
      result[key] = val.slice();
    } else {
      result[key] = val;
    }
  }

  for (var i = 0, l = arguments.length; i < l; i++) {
    forEach(arguments[i], assignValue);
  }
  return result;
}

/**
 * Extends object a by mutably adding to it the properties of object b.
 *
 * @param {Object} a The object to be extended
 * @param {Object} b The object to copy properties from
 * @param {Object} thisArg The object to bind function to
 * @return {Object} The resulting value of object a
 */
function extend(a, b, thisArg) {
  forEach(b, function assignValue(val, key) {
    if (thisArg && typeof val === 'function') {
      a[key] = bind(val, thisArg);
    } else {
      a[key] = val;
    }
  });
  return a;
}

/**
 * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)
 *
 * @param {string} content with BOM
 * @return {string} content value without BOM
 */
function stripBOM(content) {
  if (content.charCodeAt(0) === 0xFEFF) {
    content = content.slice(1);
  }
  return content;
}

module.exports = {
  isArray: isArray,
  isArrayBuffer: isArrayBuffer,
  isBuffer: isBuffer,
  isFormData: isFormData,
  isArrayBufferView: isArrayBufferView,
  isString: isString,
  isNumber: isNumber,
  isObject: isObject,
  isPlainObject: isPlainObject,
  isUndefined: isUndefined,
  isDate: isDate,
  isFile: isFile,
  isBlob: isBlob,
  isFunction: isFunction,
  isStream: isStream,
  isURLSearchParams: isURLSearchParams,
  isStandardBrowserEnv: isStandardBrowserEnv,
  forEach: forEach,
  merge: merge,
  extend: extend,
  trim: trim,
  stripBOM: stripBOM
};

},{"./helpers/bind":"../../node_modules/axios/lib/helpers/bind.js"}],"../../node_modules/axios/lib/helpers/buildURL.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

function encode(val) {
  return encodeURIComponent(val).
    replace(/%3A/gi, ':').
    replace(/%24/g, '$').
    replace(/%2C/gi, ',').
    replace(/%20/g, '+').
    replace(/%5B/gi, '[').
    replace(/%5D/gi, ']');
}

/**
 * Build a URL by appending params to the end
 *
 * @param {string} url The base of the url (e.g., http://www.google.com)
 * @param {object} [params] The params to be appended
 * @returns {string} The formatted url
 */
module.exports = function buildURL(url, params, paramsSerializer) {
  /*eslint no-param-reassign:0*/
  if (!params) {
    return url;
  }

  var serializedParams;
  if (paramsSerializer) {
    serializedParams = paramsSerializer(params);
  } else if (utils.isURLSearchParams(params)) {
    serializedParams = params.toString();
  } else {
    var parts = [];

    utils.forEach(params, function serialize(val, key) {
      if (val === null || typeof val === 'undefined') {
        return;
      }

      if (utils.isArray(val)) {
        key = key + '[]';
      } else {
        val = [val];
      }

      utils.forEach(val, function parseValue(v) {
        if (utils.isDate(v)) {
          v = v.toISOString();
        } else if (utils.isObject(v)) {
          v = JSON.stringify(v);
        }
        parts.push(encode(key) + '=' + encode(v));
      });
    });

    serializedParams = parts.join('&');
  }

  if (serializedParams) {
    var hashmarkIndex = url.indexOf('#');
    if (hashmarkIndex !== -1) {
      url = url.slice(0, hashmarkIndex);
    }

    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;
  }

  return url;
};

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/core/InterceptorManager.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

function InterceptorManager() {
  this.handlers = [];
}

/**
 * Add a new interceptor to the stack
 *
 * @param {Function} fulfilled The function to handle `then` for a `Promise`
 * @param {Function} rejected The function to handle `reject` for a `Promise`
 *
 * @return {Number} An ID used to remove interceptor later
 */
InterceptorManager.prototype.use = function use(fulfilled, rejected) {
  this.handlers.push({
    fulfilled: fulfilled,
    rejected: rejected
  });
  return this.handlers.length - 1;
};

/**
 * Remove an interceptor from the stack
 *
 * @param {Number} id The ID that was returned by `use`
 */
InterceptorManager.prototype.eject = function eject(id) {
  if (this.handlers[id]) {
    this.handlers[id] = null;
  }
};

/**
 * Iterate over all the registered interceptors
 *
 * This method is particularly useful for skipping over any
 * interceptors that may have become `null` calling `eject`.
 *
 * @param {Function} fn The function to call for each interceptor
 */
InterceptorManager.prototype.forEach = function forEach(fn) {
  utils.forEach(this.handlers, function forEachHandler(h) {
    if (h !== null) {
      fn(h);
    }
  });
};

module.exports = InterceptorManager;

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/core/transformData.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

/**
 * Transform the data for a request or a response
 *
 * @param {Object|String} data The data to be transformed
 * @param {Array} headers The headers for the request or response
 * @param {Array|Function} fns A single function or Array of functions
 * @returns {*} The resulting transformed data
 */
module.exports = function transformData(data, headers, fns) {
  /*eslint no-param-reassign:0*/
  utils.forEach(fns, function transform(fn) {
    data = fn(data, headers);
  });

  return data;
};

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/cancel/isCancel.js":[function(require,module,exports) {
'use strict';

module.exports = function isCancel(value) {
  return !!(value && value.__CANCEL__);
};

},{}],"../../node_modules/axios/lib/helpers/normalizeHeaderName.js":[function(require,module,exports) {
'use strict';

var utils = require('../utils');

module.exports = function normalizeHeaderName(headers, normalizedName) {
  utils.forEach(headers, function processHeader(value, name) {
    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {
      headers[normalizedName] = value;
      delete headers[name];
    }
  });
};

},{"../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/core/enhanceError.js":[function(require,module,exports) {
'use strict';

/**
 * Update an Error with the specified config, error code, and response.
 *
 * @param {Error} error The error to update.
 * @param {Object} config The config.
 * @param {string} [code] The error code (for example, 'ECONNABORTED').
 * @param {Object} [request] The request.
 * @param {Object} [response] The response.
 * @returns {Error} The error.
 */
module.exports = function enhanceError(error, config, code, request, response) {
  error.config = config;
  if (code) {
    error.code = code;
  }

  error.request = request;
  error.response = response;
  error.isAxiosError = true;

  error.toJSON = function toJSON() {
    return {
      // Standard
      message: this.message,
      name: this.name,
      // Microsoft
      description: this.description,
      number: this.number,
      // Mozilla
      fileName: this.fileName,
      lineNumber: this.lineNumber,
      columnNumber: this.columnNumber,
      stack: this.stack,
      // Axios
      config: this.config,
      code: this.code
    };
  };
  return error;
};

},{}],"../../node_modules/axios/lib/core/createError.js":[function(require,module,exports) {
'use strict';

var enhanceError = require('./enhanceError');

/**
 * Create an Error with the specified message, config, error code, request and response.
 *
 * @param {string} message The error message.
 * @param {Object} config The config.
 * @param {string} [code] The error code (for example, 'ECONNABORTED').
 * @param {Object} [request] The request.
 * @param {Object} [response] The response.
 * @returns {Error} The created error.
 */
module.exports = function createError(message, config, code, request, response) {
  var error = new Error(message);
  return enhanceError(error, config, code, request, response);
};

},{"./enhanceError":"../../node_modules/axios/lib/core/enhanceError.js"}],"../../node_modules/axios/lib/core/settle.js":[function(require,module,exports) {
'use strict';

var createError = require('./createError');

/**
 * Resolve or reject a Promise based on response status.
 *
 * @param {Function} resolve A function that resolves the promise.
 * @param {Function} reject A function that rejects the promise.
 * @param {object} response The response.
 */
module.exports = function settle(resolve, reject, response) {
  var validateStatus = response.config.validateStatus;
  if (!response.status || !validateStatus || validateStatus(response.status)) {
    resolve(response);
  } else {
    reject(createError(
      'Request failed with status code ' + response.status,
      response.config,
      null,
      response.request,
      response
    ));
  }
};

},{"./createError":"../../node_modules/axios/lib/core/createError.js"}],"../../node_modules/axios/lib/helpers/cookies.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

module.exports = (
  utils.isStandardBrowserEnv() ?

  // Standard browser envs support document.cookie
    (function standardBrowserEnv() {
      return {
        write: function write(name, value, expires, path, domain, secure) {
          var cookie = [];
          cookie.push(name + '=' + encodeURIComponent(value));

          if (utils.isNumber(expires)) {
            cookie.push('expires=' + new Date(expires).toGMTString());
          }

          if (utils.isString(path)) {
            cookie.push('path=' + path);
          }

          if (utils.isString(domain)) {
            cookie.push('domain=' + domain);
          }

          if (secure === true) {
            cookie.push('secure');
          }

          document.cookie = cookie.join('; ');
        },

        read: function read(name) {
          var match = document.cookie.match(new RegExp('(^|;\\s*)(' + name + ')=([^;]*)'));
          return (match ? decodeURIComponent(match[3]) : null);
        },

        remove: function remove(name) {
          this.write(name, '', Date.now() - 86400000);
        }
      };
    })() :

  // Non standard browser env (web workers, react-native) lack needed support.
    (function nonStandardBrowserEnv() {
      return {
        write: function write() {},
        read: function read() { return null; },
        remove: function remove() {}
      };
    })()
);

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/helpers/isAbsoluteURL.js":[function(require,module,exports) {
'use strict';

/**
 * Determines whether the specified URL is absolute
 *
 * @param {string} url The URL to test
 * @returns {boolean} True if the specified URL is absolute, otherwise false
 */
module.exports = function isAbsoluteURL(url) {
  // A URL is considered absolute if it begins with "<scheme>://" or "//" (protocol-relative URL).
  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed
  // by any combination of letters, digits, plus, period, or hyphen.
  return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(url);
};

},{}],"../../node_modules/axios/lib/helpers/combineURLs.js":[function(require,module,exports) {
'use strict';

/**
 * Creates a new URL by combining the specified URLs
 *
 * @param {string} baseURL The base URL
 * @param {string} relativeURL The relative URL
 * @returns {string} The combined URL
 */
module.exports = function combineURLs(baseURL, relativeURL) {
  return relativeURL
    ? baseURL.replace(/\/+$/, '') + '/' + relativeURL.replace(/^\/+/, '')
    : baseURL;
};

},{}],"../../node_modules/axios/lib/core/buildFullPath.js":[function(require,module,exports) {
'use strict';

var isAbsoluteURL = require('../helpers/isAbsoluteURL');
var combineURLs = require('../helpers/combineURLs');

/**
 * Creates a new URL by combining the baseURL with the requestedURL,
 * only when the requestedURL is not already an absolute URL.
 * If the requestURL is absolute, this function returns the requestedURL untouched.
 *
 * @param {string} baseURL The base URL
 * @param {string} requestedURL Absolute or relative URL to combine
 * @returns {string} The combined full path
 */
module.exports = function buildFullPath(baseURL, requestedURL) {
  if (baseURL && !isAbsoluteURL(requestedURL)) {
    return combineURLs(baseURL, requestedURL);
  }
  return requestedURL;
};

},{"../helpers/isAbsoluteURL":"../../node_modules/axios/lib/helpers/isAbsoluteURL.js","../helpers/combineURLs":"../../node_modules/axios/lib/helpers/combineURLs.js"}],"../../node_modules/axios/lib/helpers/parseHeaders.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

// Headers whose duplicates are ignored by node
// c.f. https://nodejs.org/api/http.html#http_message_headers
var ignoreDuplicateOf = [
  'age', 'authorization', 'content-length', 'content-type', 'etag',
  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',
  'last-modified', 'location', 'max-forwards', 'proxy-authorization',
  'referer', 'retry-after', 'user-agent'
];

/**
 * Parse headers into an object
 *
 * ```
 * Date: Wed, 27 Aug 2014 08:58:49 GMT
 * Content-Type: application/json
 * Connection: keep-alive
 * Transfer-Encoding: chunked
 * ```
 *
 * @param {String} headers Headers needing to be parsed
 * @returns {Object} Headers parsed into an object
 */
module.exports = function parseHeaders(headers) {
  var parsed = {};
  var key;
  var val;
  var i;

  if (!headers) { return parsed; }

  utils.forEach(headers.split('\n'), function parser(line) {
    i = line.indexOf(':');
    key = utils.trim(line.substr(0, i)).toLowerCase();
    val = utils.trim(line.substr(i + 1));

    if (key) {
      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {
        return;
      }
      if (key === 'set-cookie') {
        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);
      } else {
        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;
      }
    }
  });

  return parsed;
};

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/helpers/isURLSameOrigin.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

module.exports = (
  utils.isStandardBrowserEnv() ?

  // Standard browser envs have full support of the APIs needed to test
  // whether the request URL is of the same origin as current location.
    (function standardBrowserEnv() {
      var msie = /(msie|trident)/i.test(navigator.userAgent);
      var urlParsingNode = document.createElement('a');
      var originURL;

      /**
    * Parse a URL to discover it's components
    *
    * @param {String} url The URL to be parsed
    * @returns {Object}
    */
      function resolveURL(url) {
        var href = url;

        if (msie) {
        // IE needs attribute set twice to normalize properties
          urlParsingNode.setAttribute('href', href);
          href = urlParsingNode.href;
        }

        urlParsingNode.setAttribute('href', href);

        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils
        return {
          href: urlParsingNode.href,
          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',
          host: urlParsingNode.host,
          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\?/, '') : '',
          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',
          hostname: urlParsingNode.hostname,
          port: urlParsingNode.port,
          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?
            urlParsingNode.pathname :
            '/' + urlParsingNode.pathname
        };
      }

      originURL = resolveURL(window.location.href);

      /**
    * Determine if a URL shares the same origin as the current location
    *
    * @param {String} requestURL The URL to test
    * @returns {boolean} True if URL shares the same origin, otherwise false
    */
      return function isURLSameOrigin(requestURL) {
        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;
        return (parsed.protocol === originURL.protocol &&
            parsed.host === originURL.host);
      };
    })() :

  // Non standard browser envs (web workers, react-native) lack needed support.
    (function nonStandardBrowserEnv() {
      return function isURLSameOrigin() {
        return true;
      };
    })()
);

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/adapters/xhr.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');
var settle = require('./../core/settle');
var cookies = require('./../helpers/cookies');
var buildURL = require('./../helpers/buildURL');
var buildFullPath = require('../core/buildFullPath');
var parseHeaders = require('./../helpers/parseHeaders');
var isURLSameOrigin = require('./../helpers/isURLSameOrigin');
var createError = require('../core/createError');

module.exports = function xhrAdapter(config) {
  return new Promise(function dispatchXhrRequest(resolve, reject) {
    var requestData = config.data;
    var requestHeaders = config.headers;

    if (utils.isFormData(requestData)) {
      delete requestHeaders['Content-Type']; // Let the browser set it
    }

    var request = new XMLHttpRequest();

    // HTTP basic authentication
    if (config.auth) {
      var username = config.auth.username || '';
      var password = config.auth.password ? unescape(encodeURIComponent(config.auth.password)) : '';
      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);
    }

    var fullPath = buildFullPath(config.baseURL, config.url);
    request.open(config.method.toUpperCase(), buildURL(fullPath, config.params, config.paramsSerializer), true);

    // Set the request timeout in MS
    request.timeout = config.timeout;

    // Listen for ready state
    request.onreadystatechange = function handleLoad() {
      if (!request || request.readyState !== 4) {
        return;
      }

      // The request errored out and we didn't get a response, this will be
      // handled by onerror instead
      // With one exception: request that using file: protocol, most browsers
      // will return status as 0 even though it's a successful request
      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {
        return;
      }

      // Prepare the response
      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;
      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;
      var response = {
        data: responseData,
        status: request.status,
        statusText: request.statusText,
        headers: responseHeaders,
        config: config,
        request: request
      };

      settle(resolve, reject, response);

      // Clean up request
      request = null;
    };

    // Handle browser request cancellation (as opposed to a manual cancellation)
    request.onabort = function handleAbort() {
      if (!request) {
        return;
      }

      reject(createError('Request aborted', config, 'ECONNABORTED', request));

      // Clean up request
      request = null;
    };

    // Handle low level network errors
    request.onerror = function handleError() {
      // Real errors are hidden from us by the browser
      // onerror should only fire if it's a network error
      reject(createError('Network Error', config, null, request));

      // Clean up request
      request = null;
    };

    // Handle timeout
    request.ontimeout = function handleTimeout() {
      var timeoutErrorMessage = 'timeout of ' + config.timeout + 'ms exceeded';
      if (config.timeoutErrorMessage) {
        timeoutErrorMessage = config.timeoutErrorMessage;
      }
      reject(createError(timeoutErrorMessage, config, 'ECONNABORTED',
        request));

      // Clean up request
      request = null;
    };

    // Add xsrf header
    // This is only done if running in a standard browser environment.
    // Specifically not if we're in a web worker, or react-native.
    if (utils.isStandardBrowserEnv()) {
      // Add xsrf header
      var xsrfValue = (config.withCredentials || isURLSameOrigin(fullPath)) && config.xsrfCookieName ?
        cookies.read(config.xsrfCookieName) :
        undefined;

      if (xsrfValue) {
        requestHeaders[config.xsrfHeaderName] = xsrfValue;
      }
    }

    // Add headers to the request
    if ('setRequestHeader' in request) {
      utils.forEach(requestHeaders, function setRequestHeader(val, key) {
        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {
          // Remove Content-Type if data is undefined
          delete requestHeaders[key];
        } else {
          // Otherwise add header to the request
          request.setRequestHeader(key, val);
        }
      });
    }

    // Add withCredentials to request if needed
    if (!utils.isUndefined(config.withCredentials)) {
      request.withCredentials = !!config.withCredentials;
    }

    // Add responseType to request if needed
    if (config.responseType) {
      try {
        request.responseType = config.responseType;
      } catch (e) {
        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.
        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.
        if (config.responseType !== 'json') {
          throw e;
        }
      }
    }

    // Handle progress if needed
    if (typeof config.onDownloadProgress === 'function') {
      request.addEventListener('progress', config.onDownloadProgress);
    }

    // Not all browsers support upload events
    if (typeof config.onUploadProgress === 'function' && request.upload) {
      request.upload.addEventListener('progress', config.onUploadProgress);
    }

    if (config.cancelToken) {
      // Handle cancellation
      config.cancelToken.promise.then(function onCanceled(cancel) {
        if (!request) {
          return;
        }

        request.abort();
        reject(cancel);
        // Clean up request
        request = null;
      });
    }

    if (!requestData) {
      requestData = null;
    }

    // Send the request
    request.send(requestData);
  });
};

},{"./../utils":"../../node_modules/axios/lib/utils.js","./../core/settle":"../../node_modules/axios/lib/core/settle.js","./../helpers/cookies":"../../node_modules/axios/lib/helpers/cookies.js","./../helpers/buildURL":"../../node_modules/axios/lib/helpers/buildURL.js","../core/buildFullPath":"../../node_modules/axios/lib/core/buildFullPath.js","./../helpers/parseHeaders":"../../node_modules/axios/lib/helpers/parseHeaders.js","./../helpers/isURLSameOrigin":"../../node_modules/axios/lib/helpers/isURLSameOrigin.js","../core/createError":"../../node_modules/axios/lib/core/createError.js"}],"../../node_modules/process/browser.js":[function(require,module,exports) {

// shim for using process in browser
var process = module.exports = {}; // cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
  throw new Error('setTimeout has not been defined');
}

function defaultClearTimeout() {
  throw new Error('clearTimeout has not been defined');
}

(function () {
  try {
    if (typeof setTimeout === 'function') {
      cachedSetTimeout = setTimeout;
    } else {
      cachedSetTimeout = defaultSetTimout;
    }
  } catch (e) {
    cachedSetTimeout = defaultSetTimout;
  }

  try {
    if (typeof clearTimeout === 'function') {
      cachedClearTimeout = clearTimeout;
    } else {
      cachedClearTimeout = defaultClearTimeout;
    }
  } catch (e) {
    cachedClearTimeout = defaultClearTimeout;
  }
})();

function runTimeout(fun) {
  if (cachedSetTimeout === setTimeout) {
    //normal enviroments in sane situations
    return setTimeout(fun, 0);
  } // if setTimeout wasn't available but was latter defined


  if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
    cachedSetTimeout = setTimeout;
    return setTimeout(fun, 0);
  }

  try {
    // when when somebody has screwed with setTimeout but no I.E. maddness
    return cachedSetTimeout(fun, 0);
  } catch (e) {
    try {
      // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
      return cachedSetTimeout.call(null, fun, 0);
    } catch (e) {
      // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
      return cachedSetTimeout.call(this, fun, 0);
    }
  }
}

function runClearTimeout(marker) {
  if (cachedClearTimeout === clearTimeout) {
    //normal enviroments in sane situations
    return clearTimeout(marker);
  } // if clearTimeout wasn't available but was latter defined


  if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
    cachedClearTimeout = clearTimeout;
    return clearTimeout(marker);
  }

  try {
    // when when somebody has screwed with setTimeout but no I.E. maddness
    return cachedClearTimeout(marker);
  } catch (e) {
    try {
      // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
      return cachedClearTimeout.call(null, marker);
    } catch (e) {
      // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
      // Some versions of I.E. have different rules for clearTimeout vs setTimeout
      return cachedClearTimeout.call(this, marker);
    }
  }
}

var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
  if (!draining || !currentQueue) {
    return;
  }

  draining = false;

  if (currentQueue.length) {
    queue = currentQueue.concat(queue);
  } else {
    queueIndex = -1;
  }

  if (queue.length) {
    drainQueue();
  }
}

function drainQueue() {
  if (draining) {
    return;
  }

  var timeout = runTimeout(cleanUpNextTick);
  draining = true;
  var len = queue.length;

  while (len) {
    currentQueue = queue;
    queue = [];

    while (++queueIndex < len) {
      if (currentQueue) {
        currentQueue[queueIndex].run();
      }
    }

    queueIndex = -1;
    len = queue.length;
  }

  currentQueue = null;
  draining = false;
  runClearTimeout(timeout);
}

process.nextTick = function (fun) {
  var args = new Array(arguments.length - 1);

  if (arguments.length > 1) {
    for (var i = 1; i < arguments.length; i++) {
      args[i - 1] = arguments[i];
    }
  }

  queue.push(new Item(fun, args));

  if (queue.length === 1 && !draining) {
    runTimeout(drainQueue);
  }
}; // v8 likes predictible objects


function Item(fun, array) {
  this.fun = fun;
  this.array = array;
}

Item.prototype.run = function () {
  this.fun.apply(null, this.array);
};

process.title = 'browser';
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues

process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) {
  return [];
};

process.binding = function (name) {
  throw new Error('process.binding is not supported');
};

process.cwd = function () {
  return '/';
};

process.chdir = function (dir) {
  throw new Error('process.chdir is not supported');
};

process.umask = function () {
  return 0;
};
},{}],"../../node_modules/axios/lib/defaults.js":[function(require,module,exports) {
var process = require("process");
'use strict';

var utils = require('./utils');
var normalizeHeaderName = require('./helpers/normalizeHeaderName');

var DEFAULT_CONTENT_TYPE = {
  'Content-Type': 'application/x-www-form-urlencoded'
};

function setContentTypeIfUnset(headers, value) {
  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {
    headers['Content-Type'] = value;
  }
}

function getDefaultAdapter() {
  var adapter;
  if (typeof XMLHttpRequest !== 'undefined') {
    // For browsers use XHR adapter
    adapter = require('./adapters/xhr');
  } else if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {
    // For node use HTTP adapter
    adapter = require('./adapters/http');
  }
  return adapter;
}

var defaults = {
  adapter: getDefaultAdapter(),

  transformRequest: [function transformRequest(data, headers) {
    normalizeHeaderName(headers, 'Accept');
    normalizeHeaderName(headers, 'Content-Type');
    if (utils.isFormData(data) ||
      utils.isArrayBuffer(data) ||
      utils.isBuffer(data) ||
      utils.isStream(data) ||
      utils.isFile(data) ||
      utils.isBlob(data)
    ) {
      return data;
    }
    if (utils.isArrayBufferView(data)) {
      return data.buffer;
    }
    if (utils.isURLSearchParams(data)) {
      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');
      return data.toString();
    }
    if (utils.isObject(data)) {
      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');
      return JSON.stringify(data);
    }
    return data;
  }],

  transformResponse: [function transformResponse(data) {
    /*eslint no-param-reassign:0*/
    if (typeof data === 'string') {
      try {
        data = JSON.parse(data);
      } catch (e) { /* Ignore */ }
    }
    return data;
  }],

  /**
   * A timeout in milliseconds to abort a request. If set to 0 (default) a
   * timeout is not created.
   */
  timeout: 0,

  xsrfCookieName: 'XSRF-TOKEN',
  xsrfHeaderName: 'X-XSRF-TOKEN',

  maxContentLength: -1,
  maxBodyLength: -1,

  validateStatus: function validateStatus(status) {
    return status >= 200 && status < 300;
  }
};

defaults.headers = {
  common: {
    'Accept': 'application/json, text/plain, */*'
  }
};

utils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {
  defaults.headers[method] = {};
});

utils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {
  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);
});

module.exports = defaults;

},{"./utils":"../../node_modules/axios/lib/utils.js","./helpers/normalizeHeaderName":"../../node_modules/axios/lib/helpers/normalizeHeaderName.js","./adapters/xhr":"../../node_modules/axios/lib/adapters/xhr.js","./adapters/http":"../../node_modules/axios/lib/adapters/xhr.js","process":"../../node_modules/process/browser.js"}],"../../node_modules/axios/lib/core/dispatchRequest.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');
var transformData = require('./transformData');
var isCancel = require('../cancel/isCancel');
var defaults = require('../defaults');

/**
 * Throws a `Cancel` if cancellation has been requested.
 */
function throwIfCancellationRequested(config) {
  if (config.cancelToken) {
    config.cancelToken.throwIfRequested();
  }
}

/**
 * Dispatch a request to the server using the configured adapter.
 *
 * @param {object} config The config that is to be used for the request
 * @returns {Promise} The Promise to be fulfilled
 */
module.exports = function dispatchRequest(config) {
  throwIfCancellationRequested(config);

  // Ensure headers exist
  config.headers = config.headers || {};

  // Transform request data
  config.data = transformData(
    config.data,
    config.headers,
    config.transformRequest
  );

  // Flatten headers
  config.headers = utils.merge(
    config.headers.common || {},
    config.headers[config.method] || {},
    config.headers
  );

  utils.forEach(
    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],
    function cleanHeaderConfig(method) {
      delete config.headers[method];
    }
  );

  var adapter = config.adapter || defaults.adapter;

  return adapter(config).then(function onAdapterResolution(response) {
    throwIfCancellationRequested(config);

    // Transform response data
    response.data = transformData(
      response.data,
      response.headers,
      config.transformResponse
    );

    return response;
  }, function onAdapterRejection(reason) {
    if (!isCancel(reason)) {
      throwIfCancellationRequested(config);

      // Transform response data
      if (reason && reason.response) {
        reason.response.data = transformData(
          reason.response.data,
          reason.response.headers,
          config.transformResponse
        );
      }
    }

    return Promise.reject(reason);
  });
};

},{"./../utils":"../../node_modules/axios/lib/utils.js","./transformData":"../../node_modules/axios/lib/core/transformData.js","../cancel/isCancel":"../../node_modules/axios/lib/cancel/isCancel.js","../defaults":"../../node_modules/axios/lib/defaults.js"}],"../../node_modules/axios/lib/core/mergeConfig.js":[function(require,module,exports) {
'use strict';

var utils = require('../utils');

/**
 * Config-specific merge-function which creates a new config-object
 * by merging two configuration objects together.
 *
 * @param {Object} config1
 * @param {Object} config2
 * @returns {Object} New object resulting from merging config2 to config1
 */
module.exports = function mergeConfig(config1, config2) {
  // eslint-disable-next-line no-param-reassign
  config2 = config2 || {};
  var config = {};

  var valueFromConfig2Keys = ['url', 'method', 'data'];
  var mergeDeepPropertiesKeys = ['headers', 'auth', 'proxy', 'params'];
  var defaultToConfig2Keys = [
    'baseURL', 'transformRequest', 'transformResponse', 'paramsSerializer',
    'timeout', 'timeoutMessage', 'withCredentials', 'adapter', 'responseType', 'xsrfCookieName',
    'xsrfHeaderName', 'onUploadProgress', 'onDownloadProgress', 'decompress',
    'maxContentLength', 'maxBodyLength', 'maxRedirects', 'transport', 'httpAgent',
    'httpsAgent', 'cancelToken', 'socketPath', 'responseEncoding'
  ];
  var directMergeKeys = ['validateStatus'];

  function getMergedValue(target, source) {
    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {
      return utils.merge(target, source);
    } else if (utils.isPlainObject(source)) {
      return utils.merge({}, source);
    } else if (utils.isArray(source)) {
      return source.slice();
    }
    return source;
  }

  function mergeDeepProperties(prop) {
    if (!utils.isUndefined(config2[prop])) {
      config[prop] = getMergedValue(config1[prop], config2[prop]);
    } else if (!utils.isUndefined(config1[prop])) {
      config[prop] = getMergedValue(undefined, config1[prop]);
    }
  }

  utils.forEach(valueFromConfig2Keys, function valueFromConfig2(prop) {
    if (!utils.isUndefined(config2[prop])) {
      config[prop] = getMergedValue(undefined, config2[prop]);
    }
  });

  utils.forEach(mergeDeepPropertiesKeys, mergeDeepProperties);

  utils.forEach(defaultToConfig2Keys, function defaultToConfig2(prop) {
    if (!utils.isUndefined(config2[prop])) {
      config[prop] = getMergedValue(undefined, config2[prop]);
    } else if (!utils.isUndefined(config1[prop])) {
      config[prop] = getMergedValue(undefined, config1[prop]);
    }
  });

  utils.forEach(directMergeKeys, function merge(prop) {
    if (prop in config2) {
      config[prop] = getMergedValue(config1[prop], config2[prop]);
    } else if (prop in config1) {
      config[prop] = getMergedValue(undefined, config1[prop]);
    }
  });

  var axiosKeys = valueFromConfig2Keys
    .concat(mergeDeepPropertiesKeys)
    .concat(defaultToConfig2Keys)
    .concat(directMergeKeys);

  var otherKeys = Object
    .keys(config1)
    .concat(Object.keys(config2))
    .filter(function filterAxiosKeys(key) {
      return axiosKeys.indexOf(key) === -1;
    });

  utils.forEach(otherKeys, mergeDeepProperties);

  return config;
};

},{"../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/core/Axios.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');
var buildURL = require('../helpers/buildURL');
var InterceptorManager = require('./InterceptorManager');
var dispatchRequest = require('./dispatchRequest');
var mergeConfig = require('./mergeConfig');

/**
 * Create a new instance of Axios
 *
 * @param {Object} instanceConfig The default config for the instance
 */
function Axios(instanceConfig) {
  this.defaults = instanceConfig;
  this.interceptors = {
    request: new InterceptorManager(),
    response: new InterceptorManager()
  };
}

/**
 * Dispatch a request
 *
 * @param {Object} config The config specific for this request (merged with this.defaults)
 */
Axios.prototype.request = function request(config) {
  /*eslint no-param-reassign:0*/
  // Allow for axios('example/url'[, config]) a la fetch API
  if (typeof config === 'string') {
    config = arguments[1] || {};
    config.url = arguments[0];
  } else {
    config = config || {};
  }

  config = mergeConfig(this.defaults, config);

  // Set config.method
  if (config.method) {
    config.method = config.method.toLowerCase();
  } else if (this.defaults.method) {
    config.method = this.defaults.method.toLowerCase();
  } else {
    config.method = 'get';
  }

  // Hook up interceptors middleware
  var chain = [dispatchRequest, undefined];
  var promise = Promise.resolve(config);

  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {
    chain.unshift(interceptor.fulfilled, interceptor.rejected);
  });

  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {
    chain.push(interceptor.fulfilled, interceptor.rejected);
  });

  while (chain.length) {
    promise = promise.then(chain.shift(), chain.shift());
  }

  return promise;
};

Axios.prototype.getUri = function getUri(config) {
  config = mergeConfig(this.defaults, config);
  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\?/, '');
};

// Provide aliases for supported request methods
utils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {
  /*eslint func-names:0*/
  Axios.prototype[method] = function(url, config) {
    return this.request(mergeConfig(config || {}, {
      method: method,
      url: url,
      data: (config || {}).data
    }));
  };
});

utils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {
  /*eslint func-names:0*/
  Axios.prototype[method] = function(url, data, config) {
    return this.request(mergeConfig(config || {}, {
      method: method,
      url: url,
      data: data
    }));
  };
});

module.exports = Axios;

},{"./../utils":"../../node_modules/axios/lib/utils.js","../helpers/buildURL":"../../node_modules/axios/lib/helpers/buildURL.js","./InterceptorManager":"../../node_modules/axios/lib/core/InterceptorManager.js","./dispatchRequest":"../../node_modules/axios/lib/core/dispatchRequest.js","./mergeConfig":"../../node_modules/axios/lib/core/mergeConfig.js"}],"../../node_modules/axios/lib/cancel/Cancel.js":[function(require,module,exports) {
'use strict';

/**
 * A `Cancel` is an object that is thrown when an operation is canceled.
 *
 * @class
 * @param {string=} message The message.
 */
function Cancel(message) {
  this.message = message;
}

Cancel.prototype.toString = function toString() {
  return 'Cancel' + (this.message ? ': ' + this.message : '');
};

Cancel.prototype.__CANCEL__ = true;

module.exports = Cancel;

},{}],"../../node_modules/axios/lib/cancel/CancelToken.js":[function(require,module,exports) {
'use strict';

var Cancel = require('./Cancel');

/**
 * A `CancelToken` is an object that can be used to request cancellation of an operation.
 *
 * @class
 * @param {Function} executor The executor function.
 */
function CancelToken(executor) {
  if (typeof executor !== 'function') {
    throw new TypeError('executor must be a function.');
  }

  var resolvePromise;
  this.promise = new Promise(function promiseExecutor(resolve) {
    resolvePromise = resolve;
  });

  var token = this;
  executor(function cancel(message) {
    if (token.reason) {
      // Cancellation has already been requested
      return;
    }

    token.reason = new Cancel(message);
    resolvePromise(token.reason);
  });
}

/**
 * Throws a `Cancel` if cancellation has been requested.
 */
CancelToken.prototype.throwIfRequested = function throwIfRequested() {
  if (this.reason) {
    throw this.reason;
  }
};

/**
 * Returns an object that contains a new `CancelToken` and a function that, when called,
 * cancels the `CancelToken`.
 */
CancelToken.source = function source() {
  var cancel;
  var token = new CancelToken(function executor(c) {
    cancel = c;
  });
  return {
    token: token,
    cancel: cancel
  };
};

module.exports = CancelToken;

},{"./Cancel":"../../node_modules/axios/lib/cancel/Cancel.js"}],"../../node_modules/axios/lib/helpers/spread.js":[function(require,module,exports) {
'use strict';

/**
 * Syntactic sugar for invoking a function and expanding an array for arguments.
 *
 * Common use case would be to use `Function.prototype.apply`.
 *
 *  ```js
 *  function f(x, y, z) {}
 *  var args = [1, 2, 3];
 *  f.apply(null, args);
 *  ```
 *
 * With `spread` this example can be re-written.
 *
 *  ```js
 *  spread(function(x, y, z) {})([1, 2, 3]);
 *  ```
 *
 * @param {Function} callback
 * @returns {Function}
 */
module.exports = function spread(callback) {
  return function wrap(arr) {
    return callback.apply(null, arr);
  };
};

},{}],"../../node_modules/axios/lib/helpers/isAxiosError.js":[function(require,module,exports) {
'use strict';

/**
 * Determines whether the payload is an error thrown by Axios
 *
 * @param {*} payload The value to test
 * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false
 */
module.exports = function isAxiosError(payload) {
  return (typeof payload === 'object') && (payload.isAxiosError === true);
};

},{}],"../../node_modules/axios/lib/axios.js":[function(require,module,exports) {
'use strict';

var utils = require('./utils');
var bind = require('./helpers/bind');
var Axios = require('./core/Axios');
var mergeConfig = require('./core/mergeConfig');
var defaults = require('./defaults');

/**
 * Create an instance of Axios
 *
 * @param {Object} defaultConfig The default config for the instance
 * @return {Axios} A new instance of Axios
 */
function createInstance(defaultConfig) {
  var context = new Axios(defaultConfig);
  var instance = bind(Axios.prototype.request, context);

  // Copy axios.prototype to instance
  utils.extend(instance, Axios.prototype, context);

  // Copy context to instance
  utils.extend(instance, context);

  return instance;
}

// Create the default instance to be exported
var axios = createInstance(defaults);

// Expose Axios class to allow class inheritance
axios.Axios = Axios;

// Factory for creating new instances
axios.create = function create(instanceConfig) {
  return createInstance(mergeConfig(axios.defaults, instanceConfig));
};

// Expose Cancel & CancelToken
axios.Cancel = require('./cancel/Cancel');
axios.CancelToken = require('./cancel/CancelToken');
axios.isCancel = require('./cancel/isCancel');

// Expose all/spread
axios.all = function all(promises) {
  return Promise.all(promises);
};
axios.spread = require('./helpers/spread');

// Expose isAxiosError
axios.isAxiosError = require('./helpers/isAxiosError');

module.exports = axios;

// Allow use of default import syntax in TypeScript
module.exports.default = axios;

},{"./utils":"../../node_modules/axios/lib/utils.js","./helpers/bind":"../../node_modules/axios/lib/helpers/bind.js","./core/Axios":"../../node_modules/axios/lib/core/Axios.js","./core/mergeConfig":"../../node_modules/axios/lib/core/mergeConfig.js","./defaults":"../../node_modules/axios/lib/defaults.js","./cancel/Cancel":"../../node_modules/axios/lib/cancel/Cancel.js","./cancel/CancelToken":"../../node_modules/axios/lib/cancel/CancelToken.js","./cancel/isCancel":"../../node_modules/axios/lib/cancel/isCancel.js","./helpers/spread":"../../node_modules/axios/lib/helpers/spread.js","./helpers/isAxiosError":"../../node_modules/axios/lib/helpers/isAxiosError.js"}],"../../node_modules/axios/index.js":[function(require,module,exports) {
module.exports = require('./lib/axios');
},{"./lib/axios":"../../node_modules/axios/lib/axios.js"}],"alerts.js":[function(require,module,exports) {
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.showAlert = exports.hideAlert = void 0;

var hideAlert = function hideAlert() {
  var el = document.querySelector('.alert');
  if (el) el.parentElement.removeChild(el);
}; // type is 'success' or 'error'


exports.hideAlert = hideAlert;

var showAlert = function showAlert(type, msg) {
  hideAlert();
  var markup = "<div class=\"alert alert--".concat(type, "\">").concat(msg, "</div>");
  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);
  window.setTimeout(hideAlert, 5000);
};

exports.showAlert = showAlert;
},{}],"login.js":[function(require,module,exports) {
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.logout = exports.login = void 0;

var _axios = _interopRequireDefault(require("axios"));

var _alerts = require("./alerts");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

var login = /*#__PURE__*/function () {
  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(email, password) {
    var res;
    return regeneratorRuntime.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.prev = 0;
            _context.next = 3;
            return (0, _axios.default)({
              method: 'POST',
              url: 'http://127.0.0.1:8000/api/v1/users/login',
              data: {
                email: email,
                password: password
              }
            });

          case 3:
            res = _context.sent;

            if (res.data.status === 'success') {
              (0, _alerts.showAlert)('success', 'Logged in successfully!');
              window.setTimeout(function () {
                location.assign('/');
              }, 1500);
            }

            _context.next = 10;
            break;

          case 7:
            _context.prev = 7;
            _context.t0 = _context["catch"](0);
            (0, _alerts.showAlert)('error', _context.t0.response.data.message);

          case 10:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, null, [[0, 7]]);
  }));

  return function login(_x, _x2) {
    return _ref.apply(this, arguments);
  };
}();

exports.login = login;

var logout = /*#__PURE__*/function () {
  var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
    var res;
    return regeneratorRuntime.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            _context2.prev = 0;
            _context2.next = 3;
            return (0, _axios.default)({
              method: 'GET',
              url: 'http://127.0.0.1:8000/api/v1/users/logout'
            });

          case 3:
            res = _context2.sent;
            if (res.data.status === 'success') location.reload(true);
            _context2.next = 10;
            break;

          case 7:
            _context2.prev = 7;
            _context2.t0 = _context2["catch"](0);
            (0, _alerts.showAlert)('error', 'Error logging out! Try again.');

          case 10:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, null, [[0, 7]]);
  }));

  return function logout() {
    return _ref2.apply(this, arguments);
  };
}();

exports.logout = logout;
},{"axios":"../../node_modules/axios/index.js","./alerts":"alerts.js"}],"updateSettings.js":[function(require,module,exports) {
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.updateSettings = void 0;

var _axios = _interopRequireDefault(require("axios"));

var _alerts = require("./alerts");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

//Type is either 'password' or 'data'
var updateSettings = /*#__PURE__*/function () {
  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(data, type) {
    var url, res;
    return regeneratorRuntime.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.prev = 0;
            url = type === 'password' ? 'http://127.0.0.1:8000/api/v1/users/updateMyPassword' : 'http://127.0.0.1:8000/api/v1/users/updateMe';
            _context.next = 4;
            return (0, _axios.default)({
              method: 'PATCH',
              url: url,
              data: data
            });

          case 4:
            res = _context.sent;

            if (res.data.status === 'success') {
              (0, _alerts.showAlert)('success', "".concat(type.toUpperCase(), " updated successfully!")); //   window.setTimeout(() => {
              //     location.assign('/me');
              //   }, 1500);
            }

            _context.next = 11;
            break;

          case 8:
            _context.prev = 8;
            _context.t0 = _context["catch"](0);
            (0, _alerts.showAlert)('error', _context.t0.response.data.message);

          case 11:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, null, [[0, 8]]);
  }));

  return function updateSettings(_x, _x2) {
    return _ref.apply(this, arguments);
  };
}();

exports.updateSettings = updateSettings;
},{"axios":"../../node_modules/axios/index.js","./alerts":"alerts.js"}],"index.js":[function(require,module,exports) {
"use strict";

require("core-js/modules/es6.array.copy-within.js");

require("core-js/modules/es6.array.fill.js");

require("core-js/modules/es6.array.find.js");

require("core-js/modules/es6.array.find-index.js");

require("core-js/modules/es7.array.flat-map.js");

require("core-js/modules/es6.array.from.js");

require("core-js/modules/es7.array.includes.js");

require("core-js/modules/es6.array.iterator.js");

require("core-js/modules/es6.array.of.js");

require("core-js/modules/es6.array.sort.js");

require("core-js/modules/es6.array.species.js");

require("core-js/modules/es6.date.to-primitive.js");

require("core-js/modules/es6.function.has-instance.js");

require("core-js/modules/es6.function.name.js");

require("core-js/modules/es6.map.js");

require("core-js/modules/es6.math.acosh.js");

require("core-js/modules/es6.math.asinh.js");

require("core-js/modules/es6.math.atanh.js");

require("core-js/modules/es6.math.cbrt.js");

require("core-js/modules/es6.math.clz32.js");

require("core-js/modules/es6.math.cosh.js");

require("core-js/modules/es6.math.expm1.js");

require("core-js/modules/es6.math.fround.js");

require("core-js/modules/es6.math.hypot.js");

require("core-js/modules/es6.math.imul.js");

require("core-js/modules/es6.math.log1p.js");

require("core-js/modules/es6.math.log10.js");

require("core-js/modules/es6.math.log2.js");

require("core-js/modules/es6.math.sign.js");

require("core-js/modules/es6.math.sinh.js");

require("core-js/modules/es6.math.tanh.js");

require("core-js/modules/es6.math.trunc.js");

require("core-js/modules/es6.number.constructor.js");

require("core-js/modules/es6.number.epsilon.js");

require("core-js/modules/es6.number.is-finite.js");

require("core-js/modules/es6.number.is-integer.js");

require("core-js/modules/es6.number.is-nan.js");

require("core-js/modules/es6.number.is-safe-integer.js");

require("core-js/modules/es6.number.max-safe-integer.js");

require("core-js/modules/es6.number.min-safe-integer.js");

require("core-js/modules/es6.number.parse-float.js");

require("core-js/modules/es6.number.parse-int.js");

require("core-js/modules/es6.object.assign.js");

require("core-js/modules/es7.object.define-getter.js");

require("core-js/modules/es7.object.define-setter.js");

require("core-js/modules/es7.object.entries.js");

require("core-js/modules/es6.object.freeze.js");

require("core-js/modules/es6.object.get-own-property-descriptor.js");

require("core-js/modules/es7.object.get-own-property-descriptors.js");

require("core-js/modules/es6.object.get-own-property-names.js");

require("core-js/modules/es6.object.get-prototype-of.js");

require("core-js/modules/es7.object.lookup-getter.js");

require("core-js/modules/es7.object.lookup-setter.js");

require("core-js/modules/es6.object.prevent-extensions.js");

require("core-js/modules/es6.object.to-string.js");

require("core-js/modules/es6.object.is.js");

require("core-js/modules/es6.object.is-frozen.js");

require("core-js/modules/es6.object.is-sealed.js");

require("core-js/modules/es6.object.is-extensible.js");

require("core-js/modules/es6.object.keys.js");

require("core-js/modules/es6.object.seal.js");

require("core-js/modules/es7.object.values.js");

require("core-js/modules/es6.promise.js");

require("core-js/modules/es7.promise.finally.js");

require("core-js/modules/es6.reflect.apply.js");

require("core-js/modules/es6.reflect.construct.js");

require("core-js/modules/es6.reflect.define-property.js");

require("core-js/modules/es6.reflect.delete-property.js");

require("core-js/modules/es6.reflect.get.js");

require("core-js/modules/es6.reflect.get-own-property-descriptor.js");

require("core-js/modules/es6.reflect.get-prototype-of.js");

require("core-js/modules/es6.reflect.has.js");

require("core-js/modules/es6.reflect.is-extensible.js");

require("core-js/modules/es6.reflect.own-keys.js");

require("core-js/modules/es6.reflect.prevent-extensions.js");

require("core-js/modules/es6.reflect.set.js");

require("core-js/modules/es6.reflect.set-prototype-of.js");

require("core-js/modules/es6.regexp.constructor.js");

require("core-js/modules/es6.regexp.flags.js");

require("core-js/modules/es6.regexp.match.js");

require("core-js/modules/es6.regexp.replace.js");

require("core-js/modules/es6.regexp.split.js");

require("core-js/modules/es6.regexp.search.js");

require("core-js/modules/es6.regexp.to-string.js");

require("core-js/modules/es6.set.js");

require("core-js/modules/es6.symbol.js");

require("core-js/modules/es7.symbol.async-iterator.js");

require("core-js/modules/es6.string.anchor.js");

require("core-js/modules/es6.string.big.js");

require("core-js/modules/es6.string.blink.js");

require("core-js/modules/es6.string.bold.js");

require("core-js/modules/es6.string.code-point-at.js");

require("core-js/modules/es6.string.ends-with.js");

require("core-js/modules/es6.string.fixed.js");

require("core-js/modules/es6.string.fontcolor.js");

require("core-js/modules/es6.string.fontsize.js");

require("core-js/modules/es6.string.from-code-point.js");

require("core-js/modules/es6.string.includes.js");

require("core-js/modules/es6.string.italics.js");

require("core-js/modules/es6.string.iterator.js");

require("core-js/modules/es6.string.link.js");

require("core-js/modules/es7.string.pad-start.js");

require("core-js/modules/es7.string.pad-end.js");

require("core-js/modules/es6.string.raw.js");

require("core-js/modules/es6.string.repeat.js");

require("core-js/modules/es6.string.small.js");

require("core-js/modules/es6.string.starts-with.js");

require("core-js/modules/es6.string.strike.js");

require("core-js/modules/es6.string.sub.js");

require("core-js/modules/es6.string.sup.js");

require("core-js/modules/es7.string.trim-left.js");

require("core-js/modules/es7.string.trim-right.js");

require("core-js/modules/es6.typed.array-buffer.js");

require("core-js/modules/es6.typed.int8-array.js");

require("core-js/modules/es6.typed.uint8-array.js");

require("core-js/modules/es6.typed.uint8-clamped-array.js");

require("core-js/modules/es6.typed.int16-array.js");

require("core-js/modules/es6.typed.uint16-array.js");

require("core-js/modules/es6.typed.int32-array.js");

require("core-js/modules/es6.typed.uint32-array.js");

require("core-js/modules/es6.typed.float32-array.js");

require("core-js/modules/es6.typed.float64-array.js");

require("core-js/modules/es6.weak-map.js");

require("core-js/modules/es6.weak-set.js");

require("core-js/modules/web.timers.js");

require("core-js/modules/web.immediate.js");

require("core-js/modules/web.dom.iterable.js");

require("regenerator-runtime/runtime.js");

var _mapbox = require("./mapbox");

var _login = require("./login");

var _updateSettings = require("./updateSettings");

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

// DOM ELEMENTS
var mapBox = document.getElementById('map');
var loginForm = document.querySelector('.form--login');
var logOutBtn = document.querySelector('.nav__el--logout');
var userDataForm = document.querySelector('.form-user-data');
var userPasswordForm = document.querySelector('.form-user-password'); //DELEGATION

if (mapBox) {
  var locations = JSON.parse(mapBox.dataset.locations);
  (0, _mapbox.displayMap)(locations);
}

if (loginForm) {
  loginForm.addEventListener('submit', function (e) {
    e.preventDefault();
    var email = document.getElementById('email').value;
    var password = document.getElementById('password').value;
    (0, _login.login)(email, password);
  });
}

if (logOutBtn) logOutBtn.addEventListener('click', _login.logout);

if (userDataForm) {
  userDataForm.addEventListener('submit', function (e) {
    e.preventDefault();
    var form = new FormData();
    form.append('name', document.getElementById('name').value);
    form.append('email', document.getElementById('email').value);
    form.append('photo', document.getElementById('photo').files[0]);
    (0, _updateSettings.updateSettings)(form, 'data');
  });
}

if (userPasswordForm) {
  userPasswordForm.addEventListener('submit', /*#__PURE__*/function () {
    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(e) {
      var passwordCurrent, password, passwordConfirm;
      return regeneratorRuntime.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              e.preventDefault();
              document.querySelector('.btn--save-password').textContent = 'Updating...';
              passwordCurrent = document.getElementById('password-current').value;
              password = document.getElementById('password').value;
              passwordConfirm = document.getElementById('password-confirm').value;
              _context.next = 7;
              return (0, _updateSettings.updateSettings)({
                passwordCurrent: passwordCurrent,
                password: password,
                passwordConfirm: passwordConfirm
              }, 'password');

            case 7:
              document.querySelector('.btn--save-password').textContent = 'SAVE PASSWORD';
              document.getElementById('password-current').value = '';
              document.getElementById('password').value = '';
              document.getElementById('password-confirm').value = '';

            case 11:
            case "end":
              return _context.stop();
          }
        }
      }, _callee);
    }));

    return function (_x) {
      return _ref.apply(this, arguments);
    };
  }());
}
},{"core-js/modules/es6.array.copy-within.js":"../../node_modules/core-js/modules/es6.array.copy-within.js","core-js/modules/es6.array.fill.js":"../../node_modules/core-js/modules/es6.array.fill.js","core-js/modules/es6.array.find.js":"../../node_modules/core-js/modules/es6.array.find.js","core-js/modules/es6.array.find-index.js":"../../node_modules/core-js/modules/es6.array.find-index.js","core-js/modules/es7.array.flat-map.js":"../../node_modules/core-js/modules/es7.array.flat-map.js","core-js/modules/es6.array.from.js":"../../node_modules/core-js/modules/es6.array.from.js","core-js/modules/es7.array.includes.js":"../../node_modules/core-js/modules/es7.array.includes.js","core-js/modules/es6.array.iterator.js":"../../node_modules/core-js/modules/es6.array.iterator.js","core-js/modules/es6.array.of.js":"../../node_modules/core-js/modules/es6.array.of.js","core-js/modules/es6.array.sort.js":"../../node_modules/core-js/modules/es6.array.sort.js","core-js/modules/es6.array.species.js":"../../node_modules/core-js/modules/es6.array.species.js","core-js/modules/es6.date.to-primitive.js":"../../node_modules/core-js/modules/es6.date.to-primitive.js","core-js/modules/es6.function.has-instance.js":"../../node_modules/core-js/modules/es6.function.has-instance.js","core-js/modules/es6.function.name.js":"../../node_modules/core-js/modules/es6.function.name.js","core-js/modules/es6.map.js":"../../node_modules/core-js/modules/es6.map.js","core-js/modules/es6.math.acosh.js":"../../node_modules/core-js/modules/es6.math.acosh.js","core-js/modules/es6.math.asinh.js":"../../node_modules/core-js/modules/es6.math.asinh.js","core-js/modules/es6.math.atanh.js":"../../node_modules/core-js/modules/es6.math.atanh.js","core-js/modules/es6.math.cbrt.js":"../../node_modules/core-js/modules/es6.math.cbrt.js","core-js/modules/es6.math.clz32.js":"../../node_modules/core-js/modules/es6.math.clz32.js","core-js/modules/es6.math.cosh.js":"../../node_modules/core-js/modules/es6.math.cosh.js","core-js/modules/es6.math.expm1.js":"../../node_modules/core-js/modules/es6.math.expm1.js","core-js/modules/es6.math.fround.js":"../../node_modules/core-js/modules/es6.math.fround.js","core-js/modules/es6.math.hypot.js":"../../node_modules/core-js/modules/es6.math.hypot.js","core-js/modules/es6.math.imul.js":"../../node_modules/core-js/modules/es6.math.imul.js","core-js/modules/es6.math.log1p.js":"../../node_modules/core-js/modules/es6.math.log1p.js","core-js/modules/es6.math.log10.js":"../../node_modules/core-js/modules/es6.math.log10.js","core-js/modules/es6.math.log2.js":"../../node_modules/core-js/modules/es6.math.log2.js","core-js/modules/es6.math.sign.js":"../../node_modules/core-js/modules/es6.math.sign.js","core-js/modules/es6.math.sinh.js":"../../node_modules/core-js/modules/es6.math.sinh.js","core-js/modules/es6.math.tanh.js":"../../node_modules/core-js/modules/es6.math.tanh.js","core-js/modules/es6.math.trunc.js":"../../node_modules/core-js/modules/es6.math.trunc.js","core-js/modules/es6.number.constructor.js":"../../node_modules/core-js/modules/es6.number.constructor.js","core-js/modules/es6.number.epsilon.js":"../../node_modules/core-js/modules/es6.number.epsilon.js","core-js/modules/es6.number.is-finite.js":"../../node_modules/core-js/modules/es6.number.is-finite.js","core-js/modules/es6.number.is-integer.js":"../../node_modules/core-js/modules/es6.number.is-integer.js","core-js/modules/es6.number.is-nan.js":"../../node_modules/core-js/modules/es6.number.is-nan.js","core-js/modules/es6.number.is-safe-integer.js":"../../node_modules/core-js/modules/es6.number.is-safe-integer.js","core-js/modules/es6.number.max-safe-integer.js":"../../node_modules/core-js/modules/es6.number.max-safe-integer.js","core-js/modules/es6.number.min-safe-integer.js":"../../node_modules/core-js/modules/es6.number.min-safe-integer.js","core-js/modules/es6.number.parse-float.js":"../../node_modules/core-js/modules/es6.number.parse-float.js","core-js/modules/es6.number.parse-int.js":"../../node_modules/core-js/modules/es6.number.parse-int.js","core-js/modules/es6.object.assign.js":"../../node_modules/core-js/modules/es6.object.assign.js","core-js/modules/es7.object.define-getter.js":"../../node_modules/core-js/modules/es7.object.define-getter.js","core-js/modules/es7.object.define-setter.js":"../../node_modules/core-js/modules/es7.object.define-setter.js","core-js/modules/es7.object.entries.js":"../../node_modules/core-js/modules/es7.object.entries.js","core-js/modules/es6.object.freeze.js":"../../node_modules/core-js/modules/es6.object.freeze.js","core-js/modules/es6.object.get-own-property-descriptor.js":"../../node_modules/core-js/modules/es6.object.get-own-property-descriptor.js","core-js/modules/es7.object.get-own-property-descriptors.js":"../../node_modules/core-js/modules/es7.object.get-own-property-descriptors.js","core-js/modules/es6.object.get-own-property-names.js":"../../node_modules/core-js/modules/es6.object.get-own-property-names.js","core-js/modules/es6.object.get-prototype-of.js":"../../node_modules/core-js/modules/es6.object.get-prototype-of.js","core-js/modules/es7.object.lookup-getter.js":"../../node_modules/core-js/modules/es7.object.lookup-getter.js","core-js/modules/es7.object.lookup-setter.js":"../../node_modules/core-js/modules/es7.object.lookup-setter.js","core-js/modules/es6.object.prevent-extensions.js":"../../node_modules/core-js/modules/es6.object.prevent-extensions.js","core-js/modules/es6.object.to-string.js":"../../node_modules/core-js/modules/es6.object.to-string.js","core-js/modules/es6.object.is.js":"../../node_modules/core-js/modules/es6.object.is.js","core-js/modules/es6.object.is-frozen.js":"../../node_modules/core-js/modules/es6.object.is-frozen.js","core-js/modules/es6.object.is-sealed.js":"../../node_modules/core-js/modules/es6.object.is-sealed.js","core-js/modules/es6.object.is-extensible.js":"../../node_modules/core-js/modules/es6.object.is-extensible.js","core-js/modules/es6.object.keys.js":"../../node_modules/core-js/modules/es6.object.keys.js","core-js/modules/es6.object.seal.js":"../../node_modules/core-js/modules/es6.object.seal.js","core-js/modules/es7.object.values.js":"../../node_modules/core-js/modules/es7.object.values.js","core-js/modules/es6.promise.js":"../../node_modules/core-js/modules/es6.promise.js","core-js/modules/es7.promise.finally.js":"../../node_modules/core-js/modules/es7.promise.finally.js","core-js/modules/es6.reflect.apply.js":"../../node_modules/core-js/modules/es6.reflect.apply.js","core-js/modules/es6.reflect.construct.js":"../../node_modules/core-js/modules/es6.reflect.construct.js","core-js/modules/es6.reflect.define-property.js":"../../node_modules/core-js/modules/es6.reflect.define-property.js","core-js/modules/es6.reflect.delete-property.js":"../../node_modules/core-js/modules/es6.reflect.delete-property.js","core-js/modules/es6.reflect.get.js":"../../node_modules/core-js/modules/es6.reflect.get.js","core-js/modules/es6.reflect.get-own-property-descriptor.js":"../../node_modules/core-js/modules/es6.reflect.get-own-property-descriptor.js","core-js/modules/es6.reflect.get-prototype-of.js":"../../node_modules/core-js/modules/es6.reflect.get-prototype-of.js","core-js/modules/es6.reflect.has.js":"../../node_modules/core-js/modules/es6.reflect.has.js","core-js/modules/es6.reflect.is-extensible.js":"../../node_modules/core-js/modules/es6.reflect.is-extensible.js","core-js/modules/es6.reflect.own-keys.js":"../../node_modules/core-js/modules/es6.reflect.own-keys.js","core-js/modules/es6.reflect.prevent-extensions.js":"../../node_modules/core-js/modules/es6.reflect.prevent-extensions.js","core-js/modules/es6.reflect.set.js":"../../node_modules/core-js/modules/es6.reflect.set.js","core-js/modules/es6.reflect.set-prototype-of.js":"../../node_modules/core-js/modules/es6.reflect.set-prototype-of.js","core-js/modules/es6.regexp.constructor.js":"../../node_modules/core-js/modules/es6.regexp.constructor.js","core-js/modules/es6.regexp.flags.js":"../../node_modules/core-js/modules/es6.regexp.flags.js","core-js/modules/es6.regexp.match.js":"../../node_modules/core-js/modules/es6.regexp.match.js","core-js/modules/es6.regexp.replace.js":"../../node_modules/core-js/modules/es6.regexp.replace.js","core-js/modules/es6.regexp.split.js":"../../node_modules/core-js/modules/es6.regexp.split.js","core-js/modules/es6.regexp.search.js":"../../node_modules/core-js/modules/es6.regexp.search.js","core-js/modules/es6.regexp.to-string.js":"../../node_modules/core-js/modules/es6.regexp.to-string.js","core-js/modules/es6.set.js":"../../node_modules/core-js/modules/es6.set.js","core-js/modules/es6.symbol.js":"../../node_modules/core-js/modules/es6.symbol.js","core-js/modules/es7.symbol.async-iterator.js":"../../node_modules/core-js/modules/es7.symbol.async-iterator.js","core-js/modules/es6.string.anchor.js":"../../node_modules/core-js/modules/es6.string.anchor.js","core-js/modules/es6.string.big.js":"../../node_modules/core-js/modules/es6.string.big.js","core-js/modules/es6.string.blink.js":"../../node_modules/core-js/modules/es6.string.blink.js","core-js/modules/es6.string.bold.js":"../../node_modules/core-js/modules/es6.string.bold.js","core-js/modules/es6.string.code-point-at.js":"../../node_modules/core-js/modules/es6.string.code-point-at.js","core-js/modules/es6.string.ends-with.js":"../../node_modules/core-js/modules/es6.string.ends-with.js","core-js/modules/es6.string.fixed.js":"../../node_modules/core-js/modules/es6.string.fixed.js","core-js/modules/es6.string.fontcolor.js":"../../node_modules/core-js/modules/es6.string.fontcolor.js","core-js/modules/es6.string.fontsize.js":"../../node_modules/core-js/modules/es6.string.fontsize.js","core-js/modules/es6.string.from-code-point.js":"../../node_modules/core-js/modules/es6.string.from-code-point.js","core-js/modules/es6.string.includes.js":"../../node_modules/core-js/modules/es6.string.includes.js","core-js/modules/es6.string.italics.js":"../../node_modules/core-js/modules/es6.string.italics.js","core-js/modules/es6.string.iterator.js":"../../node_modules/core-js/modules/es6.string.iterator.js","core-js/modules/es6.string.link.js":"../../node_modules/core-js/modules/es6.string.link.js","core-js/modules/es7.string.pad-start.js":"../../node_modules/core-js/modules/es7.string.pad-start.js","core-js/modules/es7.string.pad-end.js":"../../node_modules/core-js/modules/es7.string.pad-end.js","core-js/modules/es6.string.raw.js":"../../node_modules/core-js/modules/es6.string.raw.js","core-js/modules/es6.string.repeat.js":"../../node_modules/core-js/modules/es6.string.repeat.js","core-js/modules/es6.string.small.js":"../../node_modules/core-js/modules/es6.string.small.js","core-js/modules/es6.string.starts-with.js":"../../node_modules/core-js/modules/es6.string.starts-with.js","core-js/modules/es6.string.strike.js":"../../node_modules/core-js/modules/es6.string.strike.js","core-js/modules/es6.string.sub.js":"../../node_modules/core-js/modules/es6.string.sub.js","core-js/modules/es6.string.sup.js":"../../node_modules/core-js/modules/es6.string.sup.js","core-js/modules/es7.string.trim-left.js":"../../node_modules/core-js/modules/es7.string.trim-left.js","core-js/modules/es7.string.trim-right.js":"../../node_modules/core-js/modules/es7.string.trim-right.js","core-js/modules/es6.typed.array-buffer.js":"../../node_modules/core-js/modules/es6.typed.array-buffer.js","core-js/modules/es6.typed.int8-array.js":"../../node_modules/core-js/modules/es6.typed.int8-array.js","core-js/modules/es6.typed.uint8-array.js":"../../node_modules/core-js/modules/es6.typed.uint8-array.js","core-js/modules/es6.typed.uint8-clamped-array.js":"../../node_modules/core-js/modules/es6.typed.uint8-clamped-array.js","core-js/modules/es6.typed.int16-array.js":"../../node_modules/core-js/modules/es6.typed.int16-array.js","core-js/modules/es6.typed.uint16-array.js":"../../node_modules/core-js/modules/es6.typed.uint16-array.js","core-js/modules/es6.typed.int32-array.js":"../../node_modules/core-js/modules/es6.typed.int32-array.js","core-js/modules/es6.typed.uint32-array.js":"../../node_modules/core-js/modules/es6.typed.uint32-array.js","core-js/modules/es6.typed.float32-array.js":"../../node_modules/core-js/modules/es6.typed.float32-array.js","core-js/modules/es6.typed.float64-array.js":"../../node_modules/core-js/modules/es6.typed.float64-array.js","core-js/modules/es6.weak-map.js":"../../node_modules/core-js/modules/es6.weak-map.js","core-js/modules/es6.weak-set.js":"../../node_modules/core-js/modules/es6.weak-set.js","core-js/modules/web.timers.js":"../../node_modules/core-js/modules/web.timers.js","core-js/modules/web.immediate.js":"../../node_modules/core-js/modules/web.immediate.js","core-js/modules/web.dom.iterable.js":"../../node_modules/core-js/modules/web.dom.iterable.js","regenerator-runtime/runtime.js":"../../node_modules/regenerator-runtime/runtime.js","./mapbox":"mapbox.js","./login":"login.js","./updateSettings":"updateSettings.js"}],"../../node_modules/parcel-bundler/src/builtins/hmr-runtime.js":[function(require,module,exports) {
var global = arguments[3];
var OVERLAY_ID = '__parcel__error__overlay__';
var OldModule = module.bundle.Module;

function Module(moduleName) {
  OldModule.call(this, moduleName);
  this.hot = {
    data: module.bundle.hotData,
    _acceptCallbacks: [],
    _disposeCallbacks: [],
    accept: function (fn) {
      this._acceptCallbacks.push(fn || function () {});
    },
    dispose: function (fn) {
      this._disposeCallbacks.push(fn);
    }
  };
  module.bundle.hotData = null;
}

module.bundle.Module = Module;
var checkedAssets, assetsToAccept;
var parent = module.bundle.parent;

if ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {
  var hostname = "" || location.hostname;
  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';
  var ws = new WebSocket(protocol + '://' + hostname + ':' + "51918" + '/');

  ws.onmessage = function (event) {
    checkedAssets = {};
    assetsToAccept = [];
    var data = JSON.parse(event.data);

    if (data.type === 'update') {
      var handled = false;
      data.assets.forEach(function (asset) {
        if (!asset.isNew) {
          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);

          if (didAccept) {
            handled = true;
          }
        }
      }); // Enable HMR for CSS by default.

      handled = handled || data.assets.every(function (asset) {
        return asset.type === 'css' && asset.generated.js;
      });

      if (handled) {
        console.clear();
        data.assets.forEach(function (asset) {
          hmrApply(global.parcelRequire, asset);
        });
        assetsToAccept.forEach(function (v) {
          hmrAcceptRun(v[0], v[1]);
        });
      } else if (location.reload) {
        // `location` global exists in a web worker context but lacks `.reload()` function.
        location.reload();
      }
    }

    if (data.type === 'reload') {
      ws.close();

      ws.onclose = function () {
        location.reload();
      };
    }

    if (data.type === 'error-resolved') {
      console.log('[parcel] â¨ Error resolved');
      removeErrorOverlay();
    }

    if (data.type === 'error') {
      console.error('[parcel] ð¨  ' + data.error.message + '\n' + data.error.stack);
      removeErrorOverlay();
      var overlay = createErrorOverlay(data);
      document.body.appendChild(overlay);
    }
  };
}

function removeErrorOverlay() {
  var overlay = document.getElementById(OVERLAY_ID);

  if (overlay) {
    overlay.remove();
  }
}

function createErrorOverlay(data) {
  var overlay = document.createElement('div');
  overlay.id = OVERLAY_ID; // html encode message and stack trace

  var message = document.createElement('div');
  var stackTrace = document.createElement('pre');
  message.innerText = data.error.message;
  stackTrace.innerText = data.error.stack;
  overlay.innerHTML = '<div style="background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;">' + '<span style="background: red; padding: 2px 4px; border-radius: 2px;">ERROR</span>' + '<span style="top: 2px; margin-left: 5px; position: relative;">ð¨</span>' + '<div style="font-size: 18px; font-weight: bold; margin-top: 20px;">' + message.innerHTML + '</div>' + '<pre>' + stackTrace.innerHTML + '</pre>' + '</div>';
  return overlay;
}

function getParents(bundle, id) {
  var modules = bundle.modules;

  if (!modules) {
    return [];
  }

  var parents = [];
  var k, d, dep;

  for (k in modules) {
    for (d in modules[k][1]) {
      dep = modules[k][1][d];

      if (dep === id || Array.isArray(dep) && dep[dep.length - 1] === id) {
        parents.push(k);
      }
    }
  }

  if (bundle.parent) {
    parents = parents.concat(getParents(bundle.parent, id));
  }

  return parents;
}

function hmrApply(bundle, asset) {
  var modules = bundle.modules;

  if (!modules) {
    return;
  }

  if (modules[asset.id] || !bundle.parent) {
    var fn = new Function('require', 'module', 'exports', asset.generated.js);
    asset.isNew = !modules[asset.id];
    modules[asset.id] = [fn, asset.deps];
  } else if (bundle.parent) {
    hmrApply(bundle.parent, asset);
  }
}

function hmrAcceptCheck(bundle, id) {
  var modules = bundle.modules;

  if (!modules) {
    return;
  }

  if (!modules[id] && bundle.parent) {
    return hmrAcceptCheck(bundle.parent, id);
  }

  if (checkedAssets[id]) {
    return;
  }

  checkedAssets[id] = true;
  var cached = bundle.cache[id];
  assetsToAccept.push([bundle, id]);

  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {
    return true;
  }

  return getParents(global.parcelRequire, id).some(function (id) {
    return hmrAcceptCheck(global.parcelRequire, id);
  });
}

function hmrAcceptRun(bundle, id) {
  var cached = bundle.cache[id];
  bundle.hotData = {};

  if (cached) {
    cached.hot.data = bundle.hotData;
  }

  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {
    cached.hot._disposeCallbacks.forEach(function (cb) {
      cb(bundle.hotData);
    });
  }

  delete bundle.cache[id];
  bundle(id);
  cached = bundle.cache[id];

  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {
    cached.hot._acceptCallbacks.forEach(function (cb) {
      cb();
    });

    return true;
  }
}
},{}]},{},["../../node_modules/parcel-bundler/src/builtins/hmr-runtime.js","index.js"], null)
//# sourceMappingURL=/bundle.js.map